<!DOCTYPE html>
<html lang="en">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="3dmathprimer_book.css" rel="stylesheet">
<link rel="icon" type="image/png" href="../favicon.png">
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-YK41S9NXZG"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-YK41S9NXZG');
    </script>
<title>Geometric Tests - 3D Math Primer for Graphics and Game Development</title>
<style id="MJX-CHTML-styles">
mjx-container[jax="CHTML"] {
  line-height: 0;
}

mjx-container [space="1"] {
  margin-left: .111em;
}

mjx-container [space="2"] {
  margin-left: .167em;
}

mjx-container [space="3"] {
  margin-left: .222em;
}

mjx-container [space="4"] {
  margin-left: .278em;
}

mjx-container [space="5"] {
  margin-left: .333em;
}

mjx-container [rspace="1"] {
  margin-right: .111em;
}

mjx-container [rspace="2"] {
  margin-right: .167em;
}

mjx-container [rspace="3"] {
  margin-right: .222em;
}

mjx-container [rspace="4"] {
  margin-right: .278em;
}

mjx-container [rspace="5"] {
  margin-right: .333em;
}

mjx-container [size="s"] {
  font-size: 70.7%;
}

mjx-container [size="ss"] {
  font-size: 50%;
}

mjx-container [size="Tn"] {
  font-size: 60%;
}

mjx-container [size="sm"] {
  font-size: 85%;
}

mjx-container [size="lg"] {
  font-size: 120%;
}

mjx-container [size="Lg"] {
  font-size: 144%;
}

mjx-container [size="LG"] {
  font-size: 173%;
}

mjx-container [size="hg"] {
  font-size: 207%;
}

mjx-container [size="HG"] {
  font-size: 249%;
}

mjx-container [width="full"] {
  width: 100%;
}

mjx-box {
  display: inline-block;
}

mjx-block {
  display: block;
}

mjx-itable {
  display: inline-table;
}

mjx-row {
  display: table-row;
}

mjx-row > * {
  display: table-cell;
}

mjx-mtext {
  display: inline-block;
  text-align: left;
}

mjx-mstyle {
  display: inline-block;
}

mjx-merror {
  display: inline-block;
  color: red;
  background-color: yellow;
}

mjx-mphantom {
  visibility: hidden;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-math {
  display: inline-block;
  text-align: left;
  line-height: 0;
  text-indent: 0;
  font-style: normal;
  font-weight: normal;
  font-size: 100%;
  font-size-adjust: none;
  letter-spacing: normal;
  word-wrap: normal;
  word-spacing: normal;
  white-space: nowrap;
  direction: ltr;
  padding: 1px 0;
}

mjx-container[jax="CHTML"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="CHTML"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="CHTML"][display="true"] mjx-math {
  padding: 0;
}

mjx-container[jax="CHTML"][justify="left"] {
  text-align: left;
}

mjx-container[jax="CHTML"][justify="right"] {
  text-align: right;
}

mjx-mrow {
  display: inline-block;
  text-align: left;
}

mjx-inferredMrow {
  display: inline-block;
  text-align: left;
}

mjx-mi {
  display: inline-block;
  text-align: left;
}

mjx-mo {
  display: inline-block;
  text-align: left;
}

mjx-stretchy-h {
  display: inline-table;
  width: 100%;
}

mjx-stretchy-h > * {
  display: table-cell;
  width: 0;
}

mjx-stretchy-h > * > mjx-c {
  display: inline-block;
  transform: scalex(1.0000001);
}

mjx-stretchy-h > * > mjx-c::before {
  display: inline-block;
  padding: .001em 0;
  width: initial;
}

mjx-stretchy-h > mjx-ext {
  overflow: hidden;
  width: 100%;
}

mjx-stretchy-h > mjx-ext > mjx-c::before {
  transform: scalex(500);
}

mjx-stretchy-h > mjx-ext > mjx-c {
  width: 0;
}

mjx-stretchy-h > mjx-beg > mjx-c {
  margin-right: -.1em;
}

mjx-stretchy-h > mjx-end > mjx-c {
  margin-left: -.1em;
}

mjx-stretchy-v {
  display: inline-block;
}

mjx-stretchy-v > * {
  display: block;
}

mjx-stretchy-v > mjx-beg {
  height: 0;
}

mjx-stretchy-v > mjx-end > mjx-c {
  display: block;
}

mjx-stretchy-v > * > mjx-c {
  transform: scaley(1.0000001);
  transform-origin: left center;
  overflow: hidden;
}

mjx-stretchy-v > mjx-ext {
  display: block;
  height: 100%;
  box-sizing: border-box;
  border: 0px solid transparent;
  overflow: hidden;
}

mjx-stretchy-v > mjx-ext > mjx-c::before {
  width: initial;
}

mjx-stretchy-v > mjx-ext > mjx-c {
  transform: scaleY(500) translateY(.1em);
  overflow: visible;
}

mjx-mark {
  display: inline-block;
  height: 0px;
}

mjx-mn {
  display: inline-block;
  text-align: left;
}

mjx-ms {
  display: inline-block;
  text-align: left;
}

mjx-mspace {
  display: inline-block;
  text-align: left;
}

mjx-mpadded {
  display: inline-block;
  text-align: left;
}

mjx-rbox {
  display: inline-block;
  position: relative;
}

mjx-menclose {
  display: inline-block;
  text-align: left;
  position: relative;
}

mjx-menclose > mjx-dstrike {
  display: inline-block;
  left: 0;
  top: 0;
  position: absolute;
  border-top: 0.067em solid;
  transform-origin: top left;
}

mjx-menclose > mjx-ustrike {
  display: inline-block;
  left: 0;
  bottom: 0;
  position: absolute;
  border-top: 0.067em solid;
  transform-origin: bottom left;
}

mjx-menclose > mjx-hstrike {
  border-top: 0.067em solid;
  position: absolute;
  left: 0;
  right: 0;
  bottom: 50%;
  transform: translateY(0.034em);
}

mjx-menclose > mjx-vstrike {
  border-left: 0.067em solid;
  position: absolute;
  top: 0;
  bottom: 0;
  right: 50%;
  transform: translateX(0.034em);
}

mjx-menclose > mjx-rbox {
  position: absolute;
  top: 0;
  bottom: 0;
  right: 0;
  left: 0;
  border: 0.067em solid;
  border-radius: 0.267em;
}

mjx-menclose > mjx-cbox {
  position: absolute;
  top: 0;
  bottom: 0;
  right: 0;
  left: 0;
  border: 0.067em solid;
  border-radius: 50%;
}

mjx-menclose > mjx-arrow {
  position: absolute;
  left: 0;
  bottom: 50%;
  height: 0;
  width: 0;
}

mjx-menclose > mjx-arrow > * {
  display: block;
  position: absolute;
  transform-origin: bottom;
  border-left: 0.268em solid;
  border-right: 0;
  box-sizing: border-box;
}

mjx-menclose > mjx-arrow > mjx-aline {
  left: 0;
  top: -0.034em;
  right: 0.201em;
  height: 0;
  border-top: 0.067em solid;
  border-left: 0;
}

mjx-menclose > mjx-arrow[double] > mjx-aline {
  left: 0.201em;
  height: 0;
}

mjx-menclose > mjx-arrow > mjx-rthead {
  transform: skewX(0.464rad);
  right: 0;
  bottom: -1px;
  border-bottom: 1px solid transparent;
  border-top: 0.134em solid transparent;
}

mjx-menclose > mjx-arrow > mjx-rbhead {
  transform: skewX(-0.464rad);
  transform-origin: top;
  right: 0;
  top: -1px;
  border-top: 1px solid transparent;
  border-bottom: 0.134em solid transparent;
}

mjx-menclose > mjx-arrow > mjx-lthead {
  transform: skewX(-0.464rad);
  left: 0;
  bottom: -1px;
  border-left: 0;
  border-right: 0.268em solid;
  border-bottom: 1px solid transparent;
  border-top: 0.134em solid transparent;
}

mjx-menclose > mjx-arrow > mjx-lbhead {
  transform: skewX(0.464rad);
  transform-origin: top;
  left: 0;
  top: -1px;
  border-left: 0;
  border-right: 0.268em solid;
  border-top: 1px solid transparent;
  border-bottom: 0.134em solid transparent;
}

mjx-menclose > dbox {
  position: absolute;
  top: 0;
  bottom: 0;
  left: -0.3em;
  width: 0.6em;
  border: 0.067em solid;
  border-radius: 50%;
  clip-path: inset(0 0 0 0.3em);
  box-sizing: border-box;
}

mjx-mfrac {
  display: inline-block;
  text-align: left;
}

mjx-frac {
  display: inline-block;
  vertical-align: 0.17em;
  padding: 0 .22em;
}

mjx-frac[type="d"] {
  vertical-align: .04em;
}

mjx-frac[delims] {
  padding: 0 .1em;
}

mjx-frac[atop] {
  padding: 0 .12em;
}

mjx-frac[atop][delims] {
  padding: 0;
}

mjx-dtable {
  display: inline-table;
  width: 100%;
}

mjx-dtable > * {
  font-size: 2000%;
}

mjx-dbox {
  display: block;
  font-size: 5%;
}

mjx-num {
  display: block;
  text-align: center;
}

mjx-den {
  display: block;
  text-align: center;
}

mjx-mfrac[bevelled] > mjx-num {
  display: inline-block;
}

mjx-mfrac[bevelled] > mjx-den {
  display: inline-block;
}

mjx-den[align="right"], mjx-num[align="right"] {
  text-align: right;
}

mjx-den[align="left"], mjx-num[align="left"] {
  text-align: left;
}

mjx-nstrut {
  display: inline-block;
  height: .054em;
  width: 0;
  vertical-align: -.054em;
}

mjx-nstrut[type="d"] {
  height: .217em;
  vertical-align: -.217em;
}

mjx-dstrut {
  display: inline-block;
  height: .505em;
  width: 0;
}

mjx-dstrut[type="d"] {
  height: .726em;
}

mjx-line {
  display: block;
  box-sizing: border-box;
  min-height: 1px;
  height: .06em;
  border-top: .06em solid;
  margin: .06em -.1em;
  overflow: hidden;
}

mjx-line[type="d"] {
  margin: .18em -.1em;
}

mjx-msqrt {
  display: inline-block;
  text-align: left;
}

mjx-root {
  display: inline-block;
  white-space: nowrap;
}

mjx-surd {
  display: inline-block;
  vertical-align: top;
}

mjx-sqrt {
  display: inline-block;
  padding-top: .07em;
}

mjx-sqrt > mjx-box {
  border-top: .07em solid;
}

mjx-sqrt.mjx-tall > mjx-box {
  padding-left: .3em;
  margin-left: -.3em;
}

mjx-mroot {
  display: inline-block;
  text-align: left;
}

mjx-msub {
  display: inline-block;
  text-align: left;
}

mjx-msup {
  display: inline-block;
  text-align: left;
}

mjx-msubsup {
  display: inline-block;
  text-align: left;
}

mjx-script {
  display: inline-block;
  padding-right: .05em;
}

mjx-script > * {
  display: block;
}

mjx-munder {
  display: inline-block;
  text-align: left;
}

mjx-over {
  text-align: left;
}

mjx-munder:not([limits="false"]) {
  display: inline-table;
}

mjx-munder > mjx-row {
  text-align: left;
}

mjx-under {
  padding-bottom: .1em;
}

mjx-mover {
  display: inline-block;
  text-align: left;
}

mjx-mover:not([limits="false"]) {
  padding-top: .1em;
}

mjx-mover:not([limits="false"]) > * {
  display: block;
  text-align: left;
}

mjx-munderover {
  display: inline-block;
  text-align: left;
}

mjx-munderover:not([limits="false"]) {
  padding-top: .1em;
}

mjx-munderover:not([limits="false"]) > * {
  display: block;
}

mjx-mmultiscripts {
  display: inline-block;
  text-align: left;
}

mjx-prescripts {
  display: inline-table;
  padding-left: .05em;
}

mjx-scripts {
  display: inline-table;
  padding-right: .05em;
}

mjx-prescripts > mjx-row > mjx-cell {
  text-align: right;
}

mjx-mfenced {
  display: inline-block;
  text-align: left;
}

mjx-mtable {
  display: inline-block;
  text-align: center;
  vertical-align: .25em;
  position: relative;
  box-sizing: border-box;
}

mjx-table {
  display: inline-block;
  vertical-align: -.5ex;
}

mjx-table > mjx-itable {
  vertical-align: middle;
  text-align: left;
  box-sizing: border-box;
}



mjx-mtable[justify="left"] {
  text-align: left;
}

mjx-mtable[justify="right"] {
  text-align: right;
}

mjx-mtable[justify="left"][side="left"] {
  padding-right: 0 ! important;
}

mjx-mtable[justify="left"][side="right"] {
  padding-left: 0 ! important;
}

mjx-mtable[justify="right"][side="left"] {
  padding-right: 0 ! important;
}

mjx-mtable[justify="right"][side="right"] {
  padding-left: 0 ! important;
}

mjx-mtable[align] {
  vertical-align: baseline;
}

mjx-mtable[align="top"] > mjx-table {
  vertical-align: top;
}

mjx-mtable[align="bottom"] > mjx-table {
  vertical-align: bottom;
}


mjx-mtr {
  display: table-row;
  text-align: left;
}

mjx-mtr[rowalign="top"] > mjx-mtd {
  vertical-align: top;
}

mjx-mtr[rowalign="center"] > mjx-mtd {
  vertical-align: middle;
}

mjx-mtr[rowalign="bottom"] > mjx-mtd {
  vertical-align: bottom;
}

mjx-mtr[rowalign="baseline"] > mjx-mtd {
  vertical-align: baseline;
}

mjx-mtr[rowalign="axis"] > mjx-mtd {
  vertical-align: .25em;
}

mjx-mlabeledtr {
  display: table-row;
  text-align: left;
}

mjx-mlabeledtr[rowalign="top"] > mjx-mtd {
  vertical-align: top;
}

mjx-mlabeledtr[rowalign="center"] > mjx-mtd {
  vertical-align: middle;
}

mjx-mlabeledtr[rowalign="bottom"] > mjx-mtd {
  vertical-align: bottom;
}

mjx-mlabeledtr[rowalign="baseline"] > mjx-mtd {
  vertical-align: baseline;
}

mjx-mlabeledtr[rowalign="axis"] > mjx-mtd {
  vertical-align: .25em;
}

mjx-mtd {
  display: table-cell;
  text-align: center;
  padding: .215em .4em;
}

mjx-mtd:first-child {
  padding-left: 0;
}

mjx-mtd:last-child {
  padding-right: 0;
}

mjx-mtable > * > mjx-itable > *:first-child > mjx-mtd {
  padding-top: 0;
}

mjx-mtable > * > mjx-itable > *:last-child > mjx-mtd {
  padding-bottom: 0;
}

mjx-tstrut {
  display: inline-block;
  height: 1em;
  vertical-align: -.25em;
}

mjx-labels[align="left"] > mjx-mtr > mjx-mtd {
  text-align: left;
}

mjx-labels[align="right"] > mjx-mtr > mjx-mtd {
  text-align: right;
}

mjx-mtr mjx-mtd[rowalign="top"], mjx-mlabeledtr mjx-mtd[rowalign="top"] {
  vertical-align: top;
}

mjx-mtr mjx-mtd[rowalign="center"], mjx-mlabeledtr mjx-mtd[rowalign="center"] {
  vertical-align: middle;
}

mjx-mtr mjx-mtd[rowalign="bottom"], mjx-mlabeledtr mjx-mtd[rowalign="bottom"] {
  vertical-align: bottom;
}

mjx-mtr mjx-mtd[rowalign="baseline"], mjx-mlabeledtr mjx-mtd[rowalign="baseline"] {
  vertical-align: baseline;
}

mjx-mtr mjx-mtd[rowalign="axis"], mjx-mlabeledtr mjx-mtd[rowalign="axis"] {
  vertical-align: .25em;
}

mjx-maction {
  display: inline-block;
  text-align: left;
  position: relative;
}

mjx-maction > mjx-tool {
  display: none;
  position: absolute;
  bottom: 0;
  right: 0;
  width: 0;
  height: 0;
  z-index: 500;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

mjx-maction[toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

mjx-mglyph {
  display: inline-block;
  text-align: left;
}

mjx-mglyph > img {
  display: inline-block;
  border: 0;
  padding: 0;
}

mjx-semantics {
  display: inline-block;
  text-align: left;
}

mjx-annotation {
  display: inline-block;
  text-align: left;
}

mjx-annotation-xml {
  display: inline-block;
  text-align: left;
  font-family: initial;
  line-height: normal;
}

mjx-TeXAtom {
  display: inline-block;
  text-align: left;
}

mjx-c {
  display: inline-block;
}

mjx-utext {
  display: inline-block;
  padding: .75em 0 .2em 0;
}

mjx-c::before {
  display: block;
  width: 0;
}

.MJX-TEX {
  font-family: MJXZERO, MJXTEX;
}

.TEX-B {
  font-family: MJXZERO, MJXTEX-B;
}

.TEX-I {
  font-family: MJXZERO, MJXTEX-I;
}

.TEX-MI {
  font-family: MJXZERO, MJXTEX-MI;
}

.TEX-BI {
  font-family: MJXZERO, MJXTEX-BI;
}

.TEX-S1 {
  font-family: MJXZERO, MJXTEX-S1;
}

.TEX-S2 {
  font-family: MJXZERO, MJXTEX-S2;
}

.TEX-S3 {
  font-family: MJXZERO, MJXTEX-S3;
}

.TEX-S4 {
  font-family: MJXZERO, MJXTEX-S4;
}

.TEX-A {
  font-family: MJXZERO, MJXTEX-A;
}

.TEX-C {
  font-family: MJXZERO, MJXTEX-C;
}

.TEX-CB {
  font-family: MJXZERO, MJXTEX-CB;
}

.TEX-FR {
  font-family: MJXZERO, MJXTEX-FR;
}

.TEX-FRB {
  font-family: MJXZERO, MJXTEX-FRB;
}

.TEX-SS {
  font-family: MJXZERO, MJXTEX-SS;
}

.TEX-SSB {
  font-family: MJXZERO, MJXTEX-SSB;
}

.TEX-SSI {
  font-family: MJXZERO, MJXTEX-SSI;
}

.TEX-SC {
  font-family: MJXZERO, MJXTEX-SC;
}

.TEX-T {
  font-family: MJXZERO, MJXTEX-T;
}

.TEX-V {
  font-family: MJXZERO, MJXTEX-V;
}

.TEX-VB {
  font-family: MJXZERO, MJXTEX-VB;
}

mjx-stretchy-v mjx-c, mjx-stretchy-h mjx-c {
  font-family: MJXZERO, MJXTEX-S1, MJXTEX-S4, MJXTEX, MJXTEX-A ! important;
}

@font-face /* 0 */ {
  font-family: MJXZERO;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Zero.woff") format("woff");
}

@font-face /* 1 */ {
  font-family: MJXTEX;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Main-Regular.woff") format("woff");
}

@font-face /* 2 */ {
  font-family: MJXTEX-B;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Main-Bold.woff") format("woff");
}

@font-face /* 3 */ {
  font-family: MJXTEX-I;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Math-Italic.woff") format("woff");
}

@font-face /* 4 */ {
  font-family: MJXTEX-MI;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Main-Italic.woff") format("woff");
}

@font-face /* 5 */ {
  font-family: MJXTEX-BI;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Math-BoldItalic.woff") format("woff");
}

@font-face /* 6 */ {
  font-family: MJXTEX-S1;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size1-Regular.woff") format("woff");
}

@font-face /* 7 */ {
  font-family: MJXTEX-S2;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size2-Regular.woff") format("woff");
}

@font-face /* 8 */ {
  font-family: MJXTEX-S3;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size3-Regular.woff") format("woff");
}

@font-face /* 9 */ {
  font-family: MJXTEX-S4;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size4-Regular.woff") format("woff");
}

@font-face /* 10 */ {
  font-family: MJXTEX-A;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_AMS-Regular.woff") format("woff");
}

@font-face /* 11 */ {
  font-family: MJXTEX-C;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Regular.woff") format("woff");
}

@font-face /* 12 */ {
  font-family: MJXTEX-CB;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Bold.woff") format("woff");
}

@font-face /* 13 */ {
  font-family: MJXTEX-FR;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Fraktur-Regular.woff") format("woff");
}

@font-face /* 14 */ {
  font-family: MJXTEX-FRB;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Fraktur-Bold.woff") format("woff");
}

@font-face /* 15 */ {
  font-family: MJXTEX-SS;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Regular.woff") format("woff");
}

@font-face /* 16 */ {
  font-family: MJXTEX-SSB;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Bold.woff") format("woff");
}

@font-face /* 17 */ {
  font-family: MJXTEX-SSI;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Italic.woff") format("woff");
}

@font-face /* 18 */ {
  font-family: MJXTEX-SC;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Script-Regular.woff") format("woff");
}

@font-face /* 19 */ {
  font-family: MJXTEX-T;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Typewriter-Regular.woff") format("woff");
}

@font-face /* 20 */ {
  font-family: MJXTEX-V;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Vector-Regular.woff") format("woff");
}

@font-face /* 21 */ {
  font-family: MJXTEX-VB;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Vector-Bold.woff") format("woff");
}

mjx-c.mjx-c28::before {
  padding: 0.75em 0.389em 0.25em 0;
  content: "(";
}

mjx-c.mjx-c29::before {
  padding: 0.75em 0.389em 0.25em 0;
  content: ")";
}

mjx-c.mjx-c2B::before {
  padding: 0.583em 0.778em 0.082em 0;
  content: "+";
}

mjx-c.mjx-c2C::before {
  padding: 0.121em 0.278em 0.194em 0;
  content: ",";
}

mjx-c.mjx-c2E::before {
  padding: 0.12em 0.278em 0 0;
  content: ".";
}

mjx-c.mjx-c30::before {
  padding: 0.666em 0.5em 0.022em 0;
  content: "0";
}

mjx-c.mjx-c31::before {
  padding: 0.666em 0.5em 0 0;
  content: "1";
}

mjx-c.mjx-c32::before {
  padding: 0.666em 0.5em 0 0;
  content: "2";
}

mjx-c.mjx-c33::before {
  padding: 0.665em 0.5em 0.022em 0;
  content: "3";
}

mjx-c.mjx-c34::before {
  padding: 0.677em 0.5em 0 0;
  content: "4";
}

mjx-c.mjx-c3C::before {
  padding: 0.54em 0.778em 0.04em 0;
  content: "<";
}

mjx-c.mjx-c3D::before {
  padding: 0.583em 0.778em 0.082em 0;
  content: "=";
}

mjx-c.mjx-c3E::before {
  padding: 0.54em 0.778em 0.04em 0;
  content: ">";
}

mjx-c.mjx-c41::before {
  padding: 0.716em 0.75em 0 0;
  content: "A";
}

mjx-c.mjx-c5E::before {
  padding: 0.694em 0.5em 0 0;
  content: "^";
}

mjx-c.mjx-c61::before {
  padding: 0.448em 0.5em 0.011em 0;
  content: "a";
}

mjx-c.mjx-c65::before {
  padding: 0.448em 0.444em 0.011em 0;
  content: "e";
}

mjx-c.mjx-c67::before {
  padding: 0.453em 0.5em 0.206em 0;
  content: "g";
}

mjx-c.mjx-c69::before {
  padding: 0.669em 0.278em 0 0;
  content: "i";
}

mjx-c.mjx-c6C::before {
  padding: 0.694em 0.278em 0 0;
  content: "l";
}

mjx-c.mjx-c6D::before {
  padding: 0.442em 0.833em 0 0;
  content: "m";
}

mjx-c.mjx-c6E::before {
  padding: 0.442em 0.556em 0 0;
  content: "n";
}

mjx-c.mjx-c6F::before {
  padding: 0.448em 0.5em 0.01em 0;
  content: "o";
}

mjx-c.mjx-c72::before {
  padding: 0.442em 0.392em 0 0;
  content: "r";
}

mjx-c.mjx-c74::before {
  padding: 0.615em 0.389em 0.01em 0;
  content: "t";
}

mjx-c.mjx-c76::before {
  padding: 0.431em 0.528em 0.011em 0;
  content: "v";
}

mjx-c.mjx-c78::before {
  padding: 0.431em 0.528em 0 0;
  content: "x";
}

mjx-c.mjx-cD7::before {
  padding: 0.491em 0.778em 0 0;
  content: "\D7";
}

mjx-c.mjx-c2032::before {
  padding: 0.56em 0.275em 0 0;
  content: "\2032";
}

mjx-c.mjx-c2212::before {
  padding: 0.583em 0.778em 0.082em 0;
  content: "\2212";
}

mjx-c.mjx-c2225::before {
  padding: 0.75em 0.5em 0.25em 0;
  content: "\2225";
}

mjx-c.mjx-c2264::before {
  padding: 0.636em 0.778em 0.138em 0;
  content: "\2264";
}

mjx-c.mjx-c22C5::before {
  padding: 0.31em 0.278em 0 0;
  content: "\22C5";
}

mjx-c.mjx-c1D41B.TEX-B::before {
  padding: 0.694em 0.639em 0.006em 0;
  content: "b";
}

mjx-c.mjx-c1D41C.TEX-B::before {
  padding: 0.453em 0.511em 0.006em 0;
  content: "c";
}

mjx-c.mjx-c1D41D.TEX-B::before {
  padding: 0.694em 0.639em 0.006em 0;
  content: "d";
}

mjx-c.mjx-c1D41E.TEX-B::before {
  padding: 0.452em 0.527em 0.006em 0;
  content: "e";
}

mjx-c.mjx-c1D426.TEX-B::before {
  padding: 0.45em 0.958em 0 0;
  content: "m";
}

mjx-c.mjx-c1D427.TEX-B::before {
  padding: 0.45em 0.639em 0 0;
  content: "n";
}

mjx-c.mjx-c1D429.TEX-B::before {
  padding: 0.45em 0.639em 0.194em 0;
  content: "p";
}

mjx-c.mjx-c1D42A.TEX-B::before {
  padding: 0.45em 0.607em 0.194em 0;
  content: "q";
}

mjx-c.mjx-c1D42B.TEX-B::before {
  padding: 0.45em 0.474em 0 0;
  content: "r";
}

mjx-c.mjx-c1D42C.TEX-B::before {
  padding: 0.453em 0.454em 0.006em 0;
  content: "s";
}

mjx-c.mjx-c1D42F.TEX-B::before {
  padding: 0.444em 0.607em 0 0;
  content: "v";
}

mjx-c.mjx-c1D435.TEX-I::before {
  padding: 0.683em 0.759em 0 0;
  content: "B";
}

mjx-c.mjx-c1D43F.TEX-I::before {
  padding: 0.683em 0.681em 0 0;
  content: "L";
}

mjx-c.mjx-c1D440.TEX-I::before {
  padding: 0.683em 1.051em 0 0;
  content: "M";
}

[noIC] mjx-c.mjx-c1D440.TEX-I:last-child::before {
  padding-right: 0.97em;
}

mjx-c.mjx-c1D443.TEX-I::before {
  padding: 0.683em 0.751em 0 0;
  content: "P";
}

[noIC] mjx-c.mjx-c1D443.TEX-I:last-child::before {
  padding-right: 0.642em;
}

mjx-c.mjx-c1D445.TEX-I::before {
  padding: 0.683em 0.759em 0.021em 0;
  content: "R";
}

mjx-c.mjx-c1D44E.TEX-I::before {
  padding: 0.441em 0.529em 0.01em 0;
  content: "a";
}

mjx-c.mjx-c1D44F.TEX-I::before {
  padding: 0.694em 0.429em 0.011em 0;
  content: "b";
}

mjx-c.mjx-c1D451.TEX-I::before {
  padding: 0.694em 0.52em 0.01em 0;
  content: "d";
}

mjx-c.mjx-c1D452.TEX-I::before {
  padding: 0.442em 0.466em 0.011em 0;
  content: "e";
}

mjx-c.mjx-c1D453.TEX-I::before {
  padding: 0.705em 0.55em 0.205em 0;
  content: "f";
}

[noIC] mjx-c.mjx-c1D453.TEX-I:last-child::before {
  padding-right: 0.49em;
}

mjx-c.mjx-c1D456.TEX-I::before {
  padding: 0.661em 0.345em 0.011em 0;
  content: "i";
}

mjx-c.mjx-c1D459.TEX-I::before {
  padding: 0.694em 0.298em 0.011em 0;
  content: "l";
}

mjx-c.mjx-c1D45A.TEX-I::before {
  padding: 0.442em 0.878em 0.011em 0;
  content: "m";
}

mjx-c.mjx-c1D45B.TEX-I::before {
  padding: 0.442em 0.6em 0.011em 0;
  content: "n";
}

mjx-c.mjx-c1D45F.TEX-I::before {
  padding: 0.442em 0.451em 0.011em 0;
  content: "r";
}

mjx-c.mjx-c1D460.TEX-I::before {
  padding: 0.442em 0.469em 0.01em 0;
  content: "s";
}

mjx-c.mjx-c1D461.TEX-I::before {
  padding: 0.626em 0.361em 0.011em 0;
  content: "t";
}

mjx-c.mjx-c1D465.TEX-I::before {
  padding: 0.442em 0.572em 0.011em 0;
  content: "x";
}

mjx-c.mjx-c1D466.TEX-I::before {
  padding: 0.442em 0.49em 0.205em 0;
  content: "y";
}

mjx-c.mjx-c1D467.TEX-I::before {
  padding: 0.442em 0.465em 0.011em 0;
  content: "z";
}

mjx-c.mjx-c1D7CE.TEX-B::before {
  padding: 0.654em 0.575em 0.01em 0;
  content: "0";
}

mjx-c.mjx-c221A.TEX-S1::before {
  padding: 0.85em 1.02em 0.35em 0;
  content: "\221A";
}

[noIC] mjx-c.mjx-c221A.TEX-S1:last-child::before {
  padding-right: 1em;
}

mjx-c.mjx-c221A.TEX-S2::before {
  padding: 1.15em 1.02em 0.65em 0;
  content: "\221A";
}

[noIC] mjx-c.mjx-c221A.TEX-S2:last-child::before {
  padding-right: 1em;
}
</style></head><body id="body">
<script>
    var body = document.getElementById('body');
    var lightmode = ( parseInt( window.localStorage && window.localStorage.getItem( 'lightMode' ) ) ) ? 1 : 0;
    if ( lightmode )
        body.classList.add( "LightMode" );
</script>
<div id="BodyContainer">
<div id="LeftColumn"></div>
<div id="MainColumn">
<header class="NavBar">
<div class="NavPrevChapter"><a class="NavChapterNum" href="afterword.html">&lt;&lt; Afterword</a>
</div><div class="NavContents"><a href="./">Contents</a></div><div class="NavNextChapter">
<a class="NavChapterNum" href="answers.html">Answers to the Exercises &gt;&gt;</a></div>
</header>
<div class="ChapterTitleSection">
    <div class="ChapterNumber">Chapter A
<img style="float:right; width:1em; height:1em" id="lightmodetoggle" src="../light_dark_toggle.png">
</div>
<script>
    document.getElementById('lightmodetoggle').onclick = function() {
        lightmode = lightmode ? 0 : 1;
        if ( lightmode )
            body.classList.add( "LightMode" );
        else
            body.classList.remove( "LightMode" );
        if ( window.localStorage )
            window.localStorage.setItem( 'lightMode', lightmode )
    }
</script>
<div class="ChapterTitle">Geometric Tests</div>
</div>
<p class="NoIndent">
<a href="geomprims.html">Chapter&#160;9</a> discussed a number of calculations that can be performed on a single
primitive.  Here, we present a number of useful calculations that operate on more than one
primitive. This appendix is a collection of various geometric calculations that are sometimes
useful.  It is also instructive to browse these tests, because many illustrate general
principles.
</p>
<p>A more comprehensive list of fast intersection methods can be found at
<a href="http://www.realtimerendering.com/intersections.html">http://www.realtimerendering.com/intersections.html</a>.
</p>

<h1 id="closest_point_2d_line"><span class="SectionNumber">A.1</span><span class="SectionTitle">Closest Point on 2D Implicit Line</span></h1>
<p class="NoIndent">Consider an infinite line <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline">
<math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math>
</mjx-assistive-mml>
</mjx-container> in 2D defined implicitly by all points
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline">
<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow></math>
</mjx-assistive-mml>
</mjx-container> such that
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block">
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mo>&#8901;</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo>=</mo><mi>d</mi><mo>,</mo></math>
</mjx-assistive-mml>
</mjx-container>
</div><p>
where <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline">
<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math>
</mjx-assistive-mml>
</mjx-container> is a unit vector.  Our goal is to find, for any point <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline">
<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow></math>
</mjx-assistive-mml>
</mjx-container>, the point
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: 0.363em"><mjx-mo class="mjx-n" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mo></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline">
<math xmlns="http://www.w3.org/1998/Math/MathML"><msup>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mo>&#8242;</mo></msup></math>
</mjx-assistive-mml>
</mjx-container> that is the closest point on <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline">
<math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math>
</mjx-assistive-mml>
</mjx-container> to <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline">
<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow></math>
</mjx-assistive-mml>
</mjx-container>. This is the result of projecting
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline">
<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow></math>
</mjx-assistive-mml>
</mjx-container> onto <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline">
<math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math>
</mjx-assistive-mml>
</mjx-container>.  Let us draw a second line <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline">
<math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math>
</mjx-assistive-mml>
</mjx-container> through <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline">
<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow></math>
</mjx-assistive-mml>
</mjx-container>, parallel to <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline">
<math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math>
</mjx-assistive-mml>
</mjx-container>, as
shown in <a href="#closest_point_implicit_line">Figure&#160;A.1</a>.
</p>
<div id="closest_point_implicit_line" class="Display Figure Narrow">
<div class="Body">
		<img class="WithFrame" src="figs/geomtests/closest_point_implicit_line.png" loading="lazy" width="270" height="270">
</div><span class="Caption">
<span class="Label">Figure&#160;A.1</span><span class="CaptionText">
Finding the closest point
on a 2D implicit line
</span>
</span>
</div><p>Let <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline">
<math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mi>M</mi></msub></math>
</mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline">
<math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>d</mi><mi>M</mi></msub></math>
</mjx-assistive-mml>
</mjx-container> be the normal and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline">
<math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math>
</mjx-assistive-mml>
</mjx-container> value, respectively, of the line equation for
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math>
</mjx-assistive-mml>
</mjx-container>; since <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math>
</mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math>
</mjx-assistive-mml>
</mjx-container> are parallel, they have the same normal: <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-TeXAtom space="4" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mi>M</mi></msub><mo>=</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math>
</mjx-assistive-mml>
</mjx-container>.
Since <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow></math>
</mjx-assistive-mml>
</mjx-container> is on <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math></mjx-assistive-mml>
</mjx-container>, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>d</mi><mi>M</mi></msub></math></mjx-assistive-mml>
</mjx-container> can be computed as <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mo>&#8901;</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math></mjx-assistive-mml>
</mjx-container>.
</p>
<p>
Now the signed distance from <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math></mjx-assistive-mml>
</mjx-container> to <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></mjx-assistive-mml>
</mjx-container> measured parallel to <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math></mjx-assistive-mml>
</mjx-container> is simply
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>d</mi><mo>&#8722;</mo><msub><mi>d</mi><mi>M</mi></msub><mo>=</mo><mi>d</mi><mo>&#8722;</mo>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mo>&#8901;</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo>.</mo></math></mjx-assistive-mml>
</mjx-container>
</div><p>
This distance is obviously the same as the distance from <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> to <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: 0.363em"><mjx-mo class="mjx-n" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mo></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mo>&#8242;</mo></msup></math></mjx-assistive-mml>
</mjx-container>. (If we
need only the distance and not the value of <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: 0.363em"><mjx-mo class="mjx-n" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mo></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mo>&#8242;</mo></msup></math></mjx-assistive-mml>
</mjx-container>, then we can stop here.)  To compute
the value of <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: 0.363em"><mjx-mo class="mjx-n" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mo></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mo>&#8242;</mo></msup></math></mjx-assistive-mml>
</mjx-container>, we can simply take <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> and displace it by a multiple of
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math></mjx-assistive-mml>
</mjx-container>:
</p>
<span class="InMarginAnchor"><span class="InMargin"><span class="EqMarginCaption">Computing the closest point on a 2D implicit line</span></span></span>
<div class="DisplayMath">
<mjx-container class="MathJax" display="true" jax="CHTML" role="presentation" style="font-size: 100%; min-width: 100%; position: relative" width="full">
<mjx-math aria-hidden="true" class="MJX-TEX" display="true" width="full"><mjx-mtable side="right" style="min-width: 100%; display: flex; justify-content: space-between; flex-flow: row nowrap">
<mjx-labels-partner style="flex: 1 0 0; max-width: 3.106em"></mjx-labels-partner><mjx-table style="flex: 0 0 9.42em"><mjx-itable width="full"><mjx-mlabeledtr><mjx-mtd><mjx-msup><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: 0.413em"><mjx-mo class="mjx-n" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-texatom space="4" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-texatom space="3" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-texatom space="3" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-base></mjx-mover></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-texatom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-base></mjx-mover></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mlabeledtr></mjx-itable></mjx-table>
<mjx-labels style="flex: 0 0 3.106em"><mjx-itable align="right" style=""><mjx-mtr style="height: 1.059em"><mjx-mtd id="mjx-eqn-A.1"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c28"></mjx-c><mjx-c class="mjx-c41"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c29"></mjx-c></mjx-mtext><mjx-tstrut style="height: 1.059em; vertical-align: -0.25em"></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-labels>
</mjx-mtable>
</mjx-math>
<mjx-assistive-mml display="block" role="presentation" unselectable="on"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mtable displaystyle="true"><mlabeledtr><mtd><mtext>(A.1)</mtext></mtd><mtd><msup>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mo>&#8242;</mo></msup><mo>=</mo>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mo>+</mo><mo stretchy="false">(</mo><mi>d</mi><mo>&#8722;</mo>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mo>&#8901;</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo stretchy="false">)</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo>.</mo></mtd></mlabeledtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>

<h1 id="closet_point_parametric_ray"><span class="SectionNumber">A.2</span><span class="SectionTitle">Closest Point on a Parametric Ray</span></h1>
<p class="NoIndent">Consider the parametric ray <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D445 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi></math></mjx-assistive-mml>
</mjx-container> in 2D or 3D defined by
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c67"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">g</mi></mrow>
</mrow></msub><mo>+</mo><mi>t</mi>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo>,</mo></math></mjx-assistive-mml>
</mjx-container>
</div><div id="closest_point_parametric_ray" class="Display Figure Wrap">
<div class="Body">
        <img class="WithFrame" src="figs/geomtests/closest_point_parametric_ray.png" loading="lazy" width="165" height="245">
</div><span class="Caption">
<span class="Label">Figure&#160;A.2</span><span class="CaptionText">
Finding the closest
point on a ray
</span>
</span>
</div>
<p class="NoIndent">
where <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math></mjx-assistive-mml>
</mjx-container> is a unit vector, and the parameter <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></mjx-assistive-mml>
</mjx-container> varies from 0 to <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></mjx-assistive-mml>
</mjx-container>, where <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></mjx-assistive-mml>
</mjx-container> is the
length of <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D445 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi></math></mjx-assistive-mml>
</mjx-container>.  For a given point <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>, we wish to find the point <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: 0.363em"><mjx-mo class="mjx-n" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mo></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mo>&#8242;</mo></msup></math></mjx-assistive-mml>
</mjx-container> on <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D445 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi></math></mjx-assistive-mml>
</mjx-container>
that is closest to <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>.
</p>
<p>
This is just a simple matter of projecting one vector onto another, which was presented in
<a href="vectors.html#dot_product_geometry">Section&#160;2.11.2</a>. Let <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> be the vector from
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c67"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">g</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container> to <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>. We wish to compute the result of projecting
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> onto <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math></mjx-assistive-mml>
</mjx-container>&#8212;in other words, the portion of <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> parallel to
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math></mjx-assistive-mml>
</mjx-container>. This is illustrated in <a href="#closest_point_parametric_ray">Figure&#160;A.2</a>.
</p>
<p>
The value of the dot product <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow><mo>&#8901;</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math></mjx-assistive-mml>
</mjx-container> is the value <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></mjx-assistive-mml>
</mjx-container> such that
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msup space="4"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: 0.363em"><mjx-mo class="mjx-n" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mo></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><msup>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mo>&#8242;</mo></msup></math></mjx-assistive-mml>
</mjx-container>:
</p>
<span class="InMarginAnchor"><span class="InMargin"><span class="EqMarginCaption">Computing the closest point on a parametric ray</span></span></span><div class="DisplayMath">
<mjx-container class="MathJax" display="true" jax="CHTML" role="presentation" style="font-size: 100%; min-width: 100%; position: relative" width="full">
<mjx-math aria-hidden="true" class="MJX-TEX" display="true" width="full"><mjx-mtable side="right" style="min-width: 100%; display: flex; justify-content: space-between; flex-flow: row nowrap">
<mjx-labels-partner style="flex: 1 0 0; max-width: 3.106em"></mjx-labels-partner><mjx-table style="flex: 0 0 20.759em"><mjx-itable width="full"><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-bottom: 0.15em"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-texatom space="4" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-base></mjx-mover></mjx-texatom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-texatom space="3" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-texatom space="4" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-base></mjx-mover></mjx-texatom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.229em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c67"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mlabeledtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em"><mjx-msup><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: 0.413em"><mjx-mo class="mjx-n" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-texatom space="4" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.229em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c67"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-texatom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-base></mjx-mover></mjx-texatom><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.229em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c67"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-texatom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-base></mjx-mover></mjx-texatom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.229em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c67"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-texatom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-base></mjx-mover></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mlabeledtr></mjx-itable></mjx-table>
<mjx-labels style="flex: 0 0 3.106em"><mjx-itable align="right" style=""><mjx-mtr style="height: 1.542em"></mjx-mtr><mjx-mtr style="height: 1.542em"><mjx-mtd id="mjx-eqn-A.2" style="padding-top: 0.15em"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c28"></mjx-c><mjx-c class="mjx-c41"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c29"></mjx-c></mjx-mtext><mjx-tstrut style="height: 1.392em; vertical-align: -0.375em"></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-labels>
</mjx-mtable>
</mjx-math>
<mjx-assistive-mml display="block" role="presentation" unselectable="on"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mtr><mtd><mi>t</mi></mtd><mtd><mi></mi><mo>=</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo>&#8901;</mo>
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow><mo>=</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo>&#8901;</mo><mo stretchy="false">(</mo>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mo>&#8722;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">g</mi></mrow>
</mrow></msub><mo stretchy="false">)</mo><mo>,</mo></mtd></mtr><mlabeledtr><mtd><mtext>(A.2)</mtext></mtd><mtd><msup>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mo>&#8242;</mo></msup></mtd><mtd><mi></mi><mo>=</mo>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">g</mi></mrow>
</mrow></msub><mo>+</mo><mi>t</mi>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo>=</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">g</mi></mrow>
</mrow></msub><mo>+</mo><mo stretchy="false">(</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo>&#8901;</mo><mo stretchy="false">(</mo>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mo>&#8722;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">g</mi></mrow>
</mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo>.</mo></mtd></mlabeledtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<p>
Actually, <a href="#closest_point_on_ray">Equation&#160;(A.2)</a>, for <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container> computes the point closest to
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> on the <i>infinite line</i> containing <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D445 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi></math></mjx-assistive-mml>
</mjx-container>. If <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c30"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>&lt;</mo><mn>0</mn></math></mjx-assistive-mml>
</mjx-container> or <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3E"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>&gt;</mo><mi>l</mi></math></mjx-assistive-mml>
</mjx-container>, then
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container> is not within the ray <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D445 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi></math></mjx-assistive-mml>
</mjx-container>, in which case, the closest point to <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> on
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D445 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi></math></mjx-assistive-mml>
</mjx-container> will be the ray origin (if <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c30"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>&lt;</mo><mn>0</mn></math></mjx-assistive-mml>
</mjx-container>) or endpoint (if <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3E"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>&gt;</mo><mi>l</mi></math></mjx-assistive-mml>
</mjx-container>).
</p>
<p>
If the ray is defined where <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></mjx-assistive-mml>
</mjx-container> varies from 0 to 1 and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> is not necessarily a unit
vector, then we must divide by the magnitude of <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> to compute the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></mjx-assistive-mml>
</mjx-container> value:
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c67"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-TeXAtom texclass="ORD"><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c2225"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2225"></mjx-c></mjx-mo></mjx-mrow></mjx-TeXAtom></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>t</mi><mo>=</mo><mfrac>
<mrow>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo>&#8901;</mo><mo stretchy="false">(</mo>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mo>&#8722;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">g</mi></mrow>
</mrow></msub><mo stretchy="false">)</mo></mrow>
<mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">&#8741;</mo>
<mrow>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow></mrow>
<mo data-mjx-texclass="CLOSE">&#8741;</mo></mrow>
</mrow></mfrac><mo>.</mo></math></mjx-assistive-mml>
</mjx-container>
</div>

<h1 id="closest_point_plane"><span class="SectionNumber">A.3</span><span class="SectionTitle">Closest Point on a Plane</span></h1>
<p class="NoIndent">Consider a plane <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D443 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></mjx-assistive-mml>
</mjx-container> defined in the standard implicit manner as all points <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> that
satisfy
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mo>&#8901;</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo>=</mo><mi>d</mi><mo>,</mo></math></mjx-assistive-mml>
</mjx-container>
</div><p>
where <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math></mjx-assistive-mml>
</mjx-container> is a unit vector.  Given a point <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>, we wish to find the point
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: 0.363em"><mjx-mo class="mjx-n" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mo></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mo>&#8242;</mo></msup></math></mjx-assistive-mml>
</mjx-container>, which is the result of projecting <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> onto <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D443 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></mjx-assistive-mml>
</mjx-container>.  Point <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: 0.363em"><mjx-mo class="mjx-n" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mo></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mo>&#8242;</mo></msup></math></mjx-assistive-mml>
</mjx-container> is
the closest point to <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> on <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D443 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></mjx-assistive-mml>
</mjx-container>.
</p>
<p>
We showed how to compute the distance from a point to a plane in
<a href="geomprims.html#plane_distance_to_point">Section&#160;9.5.4</a>.  To compute <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: 0.363em"><mjx-mo class="mjx-n" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mo></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mo>&#8242;</mo></msup></math></mjx-assistive-mml>
</mjx-container>, we simply displace
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> by this distance, parallel to <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math></mjx-assistive-mml>
</mjx-container>.
</p>
<span class="InMarginAnchor"><span class="InMargin"><span class="EqMarginCaption">Computing the closest point on a plane</span></span></span><div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: 0.413em"><mjx-mo class="mjx-n" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-TeXAtom space="4" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mo>&#8242;</mo></msup><mo>=</mo>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mo>+</mo><mo stretchy="false">(</mo><mi>d</mi><mo>&#8722;</mo>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mo>&#8901;</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo stretchy="false">)</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math></mjx-assistive-mml>
</mjx-container>
</div>
<p class="NoIndent">
Notice that this is the same as <a href="#closest_point_2d_line">Equation&#160;(A.1)</a>, which computes the closest
point to an implicit line in 2D.
</p>

<h1 id="closest_point_circle"><span class="SectionNumber">A.4</span><span class="SectionTitle">Closest Point on a Circle or Sphere</span></h1>
<div id="closest_point_sphere" class="Display Figure Wrap">
<div class="Body">
        <img class="WithFrame" src="figs/geomtests/closest_point_sphere.png" loading="lazy" width="344" height="188">
</div><span class="Caption">
<span class="Label">Figure&#160;A.3</span><span class="CaptionText">
Finding the closest point on a
circle
</span>
</span>
</div><p>
Imagine a 2D point <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> and a circle with center <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> and radius <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></mjx-assistive-mml>
</mjx-container>. (The
following discussion also applies to a sphere in 3D.)  We wish to find <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: 0.363em"><mjx-mo class="mjx-n" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mo></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mo>&#8242;</mo></msup></math></mjx-assistive-mml>
</mjx-container>, which is
the closest point on the circle to <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>.
</p>
<p>
Let <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> be the vector from <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> to <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>.  This vector intersects the circle at
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: 0.363em"><mjx-mo class="mjx-n" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mo></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mo>&#8242;</mo></msup></math></mjx-assistive-mml>
</mjx-container>.  Let <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41B TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">b</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> be the vector from <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> to <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: 0.363em"><mjx-mo class="mjx-n" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mo></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mo>&#8242;</mo></msup></math></mjx-assistive-mml>
</mjx-container>, as shown in
<a href="#closest_point_sphere">Figure&#160;A.3</a>.
</p>
<p>
Now, clearly, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c2225"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41B TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2225"></mjx-c></mjx-mo></mjx-mrow></mjx-TeXAtom><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-TeXAtom space="4" texclass="ORD"><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c2225"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2225"></mjx-c></mjx-mo></mjx-mrow></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">&#8741;</mo>
<mrow>
<mrow>
<mrow><mi mathvariant="bold">b</mi></mrow>
</mrow></mrow>
<mo data-mjx-texclass="CLOSE">&#8741;</mo></mrow>
</mrow><mo>=</mo>
<mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">&#8741;</mo>
<mrow>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow></mrow>
<mo data-mjx-texclass="CLOSE">&#8741;</mo></mrow>
</mrow><mo>&#8722;</mo><mi>r</mi></math></mjx-assistive-mml>
</mjx-container>. Therefore,
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41B TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-TeXAtom texclass="ORD"><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c2225"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2225"></mjx-c></mjx-mo></mjx-mrow></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-TeXAtom texclass="ORD"><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c2225"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2225"></mjx-c></mjx-mo></mjx-mrow></mjx-TeXAtom></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
<mrow>
<mrow><mi mathvariant="bold">b</mi></mrow>
</mrow><mo>=</mo><mfrac>
<mrow>
<mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">&#8741;</mo>
<mrow>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow></mrow>
<mo data-mjx-texclass="CLOSE">&#8741;</mo></mrow>
</mrow><mo>&#8722;</mo><mi>r</mi></mrow>
<mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">&#8741;</mo>
<mrow>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow></mrow>
<mo data-mjx-texclass="CLOSE">&#8741;</mo></mrow>
</mrow></mfrac>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo>.</mo></math></mjx-assistive-mml>
</mjx-container>
</div><p>Adding this displacement to <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> to project onto the circle, we get
</p>
<span class="InMarginAnchor"><span class="InMargin"><span class="EqMarginCaption">Computing the closest point on a circle or sphere</span></span></span><div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mtable style="min-width: 8.684em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-bottom: 0.15em"><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: 0.413em"><mjx-mo class="mjx-n" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-TeXAtom space="4" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41B TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-TeXAtom space="4" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mfrac space="3"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-TeXAtom texclass="ORD"><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c2225"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2225"></mjx-c></mjx-mo></mjx-mrow></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-TeXAtom texclass="ORD"><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c2225"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2225"></mjx-c></mjx-mo></mjx-mrow></mjx-TeXAtom></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" rowspacing="3pt"><mtr><mtd><msup>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mo>&#8242;</mo></msup></mtd><mtd><mi></mi><mo>=</mo>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mo>+</mo>
<mrow>
<mrow><mi mathvariant="bold">b</mi></mrow>
</mrow></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mo>+</mo><mfrac>
<mrow>
<mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">&#8741;</mo>
<mrow>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow></mrow>
<mo data-mjx-texclass="CLOSE">&#8741;</mo></mrow>
</mrow><mo>&#8722;</mo><mi>r</mi></mrow>
<mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">&#8741;</mo>
<mrow>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow></mrow>
<mo data-mjx-texclass="CLOSE">&#8741;</mo></mrow>
</mrow></mfrac>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo>.</mo></mtd></mtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<p>
If <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c2225"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2225"></mjx-c></mjx-mo></mjx-mrow></mjx-TeXAtom><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">&#8741;</mo>
<mrow>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow></mrow>
<mo data-mjx-texclass="CLOSE">&#8741;</mo></mrow>
</mrow><mo>&lt;</mo><mi>r</mi></math></mjx-assistive-mml>
</mjx-container>, then <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> is inside the
circle. What should we with this situation?  Should <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: 0.363em"><mjx-mo class="mjx-n" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-TeXAtom space="4" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mo>&#8242;</mo></msup><mo>=</mo>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>, or should we project <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> outwards onto the
surface of the circle?  Particular circumstances might call for
either behavior.  If we decide we wish to project the points onto
the surface of the circle, then we'll be forced to make an arbitrary
decision on what to do in the degenerate case where <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-TeXAtom space="4" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mo>=</mo>
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>.
</p>

<h1 id="closest_point_aabb"><span class="SectionNumber">A.5</span><span class="SectionTitle">Closest Point in an AABB</span></h1>
<p class="NoIndent">Let <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math></mjx-assistive-mml>
</mjx-container> be an axially aligned bounding box (AABB) defined by the extreme points
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container>. For any point <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> we can
easily compute <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: 0.363em"><mjx-mo class="mjx-n" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mo></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mo>&#8242;</mo></msup></math></mjx-assistive-mml>
</mjx-container>, the closest point in <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math></mjx-assistive-mml>
</mjx-container> to <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>. This is done by
&#8220;pushing&#8221; <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> into <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math></mjx-assistive-mml>
</mjx-container> along each axis in turn, as illustrated in
<a href="#closest_point_aabb">Listing&#160;A.1</a>.  Notice that if the point is already inside the box, this code
returns the original point.
</p>
<p>
<div class="Wide Display Listing">
<pre>
if (x &lt; minX) {
    x = minX;
} else if (x &gt; maxX) {
    x = maxX;
}

if (y &lt; minY) {
    y = minY;
} else if (y &gt; maxY) {
    y = maxY;
}

if (z &lt; minZ) {
    z = minZ;
} else if (z &gt; maxZ) {
    z = maxZ;
}
</pre>
</div>
</p>

<h1 id="intersection_tests"><span class="SectionNumber">A.6</span><span class="SectionTitle">Intersection Tests</span></h1>
<p class="NoIndent">The remaining sections of this chapter present an assortment of <i>intersection tests</i>. These
tests are designed to determine whether two geometric primitives intersect, and (in some cases)
to locate the intersection. We will consider different two types of intersection tests: static
and dynamic.
</p>
<ul>
    <li>
A <span class="ListItemTitle">static</span> test checks two <i>stationary</i> primitives and
        detects whether the two primitives intersect.  It is a Boolean test&#8212;that
        is, it usually returns only true (there is an intersection) or false
        (there is no intersection).  If the test returns more details about
        the intersection, this extra information usually has the purpose of
        describing where the intersection occurred.
</li>
<li>
A <span class="ListItemTitle">dynamic</span> test checks two <i>moving</i> primitives and
        detects if and when two primitives intersect.  Usually, the movement
        is expressed parametrically, and therefore the result of such a
        test is not only a Boolean true/false result but also a time value
        (the value of the parameter <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></mjx-assistive-mml>
</mjx-container>) that indicates when the primitives
        intersect.  For the tests that we consider here, the movement
        value is a simple linear displacement&#8212;a vector offset by which the
        primitive moves as <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></mjx-assistive-mml>
</mjx-container> varies from 0 to 1.
<br>
        Although each object may have its own displacement over the time
        interval under consideration, it will be often easier to view the
        problem from the point of view of one of the primitives, considering
        that primitive to be &#8220;still&#8221; while the other primitive does all
        of the &#8220;moving.&#8221;  We can easily do this by combining the two
        displacement vectors to get a single relative displacement vector
        that describes how the two primitives move in relation to each other.
        Thus, the dynamic tests will usually involve one stationary
        primitive and one moving primitive.
<br>
        Notice that many important tests involving rays are actually dynamic
        tests, since a ray can be viewed as a moving point.
</li>
</ul>

<h1 id="intersection_2d_lines"><span class="SectionNumber">A.7</span><span class="SectionTitle">Intersection of Two Implicit Lines in 2D</span></h1>
<p class="NoIndent">Finding the intersection of two lines defined implicitly in 2D is a straightforward matter of
solving a system of linear equations.  We have two equations (the two implicit equations of the
lines) and two unknowns (the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml>
</mjx-container>- and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></mjx-assistive-mml>
</mjx-container>-coordinates of the point of intersection). Our two
equations are
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mtable style="min-width: 6.585em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-bottom: 0.15em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D44F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D44F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" rowspacing="3pt"><mtr><mtd><msub><mi>a</mi><mn>1</mn></msub><mi>x</mi><mo>+</mo><msub><mi>b</mi><mn>1</mn></msub><mi>y</mi></mtd><mtd><mi></mi><mo>=</mo><msub><mi>d</mi><mn>1</mn></msub><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>a</mi><mn>2</mn></msub><mi>x</mi><mo>+</mo><msub><mi>b</mi><mn>2</mn></msub><mi>y</mi></mtd><mtd><mi></mi><mo>=</mo><msub><mi>d</mi><mn>2</mn></msub><mo>.</mo></mtd></mtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div><p>
Solving this system of equations yields
</p>
<span class="InMarginAnchor"><span class="InMargin"><span class="EqMarginCaption">Computing the intersection of two lines in 2D</span></span></span>
<div class="DisplayMath">
<mjx-container class="MathJax" display="true" jax="CHTML" role="presentation" style="font-size: 100%; min-width: 100%; position: relative" width="full">
<mjx-math aria-hidden="true" class="MJX-TEX" display="true" width="full"><mjx-mtable side="right" style="min-width: 100%; display: flex; justify-content: space-between; flex-flow: row nowrap">
<mjx-labels-partner style="flex: 1 0 0; max-width: 3.106em"></mjx-labels-partner><mjx-table style="flex: 0 0 7.558em"><mjx-itable width="full"><mjx-mlabeledtr><mjx-mtd style="text-align: right"><mjx-mtable justify="right" style="min-width: 7.558em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-bottom: 0.15em"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-msub><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D44F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D44F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mrow><mjx-msub><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D44F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D44F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-msub><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mrow><mjx-msub><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D44F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D44F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mlabeledtr></mjx-itable></mjx-table>
<mjx-labels style="flex: 0 0 3.106em"><mjx-itable align="right" style=""><mjx-mtr style="height: 4.712em"><mjx-mtd id="mjx-eqn-A.3"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c28"></mjx-c><mjx-c class="mjx-c41"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c33"></mjx-c><mjx-c class="mjx-c29"></mjx-c></mjx-mtext><mjx-tstrut style="height: 4.712em; vertical-align: -2.106em"></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-labels>
</mjx-mtable>
</mjx-math>
<mjx-assistive-mml display="block" role="presentation" unselectable="on"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mlabeledtr><mtd><mtext>(A.3)</mtext></mtd><mtd><mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mtr><mtd><mi>x</mi></mtd><mtd><mi></mi><mo>=</mo><mfrac>
<mrow><msub><mi>b</mi><mn>2</mn></msub><msub><mi>d</mi><mn>1</mn></msub><mo>&#8722;</mo><msub><mi>b</mi><mn>1</mn></msub><msub><mi>d</mi><mn>2</mn></msub></mrow>
<mrow><msub><mi>a</mi><mn>1</mn></msub><msub><mi>b</mi><mn>2</mn></msub><mo>&#8722;</mo><msub><mi>a</mi><mn>2</mn></msub><msub><mi>b</mi><mn>1</mn></msub></mrow>
</mfrac><mo>,</mo></mtd></mtr><mtr><mtd><mi>y</mi></mtd><mtd><mi></mi><mo>=</mo><mfrac>
<mrow><msub><mi>a</mi><mn>1</mn></msub><msub><mi>d</mi><mn>2</mn></msub><mo>&#8722;</mo><msub><mi>a</mi><mn>2</mn></msub><msub><mi>d</mi><mn>1</mn></msub></mrow>
<mrow><msub><mi>a</mi><mn>1</mn></msub><msub><mi>b</mi><mn>2</mn></msub><mo>&#8722;</mo><msub><mi>a</mi><mn>2</mn></msub><msub><mi>b</mi><mn>1</mn></msub></mrow>
</mfrac><mo>.</mo></mtd></mtr></mtable></mtd></mlabeledtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<p>
Just as for any system of linear equations, there are three solution possibilities (as
illustrated in <a href="#intersection_two_lines_2d">Figure&#160;A.4</a>):
</p>
<ul>
    <li>
There is <span class="ListItemTitle">one solution</span>.  In this case, the denominators
        in <a href="#intersection_2d_lines">Equation&#160;(A.3)</a> will be nonzero.
</li>
<li>
There are <span class="ListItemTitle">no solutions</span>.  This indicates that the lines
        are parallel and not intersecting.  The denominators are zero.
</li>
<li>
There are an <span class="ListItemTitle">infinite number of solutions</span>.  This is the
        case when the two lines are coincident.  All the numerators and denominators
        are zero in this case.
</li>
</ul>
<div id="intersection_two_lines_2d" class="Display Figure Narrow">
<div class="Body">
		<img class="WithFrame" src="figs/geomtests/intersection_two_lines_2d.png" loading="lazy" width="405" height="293">
</div><span class="Caption">
<span class="Label">Figure&#160;A.4</span><span class="CaptionText">Intersection of two lines in 2D&#8212;the three cases</span>
</span>
</div>

<h1 id="intersection_3d_rays"><span class="SectionNumber">A.8</span><span class="SectionTitle">Intersection of Two Rays in 3D</span></h1>
<p class="NoIndent">Given two rays in 3D defined parametrically by
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mtable style="min-width: 8.104em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-bottom: 0.15em"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42B TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42B TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" rowspacing="3pt"><mtr><mtd><msub>
<mrow>
<mrow><mi mathvariant="bold">r</mi></mrow>
</mrow><mn>1</mn></msub><mo stretchy="false">(</mo><msub><mi>t</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>1</mn></msub><mo>+</mo><msub><mi>t</mi><mn>1</mn></msub><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>1</mn></msub><mo>,</mo></mtd></mtr><mtr><mtd><msub>
<mrow>
<mrow><mi mathvariant="bold">r</mi></mrow>
</mrow><mn>2</mn></msub><mo stretchy="false">(</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>2</mn></msub><mo>+</mo><msub><mi>t</mi><mn>2</mn></msub><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>2</mn></msub><mo>,</mo></mtd></mtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div><p>
we can solve for their point of intersection.  For a moment, let us not restrict the range of
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi><mn>1</mn></msub></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi><mn>2</mn></msub></math></mjx-assistive-mml>
</mjx-container>; therefore, we consider the infinite lines that contain the rays. The delta
vectors <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>1</mn></msub></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>2</mn></msub></math></mjx-assistive-mml>
</mjx-container> do not necessarily have to be unit vectors. If the rays
lie in a plane, then we have the same three cases possible as in the previous section:
</p>
<ul>
    <li>
The rays intersect at exactly one point.
</li>
<li>
The rays are parallel, and there is no intersection.
</li>
<li>
The rays are coincident, and there are an infinite number of
        solutions
</li>
</ul>
<p>
However, in 3D we have a fourth case, where the rays are skew and do
not share a common plane.  An example of skew lines is illustrated
in <a href="#skew_rays">Figure&#160;A.5</a>.
</p>
<div id="skew_rays" class="Display Figure Narrow">
<div class="Body">
		<img class="WithFrame" src="figs/geomtests/skew_rays.png" loading="lazy" width="372" height="160">
</div><span class="Caption">
<span class="Label">Figure&#160;A.5</span><span class="CaptionText">Skew lines in 3D do not share a common plane or intersect.</span>
</span>
</div><p>
We can solve for <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi><mn>1</mn></msub></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi><mn>2</mn></msub></math></mjx-assistive-mml>
</mjx-container>.  At the point of intersection,
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mtable style="min-width: 23.693em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-bottom: 0.15em"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42B TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42B TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mn class="mjx-b"><mjx-c class="mjx-c1D7CE TEX-B"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mrow space="4"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c2225"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2225"></mjx-c></mjx-mo></mjx-mrow></mjx-TeXAtom><mjx-script style="vertical-align: 0.477em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" rowspacing="3pt"><mtr><mtd><msub>
<mrow>
<mrow><mi mathvariant="bold">r</mi></mrow>
</mrow><mn>1</mn></msub><mo stretchy="false">(</mo><msub><mi>t</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">r</mi></mrow>
</mrow><mn>2</mn></msub><mo stretchy="false">(</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>,</mo></mtd></mtr><mtr><mtd><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>1</mn></msub><mo>+</mo><msub><mi>t</mi><mn>1</mn></msub><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>1</mn></msub></mtd><mtd><mi></mi><mo>=</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>2</mn></msub><mo>+</mo><msub><mi>t</mi><mn>2</mn></msub><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>2</mn></msub><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>t</mi><mn>1</mn></msub><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>1</mn></msub></mtd><mtd><mi></mi><mo>=</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>2</mn></msub><mo>+</mo><msub><mi>t</mi><mn>2</mn></msub><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>2</mn></msub><mo>&#8722;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>1</mn></msub><mo>,</mo></mtd></mtr><mtr><mtd><mo stretchy="false">(</mo><msub><mi>t</mi><mn>1</mn></msub><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>1</mn></msub><mo stretchy="false">)</mo><mo>&#215;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>2</mn></msub></mtd><mtd><mi></mi><mo>=</mo><mo stretchy="false">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>2</mn></msub><mo>+</mo><msub><mi>t</mi><mn>2</mn></msub><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>2</mn></msub><mo>&#8722;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>1</mn></msub><mo stretchy="false">)</mo><mo>&#215;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>2</mn></msub><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>t</mi><mn>1</mn></msub><mo stretchy="false">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>1</mn></msub><mo>&#215;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>2</mn></msub><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mo stretchy="false">(</mo><msub><mi>t</mi><mn>2</mn></msub><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>2</mn></msub><mo stretchy="false">)</mo><mo>&#215;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>2</mn></msub><mo>+</mo><mo stretchy="false">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>2</mn></msub><mo>&#8722;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>1</mn></msub><mo stretchy="false">)</mo><mo>&#215;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>2</mn></msub><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>t</mi><mn>1</mn></msub><mo stretchy="false">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>1</mn></msub><mo>&#215;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>2</mn></msub><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="false">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>2</mn></msub><mo>&#215;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>2</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>2</mn></msub><mo>&#8722;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>1</mn></msub><mo stretchy="false">)</mo><mo>&#215;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>2</mn></msub><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>t</mi><mn>1</mn></msub><mo stretchy="false">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>1</mn></msub><mo>&#215;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>2</mn></msub><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><msub><mi>t</mi><mn>2</mn></msub>
<mrow>
<mrow><mn mathvariant="bold">0</mn></mrow>
</mrow><mo>+</mo><mo stretchy="false">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>2</mn></msub><mo>&#8722;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>1</mn></msub><mo stretchy="false">)</mo><mo>&#215;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>2</mn></msub><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>t</mi><mn>1</mn></msub><mo stretchy="false">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>1</mn></msub><mo>&#215;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>2</mn></msub><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mo stretchy="false">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>2</mn></msub><mo>&#8722;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>1</mn></msub><mo stretchy="false">)</mo><mo>&#215;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>2</mn></msub><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>t</mi><mn>1</mn></msub><mo stretchy="false">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>1</mn></msub><mo>&#215;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>2</mn></msub><mo stretchy="false">)</mo><mo>&#8901;</mo><mo stretchy="false">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>1</mn></msub><mo>&#215;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>2</mn></msub><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><mo stretchy="false">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>2</mn></msub><mo>&#8722;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>1</mn></msub><mo stretchy="false">)</mo><mo>&#215;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>2</mn></msub><mo data-mjx-texclass="CLOSE">)</mo></mrow>
<mo>&#8901;</mo><mo stretchy="false">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>1</mn></msub><mo>&#215;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>2</mn></msub><mo stretchy="false">)</mo><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>t</mi><mn>1</mn></msub></mtd><mtd><mi></mi><mo>=</mo><mfrac>
<mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><mo stretchy="false">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>2</mn></msub><mo>&#8722;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>1</mn></msub><mo stretchy="false">)</mo><mo>&#215;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>2</mn></msub><mo data-mjx-texclass="CLOSE">)</mo></mrow>
<mo>&#8901;</mo><mo stretchy="false">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>1</mn></msub><mo>&#215;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>2</mn></msub><mo stretchy="false">)</mo></mrow>
<msup>
<mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">&#8741;</mo>
<mrow><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>1</mn></msub><mo>&#215;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>2</mn></msub></mrow>
<mo data-mjx-texclass="CLOSE">&#8741;</mo></mrow>
</mrow><mn>2</mn></msup></mfrac><mo>.</mo></mtd></mtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div><p>
We obtain <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi><mn>2</mn></msub></math></mjx-assistive-mml>
</mjx-container> in a similar fashion:
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c2225"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2225"></mjx-c></mjx-mo></mjx-mrow></mjx-TeXAtom><mjx-script style="vertical-align: 0.477em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>t</mi><mn>2</mn></msub><mo>=</mo><mfrac>
<mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><mo stretchy="false">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>2</mn></msub><mo>&#8722;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>1</mn></msub><mo stretchy="false">)</mo><mo>&#215;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>1</mn></msub><mo data-mjx-texclass="CLOSE">)</mo></mrow>
<mo>&#8901;</mo><mo stretchy="false">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>1</mn></msub><mo>&#215;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>2</mn></msub><mo stretchy="false">)</mo></mrow>
<msup>
<mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">&#8741;</mo>
<mrow><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>1</mn></msub><mo>&#215;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>2</mn></msub></mrow>
<mo data-mjx-texclass="CLOSE">&#8741;</mo></mrow>
</mrow><mn>2</mn></msup></mfrac><mo>.</mo></math></mjx-assistive-mml>
</mjx-container>
</div>
<p class="NoIndent">
If the lines are parallel (or coincident), then the cross product of
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>1</mn></msub></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>2</mn></msub></math></mjx-assistive-mml>
</mjx-container> is the zero vector, and therefore
the denominator of both equations is zero.  If the lines are skew,
then <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42B TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">r</mi></mrow>
</mrow><mn>1</mn></msub><mo stretchy="false">(</mo><msub><mi>t</mi><mn>1</mn></msub><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42B TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">r</mi></mrow>
</mrow><mn>2</mn></msub><mo stretchy="false">(</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container> are the points of
closest approach. To distinguish between skew and intersecting
lines, we examine the distance between <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42B TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">r</mi></mrow>
</mrow><mn>1</mn></msub><mo stretchy="false">(</mo><msub><mi>t</mi><mn>1</mn></msub><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container> and
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42B TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">r</mi></mrow>
</mrow><mn>2</mn></msub><mo stretchy="false">(</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container>.  Of course, in practice, an exact intersection
rarely occurs due to floating point imprecision, and therefore a
tolerance must be used.
</p>
<p>
This discussion has assumed that the range of the parameters <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi><mn>1</mn></msub></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi><mn>2</mn></msub></math></mjx-assistive-mml>
</mjx-container> were not restricted.
If the rays have finite length (or extend in only  one direction), then, of course, the
appropriate boundary tests would be applied after computing <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi><mn>1</mn></msub></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi><mn>2</mn></msub></math></mjx-assistive-mml>
</mjx-container>.
</p>

<h1 id="intersection_ray_plane"><span class="SectionNumber">A.9</span><span class="SectionTitle">Intersection of a Ray and Plane</span></h1>
<p class="NoIndent">A ray intersects a plane in 3D at a point.  Let the ray be defined parametrically by
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>0</mn></msub><mo>+</mo><mi>t</mi>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo>.</mo></math></mjx-assistive-mml>
</mjx-container>
</div><p>
The plane will be defined in the standard implicit manner, by all points <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> such that
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mo>&#8901;</mo>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo>=</mo><mi>d</mi><mo>.</mo></math></mjx-assistive-mml>
</mjx-container>
</div>
<p class="NoIndent">
Although we often restrict the plane normal <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> and the ray
direction vector <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> to be unit vectors, in this case
neither restriction is necessary.
</p>
<div id="intersection_ray_plane" class="Display Figure Narrow">
<div class="Body">
		<img class="WithFrame" src="figs/geomtests/intersection_ray_plane.png" loading="lazy" width="306" height="244">
</div><span class="Caption">
<span class="Label">Figure&#160;A.6</span><span class="CaptionText">
Intersection of a ray and
plane in 3D
</span>
</span>
</div><p>
Let us solve for <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></mjx-assistive-mml>
</mjx-container> at the point of intersection, assuming an
infinite ray for the moment:
</p>
<span class="InMarginAnchor"><span class="InMargin"><span class="EqMarginCaption">Parametric intersection of a ray and a plane</span></span></span><div class="DisplayMath">
<mjx-container class="MathJax" display="true" jax="CHTML" role="presentation" style="font-size: 100%; min-width: 100%; position: relative" width="full">
<mjx-math aria-hidden="true" class="MJX-TEX" display="true" width="full"><mjx-mtable side="right" style="min-width: 100%; display: flex; justify-content: space-between; flex-flow: row nowrap">
<mjx-labels-partner style="flex: 1 0 0; max-width: 3.106em"></mjx-labels-partner><mjx-table style="flex: 0 0 12.186em"><mjx-itable width="full"><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-bottom: 0.15em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-texatom space="3" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-msub><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-texatom space="3" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-texatom space="3" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-texatom space="3" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-texatom space="3" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mlabeledtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-texatom space="3" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mrow><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-texatom space="3" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mlabeledtr></mjx-itable></mjx-table>
<mjx-labels style="flex: 0 0 3.106em"><mjx-itable align="right" style=""><mjx-mtr style="height: 3.75em"></mjx-mtr><mjx-mtr style="height: 2.241em"><mjx-mtd id="mjx-eqn-A.4" style="padding-top: 0.15em"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c28"></mjx-c><mjx-c class="mjx-c41"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c34"></mjx-c><mjx-c class="mjx-c29"></mjx-c></mjx-mtext><mjx-tstrut style="height: 2.091em; vertical-align: -0.692em"></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-labels>
</mjx-mtable>
</mjx-math>
<mjx-assistive-mml display="block" role="presentation" unselectable="on"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mtr><mtd><mo stretchy="false">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>0</mn></msub><mo>+</mo><mi>t</mi>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo stretchy="false">)</mo><mo>&#8901;</mo>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow></mtd><mtd><mi></mi><mo>=</mo><mi>d</mi><mo>,</mo></mtd></mtr><mtr><mtd><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>0</mn></msub><mo>&#8901;</mo>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo>+</mo><mi>t</mi>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo>&#8901;</mo>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow></mtd><mtd><mi></mi><mo>=</mo><mi>d</mi><mo>,</mo></mtd></mtr><mtr><mtd><mi>t</mi>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo>&#8901;</mo>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow></mtd><mtd><mi></mi><mo>=</mo><mi>d</mi><mo>&#8722;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>0</mn></msub><mo>&#8901;</mo>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo>,</mo></mtd></mtr><mlabeledtr><mtd><mtext>(A.4)</mtext></mtd><mtd><mi>t</mi></mtd><mtd><mi></mi><mo>=</mo><mfrac>
<mrow><mi>d</mi><mo>&#8722;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>0</mn></msub><mo>&#8901;</mo>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow></mrow>
<mrow>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo>&#8901;</mo>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow></mrow>
</mfrac><mo>.</mo></mtd></mlabeledtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<p class="NoIndent">
If the ray is parallel to the plane, then the denominator
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo>&#8901;</mo>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> is zero and there is no intersection.
If the value for <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></mjx-assistive-mml>
</mjx-container> is out of range, then the ray does not
intersect the plane. We may also wish to intersect only with the
front of the plane.  In this case, we say there is an
intersection  only if the ray points in a direction opposite to the
normal of the plane (i.e., <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c30"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo>&#8901;</mo>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo>&lt;</mo><mn>0</mn></math></mjx-assistive-mml>
</mjx-container>).
</p>

<h1 id="intersection_aabb_plane"><span class="SectionNumber">A.10</span><span class="SectionTitle">Intersection of an AABB and Plane</span></h1>
<p class="NoIndent">Consider a 3D axially aligned bounding box defined by extreme points <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container>
and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container>, and a plane defined in the standard implicit manner by all
points <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> that satisfy
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mo>&#8901;</mo>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo>=</mo><mi>d</mi><mo>,</mo></math></mjx-assistive-mml>
</mjx-container>
</div><p>
where <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> is not necessarily a unit vector.  The plane must be expressed in the same
coordinate space as the AABB.
</p>
<p>
One obvious implementation strategy for a static test would be to classify each corner point as
being on either the front or back side of the plane.  We do this by taking the dot products of
the corner points with <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> and comparing these dot products with <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></mjx-assistive-mml>
</mjx-container>. If all of the dot
products are greater than <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></mjx-assistive-mml>
</mjx-container>, then the box is completely on the front side of the plane.  If all
of the dot products are less than <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></mjx-assistive-mml>
</mjx-container>, then the box is completely on the back side of the plane.
</p>
<p>
As it turns out, we don't have to check all eight corner points. We'll use a trick similar to the
one used in <a href="geomprims.html#transforming_aabbs">Section&#160;9.4.4</a> to transform an AABB.  For example, if
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3E"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c30"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mi>n</mi></mrow>
<mrow><mi>x</mi></mrow>
</msub><mo>&gt;</mo><mn>0</mn></math></mjx-assistive-mml>
</mjx-container>, then the corner with the minimal dot product has <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>=</mo><msub><mi>x</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container> and
the corner with the maximal dot product has <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>=</mo><msub><mi>x</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container>.  If <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c30"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mi>n</mi></mrow>
<mrow><mi>x</mi></mrow>
</msub><mo>&lt;</mo><mn>0</mn></math></mjx-assistive-mml>
</mjx-container>, then
the opposite is true. Similar statements apply to <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mi>n</mi></mrow>
<mrow><mi>y</mi></mrow>
</msub></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mi>n</mi></mrow>
<mrow><mi>z</mi></mrow>
</msub></math></mjx-assistive-mml>
</mjx-container>. We compute
the minimum and maximum dot product values.  If the minimum dot product value is greater than
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></mjx-assistive-mml>
</mjx-container>, or if the maximum dot product is less than <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></mjx-assistive-mml>
</mjx-container>, then there is no intersection.  Otherwise,
two corners were found that are on opposite sides of the plane, and therefore an intersection is
detected.  This strategy is implemented in <a href="#aabb_plane_intersection">Listing&#160;A.2</a>.
</p>
<p>
<div class="Wide Display Listing">
<pre>
// Perform static AABB-plane intersection test.  Returns:
//
// &lt;0   Box is completely on the BACK side of the plane
// &gt;0   Box is completely on the FRONT side of the plane
// 0    Box intersects the plane
int AABB3::classifyPlane(const Vector3 &amp;n, float d) const {

    // Inspect the normal and compute the minimum and maximum
    // D values.
    float minD, maxD;

    if (n.x &gt; 0.0f) {
        minD = n.x*min.x; maxD = n.x*max.x;
    } else {
        minD = n.x*max.x; maxD = n.x*min.x;
    }

    if (n.y &gt; 0.0f) {
        minD += n.y*min.y; maxD += n.y*max.y;
    } else {
        minD += n.y*max.y; maxD += n.y*min.y;
    }

    if (n.z &gt; 0.0f) {
        minD += n.z*min.z; maxD += n.z*max.z;
    } else {
        minD += n.z*max.z; maxD += n.z*min.z;
    }

    // Check if completely on the front side of the plane
    if (minD &gt;= d) {
        return +1;
    }

    // Check if completely on the back side of the plane
    if (maxD &lt;= d) {
        return -1;
    }

    // We straddle the plane
    return 0;
}
</pre>
</div>
</p>
<p>
A dynamic test is just one step further.  Let's consider the plane to be stationary (recall from
<a href="#intersection_tests">Section&#160;A.6</a> that it is simpler to view the test from the frame of reference
of one of the moving objects).  The displacement of the box will be defined by a unit vector
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> and a length <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></mjx-assistive-mml>
</mjx-container>.  As before, we first locate the corner points with the minimum and
maximum dot products and check for an intersection at <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c30"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>=</mo><mn>0</mn></math></mjx-assistive-mml>
</mjx-container>.  If the box is not initially
intersecting the plane, then it must first strike the plane at the corner point closest to the
plane.  This will be one of the two corner points identified in the first step.  If we are
interested only in colliding with the &#8220;front&#8221; of the plane, then we can always use the corner
with the minimum dot product value.  Once we have determined which corner will strike the plane,
we use the ray-plane intersection test in <a href="#intersection_ray_plane">Section&#160;A.9</a>.
</p>

<h1 id="intersection_three_planes"><span class="SectionNumber">A.11</span><span class="SectionTitle">Intersection of Three Planes</span></h1>
<p class="NoIndent">In 3D, three planes intersect at a point, as shown in <a href="#intersection_three_planes">Figure&#160;A.7</a>.
</p>
<div id="intersection_three_planes" class="Display Figure Narrow">
<div class="Body">
		<img class="WithFrame" src="figs/geomtests/intersection_three_planes.png" loading="lazy" width="338" height="388">
</div><span class="Caption">
<span class="Label">Figure&#160;A.7</span><span class="CaptionText">
Three planes intersect at a
point in&#160;3D
</span>
</span>
</div><p>
Let the three planes be defined implicitly as
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mtable style="min-width: 18.817em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-right: 1em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding-left: 1em; padding-right: 0"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-right: 1em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding-left: 1em; padding-right: 0"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c33"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c33"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" rowspacing="3pt"><mtr><mtd>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mo>&#8901;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mn>1</mn></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>d</mi><mn>1</mn></msub><mo>,</mo></mtd><mtd>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mo>&#8901;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mn>2</mn></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>d</mi><mn>2</mn></msub><mo>,</mo></mtd><mtd>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mo>&#8901;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mn>3</mn></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>d</mi><mn>3</mn></msub><mo>.</mo></mtd></mtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div><p>
Although we usually use unit vectors for the plane normals, in this case it is not necessary that
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mi>i</mi></msub></math></mjx-assistive-mml>
</mjx-container> be of unit length.  These three plane equations give us a system of linear equations
with three equations and three unknowns (the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml>
</mjx-container>-, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></mjx-assistive-mml>
</mjx-container>-, and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container>-coordinates of the point of
intersection). Solving this system of equations yields the following result, from Goldman
<a class="RefCite" href="#reference_4">[4]</a>:
</p>
<span class="InMarginAnchor"><span class="InMargin"><span class="EqMarginCaption">Three planes intersect at a point</span></span></span>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c33"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c33"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c33"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c33"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mo>=</mo><mfrac>
<mrow><msub><mi>d</mi><mn>1</mn></msub><mo stretchy="false">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mn>2</mn></msub><mo>&#215;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mn>3</mn></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>d</mi><mn>2</mn></msub><mo stretchy="false">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mn>3</mn></msub><mo>&#215;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mn>1</mn></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>d</mi><mn>3</mn></msub><mo stretchy="false">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mn>1</mn></msub><mo>&#215;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mn>2</mn></msub><mo stretchy="false">)</mo></mrow>
<mrow><mo stretchy="false">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mn>1</mn></msub><mo>&#215;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mn>2</mn></msub><mo stretchy="false">)</mo><mo>&#8901;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mn>3</mn></msub></mrow>
</mfrac><mo>.</mo></math></mjx-assistive-mml>
</mjx-container>
</div>
<p class="NoIndent">
If any pair of planes is parallel, then the point of intersection either does not exist or is not
unique.  In either case, the triple product in the denominator is zero.
</p>

<h1 id="intersection_ray_sphere"><span class="SectionNumber">A.12</span><span class="SectionTitle">Intersection of Ray and a Circle or Sphere</span></h1>
<p class="NoIndent">This section discusses how to compute the intersection of a ray and a circle in 2D. This also works
for computing the intersection of a ray and a sphere in 3D, since we can operate in the plane
that contains the ray and the center of the circle and turn the 3D problem into a 2D one. (If the
ray lies on a line that passes through the center of the sphere, the plane is not uniquely
defined. This not a problem, however, because any of the infinitely many planes that pass through
the ray and the center of the sphere can be used.)
</p>
<div id="intersection_ray_sphere" class="Display Figure Narrow">
<div class="Body">
		<img class="WithFrame" src="figs/geomtests/intersection_ray_sphere.png" loading="lazy" width="369" height="263">
</div><span class="Caption">
<span class="Label">Figure&#160;A.8</span><span class="CaptionText">
Intersection of a ray and
sphere
</span>
</span>
</div><p>
We will use a construction inspired by Hultquist <a class="RefCite" href="#reference_5">[5]</a>; see
<a href="#intersection_ray_sphere">Figure&#160;A.8</a>. The sphere is defined by its center <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> and radius
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></mjx-assistive-mml>
</mjx-container>, and the ray is defined by
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>0</mn></msub><mo>+</mo><mi>t</mi>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo>.</mo></math></mjx-assistive-mml>
</mjx-container>
</div><p>
In this case, we use a unit vector <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math></mjx-assistive-mml>
</mjx-container> and vary <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></mjx-assistive-mml>
</mjx-container> from 0 to <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></mjx-assistive-mml>
</mjx-container>, where <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></mjx-assistive-mml>
</mjx-container> is the
length of the ray.
</p>
<p>
We are solving for the value of <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></mjx-assistive-mml>
</mjx-container> at the point of intersection. Clearly, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>=</mo><mi>a</mi><mo>&#8722;</mo><mi>f</mi></math></mjx-assistive-mml>
</mjx-container>.  We can
compute <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></mjx-assistive-mml>
</mjx-container> as follows.  Let <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41E TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">e</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> be the vector from <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>0</mn></msub></math></mjx-assistive-mml>
</mjx-container> to <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>:
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41E TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-TeXAtom space="4" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
<mrow>
<mrow><mi mathvariant="bold">e</mi></mrow>
</mrow><mo>=</mo>
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow><mo>&#8722;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>0</mn></msub><mo>.</mo></math></mjx-assistive-mml>
</mjx-container>
</div><p>
Now we project <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41E TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">e</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> onto <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math></mjx-assistive-mml>
</mjx-container> (see <a href="vectors.html#dot_product_geometry">Section&#160;2.11.2</a>).
The length of this vector is <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></mjx-assistive-mml>
</mjx-container>, and can be computed by
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-TeXAtom space="4" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41E TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>a</mi><mo>=</mo>
<mrow>
<mrow><mi mathvariant="bold">e</mi></mrow>
</mrow><mo>&#8901;</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo>.</mo></math></mjx-assistive-mml>
</mjx-container>
</div>
<p>
Now all that remains is to compute <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></mjx-assistive-mml>
</mjx-container>.  First, by the Pythagorean
theorem, we clearly see that
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em; margin-left: 0.053em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msup space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msup space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>f</mi><mn>2</mn></msup><mo>+</mo><msup><mi>b</mi><mn>2</mn></msup><mo>=</mo><msup><mi>r</mi><mn>2</mn></msup><mo>.</mo></math></mjx-assistive-mml>
</mjx-container>
</div><p>
We can solve for <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.363em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>b</mi><mn>2</mn></msup></math></mjx-assistive-mml>
</mjx-container> by using the Pythagorean theorem on the larger triangle:
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mtable style="min-width: 7.624em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-bottom: 0.15em"><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msup space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msup space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em"><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msup space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msup space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" rowspacing="3pt"><mtr><mtd><msup><mi>a</mi><mn>2</mn></msup><mo>+</mo><msup><mi>b</mi><mn>2</mn></msup></mtd><mtd><mi></mi><mo>=</mo><msup><mi>e</mi><mn>2</mn></msup><mo>,</mo></mtd></mtr><mtr><mtd><msup><mi>b</mi><mn>2</mn></msup></mtd><mtd><mi></mi><mo>=</mo><msup><mi>e</mi><mn>2</mn></msup><mo>&#8722;</mo><msup><mi>a</mi><mn>2</mn></msup><mo>,</mo></mtd></mtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<p class="NoIndent">
where <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi></math></mjx-assistive-mml>
</mjx-container> is the distance from the origin of the ray to the center, that is, the length of the
vector <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41E TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">e</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>.  Thus, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.363em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>e</mi><mn>2</mn></msup></math></mjx-assistive-mml>
</mjx-container> can be computed by
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-TeXAtom space="4" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41E TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41E TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>e</mi><mn>2</mn></msup><mo>=</mo>
<mrow>
<mrow><mi mathvariant="bold">e</mi></mrow>
</mrow><mo>&#8901;</mo>
<mrow>
<mrow><mi mathvariant="bold">e</mi></mrow>
</mrow><mo>.</mo></math></mjx-assistive-mml>
</mjx-container>
</div>
<p>
Substituting and solving for <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></mjx-assistive-mml>
</mjx-container>, we get
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mtable style="min-width: 13.765em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-bottom: 0.15em"><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em; margin-left: 0.053em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msup space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msup space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em; margin-left: 0.053em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msup space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msup space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em; margin-left: 0.053em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msup space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msup space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msup space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msqrt space="4"><mjx-sqrt><mjx-surd><mjx-mo class="mjx-sop"><mjx-c class="mjx-c221A TEX-S1"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top: 0.234em"><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.289em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msup space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.289em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msup space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.289em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-box></mjx-sqrt></mjx-msqrt><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" rowspacing="3pt"><mtr><mtd><msup><mi>f</mi><mn>2</mn></msup><mo>+</mo><msup><mi>b</mi><mn>2</mn></msup></mtd><mtd><mi></mi><mo>=</mo><msup><mi>r</mi><mn>2</mn></msup><mo>,</mo></mtd></mtr><mtr><mtd><msup><mi>f</mi><mn>2</mn></msup><mo>+</mo><mo stretchy="false">(</mo><msup><mi>e</mi><mn>2</mn></msup><mo>&#8722;</mo><msup><mi>a</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><msup><mi>r</mi><mn>2</mn></msup><mo>,</mo></mtd></mtr><mtr><mtd><msup><mi>f</mi><mn>2</mn></msup></mtd><mtd><mi></mi><mo>=</mo><msup><mi>r</mi><mn>2</mn></msup><mo>&#8722;</mo><msup><mi>e</mi><mn>2</mn></msup><mo>+</mo><msup><mi>a</mi><mn>2</mn></msup><mo>,</mo></mtd></mtr><mtr><mtd><mi>f</mi></mtd><mtd><mi></mi><mo>=</mo><msqrt><msup><mi>r</mi><mn>2</mn></msup><mo>&#8722;</mo><msup><mi>e</mi><mn>2</mn></msup><mo>+</mo><msup><mi>a</mi><mn>2</mn></msup></msqrt><mo>.</mo></mtd></mtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div><p>
Finally, solving for <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></mjx-assistive-mml>
</mjx-container>, we have
</p>
<span class="InMarginAnchor">
<span class="InMargin"><span class="EqMarginCaption">Parametric intersection of a ray and a circle or sphere</span>
</span>
</span>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mtable style="min-width: 9.846em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-bottom: 0.15em"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msqrt space="3"><mjx-sqrt><mjx-surd><mjx-mo class="mjx-sop"><mjx-c class="mjx-c221A TEX-S1"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top: 0.234em"><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.289em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msup space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.289em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msup space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.289em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-box></mjx-sqrt></mjx-msqrt><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" rowspacing="3pt"><mtr><mtd><mi>t</mi></mtd><mtd><mi></mi><mo>=</mo><mi>a</mi><mo>&#8722;</mo><mi>f</mi></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mi>a</mi><mo>&#8722;</mo><msqrt><msup><mi>r</mi><mn>2</mn></msup><mo>&#8722;</mo><msup><mi>e</mi><mn>2</mn></msup><mo>+</mo><msup><mi>a</mi><mn>2</mn></msup></msqrt><mo>.</mo></mtd></mtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<p>
If the argument to the square root (<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.363em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msup space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.363em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msup space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.363em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>r</mi><mn>2</mn></msup><mo>&#8722;</mo><msup><mi>e</mi><mn>2</mn></msup><mo>+</mo><msup><mi>a</mi><mn>2</mn></msup></math></mjx-assistive-mml>
</mjx-container>) is negative,
then the ray does not intersect the sphere.
</p>
<p>
The origin of the ray could be inside the sphere.  This is indicated by <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.363em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3C"></mjx-c></mjx-mo><mjx-msup space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.363em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>e</mi><mn>2</mn></msup><mo>&lt;</mo><msup><mi>r</mi><mn>2</mn></msup></math></mjx-assistive-mml>
</mjx-container>. Appropriate
behavior in this case would vary, depending on the purpose of the test.
</p>

<h1 id="intersection_two_spheres"><span class="SectionNumber">A.13</span><span class="SectionTitle">Intersection of Two Circles or Spheres</span></h1>
<div id="intersection_two_spheres" class="Display Figure Wrap">
<div class="Body">
        <img class="WithFrame" src="figs/geomtests/intersection_two_spheres.png" loading="lazy" width="267" height="190">
</div><span class="Caption"><span class="Label">Figure&#160;A.9</span><span class="CaptionText">Intersection of two spheres</span>
</span>
</div><p>
Detecting the static intersection of two spheres is relatively easy. (The discussion in this
section also applies to circles&#8212;in fact, we use circles in the diagrams.)  Consider two spheres
defined by centers <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow><mn>1</mn></msub></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow><mn>2</mn></msub></math></mjx-assistive-mml>
</mjx-container> and radii <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>r</mi><mn>1</mn></msub></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>r</mi><mn>2</mn></msub></math></mjx-assistive-mml>
</mjx-container>, as shown in
<a href="#intersection_two_spheres">Figure&#160;A.9</a>.  Let <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></mjx-assistive-mml>
</mjx-container> be the distance between their centers. Clearly,
the spheres intersect if <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3C"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mo>&lt;</mo><msub><mi>r</mi><mn>1</mn></msub><mo>+</mo><msub><mi>r</mi><mn>2</mn></msub></math></mjx-assistive-mml>
</mjx-container>.  In practice, we can avoid the square root involved in
the calculation of <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></mjx-assistive-mml>
</mjx-container> by checking that <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.363em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-script style="vertical-align: 0.363em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>d</mi><mn>2</mn></msup><mo>&lt;</mo><mo stretchy="false">(</mo><msub><mi>r</mi><mn>1</mn></msub><mo>+</mo><msub><mi>r</mi><mn>2</mn></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></math></mjx-assistive-mml>
</mjx-container>.
</p>
<p>
Detecting the intersection of two moving spheres is slightly more difficult. Assume, for the
moment, that we have two separate displacement vectors <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>d</mi><mn>1</mn></msub></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>d</mi><mn>2</mn></msub></math></mjx-assistive-mml>
</mjx-container>, one for each sphere,
which describe how the spheres will move during the period of time under consideration.  This is
shown in <a href="#intersection_dynamic_spheres_both_moving">Figure&#160;A.10</a>.
</p>
<div id="intersection_dynamic_spheres_both_moving" class="Display Figure Narrow">
<div class="Body">
		<img class="WithFrame" src="figs/geomtests/intersection_dynamic_spheres_both_moving.png" loading="lazy" width="270" height="160">
</div><span class="Caption">
<span class="Label">Figure&#160;A.10</span><span class="CaptionText">
Two moving
spheres
</span>
</span>
</div><p>
We can simplify the problem by viewing it from the point of view of the first sphere, considering
that sphere to be &#8220;stationary&#8221; while the other sphere is the &#8220;moving&#8221; sphere.  This gives us
a single displacement vector <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>, computed as the difference of the two movement vectors
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>2</mn></msub><mo>&#8722;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mn>1</mn></msub></math></mjx-assistive-mml>
</mjx-container>.  This is illustrated in
<a href="#intersection_dynamic_spheres_one_moving">Figure&#160;A.11</a>.
</p>
<div id="intersection_dynamic_spheres_one_moving" class="Display Figure Narrow">
<div class="Body">
		<img class="WithFrame" src="figs/geomtests/intersection_dynamic_spheres_one_moving.png" loading="lazy" width="270" height="160">
</div><span class="Caption">
<span class="Label">Figure&#160;A.11</span><span class="CaptionText">
Combining
displacement vectors so that one sphere is considered stationary
</span>
</span>
</div><p>
Let the stationary sphere be defined by its center <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow><mi>s</mi></msub></math></mjx-assistive-mml>
</mjx-container> and radius <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>r</mi><mi>s</mi></msub></math></mjx-assistive-mml>
</mjx-container>.  The radius
of the moving sphere is <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>r</mi><mi>m</mi></msub></math></mjx-assistive-mml>
</mjx-container>.  The center of the moving sphere is <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow><mi>m</mi></msub></math></mjx-assistive-mml>
</mjx-container> at <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c30"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>=</mo><mn>0</mn></math></mjx-assistive-mml>
</mjx-container>.
Rather than varying t from 0 to 1 as described previously, we normalize <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math></mjx-assistive-mml>
</mjx-container> and
vary <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></mjx-assistive-mml>
</mjx-container> from 0 to <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></mjx-assistive-mml>
</mjx-container>, where <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></mjx-assistive-mml>
</mjx-container> is the length of the total relative displacement. So the
position of the center of the moving sphere at time <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></mjx-assistive-mml>
</mjx-container> is given by <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow><mi>m</mi></msub><mo>+</mo><mi>t</mi>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math></mjx-assistive-mml>
</mjx-container>. Our goal is to find <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></mjx-assistive-mml>
</mjx-container>, the time at which the moving sphere touches the
stationary sphere. The geometry involved is illustrated in
<a href="#intersection_dynamic_spheres">Figure&#160;A.12</a>.
</p>
<div id="intersection_dynamic_spheres" class="Display Figure Narrow">
<div class="Body">
		<img class="WithFrame" src="figs/geomtests/intersection_dynamic_spheres.png" loading="lazy" width="405" height="240">
</div><span class="Caption"><span class="Label">Figure&#160;A.12</span><span class="CaptionText">Dynamic intersection of circles or spheres</span>
</span>
</div><p>
To solve for <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></mjx-assistive-mml>
</mjx-container>, we begin by calculating an intermediate vector <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41E TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">e</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> as the vector from
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow><mi>m</mi></msub></math></mjx-assistive-mml>
</mjx-container> to <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow><mi>s</mi></msub></math></mjx-assistive-mml>
</mjx-container>, and set <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></mjx-assistive-mml>
</mjx-container> equal to the sum of the radii:
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mtable style="min-width: 5.435em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-bottom: 0.15em"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41E TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" rowspacing="3pt"><mtr><mtd>
<mrow>
<mrow><mi mathvariant="bold">e</mi></mrow>
</mrow></mtd><mtd><mi></mi><mo>=</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow><mi>s</mi></msub><mo>&#8722;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow><mi>m</mi></msub><mo>,</mo></mtd></mtr><mtr><mtd><mi>r</mi></mtd><mtd><mi></mi><mo>=</mo><msub><mi>r</mi><mi>m</mi></msub><mo>+</mo><msub><mi>r</mi><mi>s</mi></msub><mo>.</mo></mtd></mtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div><p>
According to the law of cosines (see <a href="cartesianspace.html#trig_identities">Section&#160;1.4.5</a>), we have
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-merror data-mjx-error="Undefined control sequence \intertext"><mjx-mtext style="font-family: MJXZERO, serif"><mjx-utext style="font-size: 88.4%; padding: 0.848em 0 0.226em 0" variant="-explicitFont">Undefined control sequence \intertext</mjx-utext></mjx-mtext></mjx-merror>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><merror data-mjx-error="Undefined control sequence \intertext"><mtext>Undefined control sequence \intertext</mtext></merror></math></mjx-assistive-mml>
</mjx-container>
</div>
<p class="NoIndent">
Which root do we pick?  The lower number (the negative root) produces the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></mjx-assistive-mml>
</mjx-container> value when the
spheres <i>begin intersecting</i>.  The greater number (the positive root) is the point where the
spheres <i>cease to intersect</i>.  We are interested in the first intersection:
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-TeXAtom space="4" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41E TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msqrt space="3"><mjx-sqrt><mjx-surd><mjx-mo class="mjx-lop"><mjx-c class="mjx-c221A TEX-S2"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top: 0.322em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41E TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-script style="vertical-align: 0.289em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msup space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.289em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41E TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41E TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-box></mjx-sqrt></mjx-msqrt><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>t</mi><mo>=</mo>
<mrow>
<mrow><mi mathvariant="bold">e</mi></mrow>
</mrow><mo>&#8901;</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo>&#8722;</mo><msqrt><mo stretchy="false">(</mo>
<mrow>
<mrow><mi mathvariant="bold">e</mi></mrow>
</mrow><mo>&#8901;</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><msup><mi>r</mi><mn>2</mn></msup><mo>&#8722;</mo>
<mrow>
<mrow><mi mathvariant="bold">e</mi></mrow>
</mrow><mo>&#8901;</mo>
<mrow>
<mrow><mi mathvariant="bold">e</mi></mrow>
</mrow></msqrt><mo>.</mo></math></mjx-assistive-mml>
</mjx-container>
</div><p>
If <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c2225"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41E TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2225"></mjx-c></mjx-mo></mjx-mrow></mjx-TeXAtom><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">&#8741;</mo>
<mrow>
<mrow>
<mrow><mi mathvariant="bold">e</mi></mrow>
</mrow></mrow>
<mo data-mjx-texclass="CLOSE">&#8741;</mo></mrow>
</mrow><mo>&lt;</mo><mi>r</mi></math></mjx-assistive-mml>
</mjx-container>, then the spheres are intersecting at <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c30"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>=</mo><mn>0</mn></math></mjx-assistive-mml>
</mjx-container>.  If <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c30"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>&lt;</mo><mn>0</mn></math></mjx-assistive-mml>
</mjx-container> or <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3E"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>&gt;</mo><mi>l</mi></math></mjx-assistive-mml>
</mjx-container>,
then the intersection does not occur within the period of time being considered.  If the value
inside the square root is negative, then there is no intersection.
</p>

<h1 id="intersection_sphere_aabb"><span class="SectionNumber">A.14</span><span class="SectionTitle">Intersection of a Sphere and AABB</span></h1>
<p class="NoIndent">To detect the static intersection of a sphere and an AABB, we first find the point on the box
that is closest to the center of the sphere by using the techniques from
<a href="#closest_point_aabb">Section&#160;A.5</a>. We compute the distance from this point to the center of the
sphere and compare this distance with the radius. (Actually, in practice we compare the distance
squared against the radius squared to avoid the square root in the distance computation.)  If the
distance is smaller than the radius, then the sphere intersects the AABB.
</p>
<p>
Arvo <a class="RefCite" href="#reference_1">[1]</a> discusses this technique, which he uses for intersecting
spheres with &#8220;solid&#8221; boxes.  He also discusses some tricks for intersecting spheres with
&#8220;hollow&#8221; boxes.
</p>
<p>
Unfortunately, the dynamic test is more complicated than the static one. For details, see Lengyel
<a class="RefCite" href="#reference_6">[6]</a>.
</p>

<h1 id="intersection_sphere_plane"><span class="SectionNumber">A.15</span><span class="SectionTitle">Intersection of a Sphere and a Plane</span></h1>
<p class="NoIndent">Detecting the static intersection of a sphere and a plane is relatively easy&#8212;we simply compute
the distance from the center of the sphere to the plane by using
<a href="geomprims.html#plane_distance_to_point">Equation&#160;(9.14)</a>. If this distance is less than the radius of the
sphere, then the sphere intersects the plane. We can actually make a more robust test, which
classifies the sphere as being completely on the front, completely on the back, or straddling the
sphere.  A code snippet is given in <a href="#intersection_sphere_plane">Listing&#160;A.3</a>.
</p>
<p>
<div class="Wide Display Listing">
<pre>
// Given a sphere and plane, determine which side of the plane
// the sphere is on.
//
// Return values:
//
// &lt; 0  Sphere is completely on the back
// &gt; 0  Sphere is completely on the front
// 0    Sphere straddles plane

int classifySpherePlane(
    const Vector3 &amp;planeNormal,  // must be normalized
    float          planeD,       // p * planeNormal = planeD
    const Vector3 &amp;sphereCenter, // center of sphere
    float          sphereRadius  // radius of sphere
) {

    // Compute distance from center of sphere to the plane
    float d = planeNormal * sphereCenter - planeD;

    // Completely on the front side?
    if (d &gt;= sphereRadius) {
        return +1;
    }

    // Completely on the back side?
    if (d &lt;= -sphereRadius) {
        return -1;
    }

    // Sphere intersects the plane
    return 0;
}
</pre>
</div>
</p>
<p>
The dynamic situation is only slightly more complicated.  We consider the plane to be stationary,
assigning all relative displacement to the sphere.
</p>
<p>
We define the plane in the usual manner by a normalized surface normal <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math></mjx-assistive-mml>
</mjx-container> and distance
value <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></mjx-assistive-mml>
</mjx-container> such that all points <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> in the plane satisfy the equation <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mo>&#8901;</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo>=</mo><mi>d</mi></math></mjx-assistive-mml>
</mjx-container>. The sphere is defined by its radius <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></mjx-assistive-mml>
</mjx-container> and the initial position of the center,
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>. The displacement of the sphere is given by a unit vector <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math></mjx-assistive-mml>
</mjx-container>
specifying the direction, and a distance <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></mjx-assistive-mml>
</mjx-container>. As <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></mjx-assistive-mml>
</mjx-container> varies from 0 to <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></mjx-assistive-mml>
</mjx-container>, the motion of the
center of the sphere is given by the line equation <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow><mo>+</mo><mi>t</mi>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math></mjx-assistive-mml>
</mjx-container>. This situation is
shown, viewing the plane edge-on, in <a href="#intersection_dynamic_sphere_plane">Figure&#160;A.13</a>.
</p>
<div id="intersection_dynamic_sphere_plane" class="Display Figure Narrow">
<div class="Body">
		<img class="WithFrame" src="figs/geomtests/intersection_dynamic_sphere_plane.png" loading="lazy" width="272" height="244">
</div><span class="Caption">
<span class="Label">Figure&#160;A.13</span><span class="CaptionText">
A sphere moving
towards a plane
</span>
</span>
</div><p>
The problem is greatly simplified by realizing that no matter where on the surface of the plane
the intersection occurs, the point of contact on the surface of the sphere is always the same.
That point of contact <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>0</mn></msub></math></mjx-assistive-mml>
</mjx-container> is given by <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow><mo>&#8722;</mo><mi>r</mi>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math></mjx-assistive-mml>
</mjx-container>, as shown in
<a href="#intersection_dynamic_sphere_plane_2">Figure&#160;A.14</a>.
</p>
<div id="intersection_dynamic_sphere_plane_2" class="Display Figure Narrow">
<div class="Body">
		<img class="WithFrame" src="figs/geomtests/intersection_dynamic_sphere_plane_2.png" loading="lazy" width="272" height="300">
</div><span class="Caption">
<span class="Label">Figure&#160;A.14</span><span class="CaptionText">
Point of contact
between a sphere and a plane
</span>
</span>
</div><p>
Now that we know which point on the sphere first contacts the plane, we can use a simple
ray-plane intersection test from <a href="#intersection_ray_plane">Section&#160;A.9</a>. We start with our solution
to the ray-plane intersection test from <a href="#intersection_ray_plane">Equation&#160;(A.4)</a> and then substitute
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow><mo>&#8722;</mo><mi>r</mi>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math></mjx-assistive-mml>
</mjx-container> for <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>0</mn></msub></math></mjx-assistive-mml>
</mjx-container>:
</p>
<span class="InMarginAnchor"><span class="InMargin"><span class="EqMarginCaption">Dynamic intersection of a sphere and plane</span></span></span><div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mtable style="min-width: 9.118em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-bottom: 0.3em"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-bottom: 0.3em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mrow><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.3em; padding-bottom: 0.3em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.3em; padding-bottom: 0.3em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mrow><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.3em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.3em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mrow><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" rowspacing="0.6em 0.6em 0.3em"><mtr><mtd><mi>t</mi></mtd><mtd><mi></mi><mo>=</mo><mfrac>
<mrow><mi>d</mi><mo>&#8722;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>0</mn></msub><mo>&#8901;</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</mrow>
<mrow>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo>&#8901;</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</mrow></mfrac><mo>,</mo></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mfrac>
<mrow><mi>d</mi><mo>&#8722;</mo><mo stretchy="false">(</mo>
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow><mo>&#8722;</mo><mi>r</mi>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo stretchy="false">)</mo><mo>&#8901;</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</mrow>
<mrow>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo>&#8901;</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</mrow></mfrac><mo>,</mo></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mfrac>
<mrow><mi>d</mi><mo>&#8722;</mo>
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow><mo>&#8901;</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo>+</mo><mi>r</mi></mrow>
<mrow>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo>&#8901;</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</mrow></mfrac><mo>.</mo></mtd></mtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>

<h1 id="intersection_ray_triangle"><span class="SectionNumber">A.16</span><span class="SectionTitle">Intersection of a Ray and a Triangle</span></h1>
<p class="NoIndent">The ray-triangle intersection test is very important in graphics and computational geometry.  In
the absence of a special raytrace test against a given complex object, we can always represent
(or at least approximate) the surface of an object as a triangle mesh and then raytrace against this
triangle mesh representation.
</p>
<p>
Here we use a simple strategy from Badouel <a class="RefCite" href="#reference_2">[2]</a>.  The first
step is to compute the point where the ray intersects the plane containing the triangle.
<a href="#intersection_ray_plane">Section&#160;A.9</a> showed how to compute the intersection of a plane and a ray.
Then we test to see whether that point is inside the triangle by computing the barycentric
coordinates of the point, as discussed in
<a href="geomprims.html#triangle_barycentric_computing">Section&#160;9.6.4</a>.
</p>
<p>
To speed up this test, we use a few tricks:
</p>
<ul>
    <li>
Detect and return a negative result (no collision) as soon as
        possible. This is known as &#8220;early out.&#8221;
</li>
<li>
Defer expensive mathematical operations, such as division, as long
        as possible.  This is done for two reasons.  First, if the result of the
        expensive calculation is not needed (for example, if we took an early
        out), then the time we spent performing the operation was wasted.
        Second, it gives the compiler plenty of room to take advantage of
        the operator pipeline in modern processors.  If an operation such as
        division has a long latency, then the compiler may be able to look
        ahead and generate code that begins the division operation early. It
        then generates code that performs other tests (possibly taking an
        early out) while the division operation is under way. Then, at
        execution time, if and when the result of the division is actually
        needed, the result will be available or at least partially
        completed.
</li>
<li>
Only detect collisions where the ray approaches the triangle
        from the <i>front</i> side.  This allows us to take a very early out
        on approximately half of the triangles.  Intersecting with both
        sides is slightly slower.
</li>
</ul>
<p>
<a href="#ray_triangle_intersection">Listing&#160;A.4</a> implements these techniques. Although it is commented in
the listing, we have chosen to perform some floating point comparisons &#8220;backwards&#8221; since this
behaves better in the presence of invalid floating point input data and NaNs (Not a Number).
</p>
<p>
<div class="Wide Display Listing">
<pre>
float rayTriangleIntersect(
    const Vector3 &amp;rayOrg,   // origin of the ray
    const Vector3 &amp;rayDelta, // ray length and direction
    const Vector3 &amp;p0,       // triangle vertices
    const Vector3 &amp;p1,       // .
    const Vector3 &amp;p2,       // .
    float minT               // closest intersection found so far.
                             // (Start with 1.0)
) {

    // We'll return this huge number of no intersection is detected
    const float kNoIntersection = FLT_MAX;

    // Compute clockwise edge vectors.
    Vector3 e1 = p1 - p0;
    Vector3 e2 = p2 - p1;

    // Compute surface normal.  (Unnormalized)
    Vector3 n = crossProduct(e1, e2);

    // Compute gradient, which tells us how steep of an angle
    // we are approaching the *front* side of the triangle
    float dot = n * rayDelta;

    // Check for a ray that is parallel to the triangle, or not
    // pointing towards the front face of the triangle.
    //
    // Note that this also will reject degenerate triangles and
    // rays as well.  We code this in a very particular
    // way so that NANs will bail here.  (I.e. this does NOT
    // behave the same as ``dot &gt;= 0.0f'' when NANs are involved)
    if (!(dot &lt; 0.0f)) {
        return kNoIntersection;
    }

    // Compute d value for the plane equation.  We will
    // use the plane equation with d on the right side:
    // Ax + By + Cz = d
    float d = n * p0;

    // Compute parametric point of intersection with the plane
    // containing the triangle, checking at the earliest
    // possible stages for trivial rejection
    float t = d - n * rayOrg;

    // Is ray origin on the backside of the polygon?  Again,
    // we phrase the check so that NANs will bail
    if (!(t &lt;= 0.0f)) {
        return kNoIntersection;
    }

    // Closer intersection already found?  (Or does
    // ray not reach the plane?)
    //
    // since dot &lt; 0:
    //
    //      t/dot &gt; minT
    //
    // is the same as
    //
    //      t &lt; dot*minT
    //
    // (And then we invert it for NAN checking...)
    if (!(t &gt;= dot*minT)) {
        return kNoIntersection;
    }

    // OK, ray intersects the plane.  Compute actual parametric
    // point of intersection
    t /= dot;
    assert(t &gt;= 0.0f);
    assert(t &lt;= minT);

    // Compute 3D point of intersection
    Vector3 p = rayOrg + rayDelta*t;

    // Find dominant axis to select which plane
    // to project onto, and compute u's and v's
    float u0, u1, u2;
    float v0, v1, v2;
    if (fabs(n.x) &gt; fabs(n.y)) {
        if (fabs(n.x) &gt; fabs(n.z)) {
            u0 = p.y - p0.y;
            u1 = p1.y - p0.y;
            u2 = p2.y - p0.y;

            v0 = p.z - p0.z;
            v1 = p1.z - p0.z;
            v2 = p2.z - p0.z;
        } else {
            u0 = p.x - p0.x;
            u1 = p1.x - p0.x;
            u2 = p2.x - p0.x;

            v0 = p.y - p0.y;
            v1 = p1.y - p0.y;
            v2 = p2.y - p0.y;
        }
    } else {
        if (fabs(n.y) &gt; fabs(n.z)) {
            u0 = p.x - p0.x;
            u1 = p1.x - p0.x;
            u2 = p2.x - p0.x;

            v0 = p.z - p0.z;
            v1 = p1.z - p0.z;
            v2 = p2.z - p0.z;
        } else {
            u0 = p.x - p0.x;
            u1 = p1.x - p0.x;
            u2 = p2.x - p0.x;

            v0 = p.y - p0.y;
            v1 = p1.y - p0.y;
            v2 = p2.y - p0.y;
        }
    }

    // Compute denominator, check for invalid
    float temp = u1 * v2 - v1 * u2;
    if (!(temp != 0.0f)) {
        return kNoIntersection;
    }
    temp = 1.0f / temp;

    // Compute barycentric coords, checking for out-of-range
    // at each step
    float alpha = (u0 * v2 - v0 * u2) * temp;
    if (!(alpha &gt;= 0.0f)) {
        return kNoIntersection;
    }

    float beta = (u1 * v0 - v1 * u0) * temp;
    if (!(beta &gt;= 0.0f)) {
        return kNoIntersection;
    }

    float gamma = 1.0f - alpha - beta;
    if (!(gamma &gt;= 0.0f)) {
        return kNoIntersection;
    }

    // Return parametric point of intersection
    return t;
}
</pre>
</div>
</p>
<p>
There is one more significant strategy, not illustrated in
<a href="#ray_triangle_intersection">Listing&#160;A.4</a>, for optimizing expensive calculations: precompute their
results.  If values such as the polygon normal can be computed ahead of time, then different
strategies may be used.
</p>
<p>Because of the fundamental importance of this test, programmers are always looking for ways to
make it faster.  The technique we have given here is a standard one that is easy to understand
and produces the barycentric coordinates, often a useful byproduct, as a side effect. It is not
    the fastest.  See Tomas Akenine-M&#246;ller's collection of intersection tests on the web page for
<i>Real-Time Rendering</i> at <a href="http://www.realtimerendering.com/intersections.html">http://www.realtimerendering.com/intersections.html</a>.
</p>

<h1 id="intersection_two_aabbs"><span class="SectionNumber">A.17</span><span class="SectionTitle">Intersection of Two AABBs</span></h1>
<p class="NoIndent">Detecting the static intersection of two AABBs is an extremely important operation.  Luckily,
it's rather trivial.<a href="#footnote_1" class="FootnoteRef">1</a>  We simply check for overlapping extents on each dimension
independently. If there is no overlap on a particular dimension, then the two AABBs do not
intersect. This technique is used in <a href="#aabb_aabb_overlap">Listing&#160;A.5</a>.
</p>
<p>
<div class="Wide Display Listing">
<pre>
bool aabbsOverlap(const AABB3 &amp;a, const AABB3 &amp;b) {

    // Check for a separating axis.
    if (a.min.x &gt;= b.max.x) return false;
    if (a.max.x &lt;= b.min.x) return false;
    if (a.min.y &gt;= b.max.y) return false;
    if (a.max.y &lt;= b.min.y) return false;
    if (a.min.z &gt;= b.max.z) return false;
    if (a.max.z &lt;= b.min.z) return false;

    // Overlap on all three axes, so their
    // intersection must be non-empty
    return true;
}
</pre>
</div>
</p>
<p>
This strategy is actually an instance of a more general strategy known as the <i>separating
axis</i> test.  If two convex polyhedra do not overlap, then there exists a separating axis upon
which, if we project the two polyhedra, their projections will not overlap.  (In 3D, it's easier
to visualize a plane perpendicular to the separating axis that can be placed between the two
polyhedra.)  The key to the separating axis method is that only a finite number of axes need to
be tested: the normals of the faces and certain cross products; for details, see Ericson
<a class="RefCite" href="#reference_3">[3]</a>.  If the projections of the polyhedra onto those axes
overlap in all cases, then it is safe to assume that no separating axis can be found. In the case
of two AABBs, only the three cardinal axes need to be tested.  Furthermore, these &#8220;projections&#8221;
simply extract the appropriate coordinate.
</p>
<p>
The dynamic intersection of AABBs is only slightly more complicated. Consider a stationary AABB
defined by extreme points <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container>, and a
moving AABB, which has extreme points <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container>
in the initial position at <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c30"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>=</mo><mn>0</mn></math></mjx-assistive-mml>
</mjx-container>. The moving AABB displaces by an amount given by the vector
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>, as <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></mjx-assistive-mml>
</mjx-container> varies from 0 to 1.
</p>
<p>
Our task is to compute <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></mjx-assistive-mml>
</mjx-container>, the parametric point in time where the moving box first collides with
the stationary box.  (We assume that the boxes are not initially intersecting.)  To do this, we
will attempt to determine the first point in time when the boxes have overlap on all dimensions
simultaneously. Since this applies in 2D or 3D, we illustrate the problem here in 2D; extending
the technique into 3D is straightforward.  We analyze each coordinate separately, solving two (or
three, in 3D) separate one-dimensional problems, and then combining these results to give the
answer.
</p>
<p>
The problem is now one-dimensional.  We need to know the interval of time when the two boxes
overlap on a particular dimension. Imagine projecting the problem onto the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml>
</mjx-container>-axis (for example),
as shown in <a href="#intersection_dynamic_aabb">Figure&#160;A.15</a>.
</p>
<div id="intersection_dynamic_aabb" class="Display Figure Narrow">
<div class="Body">
		<img class="WithFrame" src="figs/geomtests/intersection_dynamic_aabb.png" loading="lazy" width="480" height="255">
</div><span class="Caption">
<span class="Label">Figure&#160;A.15</span><span class="CaptionText">
Projecting the dynamic AABB
intersection problem onto one axis
</span>
</span>
</div><p>
As we advance in time, the line segment representing the moving box will slide along the number
line.  In the illustration in <a href="#intersection_dynamic_aabb">Figure&#160;A.15</a>, at <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c30"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>=</mo><mn>0</mn></math></mjx-assistive-mml>
</mjx-container> the moving box is
completely to the left of the stationary box, and at <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c31"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>=</mo><mn>1</mn></math></mjx-assistive-mml>
</mjx-container>, the moving box is completely to the
right of the stationary box.  There is a point <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi>
<mrow>
<mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container> where the boxes first begin
to overlap, and a point <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c76"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi>
<mrow>
<mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">e</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container> where the boxes cease to overlap.  For the dimension
we are considering, let <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</mrow></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
</mrow></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container> be the minimum and
maximum values, respectively, of the moving box at time <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></mjx-assistive-mml>
</mjx-container>, given by
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mtable style="min-width: 10.62em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-bottom: 0.15em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" rowspacing="3pt"><mtr><mtd><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</mrow></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</mrow></msub><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>+</mo><mi>t</mi><mi>d</mi><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
</mrow></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
</mrow></msub><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>+</mo><mi>t</mi><mi>d</mi><mo>,</mo></mtd></mtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div><p>
where <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</mrow></msub><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
</mrow></msub><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container> are the initial extents of the moving box
and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></mjx-assistive-mml>
</mjx-container> is the component of the displacement vector <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41D TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">d</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> for this axis. Let
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container> have similar definitions for the stationary box. (Of
course, these values are independent of <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></mjx-assistive-mml>
</mjx-container> since the box is stationary.) The time
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi>
<mrow>
<mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container> is the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></mjx-assistive-mml>
</mjx-container> value for which <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
</mrow></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>s</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container>.
Solving, we get
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mtable style="min-width: 15.742em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-bottom: 0.15em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" rowspacing="3pt"><mtr><mtd><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
</mrow></msub><mo stretchy="false">(</mo><msub><mi>t</mi>
<mrow>
<mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi></mrow>
</mrow></msub><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><msub><mi>s</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</mrow></msub><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
</mrow></msub><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>+</mo><msub><mi>t</mi>
<mrow>
<mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi></mrow>
</mrow></msub><mi>d</mi></mtd><mtd><mi></mi><mo>=</mo><msub><mi>s</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</mrow></msub><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>t</mi>
<mrow>
<mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi></mrow>
</mrow></msub><mi>d</mi></mtd><mtd><mi></mi><mo>=</mo><msub><mi>s</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</mrow></msub><mo>&#8722;</mo><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
</mrow></msub><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>t</mi>
<mrow>
<mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi></mrow>
</mrow></msub></mtd><mtd><mi></mi><mo>=</mo><mfrac>
<mrow><msub><mi>s</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</mrow></msub><mo>&#8722;</mo><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
</mrow></msub><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow>
<mi>d</mi></mfrac><mo>.</mo></mtd></mtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<p class="NoIndent">
Likewise, we can solve for <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c76"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi>
<mrow>
<mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">e</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container>:
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mtable style="min-width: 15.583em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-bottom: 0.15em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c76"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c76"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c76"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c76"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" rowspacing="3pt"><mtr><mtd><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</mrow></msub><mo stretchy="false">(</mo><msub><mi>t</mi>
<mrow>
<mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">e</mi></mrow>
</mrow></msub><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><msub><mi>s</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
</mrow></msub><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</mrow></msub><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>+</mo><msub><mi>t</mi>
<mrow>
<mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">e</mi></mrow>
</mrow></msub><mi>d</mi></mtd><mtd><mi></mi><mo>=</mo><msub><mi>s</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
</mrow></msub><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>t</mi>
<mrow>
<mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">e</mi></mrow>
</mrow></msub><mi>d</mi></mtd><mtd><mi></mi><mo>=</mo><msub><mi>s</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
</mrow></msub><mo>&#8722;</mo><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</mrow></msub><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>t</mi>
<mrow>
<mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">e</mi></mrow>
</mrow></msub></mtd><mtd><mi></mi><mo>=</mo><mfrac>
<mrow><msub><mi>s</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
</mrow></msub><mo>&#8722;</mo><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</mrow></msub><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow>
<mi>d</mi></mfrac><mo>.</mo></mtd></mtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<p class="NoIndent">
Three important points are noted here:
</p>
<ul>
    <li>
If the denominator <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></mjx-assistive-mml>
</mjx-container> is zero, then boxes either always overlap
        or never overlap.
</li>
<li>
If the moving box begins on the right side of the stationary box
        and moves left, then <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3E"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c76"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi>
<mrow>
<mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi></mrow>
</mrow></msub><mo>&gt;</mo><msub><mi>t</mi>
<mrow>
<mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">e</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container>.  We
        handle this scenario by swapping their values to ensure that
        <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3C"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c76"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi>
<mrow>
<mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi></mrow>
</mrow></msub><mo>&lt;</mo><msub><mi>t</mi>
<mrow>
<mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">e</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container>.
</li>
<li>
The values for <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi>
<mrow>
<mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c76"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi>
<mrow>
<mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">e</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container> may
        be outside the range [0,1]. To accommodate <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></mjx-assistive-mml>
</mjx-container> values outside
        this range, we can think of the moving box as moving along an infinite
        trajectory parallel to <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></mjx-assistive-mml>
</mjx-container>.  If <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3E"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c31"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi>
<mrow>
<mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi></mrow>
</mrow></msub><mo>&gt;</mo><mn>1</mn></math></mjx-assistive-mml>
</mjx-container> or
        <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c76"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c30"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi>
<mrow>
<mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">e</mi></mrow>
</mrow></msub><mo>&lt;</mo><mn>0</mn></math></mjx-assistive-mml>
</mjx-container>, then there is no overlap in the period of time
        under consideration.
</li>
</ul>
<p>
We now have a way to find the interval of time, bounded by <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi>
<mrow>
<mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container> and
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c76"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi>
<mrow>
<mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">e</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container>, when the two boxes overlap on a single dimension. The intersection of these
intervals on all dimensions gives us the interval of time where the boxes intersect with each
other.  This is illustrated in <a href="#intersection_dynamic_aabb_t_overlap">Figure&#160;A.16</a> for two time
intervals in 2D.
</p>
<div id="intersection_dynamic_aabb_t_overlap" class="Display Figure Narrow">
<div class="Body">
		<img class="WithFrame" src="figs/geomtests/intersection_dynamic_aabb_t_overlap.png" loading="lazy" width="443" height="150">
</div><span class="Caption">
<span class="Label">Figure&#160;A.16</span><span class="CaptionText">
Intersecting two
intervals of time
</span>
</span>
</div><div class="WarningNote">
    Don't confuse <a href="#intersection_dynamic_aabb_t_overlap">Figure&#160;A.16</a> with <a href="#intersection_dynamic_aabb">Figure&#160;A.15</a>.  In
    <a href="#intersection_dynamic_aabb_t_overlap">Figure&#160;A.16</a>, the axis is the time
    axis; in <a href="#intersection_dynamic_aabb">Figure&#160;A.15</a> the axis is the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml>
</mjx-container>-axis.
</div><p>
If the interval is empty, then the boxes never collide.  If the interval lies completely outside
the range <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c31"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn><mo>&#8804;</mo><mi>t</mi><mo>&#8804;</mo><mn>1</mn></math></mjx-assistive-mml>
</mjx-container>, then there is no collision over the period of time of interest.
Actually, the interval during which the boxes overlap is more information than we wanted, since
we are interested only in the point in time when the boxes begin intersecting, not when they
cease to intersect. Still, we need to maintain this interval, mainly to determine whether it is
empty.
</p>
<p>
Unfortunately, in practice, bounding boxes for objects are rarely axially aligned in the same
coordinate space.  However, because this test is relatively fast, it is useful as a preliminary
trivial rejection test, to be followed by a more specific (and usually more expensive) test.
</p>

<h1 id="intersection_ray_aabb"><span class="SectionNumber">A.18</span><span class="SectionTitle">Intersection of a Ray and an AABB</span></h1>
<p class="NoIndent">
Computing the intersection of a ray with an AABB is an important calculation because the result
of this test is commonly used for trivial rejection on more complicated objects. (For example, if
we wish to raytrace against multiple triangle meshes, we can first raytrace against the AABBs of
the meshes to trivially reject entire meshes at once, rather than having to check each triangle.)
</p>
<p>Woo <a class="RefCite" href="#reference_7">[7]</a> describes a method that first determines which side of the
box would be intersected and then performs a ray-plane intersection test against the plane
containing that side.  If the point of intersection with the plane is within the box, then there
is an intersection; otherwise, there is no intersection.  This is implemented in
<a href="#ray_box_intersection">Listing&#160;A.6</a>.
</p>
<p>
<div class="Wide Display Listing">
<pre>
// Return parametric point of intersection 0...1, or a really huge
// number if no intersection is found
float AABB3::rayIntersect(
    const Vector3 &amp;rayOrg,      // orgin of the ray
    const Vector3 &amp;rayDelta,    // length and direction of the ray
    Vector3 *returnNormal       // optionally, the normal is returned
) const {

    // We'll return this huge number if no intersection
    const float kNoIntersection = FLT_MAX;

    // Check for point inside box, trivial reject, and
    // determine parametric distance to each front face
    bool inside = true;

    float xt, xn;
    if (rayOrg.x &lt; min.x) {
        xt = min.x - rayOrg.x;
        if (xt &gt; rayDelta.x) return kNoIntersection;
        xt /= rayDelta.x;
        inside = false;
        xn = -1.0f;
    } else if (rayOrg.x &gt; max.x) {
        xt = max.x - rayOrg.x;
        if (xt &lt; rayDelta.x) return kNoIntersection;
        xt /= rayDelta.x;
        inside = false;
        xn = 1.0f;
    } else {
        xt = -1.0f;
    }

    float yt, yn;
    if (rayOrg.y &lt; min.y) {
        yt = min.y - rayOrg.y;
        if (yt &gt; rayDelta.y) return kNoIntersection;
        yt /= rayDelta.y;
        inside = false;
        yn = -1.0f;
    } else if (rayOrg.y &gt; max.y) {
        yt = max.y - rayOrg.y;
        if (yt &lt; rayDelta.y) return kNoIntersection;
        yt /= rayDelta.y;
        inside = false;
        yn = 1.0f;
    } else {
        yt = -1.0f;
    }

    float zt, zn;
    if (rayOrg.z &lt; min.z) {
        zt = min.z - rayOrg.z;
        if (zt &gt; rayDelta.z) return kNoIntersection;
        zt /= rayDelta.z;
        inside = false;
        zn = -1.0f;
    } else if (rayOrg.z &gt; max.z) {
        zt = max.z - rayOrg.z;
        if (zt &lt; rayDelta.z) return kNoIntersection;
        zt /= rayDelta.z;
        inside = false;
        zn = 1.0f;
    } else {
        zt = -1.0f;
    }

    // Ray origin inside box?
    if (inside) {
        if (returnNormal != NULL) {
            *returnNormal = -rayDelta;
            returnNormal-&gt;normalize();
        }
        return 0.0f;
    }

    // Select farthest plane - this is
    // the plane of intersection.
    int which = 0;
    float t = xt;
    if (yt &gt; t) {
        which = 1;
        t = yt;
    }
    if (zt &gt; t) {
        which = 2;
        t = zt;
    }
    switch (which) {

        case 0: // intersect with yz plane
        {
            float y = rayOrg.y + rayDelta.y*t;
            if (y &lt; min.y || y &gt; max.y) return kNoIntersection;
            float z = rayOrg.z + rayDelta.z*t;
            if (z &lt; min.z || z &gt; max.z) return kNoIntersection;

            if (returnNormal != NULL) {
                returnNormal-&gt;x = xn;
                returnNormal-&gt;y = 0.0f;
                returnNormal-&gt;z = 0.0f;
            }

        } break;

        case 1: // intersect with xz plane
        {
            float x = rayOrg.x + rayDelta.x*t;
            if (x &lt; min.x || x &gt; max.x) return kNoIntersection;
            float z = rayOrg.z + rayDelta.z*t;
            if (z &lt; min.z || z &gt; max.z) return kNoIntersection;

            if (returnNormal != NULL) {
                returnNormal-&gt;x = 0.0f;
                returnNormal-&gt;y = yn;
                returnNormal-&gt;z = 0.0f;
            }

        } break;

        case 2: // intersect with xy plane
        {
            float x = rayOrg.x + rayDelta.x*t;
            if (x &lt; min.x || x &gt; max.x) return kNoIntersection;
            float y = rayOrg.y + rayDelta.y*t;
            if (y &lt; min.y || y &gt; max.y) return kNoIntersection;

            if (returnNormal != NULL) {
                returnNormal-&gt;x = 0.0f;
                returnNormal-&gt;y = 0.0f;
                returnNormal-&gt;z = zn;
            }

        } break;
    }

    // Return parametric point of intersection
    return t;

}
</pre>
</div>
</p>
<p>
<div class="References">
<div class="RefSectionTitle">References</div>
<div id="reference_1" class="RefEntry">
<span class="RefNum">[1]</span><span class="RefBody">
James Arvo.
 &#160; &#8220;A Simple Method for Box-Sphere Intersection Testing.&#8221;
 &#160; In <i>Graphics Gems</i>, edited by Andrew&#160;S. Glassner. San Diego:
  Academic Press Professional, 1990.
</span>
</div>
<div id="reference_2" class="RefEntry">
<span class="RefNum">[2]</span><span class="RefBody">
Didier Badouel.
 &#160; &#8220;An Efficient Ray-Polygon Intersection.&#8221;
 &#160; In <i>Graphics Gems</i>, edited by Andrew&#160;S. Glassner. San Diego:
  Academic Press Professional, 1990.
</span>
</div>
<div id="reference_3" class="RefEntry">
<span class="RefNum">[3]</span><span class="RefBody">
Christer Ericson.
 &#160; <i>Real-Time Collision Detection</i>.
 &#160; San Francisco: Morgan Kaufmann Publishers, 2005.
</span>
</div>
<div id="reference_4" class="RefEntry">
<span class="RefNum">[4]</span><span class="RefBody">
Ronald Goldman.
 &#160; &#8220;Intersection of Three Planes.&#8221;
 &#160; In <i>Graphics Gems</i>, edited by Andrew&#160;S. Glassner. San Diego:
  Academic Press Professional, 1990.
</span>
</div>
<div id="reference_5" class="RefEntry">
<span class="RefNum">[5]</span><span class="RefBody">
Jeff Hultquist.
 &#160; &#8220;Intersection of a Ray with a Sphere.&#8221;
 &#160; In <i>Graphics Gems</i>, edited by Andrew&#160;S. Glassner. San Diego:
  Academic Press Professional, 1990.
</span>
</div>
<div id="reference_6" class="RefEntry">
<span class="RefNum">[6]</span><span class="RefBody">
Eric Lengyel.
 &#160; <i>Mathematics for 3D Game Programming and Computer Graphics</i>,
  Second edition.
 &#160; Boston: Charles River Media, 2004.
 &#160; <a href="http://www.terathon.com/books/mathgames2.html">http://www.terathon.com/books/mathgames2.html</a>.
</span>
</div>
<div id="reference_7" class="RefEntry">
<span class="RefNum">[7]</span><span class="RefBody">
Andrew Woo.
 &#160; &#8220;Fast Ray-Box Intersection.&#8221;
 &#160; In <i>Graphics Gems</i>, edited by Andrew&#160;S. Glassner. San Diego:
  Academic Press Professional, 1990.
</span>
</div>
</div>
</p>
<ol class="Footnotes">
<li id="footnote_0">
This is one of Fletcher's favorite interview questions.  It's
surprising how many programmers do not know how to perform this very simple operation.  Don't be
one of those applicants!</li>
</ol>
<footer class="NavBar">
<div class="NavPrevChapter"><a class="NavChapterNum" href="afterword.html">&lt;&lt; Afterword</a>
</div><div class="NavContents"><a onclick="window.scrollTo(0,0);" style="cursor:pointer;">Back To Top</a>
</div><div class="NavNextChapter"><a class="NavChapterNum" href="answers.html">Answers to the Exercises &gt;&gt;
</a></div>
</footer></div>
<div id="RightColumn"></div>
</div></body></html>