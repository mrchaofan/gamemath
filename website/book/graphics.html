<!DOCTYPE html>
<html lang="en">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="3dmathprimer_book.css" rel="stylesheet">
<link rel="icon" type="image/png" href="../favicon.png">
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-YK41S9NXZG"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-YK41S9NXZG');
    </script>
<title>Mathematical Topics<br/>from 3D Graphics - 3D Math Primer for Graphics and Game Development</title>
<style id="MJX-CHTML-styles">
mjx-container[jax="CHTML"] {
  line-height: 0;
}

mjx-container [space="1"] {
  margin-left: .111em;
}

mjx-container [space="2"] {
  margin-left: .167em;
}

mjx-container [space="3"] {
  margin-left: .222em;
}

mjx-container [space="4"] {
  margin-left: .278em;
}

mjx-container [space="5"] {
  margin-left: .333em;
}

mjx-container [rspace="1"] {
  margin-right: .111em;
}

mjx-container [rspace="2"] {
  margin-right: .167em;
}

mjx-container [rspace="3"] {
  margin-right: .222em;
}

mjx-container [rspace="4"] {
  margin-right: .278em;
}

mjx-container [rspace="5"] {
  margin-right: .333em;
}

mjx-container [size="s"] {
  font-size: 70.7%;
}

mjx-container [size="ss"] {
  font-size: 50%;
}

mjx-container [size="Tn"] {
  font-size: 60%;
}

mjx-container [size="sm"] {
  font-size: 85%;
}

mjx-container [size="lg"] {
  font-size: 120%;
}

mjx-container [size="Lg"] {
  font-size: 144%;
}

mjx-container [size="LG"] {
  font-size: 173%;
}

mjx-container [size="hg"] {
  font-size: 207%;
}

mjx-container [size="HG"] {
  font-size: 249%;
}

mjx-container [width="full"] {
  width: 100%;
}

mjx-box {
  display: inline-block;
}

mjx-block {
  display: block;
}

mjx-itable {
  display: inline-table;
}

mjx-row {
  display: table-row;
}

mjx-row > * {
  display: table-cell;
}

mjx-mtext {
  display: inline-block;
  text-align: left;
}

mjx-mstyle {
  display: inline-block;
}

mjx-merror {
  display: inline-block;
  color: red;
  background-color: yellow;
}

mjx-mphantom {
  visibility: hidden;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-math {
  display: inline-block;
  text-align: left;
  line-height: 0;
  text-indent: 0;
  font-style: normal;
  font-weight: normal;
  font-size: 100%;
  font-size-adjust: none;
  letter-spacing: normal;
  word-wrap: normal;
  word-spacing: normal;
  white-space: nowrap;
  direction: ltr;
  padding: 1px 0;
}

mjx-container[jax="CHTML"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="CHTML"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="CHTML"][display="true"] mjx-math {
  padding: 0;
}

mjx-container[jax="CHTML"][justify="left"] {
  text-align: left;
}

mjx-container[jax="CHTML"][justify="right"] {
  text-align: right;
}

mjx-mrow {
  display: inline-block;
  text-align: left;
}

mjx-inferredMrow {
  display: inline-block;
  text-align: left;
}

mjx-mi {
  display: inline-block;
  text-align: left;
}

mjx-mo {
  display: inline-block;
  text-align: left;
}

mjx-stretchy-h {
  display: inline-table;
  width: 100%;
}

mjx-stretchy-h > * {
  display: table-cell;
  width: 0;
}

mjx-stretchy-h > * > mjx-c {
  display: inline-block;
  transform: scalex(1.0000001);
}

mjx-stretchy-h > * > mjx-c::before {
  display: inline-block;
  padding: .001em 0;
  width: initial;
}

mjx-stretchy-h > mjx-ext {
  overflow: hidden;
  width: 100%;
}

mjx-stretchy-h > mjx-ext > mjx-c::before {
  transform: scalex(500);
}

mjx-stretchy-h > mjx-ext > mjx-c {
  width: 0;
}

mjx-stretchy-h > mjx-beg > mjx-c {
  margin-right: -.1em;
}

mjx-stretchy-h > mjx-end > mjx-c {
  margin-left: -.1em;
}

mjx-stretchy-v {
  display: inline-block;
}

mjx-stretchy-v > * {
  display: block;
}

mjx-stretchy-v > mjx-beg {
  height: 0;
}

mjx-stretchy-v > mjx-end > mjx-c {
  display: block;
}

mjx-stretchy-v > * > mjx-c {
  transform: scaley(1.0000001);
  transform-origin: left center;
  overflow: hidden;
}

mjx-stretchy-v > mjx-ext {
  display: block;
  height: 100%;
  box-sizing: border-box;
  border: 0px solid transparent;
  overflow: hidden;
}

mjx-stretchy-v > mjx-ext > mjx-c::before {
  width: initial;
}

mjx-stretchy-v > mjx-ext > mjx-c {
  transform: scaleY(500) translateY(.1em);
  overflow: visible;
}

mjx-mark {
  display: inline-block;
  height: 0px;
}

mjx-mn {
  display: inline-block;
  text-align: left;
}

mjx-ms {
  display: inline-block;
  text-align: left;
}

mjx-mspace {
  display: inline-block;
  text-align: left;
}

mjx-mpadded {
  display: inline-block;
  text-align: left;
}

mjx-rbox {
  display: inline-block;
  position: relative;
}

mjx-menclose {
  display: inline-block;
  text-align: left;
  position: relative;
}

mjx-menclose > mjx-dstrike {
  display: inline-block;
  left: 0;
  top: 0;
  position: absolute;
  border-top: 0.067em solid;
  transform-origin: top left;
}

mjx-menclose > mjx-ustrike {
  display: inline-block;
  left: 0;
  bottom: 0;
  position: absolute;
  border-top: 0.067em solid;
  transform-origin: bottom left;
}

mjx-menclose > mjx-hstrike {
  border-top: 0.067em solid;
  position: absolute;
  left: 0;
  right: 0;
  bottom: 50%;
  transform: translateY(0.034em);
}

mjx-menclose > mjx-vstrike {
  border-left: 0.067em solid;
  position: absolute;
  top: 0;
  bottom: 0;
  right: 50%;
  transform: translateX(0.034em);
}

mjx-menclose > mjx-rbox {
  position: absolute;
  top: 0;
  bottom: 0;
  right: 0;
  left: 0;
  border: 0.067em solid;
  border-radius: 0.267em;
}

mjx-menclose > mjx-cbox {
  position: absolute;
  top: 0;
  bottom: 0;
  right: 0;
  left: 0;
  border: 0.067em solid;
  border-radius: 50%;
}

mjx-menclose > mjx-arrow {
  position: absolute;
  left: 0;
  bottom: 50%;
  height: 0;
  width: 0;
}

mjx-menclose > mjx-arrow > * {
  display: block;
  position: absolute;
  transform-origin: bottom;
  border-left: 0.268em solid;
  border-right: 0;
  box-sizing: border-box;
}

mjx-menclose > mjx-arrow > mjx-aline {
  left: 0;
  top: -0.034em;
  right: 0.201em;
  height: 0;
  border-top: 0.067em solid;
  border-left: 0;
}

mjx-menclose > mjx-arrow[double] > mjx-aline {
  left: 0.201em;
  height: 0;
}

mjx-menclose > mjx-arrow > mjx-rthead {
  transform: skewX(0.464rad);
  right: 0;
  bottom: -1px;
  border-bottom: 1px solid transparent;
  border-top: 0.134em solid transparent;
}

mjx-menclose > mjx-arrow > mjx-rbhead {
  transform: skewX(-0.464rad);
  transform-origin: top;
  right: 0;
  top: -1px;
  border-top: 1px solid transparent;
  border-bottom: 0.134em solid transparent;
}

mjx-menclose > mjx-arrow > mjx-lthead {
  transform: skewX(-0.464rad);
  left: 0;
  bottom: -1px;
  border-left: 0;
  border-right: 0.268em solid;
  border-bottom: 1px solid transparent;
  border-top: 0.134em solid transparent;
}

mjx-menclose > mjx-arrow > mjx-lbhead {
  transform: skewX(0.464rad);
  transform-origin: top;
  left: 0;
  top: -1px;
  border-left: 0;
  border-right: 0.268em solid;
  border-top: 1px solid transparent;
  border-bottom: 0.134em solid transparent;
}

mjx-menclose > dbox {
  position: absolute;
  top: 0;
  bottom: 0;
  left: -0.3em;
  width: 0.6em;
  border: 0.067em solid;
  border-radius: 50%;
  clip-path: inset(0 0 0 0.3em);
  box-sizing: border-box;
}

mjx-mfrac {
  display: inline-block;
  text-align: left;
}

mjx-frac {
  display: inline-block;
  vertical-align: 0.17em;
  padding: 0 .22em;
}

mjx-frac[type="d"] {
  vertical-align: .04em;
}

mjx-frac[delims] {
  padding: 0 .1em;
}

mjx-frac[atop] {
  padding: 0 .12em;
}

mjx-frac[atop][delims] {
  padding: 0;
}

mjx-dtable {
  display: inline-table;
  width: 100%;
}

mjx-dtable > * {
  font-size: 2000%;
}

mjx-dbox {
  display: block;
  font-size: 5%;
}

mjx-num {
  display: block;
  text-align: center;
}

mjx-den {
  display: block;
  text-align: center;
}

mjx-mfrac[bevelled] > mjx-num {
  display: inline-block;
}

mjx-mfrac[bevelled] > mjx-den {
  display: inline-block;
}

mjx-den[align="right"], mjx-num[align="right"] {
  text-align: right;
}

mjx-den[align="left"], mjx-num[align="left"] {
  text-align: left;
}

mjx-nstrut {
  display: inline-block;
  height: .054em;
  width: 0;
  vertical-align: -.054em;
}

mjx-nstrut[type="d"] {
  height: .217em;
  vertical-align: -.217em;
}

mjx-dstrut {
  display: inline-block;
  height: .505em;
  width: 0;
}

mjx-dstrut[type="d"] {
  height: .726em;
}

mjx-line {
  display: block;
  box-sizing: border-box;
  min-height: 1px;
  height: .06em;
  border-top: .06em solid;
  margin: .06em -.1em;
  overflow: hidden;
}

mjx-line[type="d"] {
  margin: .18em -.1em;
}

mjx-msqrt {
  display: inline-block;
  text-align: left;
}

mjx-root {
  display: inline-block;
  white-space: nowrap;
}

mjx-surd {
  display: inline-block;
  vertical-align: top;
}

mjx-sqrt {
  display: inline-block;
  padding-top: .07em;
}

mjx-sqrt > mjx-box {
  border-top: .07em solid;
}

mjx-sqrt.mjx-tall > mjx-box {
  padding-left: .3em;
  margin-left: -.3em;
}

mjx-mroot {
  display: inline-block;
  text-align: left;
}

mjx-msub {
  display: inline-block;
  text-align: left;
}

mjx-msup {
  display: inline-block;
  text-align: left;
}

mjx-msubsup {
  display: inline-block;
  text-align: left;
}

mjx-script {
  display: inline-block;
  padding-right: .05em;
}

mjx-script > * {
  display: block;
}

mjx-munder {
  display: inline-block;
  text-align: left;
}

mjx-over {
  text-align: left;
}

mjx-munder:not([limits="false"]) {
  display: inline-table;
}

mjx-munder > mjx-row {
  text-align: left;
}

mjx-under {
  padding-bottom: .1em;
}

mjx-mover {
  display: inline-block;
  text-align: left;
}

mjx-mover:not([limits="false"]) {
  padding-top: .1em;
}

mjx-mover:not([limits="false"]) > * {
  display: block;
  text-align: left;
}

mjx-munderover {
  display: inline-block;
  text-align: left;
}

mjx-munderover:not([limits="false"]) {
  padding-top: .1em;
}

mjx-munderover:not([limits="false"]) > * {
  display: block;
}

mjx-mmultiscripts {
  display: inline-block;
  text-align: left;
}

mjx-prescripts {
  display: inline-table;
  padding-left: .05em;
}

mjx-scripts {
  display: inline-table;
  padding-right: .05em;
}

mjx-prescripts > mjx-row > mjx-cell {
  text-align: right;
}

mjx-mfenced {
  display: inline-block;
  text-align: left;
}

mjx-mtable {
  display: inline-block;
  text-align: center;
  vertical-align: .25em;
  position: relative;
  box-sizing: border-box;
}

mjx-table {
  display: inline-block;
  vertical-align: -.5ex;
}

mjx-table > mjx-itable {
  vertical-align: middle;
  text-align: left;
  box-sizing: border-box;
}



mjx-mtable[justify="left"] {
  text-align: left;
}

mjx-mtable[justify="right"] {
  text-align: right;
}

mjx-mtable[justify="left"][side="left"] {
  padding-right: 0 ! important;
}

mjx-mtable[justify="left"][side="right"] {
  padding-left: 0 ! important;
}

mjx-mtable[justify="right"][side="left"] {
  padding-right: 0 ! important;
}

mjx-mtable[justify="right"][side="right"] {
  padding-left: 0 ! important;
}

mjx-mtable[align] {
  vertical-align: baseline;
}

mjx-mtable[align="top"] > mjx-table {
  vertical-align: top;
}

mjx-mtable[align="bottom"] > mjx-table {
  vertical-align: bottom;
}


mjx-mtr {
  display: table-row;
  text-align: left;
}

mjx-mtr[rowalign="top"] > mjx-mtd {
  vertical-align: top;
}

mjx-mtr[rowalign="center"] > mjx-mtd {
  vertical-align: middle;
}

mjx-mtr[rowalign="bottom"] > mjx-mtd {
  vertical-align: bottom;
}

mjx-mtr[rowalign="baseline"] > mjx-mtd {
  vertical-align: baseline;
}

mjx-mtr[rowalign="axis"] > mjx-mtd {
  vertical-align: .25em;
}

mjx-mlabeledtr {
  display: table-row;
  text-align: left;
}

mjx-mlabeledtr[rowalign="top"] > mjx-mtd {
  vertical-align: top;
}

mjx-mlabeledtr[rowalign="center"] > mjx-mtd {
  vertical-align: middle;
}

mjx-mlabeledtr[rowalign="bottom"] > mjx-mtd {
  vertical-align: bottom;
}

mjx-mlabeledtr[rowalign="baseline"] > mjx-mtd {
  vertical-align: baseline;
}

mjx-mlabeledtr[rowalign="axis"] > mjx-mtd {
  vertical-align: .25em;
}

mjx-mtd {
  display: table-cell;
  text-align: center;
  padding: .215em .4em;
}

mjx-mtd:first-child {
  padding-left: 0;
}

mjx-mtd:last-child {
  padding-right: 0;
}

mjx-mtable > * > mjx-itable > *:first-child > mjx-mtd {
  padding-top: 0;
}

mjx-mtable > * > mjx-itable > *:last-child > mjx-mtd {
  padding-bottom: 0;
}

mjx-tstrut {
  display: inline-block;
  height: 1em;
  vertical-align: -.25em;
}

mjx-labels[align="left"] > mjx-mtr > mjx-mtd {
  text-align: left;
}

mjx-labels[align="right"] > mjx-mtr > mjx-mtd {
  text-align: right;
}

mjx-mtr mjx-mtd[rowalign="top"], mjx-mlabeledtr mjx-mtd[rowalign="top"] {
  vertical-align: top;
}

mjx-mtr mjx-mtd[rowalign="center"], mjx-mlabeledtr mjx-mtd[rowalign="center"] {
  vertical-align: middle;
}

mjx-mtr mjx-mtd[rowalign="bottom"], mjx-mlabeledtr mjx-mtd[rowalign="bottom"] {
  vertical-align: bottom;
}

mjx-mtr mjx-mtd[rowalign="baseline"], mjx-mlabeledtr mjx-mtd[rowalign="baseline"] {
  vertical-align: baseline;
}

mjx-mtr mjx-mtd[rowalign="axis"], mjx-mlabeledtr mjx-mtd[rowalign="axis"] {
  vertical-align: .25em;
}

mjx-maction {
  display: inline-block;
  text-align: left;
  position: relative;
}

mjx-maction > mjx-tool {
  display: none;
  position: absolute;
  bottom: 0;
  right: 0;
  width: 0;
  height: 0;
  z-index: 500;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

mjx-maction[toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

mjx-mglyph {
  display: inline-block;
  text-align: left;
}

mjx-mglyph > img {
  display: inline-block;
  border: 0;
  padding: 0;
}

mjx-semantics {
  display: inline-block;
  text-align: left;
}

mjx-annotation {
  display: inline-block;
  text-align: left;
}

mjx-annotation-xml {
  display: inline-block;
  text-align: left;
  font-family: initial;
  line-height: normal;
}

mjx-TeXAtom {
  display: inline-block;
  text-align: left;
}

mjx-c {
  display: inline-block;
}

mjx-utext {
  display: inline-block;
  padding: .75em 0 .2em 0;
}

mjx-c::before {
  display: block;
  width: 0;
}

.MJX-TEX {
  font-family: MJXZERO, MJXTEX;
}

.TEX-B {
  font-family: MJXZERO, MJXTEX-B;
}

.TEX-I {
  font-family: MJXZERO, MJXTEX-I;
}

.TEX-MI {
  font-family: MJXZERO, MJXTEX-MI;
}

.TEX-BI {
  font-family: MJXZERO, MJXTEX-BI;
}

.TEX-S1 {
  font-family: MJXZERO, MJXTEX-S1;
}

.TEX-S2 {
  font-family: MJXZERO, MJXTEX-S2;
}

.TEX-S3 {
  font-family: MJXZERO, MJXTEX-S3;
}

.TEX-S4 {
  font-family: MJXZERO, MJXTEX-S4;
}

.TEX-A {
  font-family: MJXZERO, MJXTEX-A;
}

.TEX-C {
  font-family: MJXZERO, MJXTEX-C;
}

.TEX-CB {
  font-family: MJXZERO, MJXTEX-CB;
}

.TEX-FR {
  font-family: MJXZERO, MJXTEX-FR;
}

.TEX-FRB {
  font-family: MJXZERO, MJXTEX-FRB;
}

.TEX-SS {
  font-family: MJXZERO, MJXTEX-SS;
}

.TEX-SSB {
  font-family: MJXZERO, MJXTEX-SSB;
}

.TEX-SSI {
  font-family: MJXZERO, MJXTEX-SSI;
}

.TEX-SC {
  font-family: MJXZERO, MJXTEX-SC;
}

.TEX-T {
  font-family: MJXZERO, MJXTEX-T;
}

.TEX-V {
  font-family: MJXZERO, MJXTEX-V;
}

.TEX-VB {
  font-family: MJXZERO, MJXTEX-VB;
}

mjx-stretchy-v mjx-c, mjx-stretchy-h mjx-c {
  font-family: MJXZERO, MJXTEX-S1, MJXTEX-S4, MJXTEX, MJXTEX-A ! important;
}

@font-face /* 0 */ {
  font-family: MJXZERO;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Zero.woff") format("woff");
}

@font-face /* 1 */ {
  font-family: MJXTEX;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Main-Regular.woff") format("woff");
}

@font-face /* 2 */ {
  font-family: MJXTEX-B;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Main-Bold.woff") format("woff");
}

@font-face /* 3 */ {
  font-family: MJXTEX-I;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Math-Italic.woff") format("woff");
}

@font-face /* 4 */ {
  font-family: MJXTEX-MI;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Main-Italic.woff") format("woff");
}

@font-face /* 5 */ {
  font-family: MJXTEX-BI;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Math-BoldItalic.woff") format("woff");
}

@font-face /* 6 */ {
  font-family: MJXTEX-S1;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size1-Regular.woff") format("woff");
}

@font-face /* 7 */ {
  font-family: MJXTEX-S2;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size2-Regular.woff") format("woff");
}

@font-face /* 8 */ {
  font-family: MJXTEX-S3;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size3-Regular.woff") format("woff");
}

@font-face /* 9 */ {
  font-family: MJXTEX-S4;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size4-Regular.woff") format("woff");
}

@font-face /* 10 */ {
  font-family: MJXTEX-A;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_AMS-Regular.woff") format("woff");
}

@font-face /* 11 */ {
  font-family: MJXTEX-C;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Regular.woff") format("woff");
}

@font-face /* 12 */ {
  font-family: MJXTEX-CB;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Bold.woff") format("woff");
}

@font-face /* 13 */ {
  font-family: MJXTEX-FR;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Fraktur-Regular.woff") format("woff");
}

@font-face /* 14 */ {
  font-family: MJXTEX-FRB;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Fraktur-Bold.woff") format("woff");
}

@font-face /* 15 */ {
  font-family: MJXTEX-SS;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Regular.woff") format("woff");
}

@font-face /* 16 */ {
  font-family: MJXTEX-SSB;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Bold.woff") format("woff");
}

@font-face /* 17 */ {
  font-family: MJXTEX-SSI;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Italic.woff") format("woff");
}

@font-face /* 18 */ {
  font-family: MJXTEX-SC;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Script-Regular.woff") format("woff");
}

@font-face /* 19 */ {
  font-family: MJXTEX-T;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Typewriter-Regular.woff") format("woff");
}

@font-face /* 20 */ {
  font-family: MJXTEX-V;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Vector-Regular.woff") format("woff");
}

@font-face /* 21 */ {
  font-family: MJXTEX-VB;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Vector-Bold.woff") format("woff");
}

mjx-stretchy-v.mjx-c5B mjx-beg mjx-c::before {
  content: "\23A1";
  padding: 1.154em 0.667em 0.645em 0;
}

mjx-stretchy-v.mjx-c5B mjx-ext mjx-c::before {
  content: "\23A2";
}

mjx-stretchy-v.mjx-c5B mjx-end mjx-c::before {
  content: "\23A3";
  padding: 1.155em 0.667em 0.644em 0;
}

mjx-stretchy-v.mjx-c5B > mjx-end {
  margin-top: -1.799em;
}

mjx-stretchy-v.mjx-c5B > mjx-ext {
  border-top-width: 1.769em;
  border-bottom-width: 1.769em;
}

mjx-stretchy-v.mjx-c5D mjx-beg mjx-c::before {
  content: "\23A4";
  padding: 1.154em 0.667em 0.645em 0;
}

mjx-stretchy-v.mjx-c5D mjx-ext mjx-c::before {
  content: "\23A5";
}

mjx-stretchy-v.mjx-c5D mjx-end mjx-c::before {
  content: "\23A6";
  padding: 1.155em 0.667em 0.644em 0;
}

mjx-stretchy-v.mjx-c5D > mjx-end {
  margin-top: -1.799em;
}

mjx-stretchy-v.mjx-c5D > mjx-ext {
  border-top-width: 1.769em;
  border-bottom-width: 1.769em;
}

mjx-stretchy-v.mjx-c7B mjx-beg mjx-c::before {
  content: "\23A7";
  padding: 0.899em 0.889em 0.01em 0;
}

mjx-stretchy-v.mjx-c7B mjx-ext mjx-c::before {
  content: "\23AA";
}

mjx-stretchy-v.mjx-c7B mjx-end mjx-c::before {
  content: "\23A9";
  padding: 0.01em 0.889em 0.899em 0;
}

mjx-stretchy-v.mjx-c7B mjx-mid mjx-c::before {
  content: "\23A8";
  padding: 1.16em 0.889em 0.66em 0;
}

mjx-stretchy-v.mjx-c7B > mjx-mid {
  margin-top: -0.91em;
  margin-bottom: -0.91em;
}

mjx-stretchy-v.mjx-c7B > mjx-end {
  margin-top: -0.909em;
}

mjx-stretchy-v.mjx-c7B > mjx-ext {
  height: 50%;
  border-top-width: 0.879em;
  border-bottom-width: 0.879em;
}

mjx-c.mjx-c20::before {
  padding: 0 0.25em 0 0;
  content: " ";
}

mjx-c.mjx-c28::before {
  padding: 0.75em 0.389em 0.25em 0;
  content: "(";
}

mjx-c.mjx-c29::before {
  padding: 0.75em 0.389em 0.25em 0;
  content: ")";
}

mjx-c.mjx-c2B::before {
  padding: 0.583em 0.778em 0.082em 0;
  content: "+";
}

mjx-c.mjx-c2C::before {
  padding: 0.121em 0.278em 0.194em 0;
  content: ",";
}

mjx-c.mjx-c2E::before {
  padding: 0.12em 0.278em 0 0;
  content: ".";
}

mjx-c.mjx-c2F::before {
  padding: 0.75em 0.5em 0.25em 0;
  content: "/";
}

mjx-c.mjx-c30::before {
  padding: 0.666em 0.5em 0.022em 0;
  content: "0";
}

mjx-c.mjx-c31::before {
  padding: 0.666em 0.5em 0 0;
  content: "1";
}

mjx-c.mjx-c32::before {
  padding: 0.666em 0.5em 0 0;
  content: "2";
}

mjx-c.mjx-c33::before {
  padding: 0.665em 0.5em 0.022em 0;
  content: "3";
}

mjx-c.mjx-c34::before {
  padding: 0.677em 0.5em 0 0;
  content: "4";
}

mjx-c.mjx-c35::before {
  padding: 0.666em 0.5em 0.022em 0;
  content: "5";
}

mjx-c.mjx-c36::before {
  padding: 0.666em 0.5em 0.022em 0;
  content: "6";
}

mjx-c.mjx-c37::before {
  padding: 0.676em 0.5em 0.022em 0;
  content: "7";
}

mjx-c.mjx-c38::before {
  padding: 0.666em 0.5em 0.022em 0;
  content: "8";
}

mjx-c.mjx-c39::before {
  padding: 0.666em 0.5em 0.022em 0;
  content: "9";
}

mjx-c.mjx-c3A::before {
  padding: 0.43em 0.278em 0 0;
  content: ":";
}

mjx-c.mjx-c3C::before {
  padding: 0.54em 0.778em 0.04em 0;
  content: "<";
}

mjx-c.mjx-c3D::before {
  padding: 0.583em 0.778em 0.082em 0;
  content: "=";
}

mjx-c.mjx-c3E::before {
  padding: 0.54em 0.778em 0.04em 0;
  content: ">";
}

mjx-c.mjx-c42::before {
  padding: 0.683em 0.708em 0 0;
  content: "B";
}

mjx-c.mjx-c43::before {
  padding: 0.705em 0.722em 0.021em 0;
  content: "C";
}

mjx-c.mjx-c46::before {
  padding: 0.68em 0.653em 0 0;
  content: "F";
}

mjx-c.mjx-c4A::before {
  padding: 0.683em 0.514em 0.022em 0;
  content: "J";
}

mjx-c.mjx-c4C::before {
  padding: 0.683em 0.625em 0 0;
  content: "L";
}

mjx-c.mjx-c4E::before {
  padding: 0.683em 0.75em 0 0;
  content: "N";
}

mjx-c.mjx-c50::before {
  padding: 0.683em 0.681em 0 0;
  content: "P";
}

mjx-c.mjx-c52::before {
  padding: 0.683em 0.736em 0.022em 0;
  content: "R";
}

mjx-c.mjx-c54::before {
  padding: 0.677em 0.722em 0 0;
  content: "T";
}

mjx-c.mjx-c57::before {
  padding: 0.683em 1.028em 0.022em 0;
  content: "W";
}

mjx-c.mjx-c5B::before {
  padding: 0.75em 0.278em 0.25em 0;
  content: "[";
}

mjx-c.mjx-c5D::before {
  padding: 0.75em 0.278em 0.25em 0;
  content: "]";
}

mjx-c.mjx-c5E::before {
  padding: 0.694em 0.5em 0 0;
  content: "^";
}

mjx-c.mjx-c61::before {
  padding: 0.448em 0.5em 0.011em 0;
  content: "a";
}

mjx-c.mjx-c62::before {
  padding: 0.694em 0.556em 0.011em 0;
  content: "b";
}

mjx-c.mjx-c63::before {
  padding: 0.448em 0.444em 0.011em 0;
  content: "c";
}

mjx-c.mjx-c64::before {
  padding: 0.694em 0.556em 0.011em 0;
  content: "d";
}

mjx-c.mjx-c65::before {
  padding: 0.448em 0.444em 0.011em 0;
  content: "e";
}

mjx-c.mjx-c66::before {
  padding: 0.705em 0.372em 0 0;
  content: "f";
}

[noIC] mjx-c.mjx-c66:last-child::before {
  padding-right: 0.306em;
}

mjx-c.mjx-c67::before {
  padding: 0.453em 0.5em 0.206em 0;
  content: "g";
}

mjx-c.mjx-c68::before {
  padding: 0.694em 0.556em 0 0;
  content: "h";
}

mjx-c.mjx-c69::before {
  padding: 0.669em 0.278em 0 0;
  content: "i";
}

mjx-c.mjx-c6C::before {
  padding: 0.694em 0.278em 0 0;
  content: "l";
}

mjx-c.mjx-c6D::before {
  padding: 0.442em 0.833em 0 0;
  content: "m";
}

mjx-c.mjx-c6E::before {
  padding: 0.442em 0.556em 0 0;
  content: "n";
}

mjx-c.mjx-c6F::before {
  padding: 0.448em 0.5em 0.01em 0;
  content: "o";
}

mjx-c.mjx-c70::before {
  padding: 0.442em 0.556em 0.194em 0;
  content: "p";
}

mjx-c.mjx-c72::before {
  padding: 0.442em 0.392em 0 0;
  content: "r";
}

mjx-c.mjx-c73::before {
  padding: 0.448em 0.394em 0.011em 0;
  content: "s";
}

mjx-c.mjx-c74::before {
  padding: 0.615em 0.389em 0.01em 0;
  content: "t";
}

mjx-c.mjx-c75::before {
  padding: 0.442em 0.556em 0.011em 0;
  content: "u";
}

mjx-c.mjx-c76::before {
  padding: 0.431em 0.528em 0.011em 0;
  content: "v";
}

mjx-c.mjx-c77::before {
  padding: 0.431em 0.722em 0.011em 0;
  content: "w";
}

mjx-c.mjx-c78::before {
  padding: 0.431em 0.528em 0 0;
  content: "x";
}

mjx-c.mjx-c79::before {
  padding: 0.431em 0.528em 0.204em 0;
  content: "y";
}

mjx-c.mjx-c7A::before {
  padding: 0.431em 0.444em 0 0;
  content: "z";
}

mjx-c.mjx-c7B::before {
  padding: 0.75em 0.5em 0.25em 0;
  content: "{";
}

mjx-c.mjx-c7D::before {
  padding: 0.75em 0.5em 0.25em 0;
  content: "}";
}

mjx-c.mjx-cA0::before {
  padding: 0 0.25em 0 0;
  content: "\A0";
}

mjx-c.mjx-cD7::before {
  padding: 0.491em 0.778em 0 0;
  content: "\D7";
}

mjx-c.mjx-c3A9::before {
  padding: 0.704em 0.722em 0 0;
  content: "\3A9";
}

mjx-c.mjx-c2061::before {
  padding: 0 0 0 0;
  content: "";
}

mjx-c.mjx-c2192::before {
  padding: 0.511em 1em 0.011em 0;
  content: "\2192";
}

mjx-c.mjx-c2212::before {
  padding: 0.583em 0.778em 0.082em 0;
  content: "\2212";
}

mjx-c.mjx-c2225::before {
  padding: 0.75em 0.5em 0.25em 0;
  content: "\2225";
}

mjx-c.mjx-c2264::before {
  padding: 0.636em 0.778em 0.138em 0;
  content: "\2264";
}

mjx-c.mjx-c2265::before {
  padding: 0.636em 0.778em 0.138em 0;
  content: "\2265";
}

mjx-c.mjx-c2297::before {
  padding: 0.583em 0.778em 0.083em 0;
  content: "\2297";
}

mjx-c.mjx-c22C5::before {
  padding: 0.31em 0.278em 0 0;
  content: "\22C5";
}

mjx-c.mjx-c27F9::before {
  padding: 0.525em 1.638em 0.024em 0;
  content: "\27F9";
}

mjx-c.mjx-c1D40C.TEX-B::before {
  padding: 0.686em 1.092em 0 0;
  content: "M";
}

mjx-c.mjx-c1D41C.TEX-B::before {
  padding: 0.453em 0.511em 0.006em 0;
  content: "c";
}

mjx-c.mjx-c1D41E.TEX-B::before {
  padding: 0.452em 0.527em 0.006em 0;
  content: "e";
}

mjx-c.mjx-c1D420.TEX-B::before {
  padding: 0.455em 0.575em 0.201em 0;
  content: "g";
}

mjx-c.mjx-c1D421.TEX-B::before {
  padding: 0.694em 0.639em 0 0;
  content: "h";
}

mjx-c.mjx-c1D425.TEX-B::before {
  padding: 0.694em 0.319em 0 0;
  content: "l";
}

mjx-c.mjx-c1D426.TEX-B::before {
  padding: 0.45em 0.958em 0 0;
  content: "m";
}

mjx-c.mjx-c1D427.TEX-B::before {
  padding: 0.45em 0.639em 0 0;
  content: "n";
}

mjx-c.mjx-c1D429.TEX-B::before {
  padding: 0.45em 0.639em 0.194em 0;
  content: "p";
}

mjx-c.mjx-c1D42A.TEX-B::before {
  padding: 0.45em 0.607em 0.194em 0;
  content: "q";
}

mjx-c.mjx-c1D42B.TEX-B::before {
  padding: 0.45em 0.474em 0 0;
  content: "r";
}

mjx-c.mjx-c1D42C.TEX-B::before {
  padding: 0.453em 0.454em 0.006em 0;
  content: "s";
}

mjx-c.mjx-c1D42E.TEX-B::before {
  padding: 0.45em 0.639em 0.006em 0;
  content: "u";
}

mjx-c.mjx-c1D42F.TEX-B::before {
  padding: 0.444em 0.607em 0 0;
  content: "v";
}

mjx-c.mjx-c1D431.TEX-B::before {
  padding: 0.444em 0.607em 0 0;
  content: "x";
}

mjx-c.mjx-c1D438.TEX-I::before {
  padding: 0.68em 0.764em 0 0;
  content: "E";
}

[noIC] mjx-c.mjx-c1D438.TEX-I:last-child::before {
  padding-right: 0.738em;
}

mjx-c.mjx-c1D43B.TEX-I::before {
  padding: 0.683em 0.888em 0 0;
  content: "H";
}

[noIC] mjx-c.mjx-c1D43B.TEX-I:last-child::before {
  padding-right: 0.831em;
}

mjx-c.mjx-c1D43F.TEX-I::before {
  padding: 0.683em 0.681em 0 0;
  content: "L";
}

mjx-c.mjx-c1D441.TEX-I::before {
  padding: 0.683em 0.888em 0 0;
  content: "N";
}

[noIC] mjx-c.mjx-c1D441.TEX-I:last-child::before {
  padding-right: 0.803em;
}

mjx-c.mjx-c1D445.TEX-I::before {
  padding: 0.683em 0.759em 0.021em 0;
  content: "R";
}

mjx-c.mjx-c1D451.TEX-I::before {
  padding: 0.694em 0.52em 0.01em 0;
  content: "d";
}

mjx-c.mjx-c1D453.TEX-I::before {
  padding: 0.705em 0.55em 0.205em 0;
  content: "f";
}

[noIC] mjx-c.mjx-c1D453.TEX-I:last-child::before {
  padding-right: 0.49em;
}

mjx-c.mjx-c1D456.TEX-I::before {
  padding: 0.661em 0.345em 0.011em 0;
  content: "i";
}

mjx-c.mjx-c1D457.TEX-I::before {
  padding: 0.661em 0.412em 0.204em 0;
  content: "j";
}

mjx-c.mjx-c1D45A.TEX-I::before {
  padding: 0.442em 0.878em 0.011em 0;
  content: "m";
}

mjx-c.mjx-c1D45B.TEX-I::before {
  padding: 0.442em 0.6em 0.011em 0;
  content: "n";
}

mjx-c.mjx-c1D460.TEX-I::before {
  padding: 0.442em 0.469em 0.01em 0;
  content: "s";
}

mjx-c.mjx-c1D461.TEX-I::before {
  padding: 0.626em 0.361em 0.011em 0;
  content: "t";
}

mjx-c.mjx-c1D462.TEX-I::before {
  padding: 0.442em 0.572em 0.011em 0;
  content: "u";
}

mjx-c.mjx-c1D463.TEX-I::before {
  padding: 0.443em 0.485em 0.011em 0;
  content: "v";
}

mjx-c.mjx-c1D464.TEX-I::before {
  padding: 0.443em 0.716em 0.011em 0;
  content: "w";
}

mjx-c.mjx-c1D465.TEX-I::before {
  padding: 0.442em 0.572em 0.011em 0;
  content: "x";
}

mjx-c.mjx-c1D466.TEX-I::before {
  padding: 0.442em 0.49em 0.205em 0;
  content: "y";
}

mjx-c.mjx-c1D467.TEX-I::before {
  padding: 0.442em 0.465em 0.011em 0;
  content: "z";
}

mjx-c.mjx-c1D498.TEX-BI::before {
  padding: 0.453em 0.831em 0.008em 0;
  content: "w";
}

mjx-c.mjx-c1D49B.TEX-BI::before {
  padding: 0.452em 0.555em 0.008em 0;
  content: "z";
}

mjx-c.mjx-c1D6FC.TEX-I::before {
  padding: 0.442em 0.64em 0.011em 0;
  content: "\3B1";
}

mjx-c.mjx-c1D703.TEX-I::before {
  padding: 0.705em 0.469em 0.01em 0;
  content: "\3B8";
}

mjx-c.mjx-c1D706.TEX-I::before {
  padding: 0.694em 0.583em 0.012em 0;
  content: "\3BB";
}

mjx-c.mjx-c1D70B.TEX-I::before {
  padding: 0.431em 0.57em 0.011em 0;
  content: "\3C0";
}

mjx-c.mjx-c1D714.TEX-I::before {
  padding: 0.443em 0.622em 0.011em 0;
  content: "\3C9";
}

mjx-c.mjx-c1D7CE.TEX-B::before {
  padding: 0.654em 0.575em 0.01em 0;
  content: "0";
}

mjx-c.mjx-c3D.TEX-B::before {
  padding: 0.393em 0.894em 0 0;
  content: "=";
}

mjx-c.mjx-c2212.TEX-B::before {
  padding: 0.281em 0.894em 0 0;
  content: "\2212";
}

mjx-c.mjx-c5B.TEX-S1::before {
  padding: 0.85em 0.417em 0.349em 0;
  content: "[";
}

mjx-c.mjx-c5D.TEX-S1::before {
  padding: 0.85em 0.417em 0.349em 0;
  content: "]";
}

mjx-c.mjx-c2211.TEX-S1::before {
  padding: 0.75em 1.056em 0.25em 0;
  content: "\2211";
}

mjx-c.mjx-c222B.TEX-S1::before {
  padding: 0.805em 0.61em 0.306em 0;
  content: "\222B";
}

[noIC] mjx-c.mjx-c222B.TEX-S1:last-child::before {
  padding-right: 0.472em;
}

mjx-c.mjx-c2211.TEX-S2::before {
  padding: 0.95em 1.444em 0.45em 0;
  content: "\2211";
}

mjx-c.mjx-c222B.TEX-S2::before {
  padding: 1.36em 0.944em 0.862em 0;
  content: "\222B";
}

[noIC] mjx-c.mjx-c222B.TEX-S2:last-child::before {
  padding-right: 0.556em;
}

mjx-c.mjx-c28.TEX-S3::before {
  padding: 1.45em 0.736em 0.949em 0;
  content: "(";
}

mjx-c.mjx-c29.TEX-S3::before {
  padding: 1.45em 0.736em 0.949em 0;
  content: ")";
}

mjx-c.mjx-c5B.TEX-S3::before {
  padding: 1.45em 0.528em 0.949em 0;
  content: "[";
}

mjx-c.mjx-c5D.TEX-S3::before {
  padding: 1.45em 0.528em 0.949em 0;
  content: "]";
}

mjx-c.mjx-c5B.TEX-S4::before {
  padding: 1.75em 0.583em 1.249em 0;
  content: "[";
}

mjx-c.mjx-c5D.TEX-S4::before {
  padding: 1.75em 0.583em 1.249em 0;
  content: "]";
}
</style></head><body id="body">
<script>
    var body = document.getElementById('body');
    var lightmode = ( parseInt( window.localStorage && window.localStorage.getItem( 'lightMode' ) ) ) ? 1 : 0;
    if ( lightmode )
        body.classList.add( "LightMode" );
</script>
<div id="BodyContainer">
<div id="LeftColumn"></div>
<div id="MainColumn">
<header class="NavBar">
<div class="NavPrevChapter"><a class="NavChapterNum" href="geomprims.html">&lt;&lt; Geometric Primitives</a>
</div><div class="NavContents"><a href="./">Contents</a></div><div class="NavNextChapter">
<a class="NavChapterNum" href="kinematics_calculus.html">Mechanics 1: Linear Kinematics and Calculus &gt;&gt;
</a></div>
</header>
<div class="ChapterTitleSection">
    <div class="ChapterNumber">Chapter 10
<img style="float:right; width:1em; height:1em" id="lightmodetoggle" src="../light_dark_toggle.png">
</div>
<script>
    document.getElementById('lightmodetoggle').onclick = function() {
        lightmode = lightmode ? 0 : 1;
        if ( lightmode )
            body.classList.add( "LightMode" );
        else
            body.classList.remove( "LightMode" );
        if ( window.localStorage )
            window.localStorage.setItem( 'lightMode', lightmode )
    }
</script>
<div class="ChapterTitle">Mathematical Topics<br>from 3D Graphics</div>
<div class="ChapterQuotes">
<div class="WittyQuotation">
            I don't think there's anything wrong with pretty graphics.
<div class="QuotationSource">&#8212;&#160;Shigeru Miyamoto (1952&#8211;)</div>
</div>
</div>
</div>
<p class="NoIndent">
This chapter discusses a number of mathematical issues that arise when creating 3D graphics on a
computer.  Of course, we cannot hope to cover the vast subject of computer graphics in any amount
of detail in a single chapter.  Entire books are written that merely survey the topic. This
chapter is to graphics what this entire book is to interactive 3D applications: it presents an
extremely brief and high level overview of the subject matter, focusing on topics for which
mathematics plays a critical role.  Just like the rest of this book, we try to pay special
attention to those topics that, from our experience, are glossed over in other sources or are a
source of confusion in beginners.
</p>
<p>To be a bit more direct: this chapter alone is not enough to teach you how to get some pretty
pictures on the screen.  However, it should be used parallel with (or preceding!) some other
course, book, or self-study on graphics, and we hope that it will help you breeze past a few
traditional sticky points. Although we present some example snippets in High Level Shading
Language (HLSL) at the end of this chapter, you will not find much else to help you figure out
which DirectX or OpenGL function calls to make to achieve some desired effect. These issues are
certainly of supreme practical importance, but alas, they are also in the category of knowledge
that
    Robert Maynard Hutchins dubbed &#8220;rapidly aging facts,&#8221; and we have tried to avoid writing a
book that requires an update every other year when ATI releases a new card or Microsoft a new
version of DirectX. Luckily, up-to-date API references and examples abound on the Internet, which
is a much more appropriate place to get that sort of thing.  (API stands for application
programming interface.  In this chapter, API will mean the software that we use to communicate
with the rendering subsystem.)
</p>
<p>
One final caveat is that since this is a book on math for video games, we will have a real-time
bias. This is not to say that the book cannot be used if you are interested in learning how to
write a raytracer; only that our expertise and focus is in real-time graphics.
</p>
<p>
This chapter proceeds roughly in order from ivory tower theory to down-and-dirty code snippets.
</p>
<ul>
    <li>
<a href="#how_graphics_works">Section&#160;10.1</a> gives a very high-level (and high-brow)
        theoretical approach to graphics, culminating in the <i>rendering equation</i>.
</li>
<li>
We then lower our brows somewhat to focus attention on matters of more direct practical
        application, while still maintaining our platform independence and attempt to be relevant ten
        years from now.
<ul>
            <li>
<a href="#viewing_in_3d">Section&#160;10.2</a> discusses some basic mathematics related to <i>viewing</i>
                in 3D.
</li>
<li>
<a href="#coordinate_spaces">Section&#160;10.3</a> introduces some important coordinate
                spaces and transformations.
</li>
<li>
<a href="#polygon_meshes">Section&#160;10.4</a> looks at how to represent the surfaces of the geometry in our
                scene using a <i>polygon mesh</i>.
</li>
<li>
<a href="#texture_mapping">Section&#160;10.5</a> shows how to control material properties (such as the
                &#8220;color&#8221; of the object) using <i>texture maps</i>.
</li>
</ul>
</li>
<li>
The next sections are about lighting.
<ul>
            <li>
<a href="#standard_local_lighting_model">Section&#160;10.6</a> defines the ubiquitous <i>Blinn-Phong
                lighting model</i>.
</li>
<li>
<a href="#light_sources">Section&#160;10.7</a> discusses some common methods for representing light
                sources.
</li>
</ul>
</li>
<li>
With a little nudge further away from timeless theory, the next sections discuss
        two issues of particular contemporary interest.
<ul>
            <li>
<a href="#skeletal_animation">Section&#160;10.8</a> is about <i>skeletal animation</i>.
</li>
<li>
<a href="#bump_mapping">Section&#160;10.9</a> tells how <i>bump mapping</i> works.
</li>
</ul>
</li>
<li>
The last third of this chapter is the most in danger of becoming irrelevant in
        coming years, because it is the most immediately practical.
<ul>
        <li>
<a href="#realtime_graphics_pipeline">Section&#160;10.10</a> gives an overview of a simple real-time
            graphics pipeline, and then descends that pipeline and talks about some mathematical issues along
            the way.
</li>
<li>
<a href="#hlsl_examples">Section&#160;10.11</a> concludes the chapter squarely in the &#8220;rapidly aging facts&#8221;
            territory with several HLSL examples demonstrating some of the techniques covered earlier.
</li>
</ul>
</li>
</ul>

<h1 id="how_graphics_works"><span class="SectionNumber">10.1</span><span class="SectionTitle">How Graphics Works</span></h1>
<p class="NoIndent">
We begin our discussion of graphics by telling you how things <i>really</i> work, or perhaps more
accurately, how they really <i>should</i> work, if we had enough knowledge and processing power
to make things work the right way. The beginner student is to be warned that much introductory
material (especially tutorials on the Internet) and API documentation suffers from a great lack
of perspective. You might get the impression from reading these sources that diffuse maps,
Blinn-Phong shading, and ambient occlusion are &#8220;The way images in the real world work,&#8221; when in
fact you are probably reading a description of how one particular lighting model was implemented
in one particular language on one particular piece of hardware through one particular API.
Ultimately, any down-to-the-details tutorial must choose a lighting model, language, platform,
color representation, performance goals, etc.&#8212;as we will have to do later in this chapter.
(This lack of perspective is usually purposeful and warranted.) However, we think it's important
to know which are the fundamental and timeless principles, and which are arbitrary choices based
on approximations and trade-offs, guided by technological limitations that might by applicable
only to real-time rendering, or are likely to change in the near future. So before we get too far
into the details of the particular type of rendering most useful for introductory real-time
graphics, we want to take our stab at describing how rendering <i>really</i> works.
</p>
<p>
We also hasten to add that this discussion assumes that the goal is photorealism, simulating how
things work in nature.  In fact, this is often not the goal, and it certainly is never the only
goal. Understanding how nature works is a very important starting place, but artistic and
practical factors often dictate a different strategy than just simulating nature.
</p>
<h2 id="rendering_algorithms"><span class="SectionNumber">10.1.1</span><span class="SectionTitle">The Two Major Approaches to Rendering</span></h2>
<p class="NoIndent">We begin with the end in mind.  The end goal of rendering is a bitmap, or perhaps a sequence of
bitmaps if we are producing an animation.  You almost certainly already know that a bitmap is a
rectangular array of colors, and each grid entry is known as
    <i>pixel</i>, which is short for
&#8220;picture element.&#8221; At the time we are producing the image, this bitmap is also known as the
    <i>frame buffer</i>, and often there is additional post-processing or conversion that happens
when we copy the frame buffer to the final bitmap output.
</p>
<p>
<i>How do we determine the color of each pixel?</i>  That is the fundamental question of rendering.
Like so many challenges in computer science, a great place to start is by investigating how nature
works.
</p>
<p>
We see light.  The image that we perceive is the result of light that bounces around the
environment and finally enters the eye. This process is complicated, to say the least.  Not only
is the physics<a href="#footnote_1" class="FootnoteRef">1</a> of the light bouncing around very complicated, but so are
the physiology of the sensing equipment in our eyes<a href="#footnote_2" class="FootnoteRef">2</a> and the interpreting mechanisms in our minds. Thus, ignoring a great number of details
and variations (as any introductory book must do), the basic question that any rendering system
must answer for each pixel is &#8220;What color of light is approaching the camera from the direction
corresponding to this pixel?&#8221;
</p>
<p>
There are basically two cases to consider.  Either we are looking directly at a light source and
light traveled directly from the light source to our eye, or (more commonly) light departed from
a light source in some other direction, bounced one or more times, and then entered our eye. We
can decompose the key question asked previously into two tasks.  This book calls these two tasks
    <i>the rendering algorithm</i>, although these two highly abstracted procedures obviously conceal
a great deal of complexity about the actual algorithms used in practice to implement it.
</p>
<span class="InMarginAnchor"><span class="InMargin"><span class="EqMarginCaption">The rendering algorithm</span></span></span><ul>
    <li>
<span class="ListItemTitle">Visible surface determination.</span>  Find the surface that is closest to the
        eye, in the direction corresponding to the current pixel.
</li>
<li>
<span class="ListItemTitle">Lighting.</span>  Determine what light is emitted and/or reflected off this
        surface in the direction of the eye.
</li>
</ul>
<p>
At this point it appears that we have made some gross simplifications, and many of you no doubt
are raising your metaphorical hands to ask &#8220;What about translucency?&#8221; &#8220;What about
reflections?&#8221; &#8220;What about refraction?&#8221; &#8220;What about atmospheric effects?&#8221;  Please hold all
questions until the end of the presentation.
</p>
<p>The first step in the rendering algorithm is known as <i>visible surface determination</i>. There
are two common solutions to this problem.  The first is known as
    <i>raytracing</i>.  Rather than following light rays in the direction that they travel from the
emissive surfaces, we trace the rays backward, so that we can deal only with the light rays that
matter: the ones that enter our eye from the given direction. We send a ray out from the eye in
the direction through the center of each pixel<a href="#footnote_3" class="FootnoteRef">3</a> to see the first object in
the scene this ray strikes. Then we compute the color that is being emitted or reflected from
that surface back in the direction of the ray.  A highly simplified summary of this algorithm is
illustrated by <a href="#raytracer_pseudocode">Listing&#160;10.1</a>.
</p>
<p>
<div class="Wide Display Listing">
<pre>
for (each x,y screen pixel) {

    // Select a ray for this pixel
    Ray ray = getRayForPixel(x,y);

    // Intersect the ray against the geometry.  This will
    // not just return the point of intersection, but also
    // a surface normal and some other information needed
    // to shade the point, such as an object reference,
    // material information, local S,T coordinates, etc.
    // Don't take this pseudocode too literally.
    Vector3 pos, normal;
    Object *obj; Material *mtl;
    if (rayIntersectScene(ray, pos, normal, obj, mtl)) {

        // Shade the intersection point.  (What light is
        // emitted/reflected from this point towards the camera?)
        Color c = shadePoint(ray, pos, normal, obj, mtl);

        // Put it into the frame buffer
        writeFrameBuffer(x,y, c);

    } else {

        // Ray missed the entire scene.  Just use a generic
        // background color at this pixel
        writeFrameBuffer(x,y, backgroundColor);
    }
}
</pre>
</div>
</p>
<p>The other major strategy for visible surface determination, the one used for real-time rendering at
the time of this writing, is known as <i>depth buffering</i>.  The basic plan is that at each pixel
we store not only a color value, but also a depth value.  This depth buffer value records the
distance from the eye to the surface that is reflecting or emitting the light used to determine the
color for that pixel.  As illustrated in <a href="#raytracer_pseudocode">Listing&#160;10.1</a>, the &#8220;outer loop&#8221; of a
raytracer is the screen-space pixels, but in real-time graphics, the &#8220;outer loop&#8221; is the
geometric elements that make up the surface of the scene.
</p>
<p>
The different methods for describing surfaces are not important here.  What <i>is</i> important
is that we can project the surface onto screen-space and map them to screen-space pixels through
a process known as
    <i>rasterization</i>. For each pixel of the surface, known as the
    <i>source fragment</i>, we compute the depth of the surface at that pixel and compare it to the
existing value in the depth buffer, sometimes known as the
    <i>destination fragment</i>. If the source fragment we are currently rendering is farther away
from the camera than the existing value in the buffer, then whatever we rendered before this is
obscuring the surface we are now rendering (at least at this one pixel), and we move on to the
next pixel. However, if our depth value is closer than the existing value in the depth buffer,
then we know this is the closest surface to the eye (at least of those rendered so far) and so we
update the depth buffer with this new, closer depth value. At this point we might also proceed to
step 2 of the rendering algorithm (at least for this pixel) and update the frame buffer with the
color of the light being emitted or reflected from the surface that point. This is known
as
    <i>forward rendering</i>, and the basic idea is illustrated by
<a href="#forward_renderer_pseudocode">Listing&#160;10.2</a>.
</p>
<p>
<div class="Wide Display Listing">
<pre>
// Clear the frame and depth buffers
fillFrameBuffer(backgroundColor);
fillDepthBuffer(infinity);

// Outer loop iterates over all the primitives (usually triangles)
for (each geometric primitive) {

    // Rasterize the primitive
    for (each pixel x,y in the projection of the primitive) {

        // Test the depth buffer, to see if a closer pixel has
        // already been written.
        float primDepth = getDepthOfPrimitiveAtPixel(x,y);
        if (primDepth &gt; readDepthBuffer(x,y)) {

            // Pixel of this primitive is obscured, discard it
            continue;
        }

        // Determine primitive color at this pixel.
        Color c = getColorOfPrimitiveAtPixel(x,y);

        // Update the color and depth buffers
        writeFrameBuffer(x,y, c);
        writeDepthBuffer(x,y, primDepth);
    }
}
</pre>
</div>
</p>
<p>Opposed to forward rendering is <i>deferred rendering</i>, an old technique that is becoming
popular again due to the current location of bottlenecks in the types of images we are producing
and the hardware we are using to produce them. A deferred renderer uses, in addition to the frame
buffer and the depth buffer, additional buffers, collectively known as the
    <i>G-buffer</i> (short for &#8220;geometry&#8221; buffer), which holds extra information about the surface
closest to the eye at that location, such as the 3D location of the surface, the surface normal,
and material properties needed for lighting calculations, such as the &#8220;color&#8221; of the object and
how &#8220;shiny&#8221; it is at that particular location. (Later, we see how those intuitive terms in
quotes are a bit too vague for rendering purposes.) Compared to a forward renderer, a deferred
renderer follows our two-step rendering algorithm a bit more literally.  First we &#8220;render&#8221; the
scene into the G-buffer, essentially performing only visibility determination&#8212;fetching the
material properties of the point that is &#8220;seen&#8221; by each pixel but not yet performing lighting
calculations.  The second pass actually performs the lighting calculations.
<a href="#deferred_renderer_pseudocode">Listing&#160;10.3</a> explains deferred rendering in pseudocode.
</p>
<p>
<div class="Wide Display Listing">
<pre>
// Clear the geometry and depth buffers
clearGeometryBuffer();
fillDepthBuffer(infinity);

// Rasterize all primitives into the G-buffer
for (each geometric primitive) {
    for (each pixel x,y in the projection of the primitive) {

        // Test the depth buffer, to see if a closer pixel has
        // already been written.
        float primDepth = getDepthOfPrimitiveAtPixel(x,y);
        if (primDepth &gt; readDepthBuffer(x,y)) {

            // Pixel of this primitive is obscured, discard it
            continue;
        }

        // Fetch information needed for shading in the next pass.
        MaterialInfo mtlInfo;
        Vector3 pos, normal;
        getPrimitiveShadingInfo(mtlInfo, pos, normal);

        // Save it off into the G-buffer and depth buffer
        writeGeometryBuffer(x,y, mtlInfo, pos, normal);
        writeDepthBuffer(x,y, primDepth);
    }
}

// Now perform shading in a 2nd pass, in screen space
for (each x,y screen pixel) {
    if (readDepthBuffer(x,y) == infinity) {

        // No geometry here.  Just write a background color
        writeFrameBuffer(x,y, backgroundColor);

    } else {

        // Fetch shading info back from the geometry buffer
        MaterialInfo mtlInfo;
        Vector3 pos, normal;
        readGeometryBuffer(x,y, mtlInfo, pos, normal);

        // Shade the point
        Color c = shadePoint(pos, normal, mtlInfo);

        // Put it into the frame buffer
        writeFrameBuffer(x,y, c);
    }
}
</pre>
<span class="Caption"><span class="CaptionText">Pseudocode for deferred rendering using the depth buffer</span>
</span>
</div>
</p>
<p>Before moving on, we must mention one important point about why deferred rendering is popular.
When multiple light sources illuminate the same surface point, hardware limitations or
performance factors may prevent us from computing the final color of a pixel in a single
calculation, as was shown in the pseudocode listings for both forward and deferred rendering.
Instead, we must using multiple passes, one pass for each light, and <i>accumulate</i> the
reflected light from each light source into the frame buffer.  In forward rendering, these extra
passes involve rerendering the primitives.  Under deferred rendering, however, extra passes are
in image space, and thus depend on the 2D size of the light in screen space, not on the
complexity of the scene! It is in this situation that deferred rendering really begins to have
large performance advantages over forward rendering.
</p>
<h2 id="brdf"><span class="SectionNumber">10.1.2</span><span class="SectionTitle">Describing Surface Properties: The BRDF</span></h2>
<p class="NoIndent">Now let's talk about the second step in the rendering algorithm: lighting.  Once we have
located the surface closest to the eye, we must determine the amount of light emitted directly
from that surface, or emitted from some other source and reflected off the surface in the direction of
the eye.  The light directly transmitted from a surface to the eye&#8212;for example, when looking
directly at a light bulb or the sun&#8212;is the simplest case. These
    <i>emissive</i> surfaces are a
small minority in most scenes; most surfaces do not emit their own light, but rather they only
reflect light that was emitted from somewhere else.  We will focus the bulk of our attention on
the nonemissive surfaces.
</p>
<p>
Although we often speak informally about the &#8220;color&#8221; of an object, we know that the perceived
color of an object is actually the light that is entering our eye, and thus can depend on many
different factors.  Important questions to ask are: What colors of light are incident on the
surface, and from what directions? From which direction are we viewing the surface? How &#8220;shiny&#8221;
is the object?<a href="#footnote_4" class="FootnoteRef">4</a>
So a description of a surface suitable for use in rendering doesn't answer the question &#8220;What
color is this surface?&#8221;  This question is sometimes meaningless&#8212;what color is a mirror, for
example? Instead, the salient question is a bit more complicated, and it goes something like,
&#8220;When light of a given color strikes the surface from a given incident direction, how much of
that light is reflected in some other particular direction?&#8221;  The answer to this question is
given by the <i>bidirectional reflectance distribution function</i>, or BRDF for short. So rather
than &#8220;What color is the object?&#8221; we ask, &#8220;What is the distribution of reflected light?&#8221;
</p>
<p>
Symbolically, we write the BRDF as the function <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D706 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline">
<math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo>
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow><mo>,</mo><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</msub><mo>,</mo><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub><mo>,</mo><mi>&#955;</mi><mo stretchy="false">)</mo></math>
</mjx-assistive-mml>
</mjx-container>.<a href="#footnote_5" class="FootnoteRef">5</a> The value of this function is a
scalar that describes the relatively likelihood that light incident at the point <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline">
<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow></math>
</mjx-assistive-mml>
</mjx-container>
from direction <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline">
<math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</msub></math>
</mjx-assistive-mml>
</mjx-container> will be reflected in the outgoing direction
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline">
<math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub></math>
</mjx-assistive-mml>
</mjx-container> rather than some other outgoing direction.  As indicated by
the boldface type and hat, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline">
<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
</math>
</mjx-assistive-mml>
</mjx-container> might be a unit vector, but more generally it
can be any way of specifying a direction; polar angles are another obvious choice and are
commonly used. Different colors of light are usually reflected differently; hence the dependence
on <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D706 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline">
<math xmlns="http://www.w3.org/1998/Math/MathML"><mi>&#955;</mi></math>
</mjx-assistive-mml>
</mjx-container>, which is the color (actually, the wavelength) of the light.
</p>
<p>
Although we are particularly interested in the incident directions that come from emissive
surfaces and the outgoing directions that point towards our eye, in general, the entire
distribution is relevant. First of all, lights, eyes, and surfaces can move around, so in the
context of creating a surface description (for example, &#8220;red leather&#8221;), we don't know which
directions will be important.  But even in a particular scene with all the surfaces, lights, and
eyes fixed, light can bounce around multiple times, so we need to measure light reflections
for arbitrary pairs of directions.
</p>
<p>Before moving on, it's highly instructive to see how the two intuitive material properties that
were earlier disparaged, color and shininess, can be expressed precisely in the framework of a
BRDF. Consider a green ball. A green object is green and not blue because it reflects incident
light that is green more strongly than incident light of any other color.<a href="#footnote_6" class="FootnoteRef">6</a>  For example, perhaps green
light is almost all reflected, with only a small fraction absorbed, while 95%of the blue and
red light is absorbed and only 5%of light at those wavelengths is reflected in various
directions. White light actually consists of all the different colors of light, so a green object
essentially filters out colors other than green. If a different object responded to green and red
light in the same manner as our green ball, but absorbed 50%of the blue light and reflected the
other 50%, we might perceive the object as teal. Or if most of the light at all wavelengths was
absorbed, except for a small amount of green light, then we would perceive it as a dark shade of
green.  To summarize, a BRDF accounts for the difference in color between two objects through the
dependence on <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D706 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline">
<math xmlns="http://www.w3.org/1998/Math/MathML"><mi>&#955;</mi></math>
</mjx-assistive-mml>
</mjx-container>: any given wavelength of light has its own reflectance distribution.
</p>
<p>Next, consider the difference between shiny red plastic and diffuse red construction paper.  A
shiny surface reflects incident light much more strongly in one particular direction compared to
others, whereas a diffuse surface scatters light more evenly across all outgoing directions. A
perfect reflector, such as a mirror, would reflect all the light from one incoming direction in a
single outgoing direction, whereas a perfectly diffuse surface would reflect light equally in all
outgoing directions, regardless of the direction of incidence.  In summary, a BRDF accounts for
the difference in &#8220;shininess&#8221; of two objects through its dependence on
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline">
<math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</msub></math>
</mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline">
<math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub></math>
</mjx-assistive-mml>
</mjx-container>.
</p>
<p>
More complicated phenomena can be expressed by generalizing the BRDF.  Translucence and light
refraction can be easily incorporated by allowing the direction vectors to point back into the
surface. We might call this mathematical generalization a <i>bidirectional surface scattering
distribution function</i> (BSSDF).  Sometimes light strikes an object, bounces around inside of it,
and then exits at a different point.  This phenomenon is known as
    <i>subsurface scattering</i> and
is an important aspect of the appearances of many common substances, such as skin and milk. This
requires splitting the single reflection point <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline">
<math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow></math>
</mjx-assistive-mml>
</mjx-container> into <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline">
<math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow>
<mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</msub></math>
</mjx-assistive-mml>
</mjx-container> and
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline">
<math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub></math>
</mjx-assistive-mml>
</mjx-container>, which is used by the <i>bidirectional surface scattering
distribution function</i> (BSSDF).  Even volumetric effects, such as fog and subsurface scattering,
can be expressed, by dropping the words &#8220;surface&#8221; and defining a <i>bidirectional scattering
distribution function</i> (BSDF) at any point in space, not just on the &#8220;surfaces.&#8221;  Taken at face
value, these might seem like impractical abstractions, but they can be useful in understanding
how to design practical tools.
</p>
<p>
By the way, there are certain criteria that a BRDF must satisfy in order to be physically
plausible. First, it doesn't make sense for a negative amount of light to be reflected in any
direction.  Second, it's not possible for the total reflected light to be more than the light
that was incident, although the surface may absorb some energy so the reflected light can be less
than the incident light. This rule is usually called the
    <i>normalization constraint</i>. A final, less obvious principle obeyed by physical surfaces
is
    <i>Helmholtz reciprocity</i>: if we pick two arbitrary directions, the same fraction of light
should be reflected, no matter which is the incident direction and which is the outgoing
direction. In other words,
</p>
<span class="InMarginAnchor"><span class="InMargin"><span class="EqMarginCaption">Helmholtz reciprocity</span></span></span><div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D706 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D706 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block">
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo>
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow><mo>,</mo><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mn>1</mn></msub><mo>,</mo><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mn>2</mn></msub><mo>,</mo><mi>&#955;</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo>
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow><mo>,</mo><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mn>2</mn></msub><mo>,</mo><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mn>1</mn></msub><mo>,</mo><mi>&#955;</mi><mo stretchy="false">)</mo><mo>.</mo></math>
</mjx-assistive-mml>
</mjx-container>
</div>
<p class="NoIndent">
Due to Helmholtz reciprocity, some authors don't label the two directions in the BRDF as &#8220;in&#8221; and
&#8220;out&#8221; because to be physically plausible the computation must be symmetric.
</p>
<p>
The BRDF contains the complete description of an object's appearance at a given point, since it
describes how the surface will reflect light at that point.  Clearly, a great deal of thought
must be put into the design of this function.  Numerous lighting models have been proposed over
the last several decades, and what is surprising is that one of the earliest models,
    Blinn-Phong, is still in widespread use in real-time graphics today.  Although it is not
physically accurate (nor plausible: it violates the normalization constraint), we study it
because it is a good educational stepping stone and an important bit of graphics history.
Actually, describing Blinn-Phong as &#8220;history&#8221; is wishful thinking&#8212;perhaps the most important
reason to study this model is that it still is in such widespread use!  In fact, it's the best
example of the phenomena we mentioned at the start of this chapter: particular methods being
presented as if they are &#8220;the way graphics work.&#8221;
</p>
<p>
Different lighting models have different goals. Some are better at simulating rough surfaces,
others at surfaces with multiple strata. Some focus on providing intuitive &#8220;dials&#8221; for artists
to control, without concern for whether those dials have any physical significance at all. Others
are based on taking real-world surfaces and measuring them with special cameras called
    goniophotometers, essentially sampling the BRDF and then using interpolation to reconstruct the
function from the tabulated data.  The notable Blinn-Phong model discussed in
<a href="#standard_local_lighting_model">Section&#160;10.6</a> is useful because it is simple, inexpensive, and well
understood by artists. Consult the sources in the suggested reading for a survey of lighting
models.
</p>
<h2 id="color_and_radiometry"><span class="SectionNumber">10.1.3</span><span class="SectionTitle">A Very Brief Introduction to Colorimetry<br>and Radiometry</span></h2>
<p class="NoIndent">
Graphics is all about measuring light, and you should be aware of some important subtleties, even
though we won't have time to go into complete detail here. The first is how to measure the color
of light, and the second is how to measure its brightness.
</p>
<p>In your middle school science classes you might have learned that every color of light is some
mixture of red, green, and blue (RGB) light. This is the popular conception of light, but it's
not quite correct. Light can take on any single frequency in the visible band, or it might be a
combination of any number of frequencies. Color is a phenomena of <i>human perception</i> and is
not quite the same thing as frequency. Indeed different combinations of frequencies of light can
be perceived as the same color&#8212;these are known as
    <i>metamers</i>. The infinite combinations of frequencies of light are sort of like all the
different chords that can be played on a piano (and also tones between the keys).  In this
metaphor our color perception is unable to pick out all the different individual notes, but
instead, any given chord sounds to us like some combination of middle C, F, and G.  Three color
channels is not a magic number as far as physics is concerned, it's peculiar to human vision.
    Most other mammals have only two different types of receptors (we would call them &#8220;color
blind&#8221;), and fish, reptiles, and birds have <i>four</i> types of color receptors (they would
call <i>us</i> color blind).
</p>
<p>
However, even very advanced rendering systems project the continuous spectrum of visible light
onto some discrete basis, most commonly, the RGB basis.  This is a ubiquitous simplification, but
we still wanted to let you know that it is a simplification, as it doesn't account for certain
phenomena.  The RGB basis is not the only color space, nor is it necessarily the best one for
many purposes, but it is a very convenient basis because it is the one used by most display
devices.
    In turn, the reason that this basis is used by so many display devices is due to the
similarity to our own visual system. Hall <a class="RefCite" href="#reference_11">[11]</a> does a good job of
describing the shortcomings of the RGB system.
</p>
<p>
Since the visible portion of the electromagnetic spectrum is continuous, an expression such as
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D706 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline">
<math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo>
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow><mo>,</mo><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</msub><mo>,</mo><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub><mo>,</mo><mi>&#955;</mi><mo stretchy="false">)</mo></math>
</mjx-assistive-mml>
</mjx-container> is
continuous in terms of <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D706 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline">
<math xmlns="http://www.w3.org/1998/Math/MathML"><mi>&#955;</mi></math>
</mjx-assistive-mml>
</mjx-container>.  At least it should be in theory.  In practice, because we are
producing images for human consumption, we reduce the infinite number of different <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D706 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline">
<math xmlns="http://www.w3.org/1998/Math/MathML"><mi>&#955;</mi></math>
</mjx-assistive-mml>
</mjx-container>s
down to three particular wavelengths. Usually, we choose the three wavelengths to be those
perceived as the colors red, green, and blue.  In practice, you can think of the presence of
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D706 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>&#955;</mi></math>
</mjx-assistive-mml>
</mjx-container> in an equation as an integer that selects which of the three discrete &#8220;color
channels&#8221; is being operated on.
</p>
<div class="KeyIdea">
<div class="KeyIdeaTitle">Key Points about Color</div><ul>
    <li>
To describe the spectral distribution of light requires a continuous function, not
        just three numbers.  However, to describe the human perception of that light, three
        numbers are essentially sufficient.
</li>
<li>
The RGB system is a convenient color space, but it's not the only one, and not even
        the best one for many practical purposes.  In practice, we usually treat light as being
        a combination of red, green, and blue because we are making images for human
        consumption.
</li>
</ul>
</div><p>You should also be aware of the different ways that we can measure the intensity of light.  If we
take a viewpoint from physics, we consider light as energy in the form of electromagnetic
radiation, and we use units of measurement from the field of <i>radiometry</i>.  The most basic
quantity is
    <i>radiant energy</i>, which in the SI system is measured in the standard unit of energy, the
    <i>joule</i> (J).  Just like any other type of energy, we are often interested in the rate of
energy flow per unit time, which is known as
    <i>power</i>.  In the SI system power is measured using the
    <i>watt</i> (W), which is one joule per second (1&#160;W = 1&#160;J/s).  Power in the form of electromagnetic
radiation is called
    <i>radiant power</i> or <i>radiant flux</i>. The term &#8220;flux,&#8221; which comes
from the Latin <i>fluxus</i> for &#8220;flow,&#8221; refers to some quantity flowing across some
cross-sectional area. Thus, radiant flux measures the total amount of energy that is arriving,
leaving, or flowing across some area per unit time.
</p>
<p>
Imagine that a certain amount of radiant flux is emitted from a <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mtext class="mjx-n"><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: 0.363em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mtext>&#160;</mtext><msup>
<mrow><mi mathvariant="normal">m</mi></mrow>
<mn>2</mn></msup></math>
</mjx-assistive-mml>
</mjx-container> surface, while
that same amount of power is emitted from a different surface that is <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mtext class="mjx-n"><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: 0.363em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>100</mn><mtext>&#160;</mtext><msup>
<mrow><mi mathvariant="normal">m</mi></mrow>
<mn>2</mn></msup></math>
</mjx-assistive-mml>
</mjx-container>.
Clearly, the smaller surface is &#8220;brighter&#8221; than the larger surface; more precisely, it has a
greater flux per unit area, also known as
    <i>flux density</i>. The radiometric term for flux density, the radiant flux per unit area, is
called
    <i>radiosity</i>, and in the SI system it is measured in watts per meter. The relationship
between flux and radiosity is analogous to the relationship between force and pressure; confusing
the two will lead to similar sorts of conceptual errors.
</p>
<p>
Several equivalent terms exist for radiosity.  First, note that we can measure the flux density
(or total flux, for that matter) across any cross-sectional area.  We might be measuring the
radiant power emitted from some surface with a finite area, or the surface through which the
light flows might be an imaginary boundary that exists only mathematically (for example, the
surface of some imaginary sphere that surrounds a light source).  Although in all cases we are
measuring flux density, and thus the term &#8220;radiosity&#8221; is perfectly valid, we might also use
more specific terms, depending on whether the light being measured is coming or going.  If the
area is a surface and the light is arriving on the surface, then the term
    <i>irradiance</i> is used. If light is being emitted from a surface, the term
    <i>radiant exitance</i> or <i>radiant emittance</i> is used. In digital image synthesis, the word
&#8220;radiosity&#8221; is most often used to refer to light that is leaving a surface, having been either
reflected or emitted.
</p>
<p>
When we are talking about the brightness at a particular point, we cannot use plain old radiant
power because the area of that point is infinitesimal (essentially zero).  We can speak of the
flux <i>density</i> at a single point, but to measure flux, we need a finite area over which to
measure.  For a surface of finite area, if we have a single number that characterizes the total
for the entire surface area, it will be measured in flux, but to capture the fact that different
locations within that area might be brighter than others, we use a function that varies over the
surface that will measure the flux density.
</p>
<p>
Now we are ready to consider what is perhaps the most central quantity we need to measure in
graphics: the intensity of a &#8220;ray&#8221; of light.  We can see why the radiosity is not the unit for
the job by an extension of the ideas from the previous paragraph.  Imagine a surface point
surrounded by an emissive dome and receiving a certain amount of irradiance coming from all
directions in the hemisphere centered on the local surface normal.  Now imagine a second surface
point experiencing the same amount of irradiance, only all of the illumination is coming from a
single direction, in a very thin beam.  Intuitively, we can see that a ray along this beam is
somehow &#8220;brighter&#8221; than any one ray that is illuminating the first surface point.  The
irradiance is somehow &#8220;denser.&#8221; It is denser <i>per unit solid area</i>.
</p>
<p>The idea of a solid area is probably new to some readers, but we can easily understand the idea
by comparing it to angles in the plane.  A &#8220;regular&#8221; angle is measured (in radians) based on
the length of its projection onto the unit circle.  In the same way, a solid angle measures the
<i>area</i> as projected onto the unit sphere surrounding the point.  The SI unit for solid angle
is the
    <i>steradian</i>, abbreviated &#8220;sr.&#8221;  The complete sphere has <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c34"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70B TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>4</mn><mi>&#960;</mi></math>
</mjx-assistive-mml>
</mjx-container>&#160;sr; a hemisphere
encompasses <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70B TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mi>&#960;</mi></math>
</mjx-assistive-mml>
</mjx-container>&#160;sr.
</p>
<div id="radiance_projected_area" class="Display Figure Wrap">
<div class="Body">
        <img class="WithFrame" src="figs/graphics/radiance_projected_area.png" loading="lazy" width="163" height="433">
</div><span class="Caption">
<span class="Label">Figure&#160;10.1</span><span class="CaptionText">
The two surfaces are receiving identical bundles of light,
but the surface on the bottom has a larger area, and thus has a lower irradiance.
</span>
</span>
</div><p>
By measuring the radiance per unit solid angle, we can express the intensity of light at a
certain point as a function that varies based upon the direction of incidence.  We are very close
to having the unit of measurement that describes the intensity of a ray.  There is just one
slight catch, illustrated by <a href="#radiance_projected_area">Figure&#160;10.1</a>, which is a close-up of a very
thin pencil of light rays striking a surface.  On the top, the rays strike the surface
perpendicularly, and on the bottom, light rays of the same strength strike a different surface at
an angle.  The key point is that the area of the top surface is smaller than the area of the
bottom surface; therefore, the irradiance on the top surface is larger than the irradiance on the
bottom surface, despite the fact that the two surfaces are being illuminated by the &#8220;same
number&#8221; of identical light rays.  This basic phenomenon, that the angle of the surface causes
incident light rays to be spread out and thus contribute less irradiance, is known as
    <i>Lambert's law</i>. We have more to say about Lambert's law in <a href="#diffuse_component">Section&#160;10.6.3</a>,
but for now, the key idea is that the contribution of a bundle of light to the irradiance at a
surface depends on the angle of that surface.
</p>
<p>
Due to Lambert's law, the unit we use in graphics to measure the strength of a ray,
    <i>radiance</i>, is defined as the radiant flux per unit
    <i>projected area</i>, per unit solid
angle.  To measure a projected area, we take the actual surface area and project it onto the
plane perpendicular to the ray.  (In <a href="#radiance_projected_area">Figure&#160;10.1</a>, imagine taking the
bottom surface and projecting it upwards onto the top surface).  Essentially this counteracts
Lambert's law.
</p>
<p>
<a href="#radiometric_terms">Table&#160;10.1</a> summarizes the most important radiometric terms.
</p>
<div id="radiometric_terms" class="Display Table Wide">
<div class="Body FontScriptSize">
    <table>
<tr>
<td><b>Quantity</b></td>
<td><b>Units</b></td>
<td><b>SI unit</b></td>
<td><b>Rough translation</b></td>
</tr>
<tr class="HLineAbove">
<td>Radiant energy</td>
<td>Energy</td>
<td>
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c4A"></mjx-c></mjx-mi></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi mathvariant="normal">J</mi></mrow>
</math></mjx-assistive-mml>
</mjx-container></td>
<td>Total illumination duringan interval of time</td>
</tr>
<tr>
<td>Radiant flux</td>
<td>Power</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c57"></mjx-c></mjx-mi></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi mathvariant="normal">W</mi></mrow>
</math></mjx-assistive-mml>
</mjx-container></td>
<td>Brightness of a finite areafrom all directions</td>
</tr>
<tr>
<td>Radiant flux density</td>
<td>Power per unit area</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c57"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: 0.477em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup>
<mrow><mi mathvariant="normal">W</mi>
<mrow><mo>/</mo></mrow>
<mi mathvariant="normal">m</mi></mrow>
<mn>2</mn></msup></math></mjx-assistive-mml>
</mjx-container></td>
<td>Brightness of a single pointfrom all directions</td>
</tr>
<tr>
<td>Irradiance</td>
<td>Power per unit area</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c57"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: 0.477em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup>
<mrow><mi mathvariant="normal">W</mi>
<mrow><mo>/</mo></mrow>
<mi mathvariant="normal">m</mi></mrow>
<mn>2</mn></msup></math></mjx-assistive-mml>
</mjx-container></td>
<td>Radiant flux density ofincident light</td>
</tr>
<tr>
<td>Radiant exitance</td>
<td>Power per unit area</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c57"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: 0.477em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup>
<mrow><mi mathvariant="normal">W</mi>
<mrow><mo>/</mo></mrow>
<mi mathvariant="normal">m</mi></mrow>
<mn>2</mn></msup></math></mjx-assistive-mml>
</mjx-container></td>
<td>Radiant flux density ofemitted light</td>
</tr>
<tr>
<td>Radiosity</td>
<td>Power per unit area</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c57"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: 0.477em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup>
<mrow><mi mathvariant="normal">W</mi>
<mrow><mo>/</mo></mrow>
<mi mathvariant="normal">m</mi></mrow>
<mn>2</mn></msup></math></mjx-assistive-mml>
</mjx-container></td>
<td>Radiant flux density ofemitted or reflected light</td>
</tr>
<tr>
<td>Radiance</td>
<td>Power per unit projected area, perunit solid angle</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c57"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msup><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.363em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mi class="mjx-n" space="3"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi mathvariant="normal">W</mi>
<mrow><mo>/</mo></mrow>
<mo stretchy="false">(</mo><msup><mi mathvariant="normal">m</mi><mn>2</mn></msup><mo>&#8901;</mo><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mo stretchy="false">)</mo></mrow>
</math></mjx-assistive-mml>
</mjx-container></td>
<td>Brightness of a ray</td>
</tr>
</table>
</div><span class="Caption"><span class="Label">Table&#160;10.1</span><span class="CaptionText">Common radiometric terms</span>
</span>
</div><p>
Whereas radiometry takes the perspective of physics by measuring the raw energy of the light, the
field of
    <i>photometry</i> weighs that same light using the human eye.  For each of the
corresponding radiometric terms, there is a similar term from photometry
(<a href="#photometry_terms">Table&#160;10.2</a>).  The only real difference is a nonlinear conversion from raw
energy to perceived brightness.
</p>
<div id="photometry_terms" class="Display Table Wide">
<div class="Body FontSsFamily FontScriptSize">
<span class="CenterContainer">
<span></span><span class="CenterBody">
    <table>
<tr>
<td><b>Radiometric term</b></td>
<td><b>Photometric term</b></td>
<td><b>SI Photometric unit</b></td>
</tr>
<tr class="HLineAbove">
<td>Radiant energy</td>
<td>Luminous energy</td>
<td>talbot, or lumen second (<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mi class="mjx-n" space="3"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">m</mi><mo>&#8901;</mo><mi mathvariant="normal">s</mi></mrow>
</math></mjx-assistive-mml>
</mjx-container>)</td>
</tr>
<tr>
<td>Radiant flux</td>
<td>Luminous flux, luminous power</td>
<td>lumen (<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">m</mi></mrow>
</math></mjx-assistive-mml>
</mjx-container>)</td>
</tr>
<tr>
<td>Irradiance</td>
<td>Illuminance</td>
<td>lux (<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-n" space="4"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-msup><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.363em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">x</mi><mo>=</mo><mi mathvariant="normal">l</mi><mi mathvariant="normal">m</mi>
<mrow><mo>/</mo></mrow>
<msup><mi mathvariant="normal">m</mi><mn>2</mn></msup></mrow>
</math></mjx-assistive-mml>
</mjx-container>)</td>
</tr>
<tr>
<td>Radiant exitance</td>
<td>Luminous emittance</td>
<td>lux (<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-n" space="4"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-msup><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.363em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">x</mi><mo>=</mo><mi mathvariant="normal">l</mi><mi mathvariant="normal">m</mi>
<mrow><mo>/</mo></mrow>
<msup><mi mathvariant="normal">m</mi><mn>2</mn></msup></mrow>
</math></mjx-assistive-mml>
</mjx-container>)</td>
</tr>
<tr>
<td>Radiance</td>
<td>Luminance</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msup><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.363em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mi class="mjx-n" space="3"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">m</mi>
<mrow><mo>/</mo></mrow>
<mo stretchy="false">(</mo><msup><mi mathvariant="normal">m</mi><mn>2</mn></msup><mo>&#8901;</mo><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mo stretchy="false">)</mo></mrow>
</math></mjx-assistive-mml>
</mjx-container></td>
</tr>
</table>
</span><span></span>
</span>
</div><span class="Caption">
<span class="Label">Table&#160;10.2</span><span class="CaptionText">Units of measurement from radiometry and photometry</span>
</span>
</div><p>
Throughout the remainder of this chapter, we try to use the proper radiometric units when
possible. However, the practical realities of graphics make using proper units confusing, for two
particular reasons.  It is common in graphics to need to take some integral over a
&#8220;signal&#8221;&#8212;for example, the color of some surface.  In practice we cannot do the integral
analytically, and so we must
    integrate numerically, which boils down to taking a weighted average of many samples. Although
mathematically we are taking a weighted average (which ordinarily would not cause the units to
change), in fact what we are doing is <i>integrating</i>, and that means each sample is really
being multiplied by some differential quantity, such as a differential area or differential solid
angle, which causes the physical units to change.  A second cause of confusion is that, although
many signals have a finite nonzero domain in the real world, they are represented in a computer
by signals that are nonzero at a single point. (Mathematically, we say that the signal is a
multiple of a
    Direc delta; see <a href="dynamics.html#dirac_delta">Section&#160;12.4.3</a>.)
    For example, a real-world light source has a finite area, and we would be interested in the
radiance of the light at a given point on the emissive surface, in a given direction.  In
practice, we imagine shrinking the area of this light down to zero while holding the radiant flux
constant. The flux density becomes infinite in theory. Thus, for a real area light we would need
a signal to describe the flux density, whereas for a point light, the flux density becomes
infinite and we instead describe the brightness of the light by its total flux.  We'll repeat
this information when we talk about point lights.
</p>
<div class="KeyIdea">
<div class="KeyIdeaTitle">Key Points about Radiometry</div><ul>
    <li>
Vague words such as &#8220;intensity&#8221; and &#8220;brightness&#8221; are best avoided when the more
        specific radiometric terms can be used.  The scale of our numbers is not that
        important and we don't need to use real world SI units, but it is helpful to understand
        what the different radiometric quantities measure to avoid mixing quantities together
        inappropriately.
</li>
<li>
Use radiant flux to measure the total brightness of a finite area, in all directions.
</li>
<li>
Use radiant flux density to measure the brightness at a single point, in all
        directions. Irradiance and radiant exitance refer to radiant flux density of light that
        is incident and emitted, respectively.  Radiosity is the radiant flux density of light
        that is leaving a surface, whether the light was reflected or emitted.
</li>
<li>
Due to Lambert's law, a given ray contributes more differential irradiance when it
        strikes a surface at a perpendicular angle compared to a glancing angle.
</li>
<li>
Use radiance to measure the brightness of a ray.  More specifically, radiance is
        the flux per unit projected angle, per solid angle.  We use projected area so that
        the value for a given ray is a property of a ray alone and does not depend on the
        orientation of the surface used to measure the flux density.
</li>
<li>
Practical realities thwart our best intentions of doing things &#8220;the right way&#8221; when
        it comes to using proper units.  Numerical integration is a lot like taking a weighted
        average, which hides the change of units that really occurs.  Point lights and other
        Dirac deltas add further confusion.
</li>
</ul>
</div><h2 id="rendering_equation"><span class="SectionNumber">10.1.4</span><span class="SectionTitle">The Rendering Equation</span></h2>
<p class="NoIndent">Now let's fit the BRDF into the rendering algorithm.  In step&#160;2 of our rendering algorithm
(<a href="#how_graphics_works">Section&#160;10.1</a>), we're trying to determine the radiance leaving a particular
surface in the direction of our eye. The only way this can happen is for light to arrive from
some direction onto the surface and get reflected in our direction. With the BRDF, we now have a
way to measure this. Consider all the potential directions that light might be incident upon the
surface, which form a hemisphere centered on <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>, oriented according to the local
surface normal <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math></mjx-assistive-mml>
</mjx-container>. For each potential direction <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</msub></math></mjx-assistive-mml>
</mjx-container>, we
measure the color of light incident from that direction. The BRDF tells us how much of the
radiance from <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</msub></math></mjx-assistive-mml>
</mjx-container> is reflected in the direction
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub></math></mjx-assistive-mml>
</mjx-container> towards our eye (as opposed to scattered in some other
direction or absorbed).  By summing up the radiance reflected towards
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub></math></mjx-assistive-mml>
</mjx-container> over all possible incident directions, we obtain the total
radiance reflected along <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub></math></mjx-assistive-mml>
</mjx-container> into our eye. We add the reflected
light to any light that is being <i>emitted</i> from the surface in our direction (which is zero
for most surfaces), and voila, we have the total radiance.  Writing this in math notation, we
have the <i>rendering equation</i>.
</p>
<div class="KeyIdea">
<div class="KeyIdeaTitle">The Rendering Equation</div><div class="DisplayMath">
<mjx-container class="MathJax" display="true" jax="CHTML" role="presentation" style="font-size: 100%; min-width: 100%; position: relative" width="full">
<mjx-math aria-hidden="true" class="MJX-TEX" display="true" width="full"><mjx-mtable side="right" style="min-width: 100%; display: flex; justify-content: space-between; flex-flow: row nowrap">
<mjx-labels-partner style="flex: 1 0 0; max-width: 3.356em"></mjx-labels-partner><mjx-table style="flex: 0 0 21.49em"><mjx-itable width="full"><mjx-mtr><mjx-mtd style="text-align: left; width: 100%; max-width: 100%; min-width: 100%; padding-bottom: 0.25em"><mjx-msub><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-texatom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-texatom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-texatom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-texatom></mjx-base></mjx-mover></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D706 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-texatom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-texatom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-texatom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-texatom></mjx-base></mjx-mover></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D706 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mlabeledtr><mjx-mtd style="text-align: right; width: 100%; max-width: 100%; min-width: 100%; padding-top: 0.25em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mo class="mjx-lop" noic="true"><mjx-c class="mjx-c222B TEX-S2"></mjx-c></mjx-mo><mjx-script style="vertical-align: -0.896em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-n"><mjx-c class="mjx-c3A9"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-texatom><mjx-mspace style="width: 0.078em"></mjx-mspace><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c3A9"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-msub space="2"><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-texatom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-texatom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-texatom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-texatom></mjx-base></mjx-mover></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D706 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-texatom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-texatom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-texatom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-texatom></mjx-base></mjx-mover></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-texatom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-texatom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-texatom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-texatom></mjx-base></mjx-mover></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D706 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub><mjx-texatom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-texatom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-texatom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-texatom></mjx-base></mjx-mover></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-texatom space="3" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-base></mjx-mover></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mstyle><mjx-mspace style="width: 0.167em"></mjx-mspace></mjx-mstyle><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-msub><mjx-texatom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-texatom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-texatom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-texatom></mjx-base></mjx-mover></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mlabeledtr></mjx-itable></mjx-table>
<mjx-labels style="flex: 0 0 3.356em"><mjx-itable align="right" style=""><mjx-mtr style="height: 1.266em"></mjx-mtr><mjx-mtr style="height: 2.507em"><mjx-mtd id="mjx-eqn-10.1" style="padding-top: 0.25em"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c28"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c29"></mjx-c></mjx-mtext><mjx-tstrut style="height: 2.257em; vertical-align: -0.896em"></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-labels>
</mjx-mtable>
</mjx-math>
<mjx-assistive-mml display="block" role="presentation" unselectable="on"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnwidth="100%" displaystyle="true" rowspacing=".5em" width="85%"><mtr><mtd columnalign="left"><msub><mi>L</mi>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub><mo stretchy="false">(</mo>
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow><mo>,</mo><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub><mo>,</mo><mi>&#955;</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>L</mi>
<mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi></mrow>
</msub><mo stretchy="false">(</mo>
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow><mo>,</mo><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub><mo>,</mo><mi>&#955;</mi><mo stretchy="false">)</mo></mtd></mtr><mlabeledtr><mtd><mtext>(10.1)</mtext></mtd><mtd columnalign="right"><mi></mi><mo>+</mo><msub><mo data-mjx-texclass="OP">&#8747;</mo>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi mathvariant="normal">&#937;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi mathvariant="normal">&#937;</mi></mrow>
</mrow></mrow>
</msub><msub><mi>L</mi>
<mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</msub><mo stretchy="false">(</mo>
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow><mo>,</mo><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</msub><mo>,</mo><mi>&#955;</mi><mo stretchy="false">)</mo><mi>f</mi><mo stretchy="false">(</mo>
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow><mo>,</mo><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</msub><mo>,</mo><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub><mo>,</mo><mi>&#955;</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mo>&#8722;</mo><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</msub><mo>&#8901;</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo stretchy="false">)</mo><mstyle scriptlevel="0"><mspace width="thinmathspace"></mspace></mstyle><mi>d</mi><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</msub><mo>.</mo></mtd></mlabeledtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div></div><p>
As fundamental as <a href="#rendering_equation">Equation&#160;(10.1)</a> may be, its development is relatively recent,
having been published in SIGGRAPH in 1986 by Kajiya <a class="RefCite" href="#reference_13">[13]</a>.
Furthermore, it was the <i>result</i> of, rather than the cause of, numerous strategies for
producing realistic images. Graphics researchers pursued the creation of images through different
techniques that seemed to make sense to them before having a framework to describe the problem
they were trying to solve. And for many years after that, most of us in the video game industry
were unaware that the problem we were trying to solve had finally been clearly defined. (Many
still are.)
</p>
<p>
Now let's convert this equation into English and see what the heck it means.  First of all,
notice that <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D706 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>&#955;</mi></math></mjx-assistive-mml>
</mjx-container> appear in each function.  The whole equation governs a
balance of radiance at a single surface point <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> for a single wavelength (&#8220;color
channel&#8221;) <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D706 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>&#955;</mi></math></mjx-assistive-mml>
</mjx-container>.  So this balance equation applies to each color channel individually, at
all surface points simultaneously.
</p>
<p>
The term <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D706 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>L</mi>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub><mo stretchy="false">(</mo>
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow><mo>,</mo><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub><mo>,</mo><mi>&#955;</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container> on the left
side of the equals sign is simply &#8220;The radiance leaving the point in the direction
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub></math></mjx-assistive-mml>
</mjx-container>.&#8221;  Of course, if <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> is the visible surface at a
given pixel, and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub></math></mjx-assistive-mml>
</mjx-container> is the direction from <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> to the
eye, then this quantity is exactly what we need to determine the pixel color. But note that the
equation is more general, allowing us to compute the outgoing radiance in any arbitrary direction
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub></math></mjx-assistive-mml>
</mjx-container> and for any given point <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>, whether or not
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub></math></mjx-assistive-mml>
</mjx-container> points towards our eye.
</p>
<p>
On the right-hand side, we have a sum.  The first term in the sum <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D706 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>L</mi>
<mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi></mrow>
</msub><mo stretchy="false">(</mo>
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow><mo>,</mo><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub><mo>,</mo><mi>&#955;</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container>, is &#8220;the radiance emitted from <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> in the
direction <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub></math></mjx-assistive-mml>
</mjx-container>&#8221; and will be nonzero only for special emissive
surfaces. The second term, the integral, is &#8220;the light reflected from <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> in the
direction of <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub></math></mjx-assistive-mml>
</mjx-container>.&#8221;  Thus, from a high level the rendering
equation would seem to state the rather obvious relation
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mtable style="min-width: 29.117em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: right"><mjx-mrow><mjx-mo class="mjx-s3"><mjx-c class="mjx-c28 TEX-S3"></mjx-c></mjx-mo><mjx-mtable style="min-width: 6.309em" justify="right"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-bottom: 0.2em"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c54"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c65"></mjx-c></mjx-mtext><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-top: 0.2em"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c77"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-c73"></mjx-c></mjx-mtext><mjx-mtext class="mjx-n"><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-s3"><mjx-c class="mjx-c29 TEX-S3"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mrow space="4"><mjx-mo class="mjx-s3"><mjx-c class="mjx-c28 TEX-S3"></mjx-c></mjx-mo><mjx-mtable style="min-width: 7.597em" justify="right"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-bottom: 0.2em"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c52"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c64"></mjx-c></mjx-mtext><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-top: 0.2em"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c77"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-c73"></mjx-c></mjx-mtext><mjx-mtext class="mjx-n"><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-s3"><mjx-c class="mjx-c29 TEX-S3"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mrow space="3"><mjx-mo class="mjx-s3"><mjx-c class="mjx-c28 TEX-S3"></mjx-c></mjx-mo><mjx-mtable style="min-width: 7.961em" justify="right"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-bottom: 0.2em"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c52"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c66"></mjx-c><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c64"></mjx-c></mjx-mtext><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-top: 0.2em"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c77"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-c73"></mjx-c></mjx-mtext><mjx-mtext class="mjx-n"><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-s3"><mjx-c class="mjx-c29 TEX-S3"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" rowspacing="3pt"><mtr><mtd>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><mtable columnalign="center" columnspacing="1em" rowspacing="4pt"><mtr><mtd><mtext>Total radiance</mtext></mtd></mtr><mtr><mtd><mtext>towards</mtext><mtext>&#160;</mtext><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub></mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">)</mo></mrow>
<mo>=</mo>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><mtable columnalign="center" columnspacing="1em" rowspacing="4pt"><mtr><mtd><mtext>Radiance emitted</mtext></mtd></mtr><mtr><mtd><mtext>towards</mtext><mtext>&#160;</mtext><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub></mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">)</mo></mrow>
<mo>+</mo>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><mtable columnalign="center" columnspacing="1em" rowspacing="4pt"><mtr><mtd><mtext>Radiance reflected</mtext></mtd></mtr><mtr><mtd><mtext>towards</mtext><mtext>&#160;</mtext><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub></mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">)</mo></mrow>
<mo>.</mo></mtd></mtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div><p>
Now let's dig into that intimidating integral.  (By the way, if you haven't had calculus and
haven't read <a href="kinematics_calculus.html">Chapter&#160;11</a> yet, just replace the word &#8220;integral&#8221; with
&#8220;sum,&#8221; and you won't miss any of the main point of this section.) We've actually already
discussed how it works when we talked about the BRDF, but let's repeat it with different words.
We might rewrite the integral as
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mtable style="min-width: 27.305em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: right"><mjx-mrow><mjx-mo class="mjx-s3"><mjx-c class="mjx-c28 TEX-S3"></mjx-c></mjx-mo><mjx-mtable style="min-width: 7.961em" justify="right"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-bottom: 0.2em"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c52"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c66"></mjx-c><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c64"></mjx-c></mjx-mtext><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-top: 0.2em"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c77"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-c73"></mjx-c></mjx-mtext><mjx-mtext class="mjx-n"><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-s3"><mjx-c class="mjx-c29 TEX-S3"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mo class="mjx-lop" noIC="true"><mjx-c class="mjx-c222B TEX-S2"></mjx-c></mjx-mo><mjx-script style="vertical-align: -0.896em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-n"><mjx-c class="mjx-c3A9"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.078em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c3A9"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mrow><mjx-mo class="mjx-s3"><mjx-c class="mjx-c28 TEX-S3"></mjx-c></mjx-mo><mjx-mtable style="min-width: 11.613em" justify="right"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-bottom: 0.2em"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c52"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c66"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c6D"></mjx-c></mjx-mtext><mjx-mtext class="mjx-n"><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-top: 0.2em"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c66"></mjx-c><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c77"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-c73"></mjx-c></mjx-mtext><mjx-mtext class="mjx-n"><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-s3"><mjx-c class="mjx-c29 TEX-S3"></mjx-c></mjx-mo></mjx-mrow><mjx-mstyle><mjx-mspace style="width: 0.167em"></mjx-mspace></mjx-mstyle><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" rowspacing="3pt"><mtr><mtd>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><mtable columnalign="center" columnspacing="1em" rowspacing="4pt"><mtr><mtd><mtext>Radiance reflected</mtext></mtd></mtr><mtr><mtd><mtext>towards</mtext><mtext>&#160;</mtext><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub></mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">)</mo></mrow>
<mo>=</mo><msub><mo data-mjx-texclass="OP">&#8747;</mo>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi mathvariant="normal">&#937;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi mathvariant="normal">&#937;</mi></mrow>
</mrow></mrow>
</msub>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><mtable columnalign="center" columnspacing="1em" rowspacing="4pt"><mtr><mtd><mtext>Radiance incident from</mtext><mtext>&#160;</mtext><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</msub></mtd></mtr><mtr><mtd><mtext>and reflected towards</mtext><mtext>&#160;</mtext><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub></mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">)</mo></mrow>
<mstyle scriptlevel="0"><mspace width="thinmathspace"></mspace></mstyle><mi>d</mi><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</msub><mo>.</mo></mtd></mtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div><p>
Note that symbol <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-n"><mjx-c class="mjx-c3A9"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c3A9"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mpadded width="0"><mi mathvariant="normal">&#937;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi mathvariant="normal">&#937;</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> (uppercase Greek omega) appears where we normally would
write the limits of integration.  This is intended to mean &#8220;sum over the hemisphere of possible
incoming directions.&#8221;  For each incoming direction <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</msub></math></mjx-assistive-mml>
</mjx-container>, we
determine how much radiance was incident in this incoming direction and got scattered in the
outgoing direction <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub></math></mjx-assistive-mml>
</mjx-container>.  The sum of all these contributions from
all the different incident directions gives the total radiance reflected in the direction
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub></math></mjx-assistive-mml>
</mjx-container>.  Of course, there are an infinite number of incident
directions, which is why this is an integral.
    In practice, we cannot evaluate the integral analytically, and we must sample a discrete number
of directions, turning the &#8220;<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-sop"><mjx-c class="mjx-c222B TEX-S1"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo data-mjx-texclass="OP">&#8747;</mo></math></mjx-assistive-mml>
</mjx-container>&#8221; into a &#8220;<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-sop"><mjx-c class="mjx-c2211 TEX-S1"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo data-mjx-texclass="OP">&#8721;</mo></math></mjx-assistive-mml>
</mjx-container>.&#8221;
</p>
<p>
Now all that is left is to dissect the integrand.  It's a product of three factors:
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mtable style="min-width: 31.677em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0"><mjx-mrow><mjx-mo class="mjx-s3"><mjx-c class="mjx-c28 TEX-S3"></mjx-c></mjx-mo><mjx-mtable style="min-width: 11.613em" justify="right"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-bottom: 0.2em"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c52"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c66"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c6D"></mjx-c></mjx-mtext><mjx-mtext class="mjx-n"><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-top: 0.2em"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c66"></mjx-c><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c77"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-c73"></mjx-c></mjx-mtext><mjx-mtext class="mjx-n"><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-s3"><mjx-c class="mjx-c29 TEX-S3"></mjx-c></mjx-mo></mjx-mrow><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D706 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mstyle><mjx-mspace style="width: 0.167em"></mjx-mspace></mjx-mstyle><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D706 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mstyle><mjx-mspace style="width: 0.167em"></mjx-mspace></mjx-mstyle><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" rowspacing="3pt"><mtr><mtd>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><mtable columnalign="center" columnspacing="1em" rowspacing="4pt"><mtr><mtd><mtext>Radiance incident from</mtext><mtext>&#160;</mtext><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</msub></mtd></mtr><mtr><mtd><mtext>and reflected towards</mtext><mtext>&#160;</mtext><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub></mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">)</mo></mrow>
</mtd><mtd><mi></mi><mo>=</mo><msub><mi>L</mi>
<mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</msub><mo stretchy="false">(</mo>
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow><mo>,</mo><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</msub><mo>,</mo><mi>&#955;</mi><mo stretchy="false">)</mo><mstyle scriptlevel="0"><mspace width="thinmathspace"></mspace></mstyle><mi>f</mi><mo stretchy="false">(</mo>
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow><mo>,</mo><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</msub><mo>,</mo><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub><mo>,</mo><mi>&#955;</mi><mo stretchy="false">)</mo><mstyle scriptlevel="0"><mspace width="thinmathspace"></mspace></mstyle><mo stretchy="false">(</mo><mo>&#8722;</mo><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</msub><mo>&#8901;</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo stretchy="false">)</mo><mo>.</mo></mtd></mtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div><p>
The first factor denotes the radiance incident from the direction of
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</msub></math></mjx-assistive-mml>
</mjx-container>.
    The next factor is simply the BRDF, which tells us how much of
the radiance incident from this particular direction will be reflected in the outgoing direction
we care about.  Finally, we have the
    <i>Lambert factor</i>.  As discussed in
<a href="#brdf">Section&#160;10.1.2</a>, this accounts for the fact that more incident light is available to be
reflected, per unit surface area, when <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</msub></math></mjx-assistive-mml>
</mjx-container> is perpendicular to the
surface than when at a glancing angle to the surface.  The vector <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math></mjx-assistive-mml>
</mjx-container> is the
outward-facing surface normal; the dot product <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>&#8722;</mo><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</msub><mo>&#8901;</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math></mjx-assistive-mml>
</mjx-container> peaks at 1 in the perpendicular direction and trails off to zero as the angle of
incidence becomes more glancing. We discuss the Lambert factor once more in
<a href="#diffuse_component">Section&#160;10.6.3</a>.
</p>
<p>In purely mathematical terms, the rendering equation is an <i>integral equation</i>: it states a
relationship between some unknown function<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D706 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>L</mi>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub><mo stretchy="false">(</mo>
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow><mo>,</mo><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub><mo>,</mo><mi>&#955;</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container>, the distribution of light on the surfaces in the
scene, in terms of its own integral. It might not be apparent that the rendering equation is
recursive, but <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>L</mi>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub></math></mjx-assistive-mml>
</mjx-container> actually appears on both sides of the equals sign. It appears in
the evaluation of <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D706 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>L</mi>
<mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</msub><mo stretchy="false">(</mo>
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow><mo>,</mo><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</msub><mo>,</mo><mi>&#955;</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container>, which
is precisely the expression we set out to solve for each pixel: what is the radiance incident on
a point from a given direction?  Thus to find the radiance exiting a point <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>, we need
to know all the radiance incident at <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> from all directions.  But the radiance incident
on <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> is the same as the radiance leaving from <i>all other surfaces visible to
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container></i>, in the direction pointing from the other surface towards <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>.
</p>
<p>
To render a scene realistically, we must solve the rendering equation, which requires us to know
(in theory) not only the radiance arriving at the camera, but also the entire distribution of
radiance in the scene in every direction at every point.  Clearly, this is too much to ask for a
finite, digital computer, since both the set of surface locations and the set of potential
incident/exiting directions are infinite. The real art in creating software for digital image
synthesis is to allocate the limited processor time and memory most efficiently, to make
the best possible approximation.
</p>
<p>
The simple rendering pipeline we present in <a href="#realtime_graphics_pipeline">Section&#160;10.10</a> accounts only
for direct light.  It doesn't account for indirect light that bounced off of one surface and
arrived at another.  In other words, it only does &#8220;one recursion level&#8221; in the rendering
equation.  A huge component of realistic images is accounting for the indirect light&#8212;solving
the rendering equation more completely. The various methods for accomplishing this are known as
    <i>global illumination</i> techniques.
</p>
<p>
This concludes our high-level presentation of how graphics works.  Although we admit we have not
yet presented a single practical idea, we believe it's very important to understand what you are
trying to approximate before you start to approximate it.  Even though the compromises we are
forced to make for the sake of real-time are quite severe, the available computing power is
growing. A video game programmer whose only exposure to graphics has been OpenGL tutorials or
demos made by video card manufacturers or books that focused exclusively on real-time rendering
will have a much more difficult time understanding even the global illumination techniques of
today, much less those of tomorrow.
</p>

<h1 id="viewing_in_3d"><span class="SectionNumber">10.2</span><span class="SectionTitle">Viewing in 3D</span></h1>
<p class="NoIndent">
Before we render a scene, we must pick a camera and a window.  That is, we must decide where to
render it <i>from</i> (the view position, orientation, and zoom) and where to render it <i>to</i>
(the rectangle on the screen). The output window is the simpler of the two, and so we will
discuss it first.
</p>
<p>
<a href="#output_window">Section&#160;10.2.1</a> describes how to specify the output window.
<a href="#pixel_aspect_ratio">Section&#160;10.2.2</a> discusses the pixel aspect ratio. <a href="#view_frustum">Section&#160;10.2.3</a>
introduces the view frustum.  <a href="#field_of_view">Section&#160;10.2.4</a> describes field of view angles and zoom.
</p>
<div id="output_window" class="Display Figure Wide">
<div class="Body">
		<img class="WithFrame" src="figs/graphics/output_window.png" loading="lazy" width="555" height="368">
</div><span class="Caption"><span class="Label">Figure&#160;10.2</span><span class="CaptionText">Specifying the output window</span>
</span>
</div><h2 id="output_window"><span class="SectionNumber">10.2.1</span><span class="SectionTitle">Specifying the Output Window</span></h2>
<p class="NoIndent">We don't have to render our image to the entire screen.  For example, in
split-screen multiplayer games, each player is given a portion of the screen. The output window
refers to the portion of the output device where our image will be rendered.  This is shown in
<a href="#output_window">Figure&#160;10.2</a>.
</p>
<p>The position of the window is specified by the coordinates of the upper left-hand pixel
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c77"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c50"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c77"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c50"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub>
<mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">s</mi></mrow>
<mi>x</mi></msub><mo>,</mo><msub>
<mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">s</mi></mrow>
<mi>y</mi></msub><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container>. The integers <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c77"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c52"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">R</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi></mrow>
<mi>x</mi></msub></math></mjx-assistive-mml>
</mjx-container> and
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c77"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c52"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">R</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi></mrow>
<mi>y</mi></msub></math></mjx-assistive-mml>
</mjx-container> are the dimensions of the window in pixels.  Defining it this way, using
the size of the window rather than the coordinates of the lower right-hand corner, avoids some
sticky issues caused by integer pixel coordinates.  We are also careful to distinguish between
the size of the window in pixels, and the physical size of the window.  This distinction will
become important in <a href="#pixel_aspect_ratio">Section&#160;10.2.2</a>.
</p>
<p>
With that said, it is important to realize that we do not necessarily have to be rendering to the
screen at all.  We could be rendering into a buffer to be saved into a .TGA file or as a frame in
an .AVI, or we may be rendering into a texture as a subprocess of the &#8220;main&#8221; render, to produce
a shadow map, or a reflection, or the image on a monitor in the virtual world.  For these
reasons, the term
    <i>render target</i> is often used to refer to the current destination of
rendering output.
</p>
<h2 id="pixel_aspect_ratio"><span class="SectionNumber">10.2.2</span><span class="SectionTitle">Pixel Aspect Ratio</span></h2>
<p class="NoIndent">Regardless of whether we are rendering to the screen or an off-screen buffer, we must know the
aspect ratio of the pixels, which is the ratio of a pixel's height to its width.  This ratio is
often 1:1&#8212;that is, we have
    &#8220;square&#8221; pixels&#8212;but <i>this is not always the case!</i>  We give
some examples below, but it is common for this assumption to go unquestioned and become the
source of complicated kludges applied in the wrong place, to fix up stretched or squashed images.
</p>
<p>
The formula for computing the aspect ratio is
</p>
<span class="InMarginAnchor"><span class="InMargin"><span class="EqMarginCaption">Computing the pixel aspect ratio</span></span></span><div class="DisplayMath">
<mjx-container class="MathJax" display="true" jax="CHTML" role="presentation" style="font-size: 100%; min-width: 100%; position: relative" width="full">
<mjx-math aria-hidden="true" class="MJX-TEX" display="true" width="full"><mjx-mtable side="right" style="min-width: 100%; display: flex; justify-content: space-between; flex-flow: row nowrap">
<mjx-labels-partner style="flex: 1 0 0; max-width: 3.356em"></mjx-labels-partner><mjx-table style="flex: 0 0 15.327em"><mjx-itable width="full"><mjx-mlabeledtr><mjx-mtd style="text-align: right"><mjx-mfrac><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-msub><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c50"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c68"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c79"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-texatom><mjx-script style="vertical-align: -0.239em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-msub><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c50"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c68"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c79"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.239em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-msub><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c76"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c50"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c68"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c79"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.239em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-msub><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c76"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c50"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c68"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c79"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.239em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mfrac space="3"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-msub><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c76"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c52"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-msub><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c76"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c52"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mlabeledtr></mjx-itable></mjx-table>
<mjx-labels style="flex: 0 0 3.356em"><mjx-itable align="right" style=""><mjx-mtr style="height: 2.519em"><mjx-mtd id="mjx-eqn-10.2"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c28"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c29"></mjx-c></mjx-mtext><mjx-tstrut style="height: 2.519em; vertical-align: -1.07em"></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-labels>
</mjx-mtable>
</mjx-math>
<mjx-assistive-mml display="block" role="presentation" unselectable="on"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mlabeledtr><mtd><mtext>(10.2)</mtext></mtd><mtd><mfrac><msub>
<mrow><mi mathvariant="normal">p</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">x</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">y</mi><mi mathvariant="normal">s</mi></mrow>
<mi>x</mi></msub><msub>
<mrow>
<mrow><mi mathvariant="normal">p</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">x</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">y</mi><mi mathvariant="normal">s</mi></mrow>
</mrow><mi>y</mi></msub></mfrac><mo>=</mo><mfrac><msub>
<mrow>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">y</mi><mi mathvariant="normal">s</mi></mrow>
</mrow><mi>x</mi></msub><msub>
<mrow>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">y</mi><mi mathvariant="normal">s</mi></mrow>
</mrow><mi>y</mi></msub></mfrac><mo>&#8901;</mo><mfrac><msub>
<mrow>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">R</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi></mrow>
</mrow><mi>y</mi></msub><msub>
<mrow>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">R</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi></mrow>
</mrow><mi>x</mi></msub></mfrac><mo>.</mo></mtd></mlabeledtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<p class="NoIndent">
The notation <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c50"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c68"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c79"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi mathvariant="normal">p</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">x</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">y</mi><mi mathvariant="normal">s</mi></mrow>
</math></mjx-assistive-mml>
</mjx-container> refers to the physical size of a pixel, and
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c76"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c50"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c68"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c79"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">y</mi><mi mathvariant="normal">s</mi></mrow>
</math></mjx-assistive-mml>
</mjx-container> is the physical height and width of the device on which the image is
displayed.  For both quantities, the individual measurements may be unknown, but that's OK
because the ratio is all we need, and this usually is known.  For example, standard desktop
monitors come in all different sizes, but the viewable area on many older monitors has a ratio of
4:3, meaning it is 33%wider than it is tall. Another common ratio is 16:9 or
wider<a href="#footnote_7" class="FootnoteRef">7</a> on high-definition televisions.
The integers <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c76"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c52"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">R</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi></mrow>
<mi>x</mi></msub></math></mjx-assistive-mml>
</mjx-container>
and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c76"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c52"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">R</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi></mrow>
<mi>y</mi></msub></math></mjx-assistive-mml>
</mjx-container> are the number of pixels in the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></mjx-assistive-mml>
</mjx-container> dimensions. For example,
a resolution of <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c38"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1280</mn><mo>&#215;</mo><mn>720</mn></math></mjx-assistive-mml>
</mjx-container> means that <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c76"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c52"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c38"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">R</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi></mrow>
<mi>x</mi></msub><mo>=</mo><mn>1280</mn></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c76"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c52"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">R</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi></mrow>
<mi>y</mi></msub><mo>=</mo><mn>720</mn></math></mjx-assistive-mml>
</mjx-container>.
</p>
<p>
But, as mentioned already, we often deal with square pixels with an aspect ratio of 1:1. For
example, on a desktop monitor with a physical width:height ratio of 4:3, some common resolutions
resulting in square pixel ratios are <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c36"></mjx-c><mjx-c class="mjx-c34"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c34"></mjx-c><mjx-c class="mjx-c38"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>640</mn><mo>&#215;</mo><mn>480</mn></math></mjx-assistive-mml>
</mjx-container>, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c38"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c36"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>800</mn><mo>&#215;</mo><mn>600</mn></math></mjx-assistive-mml>
</mjx-container>, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c34"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c36"></mjx-c><mjx-c class="mjx-c38"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1024</mn><mo>&#215;</mo><mn>768</mn></math></mjx-assistive-mml>
</mjx-container>, and
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c36"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1600</mn><mo>&#215;</mo><mn>1200</mn></math></mjx-assistive-mml>
</mjx-container>. On 16:9 monitors, common resolutions are <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c38"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1280</mn><mo>&#215;</mo><mn>720</mn></math></mjx-assistive-mml>
</mjx-container>, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c36"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c39"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1600</mn><mo>&#215;</mo><mn>900</mn></math></mjx-assistive-mml>
</mjx-container>, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c39"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c38"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1920</mn><mo>&#215;</mo><mn>1080</mn></math></mjx-assistive-mml>
</mjx-container>. The aspect ratio 8:5 (more commonly known as 16:10) is also very
common, for desktop monitor sizes and televisions. Some common display resolutions that are 16:10
are <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1153</mn><mo>&#215;</mo><mn>720</mn></math></mjx-assistive-mml>
</mjx-container>, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c38"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c38"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1280</mn><mo>&#215;</mo><mn>800</mn></math></mjx-assistive-mml>
</mjx-container>, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c34"></mjx-c><mjx-c class="mjx-c34"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c39"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1440</mn><mo>&#215;</mo><mn>900</mn></math></mjx-assistive-mml>
</mjx-container>, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c36"></mjx-c><mjx-c class="mjx-c38"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1680</mn><mo>&#215;</mo><mn>1050</mn></math></mjx-assistive-mml>
</mjx-container>, and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c39"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1920</mn><mo>&#215;</mo><mn>1200</mn></math></mjx-assistive-mml>
</mjx-container>. In fact, on the PC, it's common to just assume a 1:1 pixel ratio, since obtaining the
dimensions of the display device might be impossible. Console games have it easier in this
respect.
</p>
<p>
Notice that nowhere in these calculations is the size or location of the <i>window</i> used; the
location and size of the rendering window has no bearing on the physical proportions of a pixel.
However, the size of the window will become important when we discuss field of view in
<a href="#field_of_view">Section&#160;10.2.4</a>, and the position is important when we map from camera space to screen
space <a href="#screen_space">Section&#160;10.3.5</a>.
</p>
<p>
At this point, some readers may be wondering how this discussion makes sense in the context of
rendering to a bitmap, where the word &#8220;physical&#8221; implied by the variable names
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c50"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c68"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c79"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi mathvariant="normal">p</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">x</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">y</mi><mi mathvariant="normal">s</mi></mrow>
</math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c76"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c50"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c68"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c79"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">y</mi><mi mathvariant="normal">s</mi></mrow>
</math></mjx-assistive-mml>
</mjx-container> doesn't apply.  In most of these situations,
it's appropriate simply to act as if the pixel aspect ratio is 1:1. In some special
circumstances, however, you may wish to render
    <i>anamorphically</i>, producing a squashed image in the bitmap that will later be stretched out
when the bitmap is used.
</p>
<h2 id="view_frustum"><span class="SectionNumber">10.2.3</span><span class="SectionTitle">The View Frustum</span></h2>
<p class="NoIndent">The <i>view frustum</i> is the volume of space that is potentially visible to the camera. It is
shaped like a pyramid with the tip snipped off. An example of a view frustum is shown in
<a href="#view_frustum">Figure&#160;10.3</a>.
</p>
<div id="view_frustum" class="Display Figure Narrow">
<div class="Body">
        <img src="figs/graphics/view_frustum.png" loading="lazy" width="448" height="324">
</div><span class="Caption"><span class="Label">Figure&#160;10.3</span><span class="CaptionText">The 3D view frustum</span>
</span>
</div><p>The view frustum is bounded by six planes, known as the <i>clip planes</i>.  The first four of
the planes form the sides of the pyramid and are called the top, left, bottom, and right planes,
for obvious reasons. They correspond to the sides of the output window.  The near and far clip
planes, which correspond to certain camera-space values of <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container>, require a bit more explanation.
</p>
<p>The reason for the far clip plane is perhaps easier to understand. It prevents rendering of
objects beyond a certain distance. There are two practical reasons why a far clip plane is
needed. The first is relatively easy to understand: a far clip plane can limit the number of
objects that need to be rendered in an outdoor environment.  The second reason is slightly more
complicated, but essentially it has to do with how the depth buffer values are assigned.  As an
example, if the
    depth buffer entries are 16-bit fixed point, then the largest depth value that can
be stored is 65,535.  The far clip establishes what (floating point) <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container> value in camera space
will correspond to the maximum value that can be stored in the depth buffer.  The motivation for
the near clip plane will have to wait until we discuss <i>clip space</i> in
<a href="#clip_space">Section&#160;10.3.2</a>.
</p>
<p>
Notice that each of the clipping planes are <i>planes</i>, with emphasis on the fact that they
extend infinitely.  The view volume is the intersection of the six half-spaces defined by the
clip planes.
</p>
<h2 id="field_of_view"><span class="SectionNumber">10.2.4</span><span class="SectionTitle">Field of View and Zoom</span></h2>
<p class="NoIndent">A camera has position and orientation, just like any other object in the world. However, it also
has an additional property known as <i>field of view</i>.  Another term you probably know is
<i>zoom</i>.  Intuitively, you already know what it means to &#8220;zoom in&#8221; and &#8220;zoom out.&#8221; When
you zoom in, the object you are looking at appears bigger on screen, and when you zoom out, the
apparent size of the object is smaller.  Let's see if we can develop this intuition into a more
precise definition.
</p>
<p>
The <i>field of view</i> (FOV) is the angle that is intercepted by the view frustum.  We actually
need two angles: a horizontal field of view, and a vertical field of view.  Let's drop back to 2D
briefly and consider just one of these angles. <a href="#field_of_view">Figure&#160;10.4</a> shows the view frustum
from above, illustrating precisely the angle that the horizontal field of view measures. The
labeling of the axes is illustrative of camera space, which is discussed in
<a href="#coordinate_spaces">Section&#160;10.3</a>.
</p>
<div id="field_of_view" class="Display Figure Narrow">
<div class="Body">
		<img class="WithFrame" src="figs/graphics/field_of_view.png" loading="lazy" width="350" height="400">
</div><span class="Caption"><span class="Label">Figure&#160;10.4</span><span class="CaptionText">Horizontal field of view</span>
</span>
</div><div id="zoom" class="Display Figure Narrow">
<div class="Body">
		<img class="WithFrame" src="figs/graphics/zoom.png" loading="lazy" width="350" height="400">
</div><span class="Caption"><span class="Label">Figure&#160;10.5</span><span class="CaptionText">Geometric interpretation of zoom</span>
</span>
</div>
<p>
<i>Zoom</i> measures the ratio of the apparent size of the object relative to a <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c39"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-TeXAtom texclass="ORD"><mjx-msup><mjx-mi class="mjx-n"></mjx-mi><mjx-script style="vertical-align: 0.363em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msup></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>90</mn>
<mrow><msup><mi></mi>
<mrow><mi mathvariant="normal">o</mi></mrow>
</msup></mrow>
</math></mjx-assistive-mml>
</mjx-container>
field of view. For example, a zoom of 2.0 means that object will appear twice as big on screen as
it would if we were using a <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c39"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-TeXAtom texclass="ORD"><mjx-msup><mjx-mi class="mjx-n"></mjx-mi><mjx-script style="vertical-align: 0.363em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msup></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>90</mn>
<mrow><msup><mi></mi>
<mrow><mi mathvariant="normal">o</mi></mrow>
</msup></mrow>
</math></mjx-assistive-mml>
</mjx-container> field of view.  So larger zoom values cause the image on
screen to become larger (&#8220;zoom in&#8221;), and smaller values for zoom cause the images on screen to
become smaller (&#8220;zoom out&#8221;).
</p>
<p>
Zoom can be interpreted geometrically as shown in <a href="#zoom">Figure&#160;10.5</a>.
Using some basic trig, we can derive the conversion between zoom and field of view:
</p>
<span class="InMarginAnchor"><span class="InMargin"><span class="EqMarginCaption">Converting between zoom and field of view</span></span></span><div class="DisplayMath">
<mjx-container class="MathJax" display="true" jax="CHTML" role="presentation" style="font-size: 100%; min-width: 100%; position: relative" width="full">
<mjx-math aria-hidden="true" class="MJX-TEX" display="true" width="full"><mjx-mtable side="right" style="min-width: 100%; display: flex; justify-content: space-between; flex-flow: row nowrap">
<mjx-labels-partner style="flex: 1 0 0; max-width: 3.356em"></mjx-labels-partner><mjx-table style="flex: 0 0 22.049em"><mjx-itable width="full"><mjx-mlabeledtr><mjx-mtd style="text-align: right; padding-right: 0"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c7A"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-texatom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-right: 1em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mrow><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mrow space="2"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c76"></mjx-c></mjx-mi></mjx-texatom><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-texatom><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding-left: 1em; padding-right: 0"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c76"></mjx-c></mjx-mi></mjx-texatom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mtext class="mjx-n"><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext><mjx-mi class="mjx-n" space="2"><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mrow space="2"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-texatom><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c7A"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mlabeledtr></mjx-itable></mjx-table>
<mjx-labels style="flex: 0 0 3.356em"><mjx-itable align="right" style=""><mjx-mtr style="height: 2.302em"><mjx-mtd id="mjx-eqn-10.3"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c28"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c33"></mjx-c><mjx-c class="mjx-c29"></mjx-c></mjx-mtext><mjx-tstrut style="height: 2.302em; vertical-align: -0.96em"></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-labels>
</mjx-mtable>
</mjx-math>
<mjx-assistive-mml display="block" role="presentation" unselectable="on"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mlabeledtr><mtd><mtext>(10.3)</mtext></mtd><mtd>
<mrow><mi mathvariant="normal">z</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi></mrow>
</mtd><mtd><mi></mi><mo>=</mo><mfrac><mn>1</mn>
<mrow><mi>tan</mi><mo data-mjx-texclass="NONE">&#8289;</mo>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo>
<mrow><mi mathvariant="normal">f</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">v</mi></mrow>
<mrow><mo>/</mo></mrow>
<mn>2</mn><mo data-mjx-texclass="CLOSE">)</mo></mrow>
</mrow></mfrac><mo>,</mo></mtd><mtd>
<mrow><mi mathvariant="normal">f</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">v</mi></mrow>
</mtd><mtd><mi></mi><mo>=</mo><mn>2</mn><mtext>&#160;</mtext><mi>arctan</mi><mo data-mjx-texclass="NONE">&#8289;</mo>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><mn>1</mn>
<mrow><mo>/</mo></mrow>
<mrow><mi mathvariant="normal">z</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi></mrow>
<mo data-mjx-texclass="CLOSE">)</mo></mrow>
<mo>.</mo></mtd></mlabeledtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<p>Notice the inverse relationship between zoom and field of view.  As zoom gets larger, the field
of view gets smaller, causing the view frustum to narrow.  It might not seem intuitive at first,
but when the view frustum gets more narrow, the perceived size of visible objects increases.
</p>
<p>
Field of view is a convenient measurement for humans to use, but as we discover in
<a href="#clip_space_scale">Section&#160;10.3.4</a>, zoom is the measurement that we need to feed into the graphics
pipeline.
</p>
<p>
We need <i>two</i> different field of view angles (or zoom values), one horizontal and one
vertical.  We are certainly free to choose any two arbitrary values we fancy, but if we do not
maintain a proper relationship between these values, then the rendered image will appear
stretched.
    If you've ever watched a movie intended for the wide screen that was simply squashed
anamorphically to fit on a regular TV, or watched content with a 4:3 aspect on a 16:9 TV in
&#8220;full&#8221;<a href="#footnote_8" class="FootnoteRef">8</a> mode, then you
have seen this effect.
</p>
<p>
In order to maintain proper proportions, the zoom values must be inversely proportional to the
physical dimensions of the output window:
</p>
<span class="InMarginAnchor">
<span class="InMargin"><span class="EqMarginCaption">The usual relationship between vertical and horizontal zoom</span>
</span>
</span><div class="DisplayMath">
<mjx-container class="MathJax" display="true" jax="CHTML" role="presentation" style="font-size: 100%; min-width: 100%; position: relative" width="full">
<mjx-math aria-hidden="true" class="MJX-TEX" display="true" width="full"><mjx-mtable side="right" style="min-width: 100%; display: flex; justify-content: space-between; flex-flow: row nowrap">
<mjx-labels-partner style="flex: 1 0 0; max-width: 3.356em"></mjx-labels-partner><mjx-table style="flex: 0 0 19.346em"><mjx-itable width="full"><mjx-mlabeledtr><mjx-mtd><mjx-mfrac><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-msub><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c7A"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-msub><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c7A"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-msub><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c77"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c50"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c68"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c79"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-texatom><mjx-script style="vertical-align: -0.239em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-msub><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c77"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c50"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c68"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c79"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-texatom><mjx-script style="vertical-align: -0.239em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mtext class="mjx-n" space="4"><mjx-c class="mjx-c77"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c77"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c73"></mjx-c><mjx-c class="mjx-c70"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c6F"></mjx-c></mjx-mtext><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mlabeledtr></mjx-itable></mjx-table>
<mjx-labels style="flex: 0 0 3.356em"><mjx-itable align="right" style=""><mjx-mtr style="height: 2.471em"><mjx-mtd id="mjx-eqn-10.4"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c28"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c34"></mjx-c><mjx-c class="mjx-c29"></mjx-c></mjx-mtext><mjx-tstrut style="height: 2.471em; vertical-align: -1.07em"></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-labels>
</mjx-mtable>
</mjx-math>
<mjx-assistive-mml display="block" role="presentation" unselectable="on"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mtable displaystyle="true"><mlabeledtr><mtd><mtext>(10.4)</mtext></mtd><mtd><mfrac><msub>
<mrow><mi mathvariant="normal">z</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi></mrow>
<mi>y</mi></msub><msub>
<mrow><mi mathvariant="normal">z</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi></mrow>
<mi>x</mi></msub></mfrac><mo>=</mo><mfrac><msub>
<mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">y</mi><mi mathvariant="normal">s</mi></mrow>
<mi>x</mi></msub><msub>
<mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">y</mi><mi mathvariant="normal">s</mi></mrow>
<mi>y</mi></msub></mfrac><mo>=</mo><mtext>window aspect ratio</mtext><mo>.</mo></mtd></mlabeledtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<p class="NoIndent">
The variable <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c77"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c50"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c68"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c79"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">y</mi><mi mathvariant="normal">s</mi></mrow>
</math></mjx-assistive-mml>
</mjx-container> refers to the physical size of the output window. As
indicated in <a href="#zoom_aspect_ratio_relationship">Equation&#160;(10.4)</a>, even though we don't usually know the
actual size of the render window, we can determine its aspect ratio.  But how do we do this?
Usually, all we know is the <i>resolution</i> (number of pixels) of the output window.
    Here's where the pixel aspect ratio calculations from <a href="#pixel_aspect_ratio">Section&#160;10.2.2</a> come in:
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" display="true" jax="CHTML" role="presentation" style="font-size: 100%; min-width: 100%; position: relative" width="full">
<mjx-math aria-hidden="true" class="MJX-TEX" display="true" width="full"><mjx-mtable side="right" style="min-width: 100%; display: flex; justify-content: space-between; flex-flow: row nowrap">
<mjx-labels-partner style="flex: 1 0 0; max-width: 3.356em"></mjx-labels-partner><mjx-table style="flex: 0 0 24.773em"><mjx-itable width="full"><mjx-mlabeledtr><mjx-mtd style="text-align: right"><mjx-mtable justify="right" style="min-width: 24.773em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-bottom: 0.15em"><mjx-mfrac><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-msub><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c7A"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-msub><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c7A"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-msub><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c77"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c50"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c68"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c79"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.239em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-msub><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c77"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c50"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c68"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c79"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.239em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-msub><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c77"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c52"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-msub><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c77"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c52"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mfrac space="3"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-msub><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c50"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c68"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c79"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.239em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-msub><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c50"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c68"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c79"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.239em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-texatom texclass="ORD"><mjx-msub><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c77"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c52"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-texatom></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-msub><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c77"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c52"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mfrac space="3"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-texatom texclass="ORD"><mjx-msub><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c76"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c50"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c68"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c79"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-texatom><mjx-script style="vertical-align: -0.239em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-texatom></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-msub><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c76"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c50"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c68"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c79"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.239em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mfrac space="3"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-msub><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c76"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c52"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-msub><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c76"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c52"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mlabeledtr></mjx-itable></mjx-table>
<mjx-labels style="flex: 0 0 3.356em"><mjx-itable align="right" style=""><mjx-mtr style="height: 5.291em"><mjx-mtd id="mjx-eqn-10.5"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c28"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c29"></mjx-c></mjx-mtext><mjx-tstrut style="height: 5.291em; vertical-align: -2.395em"></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-labels>
</mjx-mtable>
</mjx-math>
<mjx-assistive-mml display="block" role="presentation" unselectable="on"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mlabeledtr><mtd><mtext>(10.5)</mtext></mtd><mtd><mtable columnalign="right left" columnspacing="0em" displaystyle="true" rowspacing="3pt"><mtr><mtd><mfrac><msub>
<mrow><mi mathvariant="normal">z</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi></mrow>
<mi>y</mi></msub><msub>
<mrow><mi mathvariant="normal">z</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi></mrow>
<mi>x</mi></msub></mfrac><mo>=</mo><mfrac><msub>
<mrow>
<mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">y</mi><mi mathvariant="normal">s</mi></mrow>
</mrow><mi>x</mi></msub><msub>
<mrow>
<mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">y</mi><mi mathvariant="normal">s</mi></mrow>
</mrow><mi>y</mi></msub></mfrac></mtd><mtd><mi></mi><mo>=</mo><mfrac><msub>
<mrow>
<mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">R</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi></mrow>
</mrow><mi>x</mi></msub><msub>
<mrow>
<mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">R</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi></mrow>
</mrow><mi>y</mi></msub></mfrac><mo>&#8901;</mo><mfrac><msub>
<mrow>
<mrow><mi mathvariant="normal">p</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">x</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">y</mi><mi mathvariant="normal">s</mi></mrow>
</mrow><mi>x</mi></msub><msub>
<mrow>
<mrow><mi mathvariant="normal">p</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">x</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">y</mi><mi mathvariant="normal">s</mi></mrow>
</mrow><mi>y</mi></msub></mfrac></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mfrac>
<mrow><msub>
<mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">R</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi></mrow>
<mi>x</mi></msub></mrow>
<msub>
<mrow>
<mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">R</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi></mrow>
</mrow><mi>y</mi></msub></mfrac><mo>&#8901;</mo><mfrac>
<mrow><msub>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">y</mi><mi mathvariant="normal">s</mi></mrow>
<mi>x</mi></msub></mrow>
<msub>
<mrow>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">y</mi><mi mathvariant="normal">s</mi></mrow>
</mrow><mi>y</mi></msub></mfrac><mo>&#8901;</mo><mfrac><msub>
<mrow>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">R</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi></mrow>
</mrow><mi>y</mi></msub><msub>
<mrow>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">R</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi></mrow>
</mrow><mi>x</mi></msub></mfrac><mo>.</mo></mtd></mtr></mtable></mtd></mlabeledtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<p class="NoIndent">
In this formula,
</p>
<ul>
    <li>
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c7A"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi mathvariant="normal">z</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi></mrow>
</math></mjx-assistive-mml>
</mjx-container> refers to the camera's zoom values,
</li>
<li>
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c77"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c50"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c68"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c79"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">y</mi><mi mathvariant="normal">s</mi></mrow>
</math></mjx-assistive-mml>
</mjx-container> refers to the physical window size,
</li>
<li>
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c77"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c52"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">R</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi></mrow>
</math></mjx-assistive-mml>
</mjx-container> refers to the resolution of the window, in pixels,
</li>
<li>
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c50"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c68"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c79"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi mathvariant="normal">p</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">x</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">y</mi><mi mathvariant="normal">s</mi></mrow>
</math></mjx-assistive-mml>
</mjx-container> refers to the physical dimensions of a pixel,
</li>
<li>
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c76"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c50"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c68"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c79"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">y</mi><mi mathvariant="normal">s</mi></mrow>
</math></mjx-assistive-mml>
</mjx-container> refers to the physical dimensions of the output device.  Remember
        that we usually don't know the individual sizes, but we do know the ratio,
</li>
<li>
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c76"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c52"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">R</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi></mrow>
</math></mjx-assistive-mml>
</mjx-container> refers to the resolution of the output device.
</li>
</ul>
<p>
Many rendering packages allow you to specify only one field of view angle (or zoom value).  When
you do this, they automatically compute the other value for you, assuming you want uniform
display proportions.  For example, you may specify the horizontal field of view, and they compute
the vertical field of view for you.
</p>
<p>
Now that we know how to describe zoom in a manner suitable for consumption by a computer, what do
we do with these zoom values? They go into the <i>clip matrix</i>, which is described in
<a href="#clip_space_scale">Section&#160;10.3.4</a>.
</p>
<h2 id="orthographic_projection"><span class="SectionNumber">10.2.5</span><span class="SectionTitle">Orthographic Projection</span></h2>
<p class="NoIndent">The discussion so far has centered on perspective projection,
which is the most commonly used type of projection, since that's how our eyes perceive the world.
However, in many situations <i>orthographic projection</i> is also useful.  We introduced
orthographic projection in <a href="matrixtransforms.html#orthographic_projection">Section&#160;5.3</a>; to briefly
review, in orthographic projection, the lines of projection (the lines that connect all the
points in space that project onto the same screen coordinates) are parallel, rather than
intersecting at a single point. There is no perspective foreshortening in orthographic
projection; an object will appear the same size on the screen no matter how far away it is, and
moving the camera forward or backward along the viewing direction has <i>no apparent effect</i>
so long as the objects remain in front of the near clip plane.
</p>
<p><a href="#perspective_vs_ortho_projection">Figure&#160;10.6</a> shows a scene rendered from the same position and
orientation, comparing perspective and orthographic projection.  On the left, notice that with
perspective projection, parallel lines do not remain parallel, and the closer grid squares are
larger than the ones in the distance.  Under orthographic projection, the grid squares are all
the same size and the grid lines remain parallel.
</p>
<div id="perspective_vs_ortho_projection" class="Display Figure Wide">
<div class="Body">
    <table>
<tr>
<td class="AlignCenter"><img src="figs/graphics/projection_robot_kitchen_perspective.png" loading="lazy" width="400" height="300">
</td>
<td class="AlignCenter"><img src="figs/graphics/projection_robot_kitchen_ortho.png" loading="lazy" width="400" height="300">
</td>
</tr>
<tr>
<td class="AlignCenter"><span class="FontSmall">Perspective projection</span></td>
<td class="AlignCenter"><span class="FontSmall">Orthographic projection</span></td>
</tr>
</table>
</div><span class="Caption"><span class="Label">Figure&#160;10.6</span><span class="CaptionText">Perspective versus orthographic projection</span>
</span>
</div><p>
Orthographic views are very useful for &#8220;schematic&#8221; views and other situations where distances
and angles need to be measured precisely. Every modeling tool will support such a view.  In a
video game, you might use an orthographic view to render a map or some other HUD element.
</p>
<p>For an orthographic projection, it makes no sense to speak of the &#8220;field of view&#8221; as an angle,
since the view frustum is shaped like a box, not a pyramid.  Rather than defining the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></mjx-assistive-mml>
</mjx-container>
dimensions of the view frustum in terms of two angles, we give two sizes: the physical width and
height of the box.
</p>
<p>The zoom value has a different meaning in orthographic projection compared to perspective.  It is
related to the physical size of the frustum box:
</p>
<span class="InMarginAnchor">
<span class="InMargin"><span class="EqMarginCaption">Converting between zoom and frustum size in orthographic projection</span>
</span>
</span><div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mtable style="min-width: 14.897em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c7A"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c7A"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-right: 1em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding-left: 1em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c7A"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c7A"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" rowspacing="3pt"><mtr><mtd>
<mrow><mi mathvariant="normal">z</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi></mrow>
<mo>=</mo><mn>2</mn>
<mrow><mo>/</mo></mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">z</mi><mi mathvariant="normal">e</mi></mrow>
<mo>,</mo></mtd><mtd></mtd><mtd>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">z</mi><mi mathvariant="normal">e</mi></mrow>
<mo>=</mo><mn>2</mn>
<mrow><mo>/</mo></mrow>
<mrow><mi mathvariant="normal">z</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi></mrow>
<mo>.</mo></mtd></mtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<p>
As with perspective projections, there are <i>two</i> different zoom values, one for <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml>
</mjx-container> and one
for <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></mjx-assistive-mml>
</mjx-container>, and their ratio must be coordinated with the aspect ratio of the rendering window in order
to avoid producing a &#8220;squashed&#8221; image.  We developed
<a href="#zoom_and_aspect_relationship_expanded">Equation&#160;(10.5)</a> with perspective projection in mind, but this
formula also governs the proper relationship for orthographic projection.
</p>

<h1 id="coordinate_spaces"><span class="SectionNumber">10.3</span><span class="SectionTitle">Coordinate Spaces</span></h1>
<p class="NoIndent">
This section reviews several important coordinate spaces related to 3D viewing. Unfortunately,
terminology is not consistent in the literature on the subject, even though the concepts are.
Here, we discuss the coordinate spaces in the order they are encountered as geometry flows
through the graphics pipeline.
</p>
<h2 id="object_world_camera_space"><span class="SectionNumber">10.3.1</span><span class="SectionTitle">Model, World, and Camera Space</span></h2>
<p class="NoIndent">The geometry of an object is initially described in object space, which is a coordinate space
local to the object being described (see <a href="multiplespaces.html#object_space">Section&#160;3.2.2</a>).  The
information described usually consists of vertex positions and surface normals.  Object space is
also known as <i>local space</i> and, especially in the context of graphics, <i>model space</i>.
</p>
<p>From model space, the vertices are transformed into world space (see
<a href="multiplespaces.html#world_space">Section&#160;3.2.1</a>).  The transformation from modeling space to world
space is often called the <i>model transform</i>. Typically, lighting for the scene is specified
in world space, although, as we see in <a href="#hlsl_examples">Section&#160;10.11</a>, it doesn't really matter what
coordinate space is used to perform the lighting calculations provided that the geometry and the
lights can be expressed in the same space.
</p>
<p>From world space, vertices are transformed by the <i>view transform</i> into <i>camera space</i>
(see <a href="multiplespaces.html#camera">Section&#160;3.2.3</a>), also known as <i>eye space</i> and <i>view space</i>
(not to be confused with canonical view volume space, discussed later). Camera space is a 3D
coordinate space in which the origin is at the center of projection, one is axis parallel to the
direction the camera is facing (perpendicular to the projection plane), one axis is the
intersection of the top and bottom clip planes, and the other axis is the intersection of the
left and right clip planes. If we assume the perspective of the camera, then one axis will be
&#8220;horizontal&#8221; and one will be &#8220;vertical.&#8221;
</p>
<p>
In a left-handed world, the most common convention is to point <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>+</mo><mi>z</mi></math></mjx-assistive-mml>
</mjx-container> in the direction that the
camera is facing, with <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>+</mo><mi>x</mi></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>+</mo><mi>y</mi></math></mjx-assistive-mml>
</mjx-container> pointing &#8220;right&#8221; and &#8220;up&#8221; (again, from the perspective
from the camera). This is fairly intuitive, as shown in <a href="#camera_space">Figure&#160;10.7</a>.  The typical
right-handed convention is to have <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>&#8722;</mo><mi>z</mi></math></mjx-assistive-mml>
</mjx-container> point in the direction that the camera is facing.  We
assume the left-handed conventions for the remainder of this chapter
</p>
<div id="camera_space" class="Display Figure Narrow">
<div class="Body">
    <img class="WithFrame" src="figs/multiplespaces/camera_space.png" loading="lazy" width="358" height="351">
</div><span class="Caption">
<span class="Label">Figure&#160;10.7</span><span class="CaptionText">Typical camera-space conventions for left-handed coordinate systems</span>
</span>
</div><h2 id="clip_space"><span class="SectionNumber">10.3.2</span><span class="SectionTitle">Clip Space and the Clip Matrix</span></h2>
<p class="NoIndent">From camera space, vertices are transformed once again into <i>clip space</i>, also known as the
<i>canonical view volume space</i>.  The matrix that transforms vertices from camera space into
clip space is called the <i>clip matrix</i>, also known as the <i>projection matrix</i>.
</p>
<p>
Up until now, our vertex positions have been &#8220;pure&#8221; 3D vectors&#8212;that is, they only had three
coordinates, or if they have a fourth coordinate, then <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></mjx-assistive-mml>
</mjx-container> was always equal to 1 for position
vectors and 0 for direction vectors such as surface normals. (In some special situations, we
might use more exotic transforms, but most basic transforms are 3D affine transformations.)  The
clip matrix, however, puts meaningful information into <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></mjx-assistive-mml>
</mjx-container>. The clip matrix serves two primary
functions:
</p>
<ul>
    <li>
<span class="ListItemTitle">Prepare for projection.</span>  We put the proper value into <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></mjx-assistive-mml>
</mjx-container> so that the homogeneous
        division produces the desired projection.  For the typical perspective projection, this means
        we copy <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container> into <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></mjx-assistive-mml>
</mjx-container>.  We talk about this in <a href="#clip_space_projection">Section&#160;10.3.3</a>.
</li>
<li>
<span class="ListItemTitle">Apply zoom and prepare for clipping.</span>  We scale <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml>
</mjx-container>, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></mjx-assistive-mml>
</mjx-container>, and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container> so that
        they can be compared against <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></mjx-assistive-mml>
</mjx-container> for clipping.  This scaling takes the camera's zoom
        values into consideration, since those zoom values affect the shape of the view
        frustum against which clipping occurs.  This is discussed in
        <a href="#clip_space_scale">Section&#160;10.3.4</a>.
</li>
</ul>
<h2 id="clip_space_projection"><span class="SectionNumber">10.3.3</span><span class="SectionTitle">The Clip Matrix: Preparing for Projection</span></h2>
<p class="NoIndent">Recall from <a href="matrixmore.html#4d_homogeneous_space">Section&#160;6.4.1</a> that a 4D&#160;homogeneous vector is mapped
to the corresponding physical 3D&#160;vector by dividing by <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></mjx-assistive-mml>
</mjx-container>:
</p>
<span class="InMarginAnchor"><span class="InMargin"><span class="EqMarginCaption">Converting 4D homogeneous coordinates to 3D</span></span></span><div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mrow><mjx-mo class="mjx-n"><mjx-stretchy-v style="height: 5.2em; vertical-align: -2.35em" class="mjx-c5B"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style="min-width: 0.716em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-bottom: 0.2em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-top: 0.2em; padding-bottom: 0.2em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-top: 0.2em; padding-bottom: 0.2em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-top: 0.2em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-n"><mjx-stretchy-v style="height: 5.2em; vertical-align: -2.35em" class="mjx-c5D"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow></mjx-TeXAtom><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c27F9"></mjx-c></mjx-mo><mjx-TeXAtom space="4" texclass="ORD"><mjx-mrow><mjx-mo class="mjx-n"><mjx-stretchy-v style="height: 3.8em; vertical-align: -1.65em" class="mjx-c5B"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style="min-width: 1.788em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-bottom: 0.2em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-top: 0.2em; padding-bottom: 0.2em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-top: 0.2em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-n"><mjx-stretchy-v style="height: 3.8em; vertical-align: -1.65em" class="mjx-c5D"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
<mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mtable columnspacing="1em" rowspacing="4pt"><mtr><mtd>
<mrow><mi>x</mi></mrow>
</mtd></mtr><mtr><mtd>
<mrow><mi>y</mi></mrow>
</mtd></mtr><mtr><mtd>
<mrow><mi>z</mi></mrow>
</mtd></mtr><mtr><mtd>
<mrow><mi>w</mi></mrow>
</mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">]</mo></mrow>
</mrow><mo stretchy="false">&#10233;</mo>
<mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mtable columnspacing="1em" rowspacing="4pt"><mtr><mtd>
<mrow><mi>x</mi>
<mrow><mo>/</mo></mrow>
<mi>w</mi></mrow>
</mtd></mtr><mtr><mtd>
<mrow><mi>y</mi>
<mrow><mo>/</mo></mrow>
<mi>w</mi></mrow>
</mtd></mtr><mtr><mtd>
<mrow><mi>z</mi>
<mrow><mo>/</mo></mrow>
<mi>w</mi></mrow>
</mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">]</mo></mrow>
</mrow><mo>.</mo></math></mjx-assistive-mml>
</mjx-container>
</div>
<p class="NoIndent">
The first goal of the clip matrix is to get the correct value into <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></mjx-assistive-mml>
</mjx-container> such that this division
causes the desired projection (perspective or orthographic).  That's the reason this matrix is
sometimes called the projection matrix, although this term is a bit misleading&#8212;the projection
doesn't take place during the multiplication by this matrix, it happens when we divide <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml>
</mjx-container>, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></mjx-assistive-mml>
</mjx-container>,
and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container> by <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></mjx-assistive-mml>
</mjx-container>.
</p>
<p>If this was the only purpose of the clip matrix, to place the correct value into <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></mjx-assistive-mml>
</mjx-container>, the clip
matrix for perspective projection would simply be
</p>
<span class="InMarginAnchor">
<span class="InMargin"><span class="EqMarginCaption">A trivial matrix for setting <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-b mjx-i"><mjx-c class="mjx-c1D498 TEX-BI"></mjx-c></mjx-mi><mjx-mo class="mjx-b" space="4"><mjx-c class="mjx-c3D TEX-B"></mjx-c></mjx-mo><mjx-mi class="mjx-b mjx-i" space="4"><mjx-c class="mjx-c1D49B TEX-BI"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold-italic">w</mi><mo mathvariant="bold">=</mo><mi mathvariant="bold-italic">z</mi></math></mjx-assistive-mml>
</mjx-container>, for perspective projection</span>
</span>
</span><div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mrow><mjx-mo class="mjx-n"><mjx-stretchy-v style="height: 5.2em; vertical-align: -2.35em" class="mjx-c5B"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style="min-width: 5em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-n"><mjx-stretchy-v style="height: 5.2em; vertical-align: -2.35em" class="mjx-c5D"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mtable columnspacing="1em" rowspacing="4pt"><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">]</mo></mrow>
<mo>.</mo></math></mjx-assistive-mml>
</mjx-container>
</div>
<p class="NoIndent"> Multiplying a vector of the form <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container> by this matrix, and then performing the homogeneous
division by <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></mjx-assistive-mml>
</mjx-container>, we get
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mtable style="min-width: 5.027em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-right: 0.5em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em"><mjx-TeXAtom texclass="ORD"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-mrow></mjx-TeXAtom><mjx-mrow><mjx-mo class="mjx-n"><mjx-stretchy-v style="height: 5.2em; vertical-align: -2.35em" class="mjx-c5B"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style="min-width: 5em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-n"><mjx-stretchy-v style="height: 5.2em; vertical-align: -2.35em" class="mjx-c5D"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-TeXAtom space="4" texclass="ORD"><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mtable style="min-width: 4.992em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-right: 0.5em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-mrow></mjx-TeXAtom><mjx-mstyle><mjx-mspace style="width: 1em"></mjx-mspace></mjx-mstyle><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c27F9"></mjx-c></mjx-mo><mjx-mstyle space="4"><mjx-mspace style="width: 1em"></mjx-mspace></mjx-mstyle><mjx-TeXAtom texclass="ORD"><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mtable style="min-width: 5.492em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-right: 0.5em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em"><mjx-TeXAtom texclass="ORD"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-mrow></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
<mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mtable columnspacing="1em" rowspacing="4pt"><mtr><mtd>
<mrow><mi>x</mi></mrow>
</mtd><mtd>
<mrow><mi>y</mi></mrow>
</mtd><mtd>
<mrow><mi>z</mi></mrow>
</mtd><mtd>
<mrow><mn>1</mn></mrow>
</mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">]</mo></mrow>
</mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mtable columnspacing="1em" rowspacing="4pt"><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">]</mo></mrow>
<mo>=</mo>
<mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mtable columnspacing="1em" rowspacing="4pt"><mtr><mtd>
<mrow><mi>x</mi></mrow>
</mtd><mtd>
<mrow><mi>y</mi></mrow>
</mtd><mtd>
<mrow><mi>z</mi></mrow>
</mtd><mtd>
<mrow><mi>z</mi></mrow>
</mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">]</mo></mrow>
</mrow><mstyle scriptlevel="0"><mspace width="1em"></mspace></mstyle><mo stretchy="false">&#10233;</mo><mstyle scriptlevel="0"><mspace width="1em"></mspace></mstyle>
<mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mtable columnspacing="1em" rowspacing="4pt"><mtr><mtd>
<mrow><mi>x</mi>
<mrow><mo>/</mo></mrow>
<mi>z</mi></mrow>
</mtd><mtd>
<mrow><mi>y</mi>
<mrow><mo>/</mo></mrow>
<mi>z</mi></mrow>
</mtd><mtd>
<mrow><mn>1</mn></mrow>
</mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">]</mo></mrow>
</mrow><mo>.</mo></math></mjx-assistive-mml>
</mjx-container>
</div><p>At this point, many readers might very reasonably ask two questions. The first question might be,
&#8220;Why is this so complicated?  This seems like a lot of work to accomplish what basically amounts
to just dividing by <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container>.&#8221;  You're right.  In many old school software rasterizers, where the
projection math was hand-coded, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></mjx-assistive-mml>
</mjx-container> didn't appear anywhere, and there was just an explicit divide
by <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container>.  So why do we tolerate all this complication?  One reason for homogeneous coordinates is
that they can represent a wider range of camera specifications naturally.  At the end of this
section we'll see how orthographic projections can be handled easily, without the
&#8220;<span class="inlinecode">if</span> statement&#8221; that was necessary in the old hand-coded systems. But there are
other types of projections that are also useful and are handled naturally in this framework.  For
example, the frustum planes do not need to be symmetric about the viewing direction, which
corresponds to the situation where your view direction does not look through the center of the
window.  This is useful, for example, when rendering a very high resolution image in smaller
blocks, or for seamless dynamic splitting and merging of split screen views.
Another advantage of using homogeneous coordinates is that they make <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container>-clipping (against the
near and far clipping planes) identical to <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml>
</mjx-container>- and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></mjx-assistive-mml>
</mjx-container>-clipping. This similarity makes things
nice and tidy, but, more important, on some hardware the vector unit can be exploited to perform
clipping comparison tests in parallel. In general, the use of homogeneous coordinates and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c34"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c34"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>4</mn><mo>&#215;</mo><mn>4</mn></math></mjx-assistive-mml>
</mjx-container> matrices makes things more compact and general purpose, and (in some peoples' minds)
more elegant. But regardless of whether the use of <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c34"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c34"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>4</mn><mo>&#215;</mo><mn>4</mn></math></mjx-assistive-mml>
</mjx-container> matrices improves the
process, it's the way most APIs want things delivered, so that's the way it works, for better or
worse.
</p>
<p>
The second question a reader might have is, &#8220;What happened to <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></mjx-assistive-mml>
</mjx-container>?&#8221;  Remember that <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></mjx-assistive-mml>
</mjx-container> is the
    <i>focal distance</i>, the distance from the projection plane to the center of projection (the
&#8220;focal point&#8221;). Our discussion of perspective projection via homogeneous division in
<a href="matrixmore.html#perspective_projection">Section&#160;6.5</a> described how to project onto a plane
perpendicular to the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container>-axis and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></mjx-assistive-mml>
</mjx-container> units away from the origin. (The plane is of the form <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi><mo>=</mo><mi>d</mi></math></mjx-assistive-mml>
</mjx-container>.)  But we didn't use <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></mjx-assistive-mml>
</mjx-container> anywhere in the above discussion. As it turns out, the value we use
for <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></mjx-assistive-mml>
</mjx-container> isn't important, and so we choose the most convenient value possible for <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></mjx-assistive-mml>
</mjx-container>, which is&#160;1.
</p>
<p>
To understand why <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></mjx-assistive-mml>
</mjx-container> doesn't matter, let's compare the projection that occurs in a computer to
the projection that occurs in a physical camera.  Inside a real camera, increasing this distance
causes the camera to zoom in (objects appear bigger), and decreasing it zooms out (objects appear
smaller). This is shown in <a href="#perspective_projection_different_values_for_d">Figure&#160;10.8</a>.
</p>
<div id="perspective_projection_different_values_for_d" class="Display Figure Wide">
<div class="Body">
		<img class="WithFrame" src="figs/graphics/perspective_projection_different_values_for_d.png" loading="lazy" width="562" height="287">
</div><span class="Caption">
<span class="Label">Figure&#160;10.8</span><span class="CaptionText">
In a physical camera, increasing the
focal distance <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></mjx-assistive-mml>
</mjx-container> while keeping the size of the &#8220;film&#8221; the same has the effect of zooming in.
</span>
</span>
</div><p>
The vertical line on the left side of each diagram represents the film (or, for modern cameras,
the sensing element), which lies in the infinite plane of projection.  Importantly, notice that
the film is the same height in each diagram. As we increase <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></mjx-assistive-mml>
</mjx-container>, the film moves further away from
the focal plane, and the field of view angle intercepted by the view frustum decreases. As the
view frustum gets smaller, an object inside this frustum takes a larger proportion of the visible
volume, and thus appears larger in the projected image.  The perceived result is that we are
zooming in.  The key point here is that changing the focal length causes an object to appear
bigger because the projected image is larger <i>relative to the size of the</i> <i>film</i>.
</p>
<p>
Now let's look at what happens inside a computer.  The &#8220;film&#8221; inside a computer is the
rectangular portion of the projection plane that intersects the view frustum.<a href="#footnote_9" class="FootnoteRef">9</a>  Notice that if we increase the focal
distance, the size of the projected image increases, just like it did in a real camera.  However,
inside a computer, the film actually increases by this same proportion, rather than the view
frustum changing in size. Because the projected image and the film increase by the same
proportion, there is no change to the rendered image or the apparent size of objects within thisimage.
</p>
<p>In summary, zoom is always accomplished by changing the shape of the view frustum, whether we're
talking about a real camera or inside a computer.  In a real camera, changing the focal length
changes the shape of the view frustum because the film stays the same size.  However, in a
computer, adjusting the focal distance <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></mjx-assistive-mml>
</mjx-container> does not affect the rendered image, since the &#8220;film&#8221;
increases in size and the shape of the view frustum does not change.
</p>
<p>
Some software allow the user to specify the field of view by giving a focal length measured in
millimeters.  These numbers are in reference to some standard film size, almost always 35&#160;mm
film.
</p>
<p>What about orthographic projection?  In this case, we do <i>not</i> want to divide by <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container>, so our
clip matrix will have a right-hand column of <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo><mjx-script style="vertical-align: 0.363em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c54"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><msup><mo stretchy="false">]</mo>
<mrow><mi mathvariant="normal">T</mi></mrow>
</msup></math></mjx-assistive-mml>
</mjx-container>, the same as the identity matrix. When
multiplied by a vector of the form <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container>, this will result in a vector with <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c31"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi><mo>=</mo><mn>1</mn></math></mjx-assistive-mml>
</mjx-container>, rather
than <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi><mo>=</mo><mi>z</mi></math></mjx-assistive-mml>
</mjx-container>.  The homogeneous division still occurs, but this time we are dividingby 1:
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mtable style="min-width: 5.027em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-right: 0.5em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em"><mjx-TeXAtom texclass="ORD"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-mrow></mjx-TeXAtom><mjx-mrow><mjx-mo class="mjx-n"><mjx-stretchy-v style="height: 5.2em; vertical-align: -2.35em" class="mjx-c5B"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style="min-width: 5em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-n"><mjx-stretchy-v style="height: 5.2em; vertical-align: -2.35em" class="mjx-c5D"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-TeXAtom space="4" texclass="ORD"><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mtable style="min-width: 5.027em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-right: 0.5em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em"><mjx-TeXAtom texclass="ORD"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-mrow></mjx-TeXAtom><mjx-mstyle><mjx-mspace style="width: 1em"></mjx-mspace></mjx-mstyle><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c27F9"></mjx-c></mjx-mo><mjx-mstyle space="4"><mjx-mspace style="width: 1em"></mjx-mspace></mjx-mstyle><mjx-TeXAtom texclass="ORD"><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mtable style="min-width: 3.527em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-right: 0.5em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-mrow></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
<mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mtable columnspacing="1em" rowspacing="4pt"><mtr><mtd>
<mrow><mi>x</mi></mrow>
</mtd><mtd>
<mrow><mi>y</mi></mrow>
</mtd><mtd>
<mrow><mi>z</mi></mrow>
</mtd><mtd>
<mrow><mn>1</mn></mrow>
</mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">]</mo></mrow>
</mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mtable columnspacing="1em" rowspacing="4pt"><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">]</mo></mrow>
<mo>=</mo>
<mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mtable columnspacing="1em" rowspacing="4pt"><mtr><mtd>
<mrow><mi>x</mi></mrow>
</mtd><mtd>
<mrow><mi>y</mi></mrow>
</mtd><mtd>
<mrow><mi>z</mi></mrow>
</mtd><mtd>
<mrow><mn>1</mn></mrow>
</mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">]</mo></mrow>
</mrow><mstyle scriptlevel="0"><mspace width="1em"></mspace></mstyle><mo stretchy="false">&#10233;</mo><mstyle scriptlevel="0"><mspace width="1em"></mspace></mstyle>
<mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mtable columnspacing="1em" rowspacing="4pt"><mtr><mtd>
<mrow><mi>x</mi></mrow>
</mtd><mtd>
<mrow><mi>y</mi></mrow>
</mtd><mtd>
<mrow><mi>z</mi></mrow>
</mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">]</mo></mrow>
</mrow><mo>.</mo></math></mjx-assistive-mml>
</mjx-container>
</div><p>
The next section fills in the rest of the clip matrix.  But for now, the key point is that a
perspective projection matrix will always have a right-hand column of <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container>, and a
orthographic projection matrix will always have a right-hand column of <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container>. Here, the
word &#8220;always&#8221; means &#8220;we've never seen anything else.&#8221;  You might come across some obscure
case on some particular hardware for which other values are needed, and it is important to
understand that 1 isn't a magic number here, it is just the simplest number.  Since the
homogeneous conversion is a division, what is important is the <i>ratio</i> of the coordinates,
not their magnitude.
</p>
<p>
Notice that multiplying the entire matrix by a constant factor doesn't have
any effect on the projected values <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi>
<mrow><mo>/</mo></mrow>
<mi>w</mi></math></mjx-assistive-mml>
</mjx-container>, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi>
<mrow><mo>/</mo></mrow>
<mi>w</mi></math></mjx-assistive-mml>
</mjx-container>, and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi>
<mrow><mo>/</mo></mrow>
<mi>w</mi></math></mjx-assistive-mml>
</mjx-container>, but it will adjust the value of <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></mjx-assistive-mml>
</mjx-container>,
which is used for perspective correct rasterization. So a different value might be necessary for
some reason.  Then again, certain hardware (such as the
    Wii) assume that these are the only two cases, and no other right-hand column is allowed.
</p>
<h2 id="clip_space_scale"><span class="SectionNumber">10.3.4</span><span class="SectionTitle">The Clip Matrix: Applying Zoom and<br>Preparing for Clipping</span></h2>
<p class="NoIndent">The second goal of the clip matrix is to scale the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml>
</mjx-container>, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></mjx-assistive-mml>
</mjx-container>, and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container> components such that the six
clip planes have a trivial form. Points are outside the view frustum if they satisfy at least one
of the inequalities:
</p>
<span class="InMarginAnchor"><span class="InMargin"><span class="EqMarginCaption">The six planes of the view frustum in clip space</span></span></span><div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mtable style="min-width: 7.997em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: left; padding-right: 0.5em; padding-bottom: 0.2em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c42"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0.5em; padding-bottom: 0.2em"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: left; padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c54"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3E"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: left; padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c4C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: left; padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c52"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c68"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3E"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: left; padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c4E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: left; padding-right: 0.5em; padding-top: 0.2em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c46"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0.5em; padding-top: 0.2em"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3E"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mtr><mtd>
<mrow><mi mathvariant="normal">B</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi></mrow>
</mtd><mtd><mi>y</mi><mo>&lt;</mo><mo>&#8722;</mo><mi>w</mi><mo>,</mo></mtd></mtr><mtr><mtd>
<mrow><mi mathvariant="normal">T</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">p</mi></mrow>
</mtd><mtd><mi>y</mi><mo>&gt;</mo><mi>w</mi><mo>,</mo></mtd></mtr><mtr><mtd>
<mrow><mi mathvariant="normal">L</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi></mrow>
</mtd><mtd><mi>x</mi><mo>&lt;</mo><mo>&#8722;</mo><mi>w</mi><mo>,</mo></mtd></mtr><mtr><mtd>
<mrow><mi mathvariant="normal">R</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi></mrow>
</mtd><mtd><mi>x</mi><mo>&gt;</mo><mi>w</mi><mo>,</mo></mtd></mtr><mtr><mtd>
<mrow><mi mathvariant="normal">N</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi></mrow>
</mtd><mtd><mi>z</mi><mo>&lt;</mo><mo>&#8722;</mo><mi>w</mi><mo>,</mo></mtd></mtr><mtr><mtd>
<mrow><mi mathvariant="normal">F</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi></mrow>
</mtd><mtd><mi>z</mi><mo>&gt;</mo><mi>w</mi><mo>.</mo></mtd></mtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<p class="NoIndent">
So the points inside the view volume satisfy
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mtable style="min-width: 7.894em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-bottom: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-bottom: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-bottom: 0.2em"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-bottom: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-top: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-top: 0.2em"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="center center center center center" columnspacing="1em" rowspacing="4pt"><mtr><mtd><mo>&#8722;</mo><mi>w</mi></mtd><mtd><mo>&#8804;</mo></mtd><mtd><mi>x</mi></mtd><mtd><mo>&#8804;</mo><mi>w</mi><mo>,</mo></mtd></mtr><mtr><mtd><mo>&#8722;</mo><mi>w</mi></mtd><mtd><mo>&#8804;</mo></mtd><mtd><mi>y</mi></mtd><mtd><mo>&#8804;</mo><mi>w</mi><mo>,</mo></mtd></mtr><mtr><mtd><mo>&#8722;</mo><mi>w</mi></mtd><mtd><mo>&#8804;</mo></mtd><mtd><mi>z</mi></mtd><mtd><mo>&#8804;</mo><mi>w</mi><mo>.</mo></mtd></mtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<p class="NoIndent">
Any geometry that does not satisfy these equalities must be <i>clipped</i> to the view frustum.
Clipping is discussed in <a href="#clipping">Section&#160;10.10.4</a>.
</p>
<p>
To stretch things to put the top, left, right, and bottom clip planes in place, we scale the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml>
</mjx-container>
and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></mjx-assistive-mml>
</mjx-container> values by the zoom values of the camera.  We discussed how to compute these values in
<a href="#field_of_view">Section&#160;10.2.4</a>.  For the near and far clip planes, the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container>-coordinate is biased and
scaled such that at the near clip plane, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi>
<mrow><mo>/</mo></mrow>
<mi>w</mi><mo>=</mo><mo>&#8722;</mo><mn>1</mn></math></mjx-assistive-mml>
</mjx-container>, and at the far clip plane, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c31"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi>
<mrow><mo>/</mo></mrow>
<mi>w</mi><mo>=</mo><mn>1</mn></math></mjx-assistive-mml>
</mjx-container>.
</p>
<p>Let <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c7A"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mi mathvariant="normal">z</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi></mrow>
<mi>x</mi></msub></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c7A"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mi mathvariant="normal">z</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi></mrow>
<mi>y</mi></msub></math></mjx-assistive-mml>
</mjx-container> be the horizontal and vertical zoom values,
and let <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></mjx-assistive-mml>
</mjx-container> be the distances to the near and far clipping planes. Then the matrix that
scales <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml>
</mjx-container>, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></mjx-assistive-mml>
</mjx-container>, and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container> appropriately, while simultaneously outputting the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container>-coordinate into
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></mjx-assistive-mml>
</mjx-container>, is
</p>
<span class="InMarginAnchor">
<span class="InMargin">
<span class="EqMarginCaption">Clip matrix for perspective projection with <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-b mjx-i"><mjx-c class="mjx-c1D49B TEX-BI"></mjx-c></mjx-mi><mjx-mo class="mjx-b" space="4"><mjx-c class="mjx-c3D TEX-B"></mjx-c></mjx-mo><mjx-mo class="mjx-b" space="4"><mjx-c class="mjx-c2212 TEX-B"></mjx-c></mjx-mo><mjx-mi class="mjx-b mjx-i"><mjx-c class="mjx-c1D498 TEX-BI"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold-italic">z</mi><mo mathvariant="bold">=</mo><mo mathvariant="bold">&#8722;</mo><mi mathvariant="bold-italic">w</mi></math></mjx-assistive-mml>
</mjx-container> at the near clip plane</span>
</span>
</span><div class="DisplayMath">
<mjx-container class="MathJax" display="true" jax="CHTML" role="presentation" style="font-size: 100%; min-width: 100%; position: relative" width="full">
<mjx-math aria-hidden="true" class="MJX-TEX" display="true" width="full"><mjx-mtable side="right" style="min-width: 100%; display: flex; justify-content: space-between; flex-flow: row nowrap">
<mjx-labels-partner style="flex: 1 0 0; max-width: 3.356em"></mjx-labels-partner><mjx-table style="flex: 0 0 12.674em"><mjx-itable width="full"><mjx-mlabeledtr><mjx-mtd><mjx-mrow><mjx-mo class="mjx-n"><mjx-stretchy-v class="mjx-c5B" style="height: 6.192em; vertical-align: -2.846em"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style="min-width: 11.062em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-bottom: 0.2em"><mjx-msub><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c7A"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-msub><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c7A"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mfrac><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow size="s"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mrow size="s"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-top: 0.2em"><mjx-mfrac><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow size="s"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mrow size="s"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-n"><mjx-stretchy-v class="mjx-c5D" style="height: 6.192em; vertical-align: -2.846em"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mlabeledtr></mjx-itable></mjx-table>
<mjx-labels style="flex: 0 0 3.356em"><mjx-itable align="right" style=""><mjx-mtr style="height: 6.192em"><mjx-mtd id="mjx-eqn-10.6"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c28"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c36"></mjx-c><mjx-c class="mjx-c29"></mjx-c></mjx-mtext><mjx-tstrut style="height: 6.192em; vertical-align: -2.846em"></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-labels>
</mjx-mtable>
</mjx-math>
<mjx-assistive-mml display="block" role="presentation" unselectable="on"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mtable displaystyle="true"><mlabeledtr><mtd><mtext>(10.6)</mtext></mtd><mtd>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mtable columnalign="center center center center" columnspacing="1em" rowspacing="4pt"><mtr><mtd><msub>
<mrow><mi mathvariant="normal">z</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi></mrow>
<mi>x</mi></msub></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><msub>
<mrow><mi mathvariant="normal">z</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi></mrow>
<mi>y</mi></msub></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mfrac>
<mrow><mi>f</mi><mo>+</mo><mi>n</mi></mrow>
<mrow><mi>f</mi><mo>&#8722;</mo><mi>n</mi></mrow>
</mfrac></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mfrac>
<mrow><mo>&#8722;</mo><mn>2</mn><mi>n</mi><mi>f</mi></mrow>
<mrow><mi>f</mi><mo>&#8722;</mo><mi>n</mi></mrow>
</mfrac></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">]</mo></mrow>
<mo>.</mo></mtd></mlabeledtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<p>This clip matrix assumes a coordinate system with <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container> pointing into the screen (the usual
left-handed convention), row vectors on the left, and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container> values in the range <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>&#8722;</mo><mi>w</mi><mo>,</mo><mi>w</mi><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container> from the
near to far clip plane.  This last detail is yet another place where conventions can vary. Other
APIs, (notably, DirectX) want the projection matrix such that <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container> is in the range <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mi>w</mi><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container>. In
other words, a point in clip space is outside the clip plane if
</p>
<span class="InMarginAnchor"><span class="InMargin"><span class="EqMarginCaption">Near and far clip planes in DirectX-style clip space</span></span></span><div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mtable style="min-width: 5.685em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: left; padding-right: 0.5em; padding-bottom: 0.2em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0.5em; padding-bottom: 0.2em"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: left; padding-right: 0.5em; padding-top: 0.2em"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0.5em; padding-top: 0.2em"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3E"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mtr><mtd>
<mrow><mi mathvariant="normal">n</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi></mrow>
</mtd><mtd><mi>z</mi><mo>&lt;</mo><mn>0</mn><mo>,</mo></mtd></mtr><mtr><mtd>
<mrow><mi mathvariant="normal">f</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi></mrow>
</mtd><mtd><mi>z</mi><mo>&gt;</mo><mi>w</mi><mo>.</mo></mtd></mtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<p class="NoIndent">
Under these DirectX-style conventions, the points inside the view frustum satisfy the inequality
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn><mo>&#8804;</mo><mi>z</mi><mo>&#8804;</mo><mi>w</mi></math></mjx-assistive-mml>
</mjx-container>.  A slightly different clip matrix is used in this case:
</p>
<span class="InMarginAnchor">
<span class="InMargin">
<span class="EqMarginCaption">Clip matrix for perspective projection with <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-b mjx-i"><mjx-c class="mjx-c1D49B TEX-BI"></mjx-c></mjx-mi><mjx-mo class="mjx-b" space="4"><mjx-c class="mjx-c3D TEX-B"></mjx-c></mjx-mo><mjx-mn class="mjx-b" space="4"><mjx-c class="mjx-c1D7CE TEX-B"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold-italic">z</mi><mo mathvariant="bold">=</mo><mn mathvariant="bold">0</mn></math></mjx-assistive-mml>
</mjx-container> at the near clip plane</span>
</span>
</span>
<div class="DisplayMath">
<mjx-container class="MathJax" display="true" jax="CHTML" role="presentation" style="font-size: 100%; min-width: 100%; position: relative" width="full">
<mjx-math aria-hidden="true" class="MJX-TEX" display="true" width="full"><mjx-mtable side="right" style="min-width: 100%; display: flex; justify-content: space-between; flex-flow: row nowrap">
<mjx-labels-partner style="flex: 1 0 0; max-width: 3.356em"></mjx-labels-partner><mjx-table style="flex: 0 0 12.32em"><mjx-itable width="full"><mjx-mlabeledtr><mjx-mtd><mjx-mrow><mjx-mo class="mjx-n"><mjx-stretchy-v class="mjx-c5B" style="height: 6.192em; vertical-align: -2.846em"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style="min-width: 10.708em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-bottom: 0.2em"><mjx-msub><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c7A"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-msub><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c7A"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mfrac><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mrow size="s"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-top: 0.2em"><mjx-mfrac><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow size="s"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mrow size="s"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-n"><mjx-stretchy-v class="mjx-c5D" style="height: 6.192em; vertical-align: -2.846em"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mlabeledtr></mjx-itable></mjx-table>
<mjx-labels style="flex: 0 0 3.356em"><mjx-itable align="right" style=""><mjx-mtr style="height: 6.192em"><mjx-mtd id="mjx-eqn-10.7"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c28"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c29"></mjx-c></mjx-mtext><mjx-tstrut style="height: 6.192em; vertical-align: -2.846em"></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-labels>
</mjx-mtable>
</mjx-math>
<mjx-assistive-mml display="block" role="presentation" unselectable="on"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mtable displaystyle="true"><mlabeledtr><mtd><mtext>(10.7)</mtext></mtd><mtd>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mtable columnspacing="1em" rowspacing="4pt"><mtr><mtd><msub>
<mrow><mi mathvariant="normal">z</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi></mrow>
<mi>x</mi></msub></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><msub>
<mrow><mi mathvariant="normal">z</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi></mrow>
<mi>y</mi></msub></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mfrac><mi>f</mi>
<mrow><mi>f</mi><mo>&#8722;</mo><mi>n</mi></mrow>
</mfrac></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mfrac>
<mrow><mo>&#8722;</mo><mi>n</mi><mi>f</mi></mrow>
<mrow><mi>f</mi><mo>&#8722;</mo><mi>n</mi></mrow>
</mfrac></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">]</mo></mrow>
<mo>.</mo></mtd></mlabeledtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<p class="NoIndent">
We can easily tell that the two matrices in
Equations&#160;<a href="#clip_matrix_perspective_zneg1too1_row_vectors">(10.6)</a> and
<a href="#clip_matrix_perspective_directx_row_vectors">(10.7)</a> are <i>perspective</i> projection
matrices because the right-hand column is <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo><mjx-script style="vertical-align: 0.363em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c54"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>0</mn><msup><mo stretchy="false">]</mo>
<mrow><mi mathvariant="normal">T</mi></mrow>
</msup></math></mjx-assistive-mml>
</mjx-container>.  (OK, the caption in the margin is a bit
of a hint, too.)
</p>
<p>
What about orthographic projection?  The first and second columns of the projection matrix don't
change, and we know the fourth column will become <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo><mjx-script style="vertical-align: 0.363em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c54"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><msup><mo stretchy="false">]</mo>
<mrow><mi mathvariant="normal">T</mi></mrow>
</msup></math></mjx-assistive-mml>
</mjx-container>.  The third column, which
controls the output <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container> value, must change.  We start by assuming the first set of conventions
for <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container>, that is the output <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container> value will be scaled such that <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi>
<mrow><mo>/</mo></mrow>
<mi>w</mi></math></mjx-assistive-mml>
</mjx-container> takes on the values <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>&#8722;</mo><mn>1</mn></math></mjx-assistive-mml>
</mjx-container> and
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>+</mo><mn>1</mn></math></mjx-assistive-mml>
</mjx-container> at the near and far clip planes, respectively. The matrix that does this is
</p>
<span class="InMarginAnchor">
<span class="InMargin">
<span class="EqMarginCaption">Clip matrix for orthographic projection with <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-b mjx-i"><mjx-c class="mjx-c1D49B TEX-BI"></mjx-c></mjx-mi><mjx-mo class="mjx-b" space="4"><mjx-c class="mjx-c3D TEX-B"></mjx-c></mjx-mo><mjx-mo class="mjx-b" space="4"><mjx-c class="mjx-c2212 TEX-B"></mjx-c></mjx-mo><mjx-mi class="mjx-b mjx-i"><mjx-c class="mjx-c1D498 TEX-BI"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold-italic">z</mi><mo mathvariant="bold">=</mo><mo mathvariant="bold">&#8722;</mo><mi mathvariant="bold-italic">w</mi></math></mjx-assistive-mml>
</mjx-container> at the near clip plane</span>
</span>
</span><div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mrow><mjx-mo class="mjx-n"><mjx-stretchy-v style="height: 6.073em; vertical-align: -2.787em" class="mjx-c5B"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style="min-width: 11.486em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-bottom: 0.2em"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c7A"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c7A"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mfrac><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mrow size="s"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-top: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mfrac><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow size="s"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mrow size="s"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-n"><mjx-stretchy-v style="height: 6.073em; vertical-align: -2.787em" class="mjx-c5D"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mtable columnspacing="1em" rowspacing="4pt"><mtr><mtd><msub>
<mrow><mi mathvariant="normal">z</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi></mrow>
<mi>x</mi></msub></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><msub>
<mrow><mi mathvariant="normal">z</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi></mrow>
<mi>y</mi></msub></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mfrac><mn>2</mn>
<mrow><mi>f</mi><mo>&#8722;</mo><mi>n</mi></mrow>
</mfrac></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mo>&#8722;</mo><mfrac>
<mrow><mi>f</mi><mo>+</mo><mi>n</mi></mrow>
<mrow><mi>f</mi><mo>&#8722;</mo><mi>n</mi></mrow>
</mfrac></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">]</mo></mrow>
<mo>.</mo></math></mjx-assistive-mml>
</mjx-container>
</div>
<p>
Alternatively, if we are using a DirectX-style range for the clip space <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container> values, then the matrix
we use is
</p>
<span class="InMarginAnchor">
<span class="InMargin">
<span class="EqMarginCaption">Clip matrix for orthographic projection with <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-b mjx-i"><mjx-c class="mjx-c1D49B TEX-BI"></mjx-c></mjx-mi><mjx-mo class="mjx-b" space="4"><mjx-c class="mjx-c3D TEX-B"></mjx-c></mjx-mo><mjx-mn class="mjx-b" space="4"><mjx-c class="mjx-c1D7CE TEX-B"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold-italic">z</mi><mo mathvariant="bold">=</mo><mn mathvariant="bold">0</mn></math></mjx-assistive-mml>
</mjx-container> at the near clip plane</span>
</span>
</span><div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mrow><mjx-mo class="mjx-n"><mjx-stretchy-v style="height: 5.84em; vertical-align: -2.67em" class="mjx-c5B"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style="min-width: 10.708em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-bottom: 0.2em"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c7A"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c7A"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mfrac><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mrow size="s"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-top: 0.2em"><mjx-mfrac><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mrow size="s"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-n"><mjx-stretchy-v style="height: 5.84em; vertical-align: -2.67em" class="mjx-c5D"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mtable columnspacing="1em" rowspacing="4pt"><mtr><mtd><msub>
<mrow><mi mathvariant="normal">z</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi></mrow>
<mi>x</mi></msub></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><msub>
<mrow><mi mathvariant="normal">z</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi></mrow>
<mi>y</mi></msub></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mfrac><mn>1</mn>
<mrow><mi>f</mi><mo>&#8722;</mo><mi>n</mi></mrow>
</mfrac></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mfrac><mi>n</mi>
<mrow><mi>n</mi><mo>&#8722;</mo><mi>f</mi></mrow>
</mfrac></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">]</mo></mrow>
<mo>.</mo></math></mjx-assistive-mml>
</mjx-container>
</div>
<p>In this book, we prefer a left-handed convention and row vectors on the left, and all the
projection matrices so far assume those conventions.  However, both of these choices differ from
the OpenGL convention, and we know that many readers may be working in environments that are
similar to OpenGL. Since this can be very confusing, let's repeat these matrices, but with the
right-handed, column-vector OpenGL conventions. We'll only discuss the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container> range for
clip-space <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container> values, because that's what OpenGL uses.
</p>
<p>
It's instructive to consider how to convert these matrices from one set of conventions to the
other.  Because OpenGL uses column vectors, the first thing we need to do is transpose our
matrix. Second, the right-handed conventions have <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>&#8722;</mo><mi>z</mi></math></mjx-assistive-mml>
</mjx-container> pointing into the screen in camera space
(&#8220;eye space&#8221; in the OpenGL vocabulary), but the clip-space <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>+</mo><mi>z</mi></math></mjx-assistive-mml>
</mjx-container> axis points into the screen
just like the left-handed conventions assumed earlier. (In OpenGL, clip space is actually a
left-handed coordinate space!) This means we need to negate our <i>incoming</i> <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container> values, or
alternatively, negate the third column (after we've transposed the matrix), which is the column
that is multiplied by <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container>.
</p>
<p>
The above procedure results in the following perspective projection matrix
</p>
<span class="InMarginAnchor">
<span class="InMargin"><span class="EqMarginCaption">Clip matrix for perspective projection assuming OpenGL conventions</span>
</span>
</span><div class="DisplayMath">
<mjx-container class="MathJax" display="true" jax="CHTML" role="presentation" style="font-size: 100%; min-width: 100%; position: relative" width="full">
<mjx-math aria-hidden="true" class="MJX-TEX" display="true" width="full"><mjx-mtable side="right" style="min-width: 100%; display: flex; justify-content: space-between; flex-flow: row nowrap">
<mjx-labels-partner style="flex: 1 0 0; max-width: 4.134em"></mjx-labels-partner><mjx-table style="flex: 0 0 14.755em"><mjx-itable width="full"><mjx-mlabeledtr><mjx-mtd><mjx-mrow><mjx-mo class="mjx-n"><mjx-stretchy-v class="mjx-c5B" style="height: 5.718em; vertical-align: -2.609em"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style="min-width: 13.143em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-bottom: 0.2em"><mjx-msub><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c7A"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-msub><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c7A"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mfrac><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow size="s"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mrow size="s"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mfrac><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow size="s"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mrow size="s"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-top: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-n"><mjx-stretchy-v class="mjx-c5D" style="height: 5.718em; vertical-align: -2.609em"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mlabeledtr></mjx-itable></mjx-table>
<mjx-labels style="flex: 0 0 4.134em"><mjx-itable align="right" style=""><mjx-mtr style="height: 5.718em"><mjx-mtd id="mjx-eqn-10.3.4"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c28"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c33"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c34"></mjx-c><mjx-c class="mjx-c29"></mjx-c></mjx-mtext><mjx-tstrut style="height: 5.718em; vertical-align: -2.609em"></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-labels>
</mjx-mtable>
</mjx-math>
<mjx-assistive-mml display="block" role="presentation" unselectable="on"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mtable displaystyle="true"><mlabeledtr><mtd><mtext>(10.3.4)</mtext></mtd><mtd>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mtable columnspacing="1em" rowspacing="4pt"><mtr><mtd><msub>
<mrow><mi mathvariant="normal">z</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi></mrow>
<mi>x</mi></msub></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><msub>
<mrow><mi mathvariant="normal">z</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi></mrow>
<mi>y</mi></msub></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mo>&#8722;</mo><mfrac>
<mrow><mi>f</mi><mo>+</mo><mi>n</mi></mrow>
<mrow><mi>f</mi><mo>&#8722;</mo><mi>n</mi></mrow>
</mfrac></mtd><mtd><mfrac>
<mrow><mo>&#8722;</mo><mn>2</mn><mi>n</mi><mi>f</mi></mrow>
<mrow><mi>f</mi><mo>&#8722;</mo><mi>n</mi></mrow>
</mfrac></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mo>&#8722;</mo><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">]</mo></mrow>
<mo>,</mo></mtd></mlabeledtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<p class="NoIndent">
and the orthographic projection matrix is
</p>
<span class="InMarginAnchor">
<span class="InMargin"><span class="EqMarginCaption">Clip matrix for orthographic projection assuming OpenGL conventions</span>
</span>
</span>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mrow><mjx-mo class="mjx-n"><mjx-stretchy-v style="height: 5.718em; vertical-align: -2.609em" class="mjx-c5B"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style="min-width: 12.79em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-bottom: 0.2em"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c7A"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c7A"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mfrac><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow size="s"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mrow size="s"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mfrac><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow size="s"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mrow size="s"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-n"><mjx-stretchy-v style="height: 5.718em; vertical-align: -2.609em" class="mjx-c5D"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mtable columnspacing="1em" rowspacing="4pt"><mtr><mtd><msub>
<mrow><mi mathvariant="normal">z</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi></mrow>
<mi>x</mi></msub></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><msub>
<mrow><mi mathvariant="normal">z</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi></mrow>
<mi>y</mi></msub></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mfrac>
<mrow><mo>&#8722;</mo><mn>2</mn></mrow>
<mrow><mi>f</mi><mo>&#8722;</mo><mi>n</mi></mrow>
</mfrac></mtd><mtd><mo>&#8722;</mo><mfrac>
<mrow><mi>f</mi><mo>+</mo><mi>n</mi></mrow>
<mrow><mi>f</mi><mo>&#8722;</mo><mi>n</mi></mrow>
</mfrac></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">]</mo></mrow>
<mo>.</mo></math></mjx-assistive-mml>
</mjx-container>
</div>
<p>
So, for OpenGL conventions, you can tell whether a projection matrix is perspective or
orthographic based on the bottom <i>row</i>.  It will be <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container> for perspective, and
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container> for orthographic.
</p>
<p>Now that we know a bit about clip space, we can understand the need for the near clip plane.
Obviously, there is a singularity precisely at the origin, where a perspective projection is not
defined.  (This corresponds to a perspective division by zero.)  In practice, this singularity
would be extremely rare, and however we wanted to handle it&#8212;say, by arbitrarily projecting the
point to the center of the screen&#8212;would be OK, since putting the camera directly in a polygon
isn't often needed in practice.
</p>
<p>
But projecting polygons onto pixels isn't the only issue. Allowing for arbitrarily small (but
positive) values of <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container> will result in arbitrarily large values for <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></mjx-assistive-mml>
</mjx-container>. Depending on the
hardware, this can cause problems with perspective-correct rasterization. Another potential
problem area is depth buffering. Suffice it to say that for practical reasons it is often
necessary to restrict the range of the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container> values so that there is a known minimum value, and we
must accept the rather unpleasant necessity of a near clip plane. We say &#8220;unpleasant&#8221; because
the near clip plane is an artifact of implementation, not an inherent part of a 3D world.
(Raytracers don't necessarily have this issue.)  It cuts off objects when you get too close to
them, when in reality you should be able to get arbitrarily close. Many readers are probably
familiar with the phenomena where a camera is placed in the middle of a very large ground
polygon, just a small distance above it, and a gap opens up at the bottom of the screen, allowing
the camera to see through the ground.  A similar situation exists if you get very close to
practically any object other than a wall.  A hole will appear in the middle of the object, and
this hole will expand as you move closer.
</p>
<h2 id="screen_space"><span class="SectionNumber">10.3.5</span><span class="SectionTitle">Screen Space</span></h2>
<p class="NoIndent">Once we have clipped the geometry to the view frustum, it is projected into screen space, which
corresponds to actual pixels in the frame buffer.  Remember that we are rendering into an output
window that does not necessarily occupy the entire display device.  However, we usually want our
screen-space coordinates to be specified using coordinates that are absolute to the rendering
device (<a href="#output_window2">Figure&#160;10.9</a>).
</p>
<div id="output_window2" class="Display Figure Wide">
<div class="Body">
	<img src="figs/graphics/output_window.png" loading="lazy" width="555" height="368">
</div><span class="Caption"><span class="Label">Figure&#160;10.9</span><span class="CaptionText">The output window in screen space</span>
</span>
</div><p>Screen space is a 2D&#160;space, of course.  Thus, we must project the points from clip space to
screen space to generate the correct 2D coordinates.  The first thing that happens is the
standard homogeneous division by <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></mjx-assistive-mml>
</mjx-container>.  (OpenGL calls the result of this division the
    <i>normalized device coordinates</i>.)  Then, the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml>
</mjx-container>- and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></mjx-assistive-mml>
</mjx-container>-coordinates must be scaled to map
into the output window. This is summarized by
</p>
<span class="InMarginAnchor"><span class="InMargin"><span class="EqMarginCaption">Projecting and mapping to screen space</span></span></span><div class="DisplayMath">
<mjx-container class="MathJax" display="true" jax="CHTML" role="presentation" style="font-size: 100%; min-width: 100%; position: relative" width="full">
<mjx-math aria-hidden="true" class="MJX-TEX" display="true" width="full"><mjx-mtable side="right" style="min-width: 100%; display: flex; justify-content: space-between; flex-flow: row nowrap">
<mjx-labels-partner style="flex: 1 0 0; max-width: 3.356em"></mjx-labels-partner><mjx-table style="flex: 0 0 18.281em"><mjx-itable width="full"><mjx-mlabeledtr><mjx-mtd style="text-align: right; padding-right: 0; padding-bottom: 0.15em"><mjx-msub><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-msub><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi></mjx-texatom><mjx-script style="vertical-align: -0.229em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c77"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c52"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mrow><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi></mjx-texatom><mjx-script style="vertical-align: -0.229em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c77"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c43"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mlabeledtr><mjx-mlabeledtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em"><mjx-msub><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mfrac><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-msub><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi></mjx-texatom><mjx-script style="vertical-align: -0.229em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c77"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c52"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mrow><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi></mjx-texatom><mjx-script style="vertical-align: -0.229em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c77"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c43"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mlabeledtr></mjx-itable></mjx-table>
<mjx-labels style="flex: 0 0 3.356em"><mjx-itable align="right" style=""><mjx-mtr style="height: 2.464em"><mjx-mtd id="mjx-eqn-10.8" style="padding-bottom: 0.15em"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c28"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c38"></mjx-c><mjx-c class="mjx-c29"></mjx-c></mjx-mtext><mjx-tstrut style="height: 2.314em; vertical-align: -0.923em"></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr style="height: 2.601em"><mjx-mtd id="mjx-eqn-10.9" style="padding-top: 0.15em"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c28"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c39"></mjx-c><mjx-c class="mjx-c29"></mjx-c></mjx-mtext><mjx-tstrut style="height: 2.451em; vertical-align: -0.923em"></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-labels>
</mjx-mtable>
</mjx-math>
<mjx-assistive-mml display="block" role="presentation" unselectable="on"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mlabeledtr><mtd><mtext>(10.8)</mtext></mtd><mtd><msub>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi></mrow>
<mi>x</mi></msub></mtd><mtd><mi></mi><mo>=</mo><mfrac>
<mrow><msub>
<mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">p</mi></mrow>
<mi>x</mi></msub><mo>&#8901;</mo><msub>
<mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">R</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi></mrow>
<mi>x</mi></msub></mrow>
<mrow><mn>2</mn><mo>&#8901;</mo><msub>
<mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">p</mi></mrow>
<mi>w</mi></msub></mrow>
</mfrac><mo>+</mo><msub>
<mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">C</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi></mrow>
<mi>x</mi></msub><mo>,</mo></mtd></mlabeledtr><mlabeledtr><mtd><mtext>(10.9)</mtext></mtd><mtd><msub>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi></mrow>
<mi>y</mi></msub></mtd><mtd><mi></mi><mo>=</mo><mo>&#8722;</mo><mfrac>
<mrow><msub>
<mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">p</mi></mrow>
<mi>y</mi></msub><mo>&#8901;</mo><msub>
<mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">R</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi></mrow>
<mi>y</mi></msub></mrow>
<mrow><mn>2</mn><mo>&#8901;</mo><msub>
<mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">p</mi></mrow>
<mi>w</mi></msub></mrow>
</mfrac><mo>+</mo><msub>
<mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">C</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi></mrow>
<mi>y</mi></msub><mo>.</mo></mtd></mlabeledtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<p>A quick comment is warranted about the negation of the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></mjx-assistive-mml>
</mjx-container> component in the math above.  This
reflects DirectX-style coordinate conventions where (0,0) is in the upper-left corner.  Under
these conventions, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>+</mo><mi>y</mi></math></mjx-assistive-mml>
</mjx-container> points up in clip space, but down in screen space.  In fact, if we
continue to think about <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>+</mo><mi>z</mi></math></mjx-assistive-mml>
</mjx-container> pointing into the screen, then screen space actually becomes a
right-handed coordinate space, even though it's left-handed everywhere else in DirectX.  In
OpenGL, the origin is in the <i>lower</i> left corner, and the negation of the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></mjx-assistive-mml>
</mjx-container>-coordinate
does not occur.  (As already discussed, in OpenGL, they choose a different place to introduce
confusion, by flipping the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container>-axis between eye space, where <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>&#8722;</mo><mi>z</mi></math></mjx-assistive-mml>
</mjx-container> points into the screen, to clip
space, where <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>+</mo><mi>z</mi></math></mjx-assistive-mml>
</mjx-container> points into the screen.)
</p>
<p>
Speaking of <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container>, what happens to <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">p</mi></mrow>
<mi>z</mi></msub></math></mjx-assistive-mml>
</mjx-container>?  In general it's used in some way for
depth buffering.  A traditional method is to take the normalized depth value
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">p</mi></mrow>
<mi>z</mi></msub>
<mrow><mo>/</mo></mrow>
<msub>
<mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">p</mi></mrow>
<mi>w</mi></msub></math></mjx-assistive-mml>
</mjx-container> and store this value in the depth buffer.  The
precise details depend on exactly what sort of clip values are used for clipping, and what sort
of depth values go into the depth buffer. For example, in OpenGL, the conceptual convention is
for the view frustum to contain <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>&#8722;</mo><mn>1</mn><mo>&#8804;</mo><msub>
<mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">p</mi></mrow>
<mi>z</mi></msub>
<mrow><mo>/</mo></mrow>
<msub>
<mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">p</mi></mrow>
<mi>w</mi></msub><mo>&#8804;</mo><mo>+</mo><mn>1</mn></math></mjx-assistive-mml>
</mjx-container>, but
this might not be optimal for depth buffering. Driver vendors must convert from the API's
conceptual conventions to whatever is optimal for the hardware.
</p>
<p>An alternative strategy, known as <i><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></mjx-assistive-mml>
</mjx-container>-buffering</i>, is to use <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">p</mi></mrow>
<mi>w</mi></msub></math></mjx-assistive-mml>
</mjx-container> as the
depth value.  In most situations <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">p</mi></mrow>
<mi>w</mi></msub></math></mjx-assistive-mml>
</mjx-container> is simply a scaled version of the
camera-space <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container> value; thus by using <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">p</mi></mrow>
<mi>w</mi></msub></math></mjx-assistive-mml>
</mjx-container> in the depth buffer, each value has
a linear relationship to the viewing depth of the corresponding pixel. This method can be
attractive, especially if the depth buffer is fixed-point with limited precision, because it
spreads out the available precision more evenly. The traditional method of storing
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">p</mi></mrow>
<mi>z</mi></msub>
<mrow><mo>/</mo></mrow>
<msub>
<mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">p</mi></mrow>
<mi>w</mi></msub></math></mjx-assistive-mml>
</mjx-container> in the depth buffer results in greatly increased
precision up close, but at the expense of (sometimes drastically) reduced precision near the far
clip plane.  If the depth buffer values are stored in floating-point, this issue is much less
important.  Also note that <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></mjx-assistive-mml>
</mjx-container>-buffering doesn't work for orthographic projection, since an
orthographic projection matrix always outputs <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c31"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi><mo>=</mo><mn>1</mn></math></mjx-assistive-mml>
</mjx-container>.
</p>
<p>
The <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">p</mi></mrow>
<mi>w</mi></msub></math></mjx-assistive-mml>
</mjx-container> value is also not discarded.  As we've said, it serves the important
purpose as the denominator in the homogeneous division to normalized device coordinates.  But
this value is also usually needed for proper perspective-correct interpolation of texture
coordinates, colors, and other vertex-level values during rasterization.
</p>
<p>
On modern graphics APIs at the time of this writing, the conversion of vertex coordinates from
clip space to screen space is done for you.  Your vertex shader outputs coordinates in clip
space. The API clips the triangles to the view frustum and then projects the coordinates to
screen space.  But that doesn't mean that you will never use the equations in this section in
your code. Quite often, we need to perform these calculations in software for visibility testing,
level-of-detail selection, and so forth.
</p>
<h2 id="coordinate_spaces_summary"><span class="SectionNumber">10.3.6</span><span class="SectionTitle">Summary of Coordinate Spaces</span></h2>
<p class="NoIndent">
<a href="#coordinate_spaces_summary">Figure&#160;10.10</a> summarizes the coordinate spaces and matrices discussed in
this section, showing the data flow from object space to screen space.
</p>
<div id="coordinate_spaces_summary" class="Display Figure Wide">
<div class="Body">
<span class="minipage">
<span class="fbox"><img src="figs/graphics/coordinate_spaces_summary.png" loading="lazy" width="726" height="772">
</span>
</span>
</div><span class="Caption">
<span class="Label">Figure&#160;10.10</span><span class="CaptionText">Conversion of vertex coordinates through the graphics pipeline</span>
</span>
</div><p>
The coordinate spaces we've mentioned are the most important and common ones, but other
coordinate spaces are used in computer graphics. For example, a projected light might have its
own space, which is essentially the same as camera space, only it is from the perspective that
the light &#8220;looks&#8221; onto the scene.  This space is important when the light projects an image
    (sometimes called a <i>gobo</i>) and also for shadow mapping to determine whether a light can
&#8220;see&#8221; a given point.
</p>
<p>Another space that has become very important is <i>tangent space</i>, which is a local space on
the surface of an object. One basis vector is the surface normal and the other two basis vectors
are locally tangent to the surface, essentially establishing a 2D coordinate space that is
&#8220;flat&#8221; on the surface at that spot.  There are many different ways we could determine these
basis vectors, but by far the most common reason to establish such a coordinate space is for bump
mapping and related techniques.  A more complete discussion of tangent space will need to wait
until after we discuss texture mapping in <a href="#texture_mapping">Section&#160;10.5</a>, so we'll come back to
this subject in <a href="#tangent_space">Section&#160;10.9.1</a>.  Tangent space is also sometimes called
<i>surface-local</i>space.
</p>

<h1 id="polygon_meshes"><span class="SectionNumber">10.4</span><span class="SectionTitle">Polygon Meshes</span></h1>
<p class="NoIndent">To render a scene, we need a mathematical description of the geometry in that scene. Several
different methods are available to us.  This section focuses on the one most important for
real-time rendering: the <i>triangle mesh</i>.  But first, let's mention a few alternatives to
get some context.
    <i>Constructive solid geometry</i> (CSG) is a system for describing an object's shape using
Boolean operators (union, intersection, subtraction) on primitives.  Within video games, CSG can
be especially useful for rapid prototyping tools, with the
    <i>Unreal</i> engine being a notable
example.  Another technique that works by modeling volumes rather than their surfaces is
    <i>metaballs</i>, sometimes used to model organic shapes and fluids, as was discussed in
<a href="geomprims.html#representation_techniques">Section&#160;9.1</a>. CSG, metaballs, and other volumetric
descriptions are very useful in particular realms, but for rendering (especially real-time
rendering) we are interested in a description of the <i>surface</i> of the object, and seldom
need to determine whether a given point is inside or outside this surface. Indeed, the surface
need not be closed or even define a coherent volume.
</p>
<p>The most common surface description is the <i>polygon mesh</i>, of which you are probably already
aware.  In certain circumstances, it's useful to allow the polygons that form the surface of the
object to have an arbitrary number of vertices; this is often the case in importing and editing
tools. For real-time rendering, however, modern hardware is optimized for <i>triangle meshes</i>,
which are polygon meshes in which every polygon is a triangle.  Any given polygon mesh can be
converted into an equivalent triangle mesh by decomposing each polygon into triangles
individually, as was discussed briefly in <a href="geomprims.html#polygons_triangulation">Section&#160;9.7.3</a>. Please
note that many important concepts introduced in the context of a single triangle or polygon were
covered in <a href="geomprims.html#triangles">Section&#160;9.6</a> and <a href="geomprims.html#polygons">Section&#160;9.7</a>,
respectively. Here, our focus is on how more than one triangle can be connected in a mesh.
</p>
<p>
One very straightforward way to store a triangle mesh would be to use an array of triangles, as
shown in <a href="#triangle_mesh_trivial_representation">Listing&#160;10.4</a>.
</p>
<p>
<div class="Wide Display Listing">
<pre>
struct Triangle {
    Vector3 vertPos[3];   // vertex positions
};

struct TriangleMesh {
    int      triCount; // number of triangles
    Triangle *triList; // array of triangles
};
</pre>
</div>
</p>
<p>
For some applications this trivial representation might be adequate. However, the term &#8220;mesh&#8221;
implies a degree of connectivity between adjacent triangles, and this connectivity is not
expressed in our trivial representation.  There are three basic types of information in a
triangle mesh:
</p>
<ul>
    <li>
<span class="ListItemTitle">Vertices.</span>  Each triangle has exactly three vertices. Each vertex may be
        shared by multiple triangles.
        The <i>valence</i> of a vertex refers to how many faces are connected to the vertex.
</li>
<li>
<span class="ListItemTitle">Edges.</span>  An edge connects two vertices.  Each triangle has three edges. In
        many cases, each edge is shared by exactly two faces, but there are certainly
        exceptions.  If the object is not closed, an <i>open edge</i> with only one
        neighboring face can exist.
</li>
<li>
<span class="ListItemTitle">Faces.</span>  These are the surfaces of the triangles. We can store a face as
        either a list of three vertices, or a list of three edges.
</li>
</ul>
<p>
A variety of methods exist to represent this information efficiently, depending on the operations
to be performed most often on the mesh.  Here we will focus on a standard storage format known as
an <i>indexed triangle mesh</i>.
</p>
<h2 id="indexed_triangle_mesh"><span class="SectionNumber">10.4.1</span><span class="SectionTitle">Indexed Triangle Mesh</span></h2>
<p class="NoIndent">An indexed triangle mesh consists of two lists: a list of vertices, and a list of triangles.
</p>
<ul>
    <li>
Each <span class="ListItemTitle">vertex</span> contains a position in 3D.  We may also store other
        information at the vertex level, such as texture-mapping coordinates,
        surface normals, or lighting values.
</li>
<li>
A <span class="ListItemTitle">triangle</span> is represented by three integers that index into the vertex list.
        Usually, the order in which these vertices are listed is significant, since we may consider
        faces to have &#8220;front&#8221; and &#8220;back&#8221; sides.  We adopt the left-handed convention that the vertices
        are listed in clockwise order when viewed from the front side.  Other information may also
        be stored at the triangle level, such as a precomputed normal of the plane containing
        the triangle, surface properties (such as a texture map), and so forth.
</li>
</ul>
<p>
<a href="#indexed_triangle_mesh">Listing&#160;10.5</a> shows a highly simplified example of how an indexed triangle
mesh might be stored in C.
</p>
<p>
<div class="Wide Display Listing">
<pre>
// struct Vertex is the information we store at the vertex level
struct Vertex {

    // 3D position of the vertex
    Vector3 pos;

    // Other information could include
    // texture mapping coordinates, a
    // surface normal, lighting values, etc.
};

// struct Triangle is the information we store at the triangle level
struct Triangle {

    // Indices into the vertex list.  In practice, 16-bit indices are
    // almost always used rather than 32-bit, to save memory and bandwidth.
    int vertexIndex[3];

    // Other information could include
    // a normal, material information, etc
};

// struct TriangleMesh stores an indexed triangle mesh
struct TriangleMesh {

    // The vertices
    int    vertexCount;
    Vertex *vertexList;

    // The triangles
    int      triangleCount;
    Triangle *triangleList;
};
</pre>
</div>
</p>
<p>
<a href="#cube_and_pyramid_trimesh">Figure&#160;10.11</a> shows how a cube and a pyramid might be represented as a
polygon mesh or a triangle mesh.  Note that both objects are part of a <i>single</i> mesh with 13
vertices.  The lighter, thicker wires show the outlines of polygons, and the thinner, dark green
wires show one way to add edges to triangulate the polygon mesh.
</p>
<div id="cube_and_pyramid_trimesh" class="Display Figure Wide">
<div class="Body">
<span class="CenterContainer">
<span></span><span class="CenterBody">
        <img src="figs/graphics/cube_and_pyramid_trimesh.png" loading="lazy" width="533" height="300">
</span><span></span>
</span>
</div><span class="Caption">
<span class="Label">Figure&#160;10.11</span><span class="CaptionText">A simple mesh containing a cube and a pyramid</span>
</span>
</div><p>
Assuming the origin is on the &#8220;ground&#8221; directly between the two objects, the vertex coordinates
might be as shown in <a href="#cube_and_pyramid_vertex_positions">Table&#160;10.3</a>.
</p>
<div id="cube_and_pyramid_vertex_positions" class="Display Table Wide">
<div class="Body FontScriptSize">
    <table>
<tr>
<td class="AlignRight">0</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>&#8722;</mo><mn>3</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td class="AlignRight">4</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>&#8722;</mo><mn>3</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td class="AlignRight">8</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>2</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td class="AlignRight">&#160;&#160;&#160;12</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">1</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td class="AlignRight">5</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td class="AlignRight">9</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">2</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td class="AlignRight">6</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td class="AlignRight">10</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>3</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">3</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>&#8722;</mo><mn>3</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td class="AlignRight">&#160;&#160;&#160;7</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>&#8722;</mo><mn>3</mn><mo>,</mo><mn>0</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td class="AlignRight">&#160;&#160;&#160;11</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>3</mn><mo>,</mo><mn>0</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
</table>
</div><span class="Caption"><span class="Label">Table&#160;10.3</span><span class="CaptionText">Vertex positions in our sample mesh</span>
</span>
</div><p>
<a href="#cube_and_pyramid_face">Table&#160;10.4</a> shows the vertex indices that would form faces of this mesh,
either as a polygon mesh or as a triangle mesh.  Remember that the order of the vertices is
significant; they are listed in clockwise order when viewed from the outside.  You should study
these figures until you are sure you understand them.
</p>
<div id="cube_and_pyramid_face" class="Display Table Wide">
<div class="Body FontScriptSize">
    <table>
<tr>
<td></td>
<td><b>Vertex indices</b></td>
<td><b>Vertex indices</b></td>
</tr>
<tr>
<td><b>Description</b></td>
<td><b>(Polygon mesh)</b></td>
<td><b>(Triangle mesh)</b></td>
</tr>
<tr class="HLineAbove">
<td>Cube top</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container>, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>1</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>0</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td>Cube front</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c36"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>2</mn><mo>,</mo><mn>6</mn><mo>,</mo><mn>7</mn><mo>,</mo><mn>3</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c36"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>2</mn><mo>,</mo><mn>6</mn><mo>,</mo><mn>7</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container>, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>2</mn><mo>,</mo><mn>7</mn><mo>,</mo><mn>3</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td>Cube right</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c35"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c36"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>2</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>5</mn><mo>,</mo><mn>6</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c35"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>2</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>5</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container>, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c35"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c36"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>2</mn><mo>,</mo><mn>5</mn><mo>,</mo><mn>6</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td>Cube left</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c34"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>7</mn><mo>,</mo><mn>4</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>7</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container>, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c34"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>7</mn><mo>,</mo><mn>4</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td>Cube back</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c34"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c35"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>5</mn><mo>,</mo><mn>1</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c34"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c35"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>5</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container>, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c35"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>5</mn><mo>,</mo><mn>1</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td>Cube bottom</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c34"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c36"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c35"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>4</mn><mo>,</mo><mn>7</mn><mo>,</mo><mn>6</mn><mo>,</mo><mn>5</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c34"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c36"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>4</mn><mo>,</mo><mn>7</mn><mo>,</mo><mn>6</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container>, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c34"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c36"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c35"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>4</mn><mo>,</mo><mn>6</mn><mo>,</mo><mn>5</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td>Pyramid front</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c38"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>12</mn><mo>,</mo><mn>8</mn><mo>,</mo><mn>11</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c38"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>12</mn><mo>,</mo><mn>8</mn><mo>,</mo><mn>11</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td>Pyramid left</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c39"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c38"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>9</mn><mo>,</mo><mn>8</mn><mo>,</mo><mn>12</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c39"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c38"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>9</mn><mo>,</mo><mn>8</mn><mo>,</mo><mn>12</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td>Pyramid right</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c38"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>8</mn><mo>,</mo><mn>10</mn><mo>,</mo><mn>11</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c38"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>8</mn><mo>,</mo><mn>10</mn><mo>,</mo><mn>11</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td>Pyramid back</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c38"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c39"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>8</mn><mo>,</mo><mn>9</mn><mo>,</mo><mn>10</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c38"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c39"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>8</mn><mo>,</mo><mn>9</mn><mo>,</mo><mn>10</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td>Pyramid bottom</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c39"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>9</mn><mo>,</mo><mn>12</mn><mo>,</mo><mn>11</mn><mo>,</mo><mn>10</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c39"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>9</mn><mo>,</mo><mn>12</mn><mo>,</mo><mn>11</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container>, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c39"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>9</mn><mo>,</mo><mn>11</mn><mo>,</mo><mn>10</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
</table>
</div><span class="Caption">
<span class="Label">Table&#160;10.4</span><span class="CaptionText">
The vertex indices that form the faces of our sample mesh, either as
    a polygon mesh or a triangle mesh
</span>
</span>
</div><p>
The vertices must be listed in clockwise order around a face, but it doesn't matter which one is
considered the &#8220;first&#8221; vertex; they can be cycled without changing the logical structure of the
mesh.  For example, the quad forming the cube top could equivalently have been given as
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>0</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container>, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container>, or <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>3</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container>.
</p>
<p>
As indicated by the comments in <a href="#indexed_triangle_mesh">Listing&#160;10.5</a>, additional data are almost
always stored per vertex, such as texture coordinates, surface normals, basis vectors, colors,
skinning data, and so on. Each of these is discussed in later sections in the context of the
techniques that make use of the data.  Additional data can also be stored at the triangle level,
such as an index that tells which material to use for that face, or the plane equation (part of
which is the surface normal&#8212;see <a href="geomprims.html#planes">Section&#160;9.5</a>) for the face. This is highly
useful for editing purposes or in other tools that perform mesh manipulations in software. For
real-time rendering, however, we seldom store data at the triangle level beyond the three vertex
indices. In fact, the most common method is to not have a <span class="inlinecode">struct Triangle</span> at all,
and to represent the entire list of triangles simply as an array (e.g. <span class="inlinecode">
unsigned short
triList[]
</span>), where the length of the array is the number of triangles times 3. Triangles with
identical properties are grouped into batches so that an entire batch can be fed to the GPU in
this optimal format. After we review many of the concepts that give rise to the need to store
additional data per vertex, <a href="#geometry_delivery">Section&#160;10.10.2</a> looks at several more specific
examples of how we might feed that data to the graphics API. By the way, as a general rule,
things are a lot easier if you do not try to use the same mesh class for both rendering and
editing. The requirements are very different, and a bulkier data structure with more flexibility
is best for use in tools, importers, and the like.
</p>
<p>
Note that in an indexed triangle mesh, the edges are not stored explicitly, but rather the
adjacency information contained in an indexed triangle list is stored implicitly: to locate
shared edges between triangles, we must search the triangle list.  Our original trivial &#8220;array
of triangles&#8221; format in <a href="#triangle_mesh_trivial_representation">Listing&#160;10.4</a> did not have
<i>any</i> logical connectivity information (although we could have attempted to detect whether
the vertices on an edge were identical by comparing the vertex positions or other properties).
What's surprising is that the &#8220;extra&#8221; connectivity information contained in the indexed
representation actually results in a reduction of memory usage in most cases, compared to the
flat method.  The reason for this is that the information stored at the vertex level, which is
duplicated in the trivial flat format, is relatively large compared to a single integer index.
(At a minimum, we must store a 3D vector position.) In meshes that arise in practice, a typical
vertex has a
    valence of around 3&#8211;6, which means that the flat format duplicates quite a lot of data.
</p>
<p>
The simple indexed triangle mesh scheme is appropriate for many  applications, including
the very important one of rendering. However, some operations on triangle meshes require a more
advanced data structure in order to be implemented more efficiently. The basic problem is that
the adjacency between triangles is not expressed explicitly and must be extracted by searching
the triangle list. Other representation techniques exist that make this information available in
constant time.  One idea is to maintain an edge list explicitly.  Each edge is defined by listing
the two vertices on the ends.  We also maintain a list of triangles that share the edge.  Then
the triangles can be viewed as a list of three edges rather than a list of three vertices, so
they are stored as three indices into the edge list rather than the vertex list.  An extension of
this idea is known as the
    <i>winged-edge</i> model <a class="RefCite" href="#reference_7">[7]</a>, which also stores,
for each vertex, a reference to one edge that uses the vertex.  The edges and triangles may be
traversed intelligently to quickly locate all edges
and triangles that use the vertex.
</p>
<h2 id="surface_normals"><span class="SectionNumber">10.4.2</span><span class="SectionTitle">Surface Normals</span></h2>
<p class="NoIndent">Surface normals are used for several different purposes in graphics; for example, to compute
proper lighting (<a href="#standard_local_lighting_model">Section&#160;10.6</a>), and for backface culling
(<a href="#backface_culling">Section&#160;10.10.5</a>).  In general, a surface normal is a unit<a href="#footnote_10" class="FootnoteRef">10</a> vector that
is perpendicular to a surface.  We might be interested in the normal of a given face, in which
case the surface of interest is the plane that contains the face.  The surface normals for
polygons can be computed easily by using the techniques from <a href="geomprims.html#planes">Section&#160;9.5</a>.
</p>
<p>
Vertex-level normals are a bit trickier.  First, it should be noted that, strictly speaking,
there is not a true surface normal at a vertex (or an edge for that matter), since these
locations mark discontinuities in the surface of the polygon mesh.  Rather, for rendering
purposes, we typically interpret a polygon mesh as an approximation to some <i>smooth</i>
surface. So we don't want a normal to the piecewise linear surface defined by the polygon mesh;
rather, we want (an approximation of) the surface normal of the smooth surface.
</p>
<p>The primary purpose of vertex normals is lighting.  Practically every lighting model takes a
surface normal at the spot being lit as an input.  Indeed, the surface normal is part of the
rendering equation itself (in the
    Lambert factor), so it is always an input, even if the BRDF does
not depend on it.  We have normals available only at the vertices, but yet we need to compute
lighting values over the entire surface. What to do? If hardware resources permit (as they
usually do nowadays), then we can approximate the normal of the continuous surface corresponding
to any point on a given face by interpolating vertex normals and renormalizing the result. This
technique is illustrated in <a href="#cylinder_hexagon_interpolated_normals">Figure&#160;10.12</a>, which shows a
cross section of a cylinder (black circle) that is being approximated by a hexagonal prism (blue
outline). Black normals at the vertices are the true surface normals, whereas the interior
normals are being approximated through interpolation.  (The actual normals used would be the
result of stretching these out to unit length.)
</p>
<div id="cylinder_hexagon_interpolated_normals" class="Display Figure Narrow">
<div class="Body">
		<img class="WithFrame" src="figs/graphics/cylinder_hexagon_interpolated_normals.png" loading="lazy" width="428" height="194">
</div><span class="Caption">
<span class="Label">Figure&#160;10.12</span><span class="CaptionText">
A cylinder approximated with a hexagonal
prism.
</span>
</span>
</div><p>Once we have a normal at a given point, we can perform the full lighting equation per pixel. This
is known as <i>per-pixel</i> shading.<a href="#footnote_11" class="FootnoteRef">11</a>  An alternative strategy to per-pixel shading, known as
    <i>Gouraud</i><a href="#footnote_12" class="FootnoteRef">12</a> shading <a class="RefCite" href="#reference_9">[9]</a>, is to
perform lighting calculations only at the vertex level, and then interpolate the results
themselves, rather than the normal, across the face. This requires less computation, and is still
done on some systems, such as the
    Nintendo Wii.
</p>
<div id="cylinder_different_number_of_sides" class="Display Figure Wide">
<div class="Body">
<span class="CenterContainer">
<span></span><span class="CenterBody">
        <img src="figs/graphics/cylinder_different_number_of_sides.png" loading="lazy" width="600" height="553">
</span><span></span>
</span>
</div><span class="Caption">
<span class="Label">Figure&#160;10.13</span><span class="CaptionText">
Approximating cylinders with prisms of
varying number of sides.
</span>
</span>
</div><p>
<a href="#cylinder_different_number_of_sides">Figure&#160;10.13</a> shows per-pixel lighting of cylinders with a
different number of sides.  Although the illusion breaks down on the ends of the cylinder, where
the silhouette edge gives away the low-poly nature of the geometry, this method of approximating
a smooth surface can indeed make even a very low-resolution mesh look &#8220;smooth.&#8221; Cover up the
ends of the cylinder, and even the 5-sided cylinder is remarkably convincing.
</p>
<p>Now that we understand how normals are interpolated in order to approximately reconstruct a
curved surface, let's talk about how to obtain vertex normals.  This information may not be
readily available, depending on how the triangle mesh was generated. If the mesh is generated
procedurally, for example, from a parametric curved surface, then the vertex normals can be
supplied at that time.  Or you may simply be handed the vertex normals from the modeling package
as part of the mesh.  However, sometimes the surface normals are not provided, and we must
approximate them by interpreting the only information available to us: the vertex positions and
the triangles. One trick that works is to average the normals of the adjacent triangles, and then
renormalize the result.  This classic technique is demonstrated in
<a href="#calculating_vertex_normals">Listing&#160;10.6</a>.
</p>
<p>
<div class="Wide Display Listing">
<pre>
struct Vertex {
    Vector3 pos;
    Vector3 normal;
};
struct Triangle {
    int     vertexIndex[3];
    Vector3 normal;
};
struct TriangleMesh {
    int      vertexCount;
    Vertex   *vertexList;
    int      triangleCount;
    Triangle *triangleList;

    void computeVertexNormals() {

        // First clear out the vertex normals
        for (int i = 0 ; i &lt; vertexCount ; ++i) {
            vertexList[i].normal.zero();
        }

        // Now add in the face normals into the
        // normals of the adjacent vertices
        for (int i = 0 ; i &lt; triangleCount ; ++i) {

            // Get shortcut
            Triangle &amp;tri = triangleList[i];

            // Compute triangle normal.
            Vector3 v0 = vertexList[tri.vertexIndex[0]].pos;
            Vector3 v1 = vertexList[tri.vertexIndex[1]].pos;
            Vector3 v2 = vertexList[tri.vertexIndex[2]].pos;
            tri.normal = cross(v1-v0, v2-v1);
            tri.normal.normalize();

            // Sum it into the adjacent vertices
            for (int j = 0 ; j &lt; 3 ; ++j) {
                vertexList[tri.vertexIndex[j]].normal += tri.normal;
            }
        }

        // Finally, average and normalize the results.
        // Note that this can blow up if a vertex is isolated
        // (not used by any triangles), and in some other cases.
        for (int i = 0 ; i &lt; vertexCount ; ++i) {
            vertexList[i].normal.normalize();
        }
    }
};
</pre>
</div>
</p>
<p>
Averaging face normals to compute vertex normals is a tried-and-true technique that works well in
most cases.  However, there are a few things to watch out for.  The first is that sometimes the
mesh is <i>supposed</i> to have a discontinuity, and if we're not careful, this discontinuity
will get &#8220;smoothed out.&#8221; Take the very simple example of a box. There should be a sharp
lighting discontinuity at its edges. However, if we use vertex normals computed from the average
of the surface normals, then there is no lighting discontinuity, as shown in
<a href="#vertex_normal_too_smooth">Figure&#160;10.14</a>.
</p>
<div id="vertex_normal_too_smooth" class="Display Figure Narrow">
<div class="Body">
        <img src="figs/graphics/vertex_normal_too_smooth.png" loading="lazy" width="411" height="293">
</div><span class="Caption">
<span class="Label">Figure&#160;10.14</span><span class="CaptionText">
On the right, the box edges are not visible
because there is only one normal at each corner
</span>
</span>
</div><div id="box_mesh_smoothed" class="Display Table Wide">
<div class="Body FontScriptSize">
    <table>
<tr class="HLineAbove">
<td class="AlignRight">
<table>
<tr>
<td class="AlignRight" colspan="3"><b>Vertices</b></td>
</tr>
<tr>
<td class="AlignRight"><b>#</b></td>
<td><b>Position</b></td>
<td><b>Normal</b></td>
</tr>
<tr>
<td class="AlignRight">0</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>&#8722;</mo><mn>0.577</mn><mo>,</mo><mo>+</mo><mn>0.577</mn><mo>,</mo><mo>+</mo><mn>0.577</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">1</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>+</mo><mn>0.577</mn><mo>,</mo><mo>+</mo><mn>0.577</mn><mo>,</mo><mo>+</mo><mn>0.577</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">2</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>+</mo><mn>0.577</mn><mo>,</mo><mo>+</mo><mn>0.577</mn><mo>,</mo><mo>&#8722;</mo><mn>0.577</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">3</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>&#8722;</mo><mn>0.577</mn><mo>,</mo><mo>+</mo><mn>0.577</mn><mo>,</mo><mo>&#8722;</mo><mn>0.577</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">4</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>&#8722;</mo><mn>0.577</mn><mo>,</mo><mo>&#8722;</mo><mn>0.577</mn><mo>,</mo><mo>+</mo><mn>0.577</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">5</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>+</mo><mn>0.577</mn><mo>,</mo><mo>&#8722;</mo><mn>0.577</mn><mo>,</mo><mo>+</mo><mn>0.577</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">6</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>+</mo><mn>0.577</mn><mo>,</mo><mo>&#8722;</mo><mn>0.577</mn><mo>,</mo><mo>&#8722;</mo><mn>0.577</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">7</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>&#8722;</mo><mn>0.577</mn><mo>,</mo><mo>&#8722;</mo><mn>0.577</mn><mo>,</mo><mo>&#8722;</mo><mn>0.577</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
</table>
</td>
<td class="VLineLeft">
<table>
<tr>
<td colspan="2"><b>Faces</b></td>
</tr>
<tr>
<td><b>Description</b></td>
<td><b>Indices</b></td>
</tr>
<tr>
<td>Top</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td>Front</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c36"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>2</mn><mo>,</mo><mn>6</mn><mo>,</mo><mn>7</mn><mo>,</mo><mn>3</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td>Right</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c35"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c36"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>2</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>5</mn><mo>,</mo><mn>6</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td>Left</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c34"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>7</mn><mo>,</mo><mn>4</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td>Back</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c34"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c35"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>5</mn><mo>,</mo><mn>1</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td>Bottom</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c34"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c36"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c35"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>4</mn><mo>,</mo><mn>7</mn><mo>,</mo><mn>6</mn><mo>,</mo><mn>5</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
</table>
</td>
</tr>
</table>
</div><span class="Caption">
<span class="Label">Table&#160;10.5</span><span class="CaptionText">Polygon mesh of a box with welded vertices and smoothed edges</span>
</span>
</div><p>
The basic problem is that the surface discontinuity at the box edges cannot be properly
represented because <i>there is only one normal stored per vertex</i>.  The solution to this
problem is to
    &#8220;detach&#8221; the faces; in other words, duplicate the vertices along the edge where
there is a true geometric discontinuity, creating a topological discontinuity to prevent the
vertex normals from being averaged.  After doing so, the faces are no longer logically connected,
but this seam in the topology of the mesh doesn't cause a problem for many important tasks, such
as rendering and raytracing.  <a href="#box_mesh_smoothed">Table&#160;10.5</a> shows a smoothed box mesh with eight
vertices. Compare that mesh to the one in <a href="#box_mesh_detached">Table&#160;10.6</a>, in which the faces have
been detached, resulting in 24 vertices.
</p>
<div id="box_mesh_detached" class="Display Table Wide">
<div class="Body FontScriptSize">
    <table>
<tr class="HLineAbove">
<td class="AlignRight">
<table>
<tr>
<td class="AlignRight" colspan="3"><b>Vertices</b></td>
</tr>
<tr>
<td class="AlignRight"><b>#</b></td>
<td><b>Position</b></td>
<td><b>Normal</b></td>
</tr>
<tr>
<td class="AlignRight">0</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">1</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">2</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">3</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">4</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">5</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">6</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">7</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">8</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>+</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">9</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>+</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">10</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>+</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">11</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>+</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">12</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">13</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">14</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">15</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">16</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">17</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">18</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">19</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">20</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">21</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">22</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">23</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>+</mo><mn>1</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mo>&#8722;</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
</table>
</td>
<td class="VLineLeft">
<table>
<tr>
<td colspan="2"><b>Faces</b></td>
</tr>
<tr>
<td><b>Description</b></td>
<td><b>Indices</b></td>
</tr>
<tr>
<td>Top</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td>Front</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c34"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c35"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c36"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>4</mn><mo>,</mo><mn>5</mn><mo>,</mo><mn>6</mn><mo>,</mo><mn>7</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td>Right</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c38"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c39"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>8</mn><mo>,</mo><mn>9</mn><mo>,</mo><mn>10</mn><mo>,</mo><mn>11</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td>Left</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c34"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c35"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>12</mn><mo>,</mo><mn>13</mn><mo>,</mo><mn>14</mn><mo>,</mo><mn>15</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td>Back</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c36"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c38"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c39"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>16</mn><mo>,</mo><mn>17</mn><mo>,</mo><mn>18</mn><mo>,</mo><mn>19</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td>Bottom</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>20</mn><mo>,</mo><mn>21</mn><mo>,</mo><mn>22</mn><mo>,</mo><mn>23</mn><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
</table>
</td>
</tr>
</table>
</div><span class="Caption">
<span class="Label">Table&#160;10.6</span><span class="CaptionText">Polygon mesh of a box with detached faces and lighting discontinuities at the edges</span>
</span>
</div><p>An extreme version of this situation occurs when two faces are placed back-to-back.  Such
infinitely thin double-sided geometry can arise with foliage, cloth, billboards, and the like. In
this case, since the normals are exactly opposite, averaging them produces the zero vector, which
cannot be normalized.  The simplest solution is to detach the faces so that the vertex normals
will not average together.  Or if the front and back sides are mirror images, the two
&#8220;single-sided&#8221; polygons can be replaced by one &#8220;double-sided&#8221; one.  This requires special
treatment during rendering to disable backface culling (<a href="#backface_culling">Section&#160;10.10.5</a>) and
intelligently dealing with the normal in the lighting equation.
</p>
<p>
A more subtle problem is that the averaging is biased towards large numbers of triangles with the
same normal.  For example, consider the vertex at index 1 in
<a href="#cube_and_pyramid_trimesh">Figure&#160;10.11</a>. This vertex is adjacent to two triangles on the top of the
cube, but only one triangle on the right side and one triangle on the back side.  The vertex
normal computed by averaging the triangle normals is biased because the top face normal
essentially gets twice as many &#8220;votes&#8221; as each of the side face normals.  But this topology is
the result of an arbitrary decision as to where to draw the edges to triangulate the faces of the
cube.  For example, if we were to triangulate the top face by drawing an edge between vertices 0
and 2 (this is known as
    &#8220;turning&#8221; the edge), all of the normals on the top face wouldchange.
</p>
<p>
 Techniques exist to deal
with this problem, such as weighing the contribution from each adjacent face based on the
interior angle adjacent to the vertex, but it's often ignored in practice. Most of the really
terrible examples are contrived ones like this, where the faces should be detached anyway.
Furthermore, the normals are an approximation to begin with, and having a slightly perturbed
normal is often difficult to tell visually.
</p>
<p>
Although some modeling packages can deliver vertex normals for you, fewer provide the basis
vectors needed for bump mapping.  As we see in <a href="#bump_mapping">Section&#160;10.9</a>, techniques used to
synthesize vertex basis vectors are similar to those described here.
</p>
<p>Before we go on, there is one very important fact about surface normals that we must mention.  In
certain circumstances, they cannot be transformed by the same matrix that is used to transform
positions.  (This is an entirely separate issue from the fact that normals should not be
translated like positions.)  The reason for this is that normals are
    <i>covariant</i> vectors.  &#8220;Regular&#8221; vectors, such as position and velocity, are said to be
<i>contravariant</i>: if we scale the coordinate space used to describe the vector, the
coordinates will respond in the <i>opposite</i> direction. If we use a coordinate space with a
larger scale (for example, using meters instead of feet) the coordinates of a contravariant
vector respond to the contrary, by becoming smaller. Notice that this is all about scale;
translation and rotation are not
part of the discussion. Normals and other types of gradients,
known as
    <i>dual</i> vectors, do not behave like this.
</p>
<p>
Imagine that we stretch a 2D object, such as a circle, horizontally, as shown in
<a href="#normals_dual_vectors">Figure&#160;10.15</a>. Notice that the normals (shown in light blue in the right
figure) begin to turn to point more <i>vertically</i>&#8212;the horizontal coordinates of the normals
are decreasing in absolute value while the horizontal coordinates of the positions are
increasing. A stretching of the object (object getting bigger while coordinate space stays the
same) has the same effect as scaling down the coordinate space while holding the object at the
same size. The coordinates of the normal change in the same direction as the scale of the
coordinate space, which is why they are called covariant vectors.
</p>
<div id="normals_dual_vectors" class="Display Figure Wide">
<div class="Body">
<span class="minipage">
<span class="fbox"><img src="figs/graphics/normals_dual_vectors.png" loading="lazy" width="585" height="196">
</span>
</span>
</div><span class="Caption">
<span class="Label">Figure&#160;10.15</span><span class="CaptionText">
Transforming normals with nonuniform scale.  The light red vectors show the normals multiplied by the same transform matrix used to transform the object; the dark red vectors are their normalized versions.  The light blue vectors show the correct normals.
</span>
</span>
</div><p>To properly transform surface normals, we must use the <i>inverse transpose</i> of the matrix
used to transform positions; that is, the result of transposing and inverting the matrix. This is
sometimes denoted <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D40C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: 0.413em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-n"><mjx-c class="mjx-c54"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup>
<mrow>
<mrow><mi mathvariant="bold">M</mi></mrow>
</mrow>
<mrow><mo>&#8722;</mo><mi mathvariant="normal">T</mi></mrow>
</msup></math></mjx-assistive-mml>
</mjx-container>, since it doesn't matter if we transpose first, or invert
first: <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D40C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: 0.413em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-script></mjx-msup><mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-script style="vertical-align: 0.363em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c54"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D40C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: 0.413em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c54"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msup><mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-script style="vertical-align: 0.363em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msup>
<mrow>
<mrow><mi mathvariant="bold">M</mi></mrow>
</mrow>
<mrow><mo>&#8722;</mo><mn>1</mn></mrow>
</msup><msup><mo stretchy="false">)</mo>
<mrow><mi mathvariant="normal">T</mi></mrow>
</msup><mo>=</mo><mo stretchy="false">(</mo><msup>
<mrow>
<mrow><mi mathvariant="bold">M</mi></mrow>
</mrow>
<mrow><mi mathvariant="normal">T</mi></mrow>
</msup><msup><mo stretchy="false">)</mo>
<mrow><mo>&#8722;</mo><mn>1</mn></mrow>
</msup></math></mjx-assistive-mml>
</mjx-container>.  If the transform matrix doesn't contain any
scale (or skew), then the matrix is orthonormal, and thus the inverse transpose is simply the
same as the original matrix, and we can safely transform normals with this transform.  If the
matrix contains uniform scale, then we can still ignore this, but we must renormalize the normals
after transforming them.  If the matrix contains nonuniform scale (or skew, which is
indistinguishable from nonuniform scale combined with rotation), then to properly transform the
normals, we must use the inverse transpose transform matrix, and then re-normalize the resulting
transformed normals.
</p>
<div class="KeyIdea">
    In general, normals must be transformed with the inverse transpose of the matrix used to
    transform positions.  This can safely be ignored if the transform matrix is without scale. If the
    matrix contains uniform scale, then all that is required is to renormalize the normals after
    transformation.  If the matrix contains nonuniform scale, then we must use the inverse transpose
    transform and renormalize after transforming.
</div>

<h1 id="texture_mapping"><span class="SectionNumber">10.5</span><span class="SectionTitle">Texture Mapping</span></h1>
<p class="NoIndent">There is much more to the appearance of an object than its shape.  Different objects are
different colors and have different patterns on their surface.  One simple yet powerful way to
capture these qualities is through <i>texture mapping</i>.  A texture map is a bitmap image that
is &#8220;pasted&#8221; to the surface of an object. Rather than controlling the color of an object per
triangle or per vertex, with texture mapping we can control the color at a much finer level&#8212;per
    <i>texel</i>. (A texel is a single pixel in a texture map.  This is a handy word to know, since
in graphics contexts, there are lots of different bitmaps being accessed, and it's nice to have a
short way to differentiate between a pixel in the frame buffer and a pixel in a texture.)
</p>
<p>
So a texture map is just a regular bitmap that is applied onto the surface of a model.  Exactly
how does this work?  Actually, there are many different ways to apply a texture map
onto a mesh.
    <i>Planar mapping</i> projects the texture orthographically onto the mesh. <i>Spherical</i>,
<i>cylindrical</i>, and <i>cubic</i> mapping are various methods of &#8220;wrapping&#8221; the texture
around the object. The details of each of these techniques are not important to us at the moment,
since modeling packages such as <i>3DS Max</i> deal with these user interface issues.  The key
idea is that, at each point on the surface of the mesh, we can obtain <i>texture-mapping
coordinates</i>, which define the 2D location in the texture map that corresponds to this 3D
location.  Traditionally, these coordinates are assigned the variables <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container>, where <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></mjx-assistive-mml>
</mjx-container> is the
horizontal coordinate and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></mjx-assistive-mml>
</mjx-container> is the vertical coordinate; thus, texture-mapping coordinates are
often called
    <i>UV coordinates</i> or simply <i>UV</i>s.
</p>
<p>Although bitmaps come in different sizes, UV coordinates are normalized such that the mapping
space ranges from 0 to 1 over the entire width (<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></mjx-assistive-mml>
</mjx-container>) or height (<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></mjx-assistive-mml>
</mjx-container>) of the image, rather than
depending on the image dimensions.  The origin of this space is either in the upper left-hand
corner of the image, which is the DirectX-style convention, or in the lower left-hand corner, the
OpenGL conventions. We use the DirectX conventions in this book.
<a href="#texture_mapping_example_map">Figure&#160;10.16</a> shows the texture map that we use in several examples and
the DirectX-style coordinate conventions.
</p>
<div id="texture_mapping_example_map" class="Display Figure Wrap">
<div class="Body">
        <img src="figs/graphics/texture_mapping_example_map.png" loading="lazy" width="272" height="263">
</div><span class="Caption">
<span class="Label">Figure&#160;10.16</span><span class="CaptionText">
An example texture map, with labeled UV
coordinates according to the DirectX convention, which places the origin in the upper-left
corner.
</span>
</span>
</div><p>
In principle, it doesn't matter how we determine the UV coordinates for a given point on the
surface.  However, even when UV coordinates are calculated dynamically, rather than edited by an
artist, we typically compute or assign UV coordinates only at the <i>vertex</i> level, and the UV
coordinates at an arbitrary interior position on a face are obtained through
    interpolation.  If you imagine the texture map as a stretchy cloth, then when we assign
texture-mapping coordinates to a vertex, it's like sticking a pin through the cloth at those UV
coordinates, and then pinning the cloth onto the surface at that vertex.  There is one pin per
vertex, so the whole surface is covered.
</p>
<p>Let's look at some examples.  <a href="#texture_map_example_basic_quad">Figure&#160;10.17</a> shows  a single
texture-mapped quad, with different UV values assigned to the vertices.  The bottom of each
diagram shows the UV space of the texture.  You should study these examples until you are sure
you understand them.
</p>
<div id="texture_map_example_basic_quad" class="Display Figure Wide">
<div class="Body">
<span class="minipage">
    <table>
<tr>
<td class="AlignCenter"><img src="figs/graphics/texture_map_example_full.png" loading="lazy" width="267" height="243">
</td>
<td class="AlignCenter"><img src="figs/graphics/texture_map_example_zoom.png" loading="lazy" width="267" height="243">
</td>
<td class="AlignCenter"><img src="figs/graphics/texture_map_example_rotate.png" loading="lazy" width="267" height="243">
</td>
</tr>
<tr>
<td class="AlignCenter"><img src="figs/graphics/texture_map_example_full_uvspace.png" loading="lazy" width="267" height="243">
</td>
<td class="AlignCenter"><img src="figs/graphics/texture_map_example_zoom_uvspace.png" loading="lazy" width="267" height="243">
</td>
<td class="AlignCenter"><img src="figs/graphics/texture_map_example_rotate_uvspace.png" loading="lazy" width="267" height="243">
</td>
</tr>
</table>
</span>
</div><span class="Caption">
<span class="Label">Figure&#160;10.17</span><span class="CaptionText">A texture-mapped quad, with different UV coordinates assigned to the vertices </span>
</span>
</div><p>UV coordinates outside of the range <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container> are allowed, and in fact are quite useful.  Such
coordinates are interpreted in a variety of ways.  The most common addressing modes are
    <i>repeat</i> (also known as <i>tile</i> or <i>wrap</i>) and <i>clamp</i>.  When repeating is
used, the integer portion is discarded and only the fractional portion is used, causing the
texture to repeat, as shown in the left side of <a href="#texture_map_clamp_vs_tile">Figure&#160;10.18</a>.  Under
clamping, when a coordinate outside the range <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container> is used to access a bitmap, it is clamped
in range. This has the effect of streaking the edge pixels of the bitmap outwards, as depicted on
the right side of <a href="#texture_map_clamp_vs_tile">Figure&#160;10.18</a>.  The mesh in both cases is identical: a
single polygon with four vertices.  And the meshes have identical UV coordinates. The only
difference is how coordinates outside the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container> range are interpreted.
</p>
<div id="texture_map_clamp_vs_tile" class="Display Figure Wide">
<div class="Body">
<span class="CenterContainer">
<span></span><span class="CenterBody">
    <table>
<tr>
<td class="AlignCenter"><b><span class="FontSmall">Repeat</span></b></td>
<td class="AlignCenter"><b><span class="FontSmall">Clamp</span></b></td>
</tr>
<tr>
<td class="AlignCenter"><img src="figs/graphics/texture_map_example_tile.png" loading="lazy" width="267" height="243">
</td>
<td class="AlignCenter"><img src="figs/graphics/texture_map_example_clamp.png" loading="lazy" width="267" height="243">
</td>
</tr>
</table>
</span><span></span>
</span>
</div><span class="Caption">
<span class="Label">Figure&#160;10.18</span><span class="CaptionText">Comparing repeating and clamping texture addressing modes</span>
</span>
</div><p>There are other options supported on some hardware, such as mirror, which is similar to repeat
except that every other tile is mirrored.  (This can be beneficial because it guarantees that no
&#8220;seam&#8221; will exist between adjacent tiles.)  On most hardware, the addressing mode can be set
for the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></mjx-assistive-mml>
</mjx-container>- and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></mjx-assistive-mml>
</mjx-container>-coordinates independently.  It's important to understand that these rules
are applied at the last moment, when the coordinates are used to index into the texture. The
coordinates at the vertex are not limited or processed in any way; otherwise, they could not be
interpolated properly across the face.
</p>
<p>
<a href="#texture_map_examples_not_quad">Figure&#160;10.19</a> shows one last instructive example: the same mesh is
texture mapped two different ways.
</p>
<div id="texture_map_examples_not_quad" class="Display Figure Wide">
<div class="Body">
<span class="CenterContainer">
<span></span><span class="CenterBody">
    <table>
<tr>
<td class="AlignCenter"><img src="figs/graphics/texture_map_example_warp1.png" loading="lazy" width="267" height="243">
</td>
<td class="AlignCenter"><img src="figs/graphics/texture_map_example_warp2.png" loading="lazy" width="267" height="243">
</td>
</tr>
<tr>
<td class="AlignCenter"><img src="figs/graphics/texture_map_example_warp1_uvspace.png" loading="lazy" width="267" height="243">
</td>
<td class="AlignCenter"><img src="figs/graphics/texture_map_example_warp2_uvspace.png" loading="lazy" width="267" height="243">
</td>
</tr>
</table>
</span><span></span>
</span>
</div><span class="Caption">
<span class="Label">Figure&#160;10.19</span><span class="CaptionText">Texture mapping works on stuff that's not just a single quad</span>
</span>
</div>

<h1 id="standard_local_lighting_model"><span class="SectionNumber">10.6</span><span class="SectionTitle">The Standard Local Lighting Model</span></h1>
<p class="NoIndent">In the rendering equation, the BRDF describes the scattering distribution for light of a given
frequency and direction of incidence.  The differences in distributions between different
surfaces is precisely what causes those surfaces (or even different surface points on the same
object) to look different from one another. Most BRDFs are expressed in a computer by some sort
of formula, where certain numbers in the formula are adjusted to match the desired material
properties.  The formula itself is often called a
    <i>lighting model</i>, and the particular values going into the formula come from the
    <i>material</i> assigned to the surface. It is common
for a game engine to use only a handful of lighting models, even though the materials in the
scene may be quite diverse and there may be thousands of different BRDFs. Indeed, just a few
years ago, almost all real-time rendering was done with a <i>single</i> lighting model.  In fact,
the practice is not uncommon today.
</p>
<p>This lighting model was so ubiquitous that it was hardwired into the very rendering APIs of
OpenGL and DirectX.  Although these older parts of the API have effectively become legacy
features on hardware with programmable shaders, the standard model is still commonly used in the
more general framework of shaders and generic constants and interpolants.  The great diversity
and flexibility available is usually used to determine the best way to feed the parameters into
the model (for example, by doing multiple lights at once, or doing all the lighting at the end
with deferred shading), rather than using different models.  But even ignoring programmable
shaders, at the time of this writing, the most popular video game console is the
    Nintendo Wii,<a href="#footnote_13" class="FootnoteRef">13</a>
which has hardwired support for this standard model.
</p>
<p>
The venerable standard lighting model is the subject of this section.  Since its development
precedes the framework of the BRDF and the rendering equation by at least a decade, we first
present this model in the simplified context that surrounded its creation.  This notation and
perspective are still predominant in the literature today, which is why we think we should
present the idea in its own terms.  Along the way, we show how one component of the model (the
diffuse component) is modeled as a BRDF.  The standard model is important in the present, but you
must understand the rendering equation if you want to be prepared for the future.
</p>
<h2 id="lighting_equation_overview"><span class="SectionNumber">10.6.1</span><span class="SectionTitle">The Standard Lighting Equation: Overview</span></h2>
<p class="NoIndent">
Bui Tuong Phong <a class="RefCite" href="#reference_21">[21]</a> introduced the basic concepts behind the standard lighting
model in 1975.  Back then, the focus was on a fast way to model <i>direct</i> reflection. While
certainly researchers understood the importance of indirect light, it was a luxury that could not
yet be afforded.  Thus while the rendering equation (which, as we noted previously, came into
focus a decade or so after the proposal of the standard model) is an equation for the radiance
outgoing from a point in any particular direction, the only outgoing direction that mattered in
those days were the directions that pointed to the eye. Similarly, while the rendering equation
considers incident light from the entire hemisphere surrounding the surface normal, if we ignore
indirect light, then we need not cast about in all incident directions.  We need to consider only
those directions that aim at a light source. We examine some different ways that light sources
are modeled in real-time graphics in more detail in <a href="#light_sources">Section&#160;10.7</a>, but for now an
important point is that the light sources are not emissive <i>surfaces</i> in the scene, as they
are in the rendering equation and in the real world. Instead, lights are special entities without
any corresponding geometry, and are simulated as if the light were emitting from a single point.
Thus, rather than including a solid angle of directions corresponding to the projection of the
emissive surface of each light source onto the hemisphere surrounding <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>, we only care
about a <i>single</i> incident direction for the light. To summarize, the original goal of the
standard model was to determine the light reflected back in the direction of the camera, only
considering direct reflections, incident from a finite number of directions, one direction for
each light source.
</p>
<p>
Now for the model.  The basic idea is to classify light coming into the eye into four distinct
categories, each of which has a unique method for calculating its contribution. The four
categories are
</p>
<ul>
    <li>
The <span class="ListItemTitle">emissive</span> contribution, denoted <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow>
<mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi></mrow>
</msub></math></mjx-assistive-mml>
</mjx-container>, is the same
        as the rendering equation. It tells the amount of radiance emitted directly from the
        surface in the given direction.  Note that without global illumination techniques,
        these surfaces do not actually light up anything (except themselves).
</li>
<li>
The <span class="ListItemTitle">specular</span> contribution, denoted <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</msub></math></mjx-assistive-mml>
</mjx-container>, accounts for
        light incident directly from a light source that is scattered preferentially in the
        direction of a perfect &#8220;mirror bounce.&#8221;
</li>
<li>
The <span class="ListItemTitle">diffuse</span> contribution, denoted <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">f</mi></mrow>
</msub></math></mjx-assistive-mml>
</mjx-container>, accounts for
        light incident directly from a light source that is scattered in every direction
        evenly.
</li>
<li>
The <span class="ListItemTitle">ambient</span> contribution, denoted <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c62"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow>
<mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi></mrow>
</msub></math></mjx-assistive-mml>
</mjx-container>,  is a fudge
        factor to account for all indirect light.
</li>
</ul>
<p>
The letter <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> is intended to be short for &#8220;contribution.&#8221;  Note the bold typeface,
indicating that these contributions are not scalar quantities representing the amount of light of
a particular wavelength, but rather they are vectors representing <i>colors</i> in some basis
with a discrete number of components (&#8220;channels&#8221;).
    As stated before, due to the tri-stimulus human vision system, the number of channels is almost
always chosen to be three. A less fundamental choice is which three basis functions to use, but
in real-time graphics, by far the most common choice is to make one channel for red, one channel
for blue, and one channel for green.  These details are surprisingly irrelevant from a high-level
discussion (they will not appear anywhere in the equations), but, of course, they are important
practical considerations.
</p>
<p>
The emissive term is the same as in the rendering equation, so there's not much more detail to
say about it.  In practice, the emissive contribution is simply a constant color at any given
surface point <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>. The specular, diffuse, and ambient terms are more involved, so we
discuss each in more detail in the next three sections.
</p>
<h2 id="specular_component"><span class="SectionNumber">10.6.2</span><span class="SectionTitle">The Specular Component</span></h2>
<p class="NoIndent">The <i>specular component</i> of the standard lighting model accounts for the light that is
reflected (mostly) in a &#8220;perfect mirror bounce&#8221; off the surface.  The specular component is
what gives surfaces a &#8220;shiny&#8221; appearance.  Rougher surfaces tend to scatter the light in a much
broader pattern of directions, which is modeled by the diffuse component described in
<a href="#diffuse_component">Section&#160;10.6.3</a>.
</p>
<p>Now let's see how the standard model calculates the specular contribution. The important vectors
are labeled in <a href="#lighting_specular_phong">Figure&#160;10.20</a>.
</p>
<ul>
    <li>
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> is a the local outward-pointing surface normal.
</li>
<li>
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> points towards the viewer.  (The symbol <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D41E TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">e</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>, for &#8220;eye,&#8221; is
        also sometimes used to name this vector.)
</li>
<li>
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D425 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">l</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> points towards the light source.
</li>
<li>
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42B TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">r</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> is the <i>reflection</i> vector, which is the direction of a &#8220;perfect
        mirror bounce.&#8221;  It's the result of reflecting <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D425 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">l</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> about <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>.
</li>
<li>
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D703 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>&#952;</mi></math></mjx-assistive-mml>
</mjx-container> is the angle between <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42B TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">r</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>.
</li>
</ul>
<div id="lighting_specular_phong" class="Display Figure Narrow">
<div class="Body">
		<img class="WithFrame" src="figs/graphics/lighting_specular_phong.png" loading="lazy" width="356" height="226">
</div><span class="Caption"><span class="Label">Figure&#160;10.20</span><span class="CaptionText">Phong model for specular reflection</span>
</span>
</div><p>
For convenience, we assume that all of these vectors are unit vectors.  Our convention in this
book is to denote unit vectors with hats, but we'll drop the hats to avoid decorating the
equations excessively.  Many texts on the subject use these standard variable names and,
especially in the video game community, they are effectively part of the vernacular. It is not
uncommon for
    job interview questions to be posed in such a way that assumes the applicant is familiar with
this framework.
</p>
<p>
One note about the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D425 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">l</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> vector before we continue.  Since lights are abstract entities,
they need not necessarily have a &#8220;position.&#8221;  Directional lights and <i>Doom</i>-style volumetric
lights (see <a href="#light_sources">Section&#160;10.7</a>) are examples for which the position of the light might
not be obvious.  The key point is that the <i>position</i> of the light isn't important, but the
abstraction being used for the light must facilitate the computation of a <i>direction of
incidence</i> at any given shading point.  (It must also provide the color and intensity of incident
light.)
</p>
<p>
Of the four vectors, the first three are inherent degrees of freedom of the problem, and the
reflection vector <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42B TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">r</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> is a derived quantity and must be computed.  The geometry is shown
in <a href="#lighting_specular_r">Figure&#160;10.21</a>.
</p>
<div id="lighting_specular_r" class="Display Figure Narrow">
<div class="Body">
		<img class="WithFrame" src="figs/graphics/lighting_specular_r.png" loading="lazy" width="400" height="250">
</div><span class="Caption">
<span class="Label">Figure&#160;10.21</span><span class="CaptionText">Constructing the reflection vector <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42B TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">r</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container></span>
</span>
</div><p>
As you can see, the reflection vector can be computed by
</p>
<span class="InMarginAnchor">
<span class="InMargin"><span class="EqMarginCaption">Computing the reflection vector is a popular job interview question</span>
</span>
</span><div class="DisplayMath">
<mjx-container class="MathJax" display="true" jax="CHTML" role="presentation" style="font-size: 100%; min-width: 100%; position: relative" width="full">
<mjx-math aria-hidden="true" class="MJX-TEX" display="true" width="full"><mjx-mtable side="right" style="min-width: 100%; display: flex; justify-content: space-between; flex-flow: row nowrap">
<mjx-labels-partner style="flex: 1 0 0; max-width: 3.856em"></mjx-labels-partner><mjx-table style="flex: 0 0 7.224em"><mjx-itable width="full"><mjx-mlabeledtr><mjx-mtd style="text-align: right"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42B TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-texatom space="3" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D425 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-texatom space="3" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D425 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mlabeledtr></mjx-itable></mjx-table>
<mjx-labels style="flex: 0 0 3.856em"><mjx-itable align="right" style=""><mjx-mtr style="height: 1em"><mjx-mtd id="mjx-eqn-10.10"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c28"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c29"></mjx-c></mjx-mtext><mjx-tstrut style="height: 1em; vertical-align: -0.25em"></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-labels>
</mjx-mtable>
</mjx-math>
<mjx-assistive-mml display="block" role="presentation" unselectable="on"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mlabeledtr><mtd><mtext>(10.10)</mtext></mtd><mtd>
<mrow>
<mrow><mi mathvariant="bold">r</mi></mrow>
</mrow><mo>=</mo><mn>2</mn><mo stretchy="false">(</mo>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo>&#8901;</mo>
<mrow>
<mrow><mi mathvariant="bold">l</mi></mrow>
</mrow><mo stretchy="false">)</mo>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo>&#8722;</mo>
<mrow>
<mrow><mi mathvariant="bold">l</mi></mrow>
</mrow><mo>.</mo></mtd></mlabeledtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<p class="NoIndent">
There are many interviewers for whom this equation is a favorite topic, which is why we have
displayed it on a line by itself, despite the fact that it would have fit perfectly fine inline
in the paragraph. A reader seeking a job in the video game industry is advised to fully digest
<a href="#lighting_specular_r">Figure&#160;10.21</a>, to be able to produce <a href="#reflection_vector_formula">Equation&#160;(10.10)</a>
under pressure.  Notice that if we assume <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D425 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">l</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> are unit vectors, then
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42B TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">r</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> will be as well.
</p>
<p>
Now that we know <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42B TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">r</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>, we can compute the specular contribution by using the <i>Phong
model</i> for specular reflection (<a href="#phong_specular_model">Equation&#160;(10.11)</a>).
</p>
<div class="KeyIdea">
<div class="KeyIdeaTitle">The Phong Model for Specular Reflection</div><div class="DisplayMath">
<mjx-container class="MathJax" display="true" jax="CHTML" role="presentation" style="font-size: 100%; min-width: 100%; position: relative" width="full">
<mjx-math aria-hidden="true" class="MJX-TEX" display="true" width="full"><mjx-mtable side="right" style="min-width: 100%; display: flex; justify-content: space-between; flex-flow: row nowrap">
<mjx-labels-partner style="flex: 1 0 0; max-width: 3.856em"></mjx-labels-partner><mjx-table style="flex: 0 0 24.947em"><mjx-itable width="full"><mjx-mlabeledtr><mjx-mtd style="text-align: right; padding-right: 0"><mjx-msub><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mrow space="4"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2297"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D703 TEX-I"></mjx-c></mjx-mi><mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-script style="vertical-align: 0.413em"><mjx-texatom size="s" texclass="ORD"><mjx-msub><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub></mjx-texatom></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mrow space="4"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2297"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-texatom space="3" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42B TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-script style="vertical-align: 0.413em"><mjx-texatom size="s" texclass="ORD"><mjx-msub><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub></mjx-texatom></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mlabeledtr></mjx-itable></mjx-table>
<mjx-labels style="flex: 0 0 3.856em"><mjx-itable align="right" style=""><mjx-mtr style="height: 1.037em"><mjx-mtd id="mjx-eqn-10.11"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c28"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c29"></mjx-c></mjx-mtext><mjx-tstrut style="height: 1.037em; vertical-align: -0.287em"></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-labels>
</mjx-mtable>
</mjx-math>
<mjx-assistive-mml display="block" role="presentation" unselectable="on"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mlabeledtr><mtd><mtext>(10.11)</mtext></mtd><mtd><msub>
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</mrow></msub></mtd><mtd><mi></mi><mo>=</mo>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</mrow></msub><mo>&#8855;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</mrow></msub><mo data-mjx-texclass="CLOSE">)</mo></mrow>
<mo stretchy="false">(</mo><mi>cos</mi><mo data-mjx-texclass="NONE">&#8289;</mo><mi>&#952;</mi><msup><mo stretchy="false">)</mo>
<mrow><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">g</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow>
</mrow></msub></mrow>
</msup><mo>=</mo>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</mrow></msub><mo>&#8855;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</mrow></msub><mo data-mjx-texclass="CLOSE">)</mo></mrow>
<mo stretchy="false">(</mo>
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow><mo>&#8901;</mo>
<mrow>
<mrow><mi mathvariant="bold">r</mi></mrow>
</mrow><msup><mo stretchy="false">)</mo>
<mrow><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">g</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow>
</mrow></msub></mrow>
</msup><mo>.</mo></mtd></mlabeledtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div></div><p>
In this formula and elsewhere in this book, the symbol <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2297"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>&#8855;</mo></math></mjx-assistive-mml>
</mjx-container> denotes componentwise
multiplication of colors. Let's look at the inputs to this formula in more detail.
</p>
<p>First, let's consider <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">g</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container>, which is the <i>glossiness</i> of the material, also
known as the <i>Phong exponent</i>, <i>specular exponent</i>, or just as the material
<i>shininess</i>. This controls how wide the
    &#8220;hotspot&#8221; is&#8212;a smaller <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">g</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container>
produces a larger, more gradual falloff from the hotspot, and a larger <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">g</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container>
produces a very tight hotspot with sharp falloff. (Here we are talking about the hotspot of a
reflection, not to be confused with the hotspot of a spot light.) Perfectly reflective surfaces,
such as chrome, would have an extremely high value for <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">g</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container>. When rays of light
strike the surface from the incident direction <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D425 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">l</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>, there is very little variation in
the reflected directions. They are reflected in a very narrow solid angle (&#8220;cone&#8221;) surrounding
the direction described by <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42B TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">r</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>, with very little scattering. Shiny surfaces that are not
perfect reflectors&#8212;for example, the surface of an apple&#8212;have lower specular exponents,
resulting in a larger hotspot. Lower specular exponents model a less perfect reflection of light
rays. When rays of light strike the surface at the same incident direction given by <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D425 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">l</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>,
there is more variation in the reflected directions. The distribution clusters about the bounce
direction <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42B TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">r</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>, but the falloff in intensity as we move away from <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42B TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">r</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> is more
gradual. We'll show this difference visually in just a moment.
</p>
<p>
Like all of the material properties that are input to the lighting equation, the value for
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">g</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container> can vary over the surface, and the specific value for any given location on
that surface may be determined in any way you wish, for example with a texture map (see
<a href="#texture_mapping">Section&#160;10.5</a>). However, compared to the other material properties, this is
relatively rare; in fact it is quite common in real-time graphics for the glossiness value to be
a constant for an entire material and not vary over the surface.
</p>
<p>Another value in <a href="#phong_specular_model">Equation&#160;(10.11)</a> related to &#8220;shininess&#8221; is the material's
<i>specular color</i>, denoted <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container>.  While <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">g</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container> controls
the size of the hotspot, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container> controls its intensity and color. Highly
reflective surfaces will have a higher value for <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container>, and more matte
surfaces will have a lower value. If desired, a
    <i>specular map</i><a href="#footnote_14" class="FootnoteRef">14</a> may be used to control the color of the
hotspot using a bitmap, much as a texture map controls the color of an object.
</p>
<p>The <i>light specular color</i>, denoted <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container>, is essentially the
&#8220;color&#8221; of the light, which contains both its color and intensity.  Although many lights will
have a single constant color, the strength of this color will attenuate with distance
(<a href="#light_attenuation">Section&#160;10.7.2</a>), and this attenuation is contained in
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container> in our formulation. Furthermore, even ignoring attenuation, the same
light source may shine light of different colors in different directions.  For rectangular spot
lights, we might determine the color from a
    <i>gobo</i>, which is a projected bitmap image. A
colored gobo might be used to simulate a light shining through a stained glass window, or an
animated gobo could be used to fake shadows of spinning ceiling fans or trees blowing in the
wind.  We use the letter <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> to stand for &#8220;source.&#8221; The subscript &#8220;<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</math></mjx-assistive-mml>
</mjx-container>&#8221;
indicates that this color is used for specular calculations.  A different light color can be used
for diffuse calculations&#8212;this is a feature of the lighting model used to achieve special
effects in certain circumstances, but it doesn't have any real-world meaning.  In practice,
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container> is almost always equal to the light color used for diffuse lighting,
which, not surprisingly, is denoted in this book as <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">f</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container>.
</p>
<div id="lighting_specular_heads" class="Display Figure Wide">
<div class="Body">
<span class="CenterContainer">
<span></span><span class="CenterBody">
        <img src="figs/graphics/lighting_specular_heads.png" loading="lazy" width="600" height="534">
</span><span></span>
</span>
</div><span class="Caption">
<span class="Label">Figure&#160;10.22</span><span class="CaptionText">
Different values for <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">g</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container> and
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container>
</span>
</span>
</div><p>
<a href="#lighting_specular_heads">Figure&#160;10.22</a> shows how different values of <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">g</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container> and
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container> affect the appearance of an object with specular reflection.  The
material specular color <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container> goes from black on the leftmost column to
white on the right-most column.  The specular exponent <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">g</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container> is large on the top row
and decreases with each subsequent row.  Notice that the heads in the left-most column all look
the same; since the specular strength is zero, the specular exponent is irrelevant and there is
no specular contribution in any case.  (The lighting comes from the diffuse and ambient
components, which are discussed in Sections&#160;<a href="#diffuse_component">10.6.3</a>
and <a href="#ambient_and_emissive_components">10.6.4</a>, respectively.)
</p>
<p>Blinn <a class="RefCite" href="#reference_4">[4]</a> popularized a slight modification to the Phong model that produces
very similar visual results, but at the time was a significant optimization. In many cases, it is
still faster to compute today, but beware that vector operations (which are reduced with this
model) are not always the performance bottleneck. The basic idea is this: if the distance to the
viewer is large relative to the size of an object, then <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> may be computed once and
then considered constant for an entire object. Likewise for a light source and the vector
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D425 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">l</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>. (In fact, for directional lights, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D425 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">l</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> is always constant.) However, since
the surface normal <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> is not constant, we must still compute the reflection vector
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42B TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">r</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>, a computation that we would like to avoid, if possible. The Blinn model introduces
a new vector
    <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D421 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">h</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>, which stands for &#8220;halfway&#8221; vector and is the result of averaging
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D425 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">l</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> and then normalizing the result:
</p>
<span class="InMarginAnchor">
<span class="InMargin"><span class="EqMarginCaption">The halfway vector <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D421 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">h</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>, used in the Blinn specular model</span>
</span>
</span><div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D421 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D425 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-TeXAtom texclass="ORD"><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c2225"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D425 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2225"></mjx-c></mjx-mo></mjx-mrow></mjx-TeXAtom></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
<mrow>
<mrow><mi mathvariant="bold">h</mi></mrow>
</mrow><mo>=</mo><mfrac>
<mrow>
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow><mo>+</mo>
<mrow>
<mrow><mi mathvariant="bold">l</mi></mrow>
</mrow></mrow>
<mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">&#8741;</mo>
<mrow>
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow><mo>+</mo>
<mrow>
<mrow><mi mathvariant="bold">l</mi></mrow>
</mrow></mrow>
<mo data-mjx-texclass="CLOSE">&#8741;</mo></mrow>
</mrow></mfrac><mo>.</mo></math></mjx-assistive-mml>
</mjx-container>
</div>
<p class="NoIndent">
Then, rather than using the angle between <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42B TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">r</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>, as the Phong model does,
the cosine of the angle between <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D421 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">h</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> is used.  The situation is shown in
<a href="#lighting_specular_blinn">Figure&#160;10.23</a>.
</p>
<div id="lighting_specular_blinn" class="Display Figure Narrow">
<div class="Body">
		<img class="WithFrame" src="figs/graphics/lighting_specular_blinn.png" loading="lazy" width="354" height="220">
</div><span class="Caption"><span class="Label">Figure&#160;10.23</span><span class="CaptionText">Blinn model for specular reflection</span>
</span>
</div><p>
The formula for the Blinn model is quite similar to the original Phong model.  Only the dot
product portion is changed.
</p>
<div class="KeyIdea">
<div class="KeyIdeaTitle">The Blinn Model for Specular Reflection</div><div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mrow space="4"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2297"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D703 TEX-I"></mjx-c></mjx-mi><mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-script style="vertical-align: 0.413em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub></mjx-TeXAtom></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mrow space="4"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2297"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D421 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-script style="vertical-align: 0.413em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub></mjx-TeXAtom></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub>
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</mrow></msub><mo>=</mo>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</mrow></msub><mo>&#8855;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</mrow></msub><mo data-mjx-texclass="CLOSE">)</mo></mrow>
<mo stretchy="false">(</mo><mi>cos</mi><mo data-mjx-texclass="NONE">&#8289;</mo><mi>&#952;</mi><msup><mo stretchy="false">)</mo>
<mrow><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">g</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow>
</mrow></msub></mrow>
</msup><mo>=</mo>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</mrow></msub><mo>&#8855;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</mrow></msub><mo data-mjx-texclass="CLOSE">)</mo></mrow>
<mo stretchy="false">(</mo>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo>&#8901;</mo>
<mrow>
<mrow><mi mathvariant="bold">h</mi></mrow>
</mrow><msup><mo stretchy="false">)</mo>
<mrow><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">g</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow>
</mrow></msub></mrow>
</msup><mo>.</mo></math></mjx-assistive-mml>
</mjx-container>
</div></div><p>
The Blinn model can be faster to implement in hardware than the Phong model, if the viewer and
light source are far enough away from the object to be considered a constant, since then
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D421 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">h</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> is a constant and only needs to be computed once.  But when <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> or
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D425 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">l</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> may not be considered constant, the Phong calculation might be faster.  As we've
said, the two models produce similar, but not identical, results (see Fisher and Woo
<a class="RefCite" href="#reference_6">[6]</a> for a comparison). Both are empirical models, and the Blinn model should
not be considered an &#8220;approximation&#8221; to the &#8220;correct&#8221; Phong model. In fact, Ngan et al.
<a class="RefCite" href="#reference_17">[17]</a> have demonstrated that the Blinn model has some objective
advantages and more closely matches experimental data for certain surfaces.
</p>
<p>
One detail  we have omitted is that in either model, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D703 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>cos</mi><mo data-mjx-texclass="NONE">&#8289;</mo><mi>&#952;</mi></math></mjx-assistive-mml>
</mjx-container> may be less than zero.  In
this case, we usually clamp the specular contribution to&#160;zero.
</p>
<h2 id="diffuse_component"><span class="SectionNumber">10.6.3</span><span class="SectionTitle">The Diffuse Component</span></h2>
<p class="NoIndent">The next component in the standard lighting model is the <i>diffuse</i> component.  Like the
specular component, the diffuse component also models light that traveled directly from the light
source to the shading point. However, whereas specular light accounts for light that reflects
preferentially in a particular direction, diffuse light models light that is reflected randomly
in all directions due to the rough nature of the surface material.
<a href="#lighting_diffuse_reflection">Figure&#160;10.24</a> compares how rays of light reflect on a perfectly
reflective surface and on a rough surface.
</p>
<div id="lighting_diffuse_reflection" class="Display Figure Wide">
<div class="Body">
	<img src="figs/graphics/lighting_diffuse_reflection.png" loading="lazy" width="675" height="238">
</div><span class="Caption">
<span class="Label">Figure&#160;10.24</span><span class="CaptionText">Diffuse lighting models scattered reflections</span>
</span>
</div><p>
To compute specular lighting, we needed to know the location of the viewer, to see how close the
eye is to the direction of the perfect mirror bounce.  For diffuse lighting, in contrast, the
location of the viewer is <i>not relevant</i>, since the reflections are scattered randomly, and
no matter where we position the camera, it is equally likely that a ray will be sent our way.
However, the direction if incidence <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D425 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">l</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>, which is dictated by the position of the light
source relative to the surface, <i>is</i> important.  We've mentioned Lambert's law previously,
but let's review it here, since the diffuse portion of Blinn-Phong is the most important place in
real-time graphics that it comes into play.  If we imagine counting the photons that hit the
surface of the object and have a chance of reflecting into the eye, a surface that is
perpendicular to the rays of light receives more photons per unit area than a surface oriented at
a more glancing angle, as shown in <a href="#lighting_lambert">Figure&#160;10.25</a>.
</p>
<div id="lighting_lambert" class="Display Figure Wide">
<div class="Body">
		<img class="WithFrame" src="figs/graphics/lighting_lambert.png" loading="lazy" width="575" height="138">
</div><span class="Caption">
<span class="Label">Figure&#160;10.25</span><span class="CaptionText">
Surfaces more perpendicular to the light rays receive more light per
unit area
</span>
</span>
</div><p>
Notice that, in both cases, the perpendicular distance between the rays is the same.  (Due to an
optical illusion in the diagram, the rays on the right may appear to be farther apart, but they
are not.)  So, the perpendicular distance between the rays is the same, but notice that on the
right side of <a href="#lighting_lambert">Figure&#160;10.25</a>, they strike the object at points that are farther
apart.  The surface on the left receives nine light rays, and the surface on the right receives
only six, even though the &#8220;area&#8221; of both surfaces is the same.  Thus the number of photons per
unit area<a href="#footnote_15" class="FootnoteRef">15</a> is higher on the left, and it will appear brighter, all other
factors being equal.  This same phenomenon is responsible for the fact that the climate near the
equator is warmer than near the poles. Since Earth is round, the light from the sun strikes Earth
at a more perpendicular angle near the equator.
</p>
<p>Diffuse lighting obeys <i>Lambert's law</i>: the intensity of the reflected light is proportional
to the cosine of the angle between the surface normal and the rays of light.  We will compute
this cosine with the dot product.
</p>
<div class="KeyIdea">
<div class="KeyIdeaTitle">Calculating the Diffuse Component according to Lambert's Law</div><div class="DisplayMath">
<mjx-container class="MathJax" display="true" jax="CHTML" role="presentation" style="font-size: 100%; min-width: 100%; position: relative" width="full">
<mjx-math aria-hidden="true" class="MJX-TEX" display="true" width="full"><mjx-mtable side="right" style="min-width: 100%; display: flex; justify-content: space-between; flex-flow: row nowrap">
<mjx-labels-partner style="flex: 1 0 0; max-width: 3.856em"></mjx-labels-partner><mjx-table style="flex: 0 0 11.491em"><mjx-itable width="full"><mjx-mlabeledtr><mjx-mtd><mjx-msub><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mrow space="4"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2297"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-texatom space="3" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D425 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mlabeledtr></mjx-itable></mjx-table>
<mjx-labels style="flex: 0 0 3.856em"><mjx-itable align="right" style=""><mjx-mtr style="height: 1em"><mjx-mtd id="mjx-eqn-10.12"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c28"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c29"></mjx-c></mjx-mtext><mjx-tstrut style="height: 1em; vertical-align: -0.25em"></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-labels>
</mjx-mtable>
</mjx-math>
<mjx-assistive-mml display="block" role="presentation" unselectable="on"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mtable displaystyle="true"><mlabeledtr><mtd><mtext>(10.12)</mtext></mtd><mtd><msub>
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">f</mi></mrow>
</mrow></msub><mo>=</mo>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">f</mi></mrow>
</mrow></msub><mo>&#8855;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">f</mi></mrow>
</mrow></msub><mo data-mjx-texclass="CLOSE">)</mo></mrow>
<mo stretchy="false">(</mo>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo>&#8901;</mo>
<mrow>
<mrow><mi mathvariant="bold">l</mi></mrow>
</mrow><mo stretchy="false">)</mo><mo>.</mo></mtd></mlabeledtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div></div><p>As before, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> is the surface normal and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D425 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">l</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> is a unit vector that points
towards the light source.  The factor <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">f</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container> is the material's diffuse
color, which is the value that most people think of when they think of the &#8220;color&#8221; of an
object. The diffuse material color often comes from a texture map. The diffuse color of the light
source is <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">f</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container>; this is usually equal to the light's specular color,
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container>.
</p>
<p>Just as with specular lighting, we must prevent the dot product from going negative by clamping
it to zero.  This prevents objects from being lit from behind.
</p>
<p>It's very instructive to see how diffuse surfaces are implemented in the framework of the
rendering equation.
</p>
<div class="KeyIdea">
Diffuse reflection models light that is scattered completely randomly, and any given outgoing
direction is equally likely, no matter what the incoming light direction.  Thus, the BRDF for a
perfectly diffuse surface is a constant.
</div><p>Note the similarity of <a href="#diffuse_reflection_lambert_law">Equation&#160;(10.12)</a> with the
contents of the integral from the rendering equation,
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D706 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c75"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D706 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>L</mi>
<mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</msub><mo stretchy="false">(</mo>
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow><mo>,</mo><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</msub><mo>,</mo><mi>&#955;</mi><mo stretchy="false">)</mo><mi>f</mi><mo stretchy="false">(</mo>
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow><mo>,</mo><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</msub><mo>,</mo><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi></mrow>
</msub><mo>,</mo><mi>&#955;</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mo>&#8722;</mo><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</msub><mo>&#8901;</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo stretchy="false">)</mo><mo>.</mo></math></mjx-assistive-mml>
</mjx-container>
</div><p>
The first factor is the incident light color.  The material color <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">f</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container> is
the constant value of the BRDF, which comes next.  Finally, we have the Lambert factor.
</p>
<h2 id="ambient_and_emissive_components"><span class="SectionNumber">10.6.4</span><span class="SectionTitle">The Ambient and Emmissive Components</span></h2>
<p class="NoIndent">
Specular and diffuse lighting both account for light rays that travel directly from the light
source to the surface of the object, &#8220;bounce&#8221; one time, and then arrive in the eye. However, in
the real world, light often bounces off one or more intermediate objects before hitting an object
and reflecting to the eye.  When you open the refrigerator door in the middle of the night, the
entire kitchen will get just a bit brighter, even though the refrigerator door blocks most of the
direct light.
</p>
<p>To model light that is reflected more than one time before it enters the eye, we can use a very
crude approximation known as &#8220;ambient light.&#8221; The ambient portion of the lighting equation
depends only on the properties of the material and an ambient lighting value, which is often a
global value used for the entire scene.  None of the light sources are involved in the
computation. (In fact, a light source is not even necessary.) <a href="#ambient_contribution">Equation&#160;(10.13)</a> is
used to compute the ambient component:
</p>
<span class="InMarginAnchor"><span class="InMargin"><span class="EqMarginCaption">Ambient contribution to the lighting equation</span></span></span><div class="DisplayMath">
<mjx-container class="MathJax" display="true" jax="CHTML" role="presentation" style="font-size: 100%; min-width: 100%; position: relative" width="full">
<mjx-math aria-hidden="true" class="MJX-TEX" display="true" width="full"><mjx-mtable side="right" style="min-width: 100%; display: flex; justify-content: space-between; flex-flow: row nowrap">
<mjx-labels-partner style="flex: 1 0 0; max-width: 3.856em"></mjx-labels-partner><mjx-table style="flex: 0 0 9.035em"><mjx-itable width="full"><mjx-mlabeledtr><mjx-mtd><mjx-msub><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c62"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D420 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.236em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c62"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2297"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c62"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mlabeledtr></mjx-itable></mjx-table>
<mjx-labels style="flex: 0 0 3.856em"><mjx-itable align="right" style=""><mjx-mtr style="height: 1em"><mjx-mtd id="mjx-eqn-10.13"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c28"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c33"></mjx-c><mjx-c class="mjx-c29"></mjx-c></mjx-mtext><mjx-tstrut style="height: 1em; vertical-align: -0.25em"></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-labels>
</mjx-mtable>
</mjx-math>
<mjx-assistive-mml display="block" role="presentation" unselectable="on"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mtable displaystyle="true"><mlabeledtr><mtd><mtext>(10.13)</mtext></mtd><mtd><msub>
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi></mrow>
</mrow></msub><mo>=</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">g</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi></mrow>
</mrow></msub><mo>&#8855;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi></mrow>
</mrow></msub><mo>.</mo></mtd></mlabeledtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<p>The factor <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c62"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container> is the material's &#8220;ambient color.&#8221; This is almost always
the same as the diffuse color (which is often defined using a texture map). The other factor,
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D420 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.236em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c62"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">g</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container>, is the ambient light value.  We use the notation <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D420 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">g</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> for
&#8220;global,&#8221; because often one global ambient value is used for the entire scene. However, some
techniques, such as lighting probes, attempt to provide more localized and direction-dependent
indirect lighting.
</p>
<p>Sometimes a ray of light travels directly from the light source to the eye, without striking any
surface in between.  The standard lighting equation accounts for such rays by assigning a
material an <i>emissive</i> color.  For example, when we render the surface of a light bulb, this
surface will probably appear very bright, even if there are no other light sources in the scene,
because the light bulb is emitting light.
</p>
<p>
In many situations, the emissive contribution doesn't depend on environmental factors; it is
simply the emissive color of the material:
</p>
<span class="InMarginAnchor">
<span class="InMargin"><span class="EqMarginCaption">The emissive contribution depends only on the material</span>
</span>
</span><div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub>
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi></mrow>
</mrow></msub><mo>=</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi></mrow>
</mrow></msub><mo>.</mo></math></mjx-assistive-mml>
</mjx-container>
</div>
<p class="NoIndent">
Most surfaces don't emit light, so their emissive component is <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mn class="mjx-b"><mjx-c class="mjx-c1D7CE TEX-B"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mn mathvariant="bold">0</mn></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>. Surfaces that have a
nonzero emissive component are called &#8220;self-illuminated.&#8221;
</p>
<p>
It's important to understand that in real-time graphics, a self-illuminated surface does
<i>not</i> light the other surfaces&#8212;you need a light source for that.  In other words, we don't
actually render light sources, we only render the effects that those light sources have on the
surfaces in the scene. We <i>do</i> render self-illuminated surfaces, but those surfaces don't
interact with the other surfaces in the scene.  When using the rendering equation properly,
however, emissive surfaces do light up their surroundings.
</p>
<p>
We may choose to attenuate the emissive contribution due to atmospheric conditions, such as fog, and of course there may be performance reasons to have objects fade out and disappear in the distance. However, as explained in <a href="#light_attenuation">Section&#160;10.7.2</a>, in general the emissive contribution should <i>not</i> be attenuated due to distance in the same way that light sources are.
</p>
<h2 id="lighting_equation_summary"><span class="SectionNumber">10.6.5</span><span class="SectionTitle">The Lighting Equation: Putting It All Together</span></h2>
<p class="NoIndent">We have discussed the individual components of the lighting equation in detail.  Now it's time to
give the complete equation for the standard lighting model.
</p>
<span class="InMarginAnchor"><span class="InMargin"><span class="EqMarginCaption">The standard lighting equation for one light source</span></span></span><div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mstyle><mjx-mspace style="width: 1em"></mjx-mspace></mjx-mstyle><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mstyle space="4"><mjx-mspace style="width: 1em"></mjx-mspace></mjx-mstyle><mjx-mtable style="min-width: 3.717em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0.5em; padding-bottom: 0.2em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0.5em; padding-bottom: 0.2em"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c62"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0.5em; padding-top: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0.5em; padding-top: 0.2em"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mstyle><mjx-mspace style="width: 1em"></mjx-mspace></mjx-mstyle><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mstyle space="4"><mjx-mspace style="width: 1em"></mjx-mspace></mjx-mstyle><mjx-mtable style="min-width: 14.766em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0.5em; padding-bottom: 0.2em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0.5em; padding-bottom: 0.2em"><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2297"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D421 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-TeXAtom space="2" texclass="ORD"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: 0.477em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub></mjx-TeXAtom></mjx-script></mjx-msup><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2297"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D425 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-TeXAtom space="2" texclass="ORD"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D420 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.236em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c62"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2297"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c62"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0.5em; padding-top: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0.5em; padding-top: 0.2em"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub>
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow>
</mrow></msub><mstyle scriptlevel="0"><mspace width="1em"></mspace></mstyle><mo>=</mo><mstyle scriptlevel="0"><mspace width="1em"></mspace></mstyle><mtable columnalign="right left" columnspacing="1em" rowspacing="4pt"><mtr><mtd></mtd><mtd><msub>
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</mrow></msub></mtd></mtr><mtr><mtd><mo>+</mo></mtd><mtd><msub>
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">f</mi></mrow>
</mrow></msub></mtd></mtr><mtr><mtd><mo>+</mo></mtd><mtd><msub>
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi></mrow>
</mrow></msub></mtd></mtr><mtr><mtd><mo>+</mo></mtd><mtd><msub>
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi></mrow>
</mrow></msub></mtd></mtr></mtable><mstyle scriptlevel="0"><mspace width="1em"></mspace></mstyle><mo>=</mo><mstyle scriptlevel="0"><mspace width="1em"></mspace></mstyle><mtable columnalign="right left" columnspacing="1em" rowspacing="4pt"><mtr><mtd></mtd><mtd>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</mrow></msub><mo>&#8855;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</mrow></msub><mo data-mjx-texclass="CLOSE">)</mo></mrow>
<msup>
<mrow>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo>
<mrow>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo>&#8901;</mo>
<mrow>
<mrow><mi mathvariant="bold">h</mi></mrow>
</mrow></mrow>
<mo>,</mo>
<mrow><mn>0</mn></mrow>
<mo data-mjx-texclass="CLOSE">)</mo></mrow>
</mrow></mrow>
<mrow><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">g</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow>
</mrow></msub></mrow>
</msup></mtd></mtr><mtr><mtd><mo>+</mo></mtd><mtd>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">f</mi></mrow>
</mrow></msub><mo>&#8855;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">f</mi></mrow>
</mrow></msub><mo data-mjx-texclass="CLOSE">)</mo></mrow>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo>
<mrow>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo>&#8901;</mo>
<mrow>
<mrow><mi mathvariant="bold">l</mi></mrow>
</mrow></mrow>
<mo>,</mo>
<mrow><mn>0</mn></mrow>
<mo data-mjx-texclass="CLOSE">)</mo></mrow>
</mrow></mtd></mtr><mtr><mtd><mo>+</mo></mtd><mtd><msub>
<mrow>
<mrow><mi mathvariant="bold">g</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi></mrow>
</mrow></msub><mo>&#8855;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi></mrow>
</mrow></msub></mtd></mtr><mtr><mtd><mo>+</mo></mtd><mtd><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi></mrow>
</mrow></msub></mtd></mtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<div id="lighting_equation_head" class="Display Figure Wide">
<div class="Body">
<span class="minipage">
<img src="figs/graphics/lighting_equation_head.png" loading="lazy" width="825" height="278">
</span>
</div><span class="Caption">
<span class="Label">Figure&#160;\caption@xref {fig:graphics_lighting_equation_head}{ on input line 3591}</span>
<span class="CaptionText">
The visual contribution of each of the components of the
lighting equation
</span>
</span>
</div><p>
<a href="#lighting_equation_head">Figure&#160;\caption@xref fig:graphics_lighting_equation_head on input line 3591</a> shows what the ambient, diffuse, and specular lighting
components actually look like in isolation from the others. (We are ignoring the emissive
component, assuming that this particular floating head doesn't emit light.) There are several
interesting points to be noted:
</p>
<ul>
    <li>
The ear is lit just as bright as the nose, even though it is actually in the shadow
        of the head.  For shadows, we must determine whether the light can actually &#8220;see&#8221;
        the point being shaded, using techniques such as shadow mapping.
</li>
<li>
In the first two images, without ambient light, the side of the head that is facing
        away from the light is completely black.  In order to light the &#8220;back side&#8221; of
        objects, you must use ambient light.  Placing enough lights in your scene so that
        every surface is lit directly is the best situation, but it's not always possible.
        One common hack, which Mitchell et al. <a class="RefCite" href="#reference_16">[16]</a> dubbed
        &#8220;Half Lambert&#8221; lighting, is to bias the Lambert term, allowing diffuse lighting to
        &#8220;wrap around&#8221; to the back side of the model to prevent it from ever being flattened
        out and lit only by ambient light. This can easily be done by replacing the standard
        <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D425 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo>&#8901;</mo>
<mrow>
<mrow><mi mathvariant="bold">l</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> term with <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FC TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D6FC TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D425 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>&#945;</mi><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>&#8722;</mo><mi>&#945;</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo>&#8901;</mo>
<mrow>
<mrow><mi mathvariant="bold">l</mi></mrow>
</mrow><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container>, where <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FC TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>&#945;</mi></math></mjx-assistive-mml>
</mjx-container> is a tunable parameter that specifies the extra wraparound
        effect. (Mitchell et al. suggest using <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FC TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>&#945;</mi><mo>=</mo><mn>1</mn>
<mrow><mo>/</mo></mrow>
<mn>2</mn></math></mjx-assistive-mml>
</mjx-container>, and they also square the
        result.) Although this adjustment has little physical basis, it has a very high
        perceptual benefit, especially considering the small computational cost.
</li>
<li>
With only ambient lighting, just the silhouette is visible.  Lighting is an extremely
        powerful visual cue that makes the object appear &#8220;3D.&#8221; The solution to this
        &#8220;cartoon&#8221; effect is to place a sufficient number of lights in the scene so that every
        surface is lit directly.
</li>
</ul>
<p>Speaking of multiple lights, how do multiple light sources work with the lighting equation? We
must sum up the lighting values for all the lights.  To simplify the notation, we'll go ahead and
make the almost universal assumption that <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</mrow></msub><mo>=</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">f</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container>. Then we can let <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow><mi>j</mi></msub></math></mjx-assistive-mml>
</mjx-container> denote the color of the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></mjx-assistive-mml>
</mjx-container>th light
source, including the attenuation factor.  The index <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></mjx-assistive-mml>
</mjx-container> goes from <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></mjx-assistive-mml>
</mjx-container> to <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></mjx-assistive-mml>
</mjx-container>, where <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></mjx-assistive-mml>
</mjx-container> is the
number of lights.  Now the lighting equation becomes
</p>
<span class="InMarginAnchor"><span class="InMargin"><span class="EqMarginCaption">The standard lighting equation for multiple lights</span></span></span><div class="DisplayMath">
<mjx-container class="MathJax" display="true" jax="CHTML" role="presentation" style="font-size: 100%; min-width: 100%; position: relative" width="full">
<mjx-math aria-hidden="true" class="MJX-TEX" display="true" width="full"><mjx-mtable side="right" style="min-width: 100%; display: flex; justify-content: space-between; flex-flow: row nowrap">
<mjx-labels-partner style="flex: 1 0 0; max-width: 3.856em"></mjx-labels-partner><mjx-table style="flex: 0 0 28.909em"><mjx-itable width="full"><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-bottom: 0.15em"><mjx-msub><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-munderover space="4"><mjx-over style="padding-bottom: 0.192em; padding-left: 0.51em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo class="mjx-lop"><mjx-c class="mjx-c2211 TEX-S2"></mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style="padding-top: 0.167em; padding-left: 0.124em"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-texatom texclass="OPEN"><mjx-mo class="mjx-sop"><mjx-c class="mjx-c5B TEX-S1"></mjx-c></mjx-mo></mjx-texatom><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2297"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow><mjx-msup><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-texatom><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D421 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-texatom space="2" texclass="ORD"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: 0.477em"><mjx-texatom size="s" texclass="ORD"><mjx-msub><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub></mjx-texatom></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mrow space="3"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2297"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-texatom><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D425 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-texatom space="2" texclass="ORD"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-texatom><mjx-texatom texclass="CLOSE"><mjx-mo class="mjx-sop"><mjx-c class="mjx-c5D TEX-S1"></mjx-c></mjx-mo></mjx-texatom><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mlabeledtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em"><mjx-mstyle><mjx-mspace style="width: 1em"></mjx-mspace></mjx-mstyle><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D420 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.236em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c62"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2297"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c62"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mlabeledtr></mjx-itable></mjx-table>
<mjx-labels style="flex: 0 0 3.856em"><mjx-itable align="right" style=""><mjx-mtr style="height: 3.045em"></mjx-mtr><mjx-mtr style="height: 1.15em"><mjx-mtd id="mjx-eqn-10.14" style="padding-top: 0.15em"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c28"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c34"></mjx-c><mjx-c class="mjx-c29"></mjx-c></mjx-mtext><mjx-tstrut style="height: 1em; vertical-align: -0.25em"></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-labels>
</mjx-mtable>
</mjx-math>
<mjx-assistive-mml display="block" role="presentation" unselectable="on"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mtr><mtd><msub>
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow>
</mrow></msub></mtd><mtd><mi></mi><mo>=</mo><munderover><mo data-mjx-texclass="OP">&#8721;</mo>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow>
<mi>n</mi></munderover>
<mrow data-mjx-texclass="OPEN"><mo maxsize="1.2em" minsize="1.2em">[</mo></mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow><mi>j</mi></msub><mo>&#8855;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</mrow></msub><mo data-mjx-texclass="CLOSE">)</mo></mrow>
<msup>
<mrow>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo>
<mrow>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo>&#8901;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">h</mi></mrow>
</mrow><mi>j</mi></msub></mrow>
<mo>,</mo>
<mrow><mn>0</mn></mrow>
<mo data-mjx-texclass="CLOSE">)</mo></mrow>
</mrow></mrow>
<mrow><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">g</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow>
</mrow></msub></mrow>
</msup><mo>+</mo>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow><mi>j</mi></msub><mo>&#8855;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">f</mi></mrow>
</mrow></msub><mo data-mjx-texclass="CLOSE">)</mo></mrow>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo>
<mrow>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo>&#8901;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">l</mi></mrow>
</mrow><mi>j</mi></msub></mrow>
<mo>,</mo>
<mrow><mn>0</mn></mrow>
<mo data-mjx-texclass="CLOSE">)</mo></mrow>
</mrow>
<mrow data-mjx-texclass="CLOSE"><mo maxsize="1.2em" minsize="1.2em">]</mo></mrow>
</mtd></mtr><mlabeledtr><mtd><mtext>(10.14)</mtext></mtd><mtd></mtd><mtd><mstyle scriptlevel="0"><mspace width="1em"></mspace></mstyle><mo>+</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">g</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi></mrow>
</mrow></msub><mo>&#8855;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi></mrow>
</mrow></msub><mo>+</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi></mrow>
</mrow></msub><mo>.</mo></mtd></mlabeledtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<p>
Since there is only one ambient light value and one emissive component for any given surface, these
components are not summed per light source.
</p>
<h2 id="lighting_equation_limitations"><span class="SectionNumber">10.6.6</span><span class="SectionTitle">Limitations of the Standard Model</span></h2>
<p class="NoIndent">Nowadays we have the freedom of programmable shaders and can choose any lighting model we wish.
Since the standard model has some fairly serious shortcomings, you might very well ask, &#8220;Why
learn about this ancient history?&#8221;  First, it isn't exactly ancient history; it is alive and
well.  The reasons that made it a good compromise between realism, usability, and speed of
calculation still apply. Yes, we have more processing power; but we also want to render more
pixels and more lights, and it currently is very common for the standard lighting model to be the
winner when programmers are deciding whether to spend the cycles on more pixels (higher
resolution) or more accurate pixels (a more accurate lighting model).  Second, the current local
lighting model is one that content creators can understand and use.  This advantage is not to be
taken lightly.  Artists have <i>decades</i> of experience with diffuse and specular maps.
Switching to a lighting model that replaces those familiar inputs with different ones such as
    &#8220;metalness&#8221; (from Strauss's model <a class="RefCite" href="#reference_26">[26]</a>) for which artists do not have
an intuitive grasp is a big price to pay.  A final reason to learn the standard lighting model is
because many newer models bear similarities to the standard model, and you cannot know when to
use more advanced lighting models without understanding the old standard.
</p>
<p>If you have read the OpenGL or DirectX documentation for setting material parameters, you are
forgiven for thinking that ambient, diffuse, and specular are &#8220;how light works&#8221; (remember our
warning at the beginning of this chapter) as opposed being arbitrary practical constructs
peculiar to a particular lighting model.  The dichotomy between diffuse and specular is
<i>not</i> an inherent physical reality; rather, it arose (and continues to be used) due to
practical considerations. These are descriptive terms for two extreme scattering patterns, and by
taking arbitrary combinations of these two patterns, many phenomena are able to be approximated
to a decent degree.
</p>
<p>
Because of the near unanimous adoption of this model, it is often used without giving it a name,
and in fact there is still some confusion as to exactly what to call it. You might call it the
<i>Phong</i> lighting model, because Phong introduced the basic idea of modeling reflection as
the sum of diffuse and specular contributions, and also provided a useful empirically based
calculation for specular reflection.  (The Lambert model for diffuse reflection was already
known.)  We saw that Blinn's computation for specular reflection is similar but sometimes faster.
Because this is the specific calculation most often used, perhaps we should call it the Blinn
model? But Blinn's name is also attached to a different microfacet model in which diffuse and
specular are at different ends of a continuous spectrum, rather than independent &#8220;orthogonal&#8221;
components being mixed together.  Since most implementations use Blinn's optimization for Phong's
basic idea, the name <i>Blinn-Phong</i> is the one most often used for this model, and that's the
name we use.
</p>
<p>A huge part of realistic lighting is, of course, realistic shadows. Although the techniques for
producing shadows are interesting and important, alas we will not have time to discuss them here.
In the theory of the rendering equation, shadows are accounted for when we determine the radiance
incident in a given direction.  If a light (more accurately, an emissive surface) exists in a
particular direction, and the point can &#8220;see&#8221; that surface, then its light will be incident
upon the point.  If, however, there is some other surface that obscures the light source when
looking in that direction, then the point is in shadow with respect to that light source.  More
generally, shadows can be cast not just due to the light from emissive surfaces; the light
bouncing off reflective surfaces can cause shadows.  In all cases, shadows are an issue of light
visibility, not reflectance model.
</p>
<p>
Finally, we would like to mention several important physical phenomena not properly captured by
the Blinn-Phong model.  The first is
    <i>Fresnel</i><a href="#footnote_16" class="FootnoteRef">16</a> <i>reflectance</i>, which predicts that the
reflectance of nonmetals is strongest when the light is incident at a glancing angle, and least
when incident from the normal angle.  Some surfaces, such as velvet, exhibit
    <i>retroreflection</i>; you might guess this means that the surface looks like
    Madonna's earrings, but it actually means that the primary direction of reflection is not the
&#8220;mirror bounce&#8221; as predicted by Blinn-Phong, but rather back towards the light source. Finally,
Blinn-Phong is
    <i>isotropic</i>, which means that if we rotate the surface while keeping the viewer and light
source stationary, the reflectance will not change. Some surfaces have <i>anisotropic</i>
reflection, due to grooves or other patterns in the surface. This means that the strength of the
reflection varies, based on the direction of incidence relative to the direction of the grooves,
which is sometimes called the
    <i>scratch direction</i>. Classic examples of anisotropic materials
are brushed metal, hair, and those little Christmas ornaments made of shiny fibers.
</p>
<h2 id="flat_gouraud_shading"><span class="SectionNumber">10.6.7</span><span class="SectionTitle">Flat and Gouraud Shading</span></h2>
<p class="NoIndent">
On modern shader-based hardware, lighting calculations are usually done on a per-pixel basis.  By
this we mean that for each pixel, we determine a surface normal (whether by interpolating the
vertex normal across the face or by fetching it from a bump map), and then we perform the full
lighting equation using this surface normal. This is
    <i>per-pixel</i> lighting, and the technique of interpolating vertex normals across the face is
sometimes called <i>Phong shading</i>, not to be confused with the Phong calculation for specular
reflection.  The alternative to Phong shading is to perform the lighting equation less frequently
(per face, or per vertex). These two techniques are known as <i>flat shading</i> and
<i>Gouraud shading</i>, respectively. Flat shading is almost never used in practice except in
software rendering.  This is because most modern methods of sending geometry efficiently to the
hardware do not provide any face-level data whatsoever. Gouraud shading, in contrast, still has
some limited use on some platforms. Some important general principles can be gleaned from
studying these methods, so let's examine their results.
</p>
<div id="shading_teapot_flat" class="Display Figure Wrap">
<div class="Body">
        <img src="figs/graphics/shading_teapot_flat.png" loading="lazy" width="324" height="189">
</div><span class="Caption"><span class="Label">Figure&#160;10.27</span><span class="CaptionText">A flat shaded teapot</span>
</span>
</div><p>
When using flat shading, we compute a single lighting value for the entire triangle. Usually the
&#8220;position&#8221; used in lighting computations is the centroid of the triangle, and the surface
normal is the normal of the triangle. As you can see in <a href="#shading_teapot_flat">Figure&#160;10.27</a>, when an
object is lit using flat shading, the faceted nature of the object becomes painfully apparent,
and any illusion of smoothness is lost.
</p>
<p>Gouraud shading, also known as <i>vertex shading</i>, <i>vertex lighting</i>, or
<i>interpolated shading</i>, is a trick whereby values for lighting, fog, and so forth are
computed at the vertex level. These values are then linearly interpolated across the face of the
polygon. <a href="#shading_teapot_gouraud">Figure&#160;10.28</a> shows the same teapot rendered with Gouraud shading.
</p>
<div id="shading_teapot_gouraud" class="Display Figure Narrow">
<div class="Body">
        <img src="figs/graphics/shading_teapot_gouraud.png" loading="lazy" width="324" height="189">
</div><span class="Caption"><span class="Label">Figure&#160;10.28</span><span class="CaptionText">A Gouraud shaded teapot</span>
</span>
</div><p>
As you can see, Gouraud shading does a relatively good job at restoring the smooth nature of the
object.  When the values being approximated are basically linear across the triangle, then, of
course, the linear interpolation used by Gouraud shading works well. Gouraud shading breaks down
when the values are not linear, as in the case of specular highlights.
</p>
<div id="shading_teapot_phong" class="Display Figure Wrap">
<div class="Body">
        <img src="figs/graphics/shading_teapot_phong.png" loading="lazy" width="324" height="189">
</div><span class="Caption"><span class="Label">Figure&#160;10.29</span><span class="CaptionText">A Phong shaded teapot</span>
</span>
</div><p>
 Compare the specular
highlights in the Gouraud shaded teapot with the highlights in a Phong (per-pixel) shaded teapot,
shown in <a href="#shading_teapot_phong">Figure&#160;10.29</a>. Notice how much smoother the highlights are. Except
for the silhouette and areas of extreme geometric discontinuities, such as the handle and spout,
the illusion of smoothness is very convincing.  With Gouraud shading, the individual facets are
detectable due to the specular highlights.
</p>
<p>
The basic problem with interpolated shading is that no value in the middle of the triangle can be
larger than the largest value at a vertex; highlights can occur only at a vertex. Sufficient
tessellation can overcome this problem.  Despite its limitations, Gouraud shading is still in use
on some limited hardware, such as hand-held platforms and the
    Nintendo Wii.
</p>
<p>One question that you should be asking is how the lighting can be computed at the vertex level if
any maps are used to control inputs to the lighting equation. We can't use the lighting equation
as given in <a href="#standard_lighting_model_multiple_lights">Equation&#160;(10.14)</a> directly. Most notably, the
    diffuse color <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">f</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container> is not usually a vertex-level material property; this
value is typically defined by a texture map. In order to make
<a href="#standard_lighting_model_multiple_lights">Equation&#160;(10.14)</a> more suitable for use in an interpolated
lighting scheme, it must be manipulated to isolate <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">f</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container>.  We first split
the sum and move the constant material colors outside:
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mtable style="min-width: 29.519em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-bottom: 0.15em"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-munderover space="4"><mjx-over style="padding-bottom: 0.192em; padding-left: 0.51em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo class="mjx-lop"><mjx-c class="mjx-c2211 TEX-S2"></mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style="padding-top: 0.167em; padding-left: 0.124em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-TeXAtom texclass="OPEN"><mjx-mo class="mjx-sop"><mjx-c class="mjx-c5B TEX-S1"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2297"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D421 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-TeXAtom space="2" texclass="ORD"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: 0.477em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub></mjx-TeXAtom></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mrow space="3"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2297"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D425 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-TeXAtom space="2" texclass="ORD"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-TeXAtom><mjx-TeXAtom texclass="CLOSE"><mjx-mo class="mjx-sop"><mjx-c class="mjx-c5D TEX-S1"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-mstyle><mjx-mspace style="width: 1em"></mjx-mspace></mjx-mstyle><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D420 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.236em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c62"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2297"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c62"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-munderover space="4"><mjx-over style="padding-bottom: 0.192em; padding-left: 0.51em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo class="mjx-lop"><mjx-c class="mjx-c2211 TEX-S2"></mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style="padding-top: 0.167em; padding-left: 0.124em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2297"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D421 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-TeXAtom space="2" texclass="ORD"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: 0.477em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub></mjx-TeXAtom></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-munderover space="3"><mjx-over style="padding-bottom: 0.192em; padding-left: 0.51em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo class="mjx-lop"><mjx-c class="mjx-c2211 TEX-S2"></mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style="padding-top: 0.167em; padding-left: 0.124em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2297"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D425 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-TeXAtom space="2" texclass="ORD"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em"><mjx-mstyle><mjx-mspace style="width: 1em"></mjx-mspace></mjx-mstyle><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D420 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.236em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c62"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2297"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c62"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" rowspacing="3pt"><mtr><mtd><msub>
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow>
</mrow></msub></mtd><mtd><mi></mi><mo>=</mo><munderover><mo data-mjx-texclass="OP">&#8721;</mo>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow>
<mi>n</mi></munderover>
<mrow data-mjx-texclass="OPEN"><mo minsize="1.2em" maxsize="1.2em">[</mo></mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow><mi>j</mi></msub><mo>&#8855;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</mrow></msub><mo data-mjx-texclass="CLOSE">)</mo></mrow>
<msup>
<mrow>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo>
<mrow>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo>&#8901;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">h</mi></mrow>
</mrow><mi>j</mi></msub></mrow>
<mo>,</mo>
<mrow><mn>0</mn></mrow>
<mo data-mjx-texclass="CLOSE">)</mo></mrow>
</mrow></mrow>
<mrow><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">g</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow>
</mrow></msub></mrow>
</msup><mo>+</mo>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow><mi>j</mi></msub><mo>&#8855;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">f</mi></mrow>
</mrow></msub><mo data-mjx-texclass="CLOSE">)</mo></mrow>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo>
<mrow>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo>&#8901;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">l</mi></mrow>
</mrow><mi>j</mi></msub></mrow>
<mo>,</mo>
<mrow><mn>0</mn></mrow>
<mo data-mjx-texclass="CLOSE">)</mo></mrow>
</mrow>
<mrow data-mjx-texclass="CLOSE"><mo minsize="1.2em" maxsize="1.2em">]</mo></mrow>
</mtd></mtr><mtr><mtd></mtd><mtd><mstyle scriptlevel="0"><mspace width="1em"></mspace></mstyle><mo>+</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">g</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi></mrow>
</mrow></msub><mo>&#8855;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi></mrow>
</mrow></msub><mo>+</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi></mrow>
</mrow></msub></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><munderover><mo data-mjx-texclass="OP">&#8721;</mo>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow>
<mi>n</mi></munderover>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow><mi>j</mi></msub><mo>&#8855;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</mrow></msub><mo data-mjx-texclass="CLOSE">)</mo></mrow>
<msup>
<mrow>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo>
<mrow>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo>&#8901;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">h</mi></mrow>
</mrow><mi>j</mi></msub></mrow>
<mo>,</mo>
<mrow><mn>0</mn></mrow>
<mo data-mjx-texclass="CLOSE">)</mo></mrow>
</mrow></mrow>
<mrow><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">g</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow>
</mrow></msub></mrow>
</msup><mo>+</mo><munderover><mo data-mjx-texclass="OP">&#8721;</mo>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow>
<mi>n</mi></munderover>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow><mi>j</mi></msub><mo>&#8855;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">f</mi></mrow>
</mrow></msub><mo data-mjx-texclass="CLOSE">)</mo></mrow>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo>
<mrow>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo>&#8901;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">l</mi></mrow>
</mrow><mi>j</mi></msub></mrow>
<mo>,</mo>
<mrow><mn>0</mn></mrow>
<mo data-mjx-texclass="CLOSE">)</mo></mrow>
</mrow></mtd></mtr><mtr><mtd></mtd><mtd><mstyle scriptlevel="0"><mspace width="1em"></mspace></mstyle><mo>+</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">g</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi></mrow>
</mrow></msub><mo>&#8855;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi></mrow>
</mrow></msub><mo>+</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi></mrow>
</mrow></msub></mtd></mtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div><div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mtable style="min-width: 29.733em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-bottom: 0.15em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mrow space="4"><mjx-mo class="mjx-s4"><mjx-c class="mjx-c5B TEX-S4"></mjx-c></mjx-mo><mjx-munderover><mjx-over style="padding-bottom: 0.192em; padding-left: 0.51em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo class="mjx-lop"><mjx-c class="mjx-c2211 TEX-S2"></mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style="padding-top: 0.167em; padding-left: 0.124em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-msub space="2"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mstyle><mjx-mspace style="width: 0.167em"></mjx-mspace></mjx-mstyle><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D421 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-TeXAtom space="2" texclass="ORD"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: 0.477em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub></mjx-TeXAtom></mjx-script></mjx-msup><mjx-mo class="mjx-s4"><mjx-c class="mjx-c5D TEX-S4"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2297"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mrow space="3"><mjx-mo class="mjx-s4"><mjx-c class="mjx-c5B TEX-S4"></mjx-c></mjx-mo><mjx-munderover><mjx-over style="padding-bottom: 0.192em; padding-left: 0.51em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo class="mjx-lop"><mjx-c class="mjx-c2211 TEX-S2"></mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style="padding-top: 0.167em; padding-left: 0.124em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-msub space="2"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mstyle><mjx-mspace style="width: 0.167em"></mjx-mspace></mjx-mstyle><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D425 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-TeXAtom space="2" texclass="ORD"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-TeXAtom><mjx-mo class="mjx-s4"><mjx-c class="mjx-c5D TEX-S4"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2297"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em"><mjx-mstyle><mjx-mspace style="width: 1em"></mjx-mspace></mjx-mstyle><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D420 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.236em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c62"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2297"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c62"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" rowspacing="3pt"><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><munderover><mo data-mjx-texclass="OP">&#8721;</mo>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow>
<mi>n</mi></munderover><msub>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow><mi>j</mi></msub><mstyle scriptlevel="0"><mspace width="thinmathspace"></mspace></mstyle><msup>
<mrow>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo>
<mrow>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo>&#8901;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">h</mi></mrow>
</mrow><mi>j</mi></msub></mrow>
<mo>,</mo>
<mrow><mn>0</mn></mrow>
<mo data-mjx-texclass="CLOSE">)</mo></mrow>
</mrow></mrow>
<mrow><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">g</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow>
</mrow></msub></mrow>
</msup><mo data-mjx-texclass="CLOSE">]</mo></mrow>
<mo>&#8855;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</mrow></msub><mo>+</mo>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><munderover><mo data-mjx-texclass="OP">&#8721;</mo>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow>
<mi>n</mi></munderover><msub>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow><mi>j</mi></msub><mstyle scriptlevel="0"><mspace width="thinmathspace"></mspace></mstyle>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo>
<mrow>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo>&#8901;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">l</mi></mrow>
</mrow><mi>j</mi></msub></mrow>
<mo>,</mo>
<mrow><mn>0</mn></mrow>
<mo data-mjx-texclass="CLOSE">)</mo></mrow>
</mrow><mo data-mjx-texclass="CLOSE">]</mo></mrow>
<mo>&#8855;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">f</mi></mrow>
</mrow></msub></mtd></mtr><mtr><mtd></mtd><mtd><mstyle scriptlevel="0"><mspace width="1em"></mspace></mstyle><mo>+</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">g</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi></mrow>
</mrow></msub><mo>&#8855;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi></mrow>
</mrow></msub><mo>+</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi></mrow>
</mrow></msub><mo>.</mo></mtd></mtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div><p>
Finally, we make the very reasonable assumption that <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c62"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi></mrow>
</mrow></msub><mo>=</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">f</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container>:
</p>
<span class="InMarginAnchor">
<span class="InMargin">
<span class="EqMarginCaption">
A version of the standard lighting equation more suitable for
vertex-level lighting computations
</span>
</span>
</span><div class="DisplayMath">
<mjx-container class="MathJax" display="true" jax="CHTML" role="presentation" style="font-size: 100%; min-width: 100%; position: relative" width="full">
<mjx-math aria-hidden="true" class="MJX-TEX" display="true" width="full"><mjx-mtable side="right" style="min-width: 100%; display: flex; justify-content: space-between; flex-flow: row nowrap">
<mjx-labels-partner style="flex: 1 0 0; max-width: 3.856em"></mjx-labels-partner><mjx-table style="flex: 0 0 19.325em"><mjx-itable width="full"><mjx-mlabeledtr><mjx-mtd style="text-align: right"><mjx-mtable justify="right" style="min-width: 19.325em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-bottom: 0.15em"><mjx-msub><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mrow space="4"><mjx-mo class="mjx-s4"><mjx-c class="mjx-c5B TEX-S4"></mjx-c></mjx-mo><mjx-munderover><mjx-over style="padding-bottom: 0.192em; padding-left: 0.51em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo class="mjx-lop"><mjx-c class="mjx-c2211 TEX-S2"></mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style="padding-top: 0.167em; padding-left: 0.124em"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-msub space="2"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mstyle><mjx-mspace style="width: 0.167em"></mjx-mspace></mjx-mstyle><mjx-msup><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-texatom><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D421 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-texatom space="2" texclass="ORD"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: 0.477em"><mjx-texatom size="s" texclass="ORD"><mjx-msub><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub></mjx-texatom></mjx-script></mjx-msup><mjx-mo class="mjx-s4"><mjx-c class="mjx-c5D TEX-S4"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2297"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-mstyle><mjx-mspace style="width: 1em"></mjx-mspace></mjx-mstyle><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mrow space="3"><mjx-mo class="mjx-s4"><mjx-c class="mjx-c5B TEX-S4"></mjx-c></mjx-mo><mjx-msub><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D420 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.236em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c62"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-munderover space="3"><mjx-over style="padding-bottom: 0.192em; padding-left: 0.51em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo class="mjx-lop"><mjx-c class="mjx-c2211 TEX-S2"></mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style="padding-top: 0.167em; padding-left: 0.124em"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-msub space="2"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mstyle><mjx-mspace style="width: 0.167em"></mjx-mspace></mjx-mstyle><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-texatom><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D425 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-texatom space="2" texclass="ORD"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-texatom><mjx-mo class="mjx-s4"><mjx-c class="mjx-c5D TEX-S4"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2297"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em"><mjx-mstyle><mjx-mspace style="width: 1em"></mjx-mspace></mjx-mstyle><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b" noic="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mlabeledtr></mjx-itable></mjx-table>
<mjx-labels style="flex: 0 0 3.856em"><mjx-itable align="right" style=""><mjx-mtr style="height: 7.763em"><mjx-mtd id="mjx-eqn-10.15"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c28"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c29"></mjx-c></mjx-mtext><mjx-tstrut style="height: 7.763em; vertical-align: -3.632em"></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-labels>
</mjx-mtable>
</mjx-math>
<mjx-assistive-mml display="block" role="presentation" unselectable="on"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mlabeledtr><mtd><mtext>(10.15)</mtext></mtd><mtd><mtable columnalign="right left" columnspacing="0em" displaystyle="true" rowspacing="3pt"><mtr><mtd><msub>
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow>
</mrow></msub></mtd><mtd><mi></mi><mo>=</mo>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><munderover><mo data-mjx-texclass="OP">&#8721;</mo>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow>
<mi>n</mi></munderover><msub>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow><mi>j</mi></msub><mstyle scriptlevel="0"><mspace width="thinmathspace"></mspace></mstyle><msup>
<mrow>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo>
<mrow>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo>&#8901;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">h</mi></mrow>
</mrow><mi>j</mi></msub></mrow>
<mo>,</mo>
<mrow><mn>0</mn></mrow>
<mo data-mjx-texclass="CLOSE">)</mo></mrow>
</mrow></mrow>
<mrow><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">g</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow>
</mrow></msub></mrow>
</msup><mo data-mjx-texclass="CLOSE">]</mo></mrow>
<mo>&#8855;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</mrow></msub></mtd></mtr><mtr><mtd></mtd><mtd><mstyle scriptlevel="0"><mspace width="1em"></mspace></mstyle><mo>+</mo>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">g</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi></mrow>
</mrow></msub><mo>+</mo><munderover><mo data-mjx-texclass="OP">&#8721;</mo>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow>
<mi>n</mi></munderover><msub>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow><mi>j</mi></msub><mstyle scriptlevel="0"><mspace width="thinmathspace"></mspace></mstyle>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo>
<mrow>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo>&#8901;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">l</mi></mrow>
</mrow><mi>j</mi></msub></mrow>
<mo>,</mo>
<mrow><mn>0</mn></mrow>
<mo data-mjx-texclass="CLOSE">)</mo></mrow>
</mrow><mo data-mjx-texclass="CLOSE">]</mo></mrow>
<mo>&#8855;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">f</mi></mrow>
</mrow></msub></mtd></mtr><mtr><mtd></mtd><mtd><mstyle scriptlevel="0"><mspace width="1em"></mspace></mstyle><mo>+</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi></mrow>
</mrow></msub><mo>.</mo></mtd></mtr></mtable></mtd></mlabeledtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<p>
With the lighting equation in the format of <a href="#standard_lighting_model_gouraud_suitable">Equation&#160;(10.15)</a>,
we can see how to use interpolated lighting values computed at the vertex level.  At each vertex,
we will compute two values: <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</msub></math></mjx-assistive-mml>
</mjx-container> contains the specular portion of
<a href="#standard_lighting_model_gouraud_suitable">Equation&#160;(10.15)</a> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">f</mi></mrow>
</msub></math></mjx-assistive-mml>
</mjx-container> contains the
ambient and diffuse terms:
</p>
<span class="InMarginAnchor"><span class="InMargin"><span class="EqMarginCaption">Vertex-level diffuse and specular lighting values</span></span></span><div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mtable style="min-width: 29.826em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-right: 1em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-munderover space="4"><mjx-over style="padding-bottom: 0.192em; padding-left: 0.51em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo class="mjx-lop"><mjx-c class="mjx-c2211 TEX-S2"></mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style="padding-top: 0.167em; padding-left: 0.124em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-msub space="2"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mstyle><mjx-mspace style="width: 0.167em"></mjx-mspace></mjx-mstyle><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D421 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-TeXAtom space="2" texclass="ORD"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: 0.477em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub></mjx-TeXAtom></mjx-script></mjx-msup><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding-left: 1em; padding-right: 0"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D420 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.236em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c62"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-munderover space="3"><mjx-over style="padding-bottom: 0.192em; padding-left: 0.51em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo class="mjx-lop"><mjx-c class="mjx-c2211 TEX-S2"></mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style="padding-top: 0.167em; padding-left: 0.124em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-msub space="2"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mstyle><mjx-mspace style="width: 0.167em"></mjx-mspace></mjx-mstyle><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D425 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-TeXAtom space="2" texclass="ORD"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" rowspacing="3pt"><mtr><mtd><msub>
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</msub></mtd><mtd><mi></mi><mo>=</mo><munderover><mo data-mjx-texclass="OP">&#8721;</mo>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow>
<mi>n</mi></munderover><msub>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow><mi>j</mi></msub><mstyle scriptlevel="0"><mspace width="thinmathspace"></mspace></mstyle><msup>
<mrow>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo>
<mrow>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo>&#8901;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">h</mi></mrow>
</mrow><mi>j</mi></msub></mrow>
<mo>,</mo>
<mrow><mn>0</mn></mrow>
<mo data-mjx-texclass="CLOSE">)</mo></mrow>
</mrow></mrow>
<mrow><msub><mi>m</mi>
<mrow>
<mrow><mi mathvariant="normal">g</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow>
</mrow></msub></mrow>
</msup></mtd><mtd><msub>
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">f</mi></mrow>
</msub></mtd><mtd><mi></mi><mo>=</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">g</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi></mrow>
</mrow></msub><mo>+</mo><munderover><mo data-mjx-texclass="OP">&#8721;</mo>
<mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow>
<mi>n</mi></munderover><msub>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow><mi>j</mi></msub><mstyle scriptlevel="0"><mspace width="thinmathspace"></mspace></mstyle>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo>
<mrow>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo>&#8901;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">l</mi></mrow>
</mrow><mi>j</mi></msub></mrow>
<mo>,</mo>
<mrow><mn>0</mn></mrow>
<mo data-mjx-texclass="CLOSE">)</mo></mrow>
</mrow><mo>.</mo></mtd></mtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<p>
Each of these values is computed per vertex and interpolated across the face of the triangle.
Then, per pixel, the light contributions are multiplied by the corresponding material colors and
summed:
</p>
<span class="InMarginAnchor"><span class="InMargin"><span class="EqMarginCaption">Shading pixels using interpolated lighting values</span></span></span><div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mtable style="min-width: 18.944em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D41C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2297"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mstyle><mjx-mspace style="width: 0.167em"></mjx-mspace></mjx-mstyle><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mstyle space="3"><mjx-mspace style="width: 0.167em"></mjx-mspace></mjx-mstyle><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2297"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c66"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mstyle><mjx-mspace style="width: 0.167em"></mjx-mspace></mjx-mstyle><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mstyle space="3"><mjx-mspace style="width: 0.167em"></mjx-mspace></mjx-mstyle><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" rowspacing="3pt"><mtr><mtd><msub>
<mrow>
<mrow><mi mathvariant="bold">c</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow>
</mrow></msub></mtd><mtd><mi></mi><mo>=</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</msub><mo>&#8855;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</mrow></msub><mstyle scriptlevel="0"><mspace width="thinmathspace"></mspace></mstyle><mo>+</mo><mstyle scriptlevel="0"><mspace width="thinmathspace"></mspace></mstyle><msub>
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">f</mi></mrow>
</msub><mo>&#8855;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">f</mi></mrow>
</mrow></msub><mstyle scriptlevel="0"><mspace width="thinmathspace"></mspace></mstyle><mo>+</mo><mstyle scriptlevel="0"><mspace width="thinmathspace"></mspace></mstyle><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi></mrow>
</mrow></msub><mo>.</mo></mtd></mtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<p>
As mentioned earlier, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D426 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c73"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">m</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container> is sometimes a constant color, in which case
we could move this multiplication into the vertex shader.  But it also can come from a specular
map.
</p>
<p>
What coordinate space should be used for lighting computations?  We could perform the lighting
computations in world space.  Vertex positions and normals would be transformed into world space,
lighting would be performed, and then the vertex positions would be transformed into clip space.
Or we may transform the lights into modeling space, and perform lighting computations in modeling
space.  Since there are usually fewer lights than there are vertices, this results in fewer
overall vector-matrix multiplications.  A third possibility is to perform the lighting
computations in camera space.
</p>

<h1 id="light_sources"><span class="SectionNumber">10.7</span><span class="SectionTitle">Light Sources</span></h1>
<p class="NoIndent">In the rendering equation, light sources produce their effect when we factor
in the emissive component of a surface.  As mentioned earlier, in real-time graphics, doing this
&#8220;properly&#8221; with emissive surfaces is usually a luxury we cannot afford. Even in offline
situations where it can be afforded, we might have reasons to just emit light out of nowhere, to
make it easier to get control of the look of the scene for dramatic lighting, or to simulate the
light that would be reflecting from a surface for which we're not wasting time to model geometry
since it's off camera. Thus we usually have light sources that are abstract entities within the
rendering framework with no surface geometry to call their own.  This section discusses some of
the most common types of light sources.
</p>
<p>
<a href="#standard_abstract_lights">Section&#160;10.7.1</a> covers the classic point, directional, and spot lights.
<a href="#light_attenuation">Section&#160;10.7.2</a> considers how light attenuates in the real world and how
deviations from this reality are common for practical reasons.  The next two sections move away
from the theoretically pure territory and into the messy domain of ad-hoc lighting techniques in
use in real-time graphics today. <a href="#volumetric_lights">Section&#160;10.7.3</a> presents the subject of
<i>Doom</i>-style volumetric lights.  Finally, <a href="#precomputed_light">Section&#160;10.7.4</a> discusses how
lighting calculations can be done offline and then used at runtime, especially for the purpose of
incorporating indirect lighting effects.
</p>
<h2 id="standard_abstract_lights"><span class="SectionNumber">10.7.1</span><span class="SectionTitle">Standard Abstract Light Types</span></h2>
<p class="NoIndent">This section lists some of the most basic light types that are supported by most rendering
systems, even older or limited platforms, such as the OpenGL and DirectX fixed-function lighting
pipelines or the Nintendo Wii.  Of course, systems with programmable shaders often use these
light types, too. Even when completely different methods, such as spherical harmonics, are used
at runtime, standard light types are usually used as an offline editing interface.
</p>
<p>A <i>point light</i> source represents light that emanates from a single point outward in all
directions.  Point lights are also called <i>omni</i> lights(short for &#8220;omnidirectional&#8221;) or
<i>spherical</i> lights. A point light has aposition and color, which controls not only the hue
of the light, but also itsintensity.  <a href="#point_light">Figure&#160;10.30</a> shows how
    <i>3DS Max</i> represents point lightsvisually.
</p>
<div id="point_light" class="Display Figure Narrow">
<div class="Body">
        <img src="figs/graphics/point_light.png" loading="lazy" width="320" height="308">
</div><span class="Caption"><span class="Label">Figure&#160;10.30</span><span class="CaptionText">A point light</span>
</span>
</div><p>As <a href="#point_light">Figure&#160;10.30</a> illustrates, a point light may have a <i>falloff radius</i>, which
controls the size of the sphere that is illuminated by the light. The intensity of the light
usually decreases the farther away we are from the center of the light.  Although not realistic,
it is desirable for many reasons that the intensity drop to zero at the falloff distance, so that
the volume of the effect of the light can be bounded. <a href="#light_attenuation">Section&#160;10.7.2</a> compares
real-world attenuation with the simplified models commonly used. Point lights can be used to
represent many common light sources, such as light bulbs, lamps, fires, and so forth.
</p>
<p>A <i>spot light</i> is used to represent light from a specific location in a specific
direction. These are used for lights such as flashlights, headlights, and of course, spot lights!
A spot light has a position and an orientation, and optionally a falloff distance.  The shape of
the lit area is either a cone or a pyramid.
</p>
<p>A <i>conical spot</i> light has a circular &#8220;bottom.&#8221; The width of the cone is defined by a
    <i>falloff angle</i> (not to be confused with the falloff distance). Also, there is an inner
angle that measures the size of the hotspot.  A conical spot light is shown in
<a href="#spot_light_conical">Figure&#160;10.31</a>.
</p>
<div id="spot_light_conical" class="Display Figure Narrow">
<div class="Body">
        <img src="figs/graphics/spot_light_conical.png" loading="lazy" width="494" height="346">
</div><span class="Caption"><span class="Label">Figure&#160;10.31</span><span class="CaptionText">A conical spot light</span>
</span>
</div><p>A <i>rectangular spot light</i> forms a pyramid rather than a cone. Rectangular spot lights are
especially interesting because they are used to project an image.  For example, imagine walking
in front of a movie screen while a movie is being shown.  This projected image goes by many
names, including
    <i>projected light map</i>, <i>gobo</i>, and even
<i>cookie</i>.<a href="#footnote_17" class="FootnoteRef">17</a>  The term <i>gobo</i> originated from the world of
theater, where it refers to a mask or filter placed over a spot light used to create a colored
light or special effect, and it's the term we use in this book. Gobos are very useful for faking
shadows and other lighting effects. If conical spot lights are not directly supported, they can
be implemented with an appropriately designed circular gobo.
</p>
<p>A <i>directional light</i> represents light emanating from a point in space sufficiently far
away that all the rays of light involved in lighting the scene (or at least the object we are
currently considering) can be considered as parallel. The sun and moon are the most obvious
examples of directional lights, and certainly we wouldn't try to specify the actual position of
the sun in world space in order to properly light the scene.  Thus directional lights usually do
not have a position, at least as far as lighting calculations are concerned, and they usually do
not attenuate. For editing purposes, however, it's often useful to create a &#8220;box&#8221; of
directional light that can be moved around and placed strategically, and we might include
additional attenuation factors to cause the light to drop off at the edge of the box. Directional
lights are sometimes called <i>parallel</i> lights. We might also use a gobo on a directional
light, in which case the projection of the image is orthographic rather than perspective, as it
is with rectangular spot lights.
</p>
<p>As we've said, in the rendering equation and in the real world, lights are emissive surfaces with
finite surface areas.  Abstract light types do not have any surface area, and thus require
special handling during integration.  Typically in a Monte Carlo integrator, a sample is
specifically chosen to be in the direction of the light source, and the multiplication by <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.089em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mpadded><mjx-block style="width: 0"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-block></mjx-mpadded></mjx-TeXAtom><mjx-mspace style="width: 0.055em"></mjx-mspace><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><msub>
<mrow><mover>
<mrow>
<mrow>
<mrow><mpadded width="0"><mi>&#969;</mi></mpadded></mrow>
<mspace width="1px"></mspace>
<mrow><mi>&#969;</mi></mrow>
</mrow></mrow>
<mo stretchy="false">^</mo></mover></mrow>
<mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</msub></math></mjx-assistive-mml>
</mjx-container> is ignored.  Imagine if, rather than the light coming from a
single point, it comes instead from a disk of some nonzero surface area that is facing the point
being illuminated.  Now imagine that we shrink the area of the disk down to zero, all the while
increasing the radiosity (energy flow per unit area) from the disk such that radiant flux (total
energy flow) remains constant. An abstract light can be considered the result of this limiting
process in a manner very similar to a
    Dirac delta (see <a href="dynamics.html#dirac_delta">Section&#160;12.4.3</a>).  The
radiosity is infinite, but the flux is finite.
</p>
<p>While the light types discussed so far are the classic ones supported by fixed-function real-time
pipelines, we certainly are free to define light volumes in any way we find useful.  The
volumetric lights discussed in <a href="#volumetric_lights">Section&#160;10.7.3</a> are an alternative system that is
flexible and also amenable to real-time rendering.  Warn <a class="RefCite" href="#reference_27">[27]</a> and Barzel
<a class="RefCite" href="#reference_3">[3]</a> discuss more flexible systems for shaping lights in greater
detail.
</p>
<h2 id="light_attenuation"><span class="SectionNumber">10.7.2</span><span class="SectionTitle">Light Attenuation</span></h2>
<p class="NoIndent">Light <i>attenuates</i> with distance.  That is, objects receive less
illumination from a light as the distance between the light and the object increases.  In the
real world, the intensity of a light is inversely proportional to the square of the distance
between the light and the object, as
</p>
<span class="InMarginAnchor"><span class="InMargin"><span class="EqMarginCaption">Real-world light attenuation</span></span></span><div class="DisplayMath">
<mjx-container class="MathJax" display="true" jax="CHTML" role="presentation" style="font-size: 100%; min-width: 100%; position: relative" width="full">
<mjx-math aria-hidden="true" class="MJX-TEX" display="true" width="full"><mjx-mtable side="right" style="min-width: 100%; display: flex; justify-content: space-between; flex-flow: row nowrap">
<mjx-labels-partner style="flex: 1 0 0; max-width: 3.856em"></mjx-labels-partner><mjx-table style="flex: 0 0 6.039em"><mjx-itable width="full"><mjx-mlabeledtr><mjx-mtd><mjx-mfrac><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-msub><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-msub><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msup space="4"><mjx-mrow><mjx-mo class="mjx-s3"><mjx-c class="mjx-c28 TEX-S3"></mjx-c></mjx-mo><mjx-mfrac><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-msub><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-msub><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-s3"><mjx-c class="mjx-c29 TEX-S3"></mjx-c></mjx-mo></mjx-mrow><mjx-script style="vertical-align: 1.177em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mlabeledtr></mjx-itable></mjx-table>
<mjx-labels style="flex: 0 0 3.856em"><mjx-itable align="right" style=""><mjx-mtr style="height: 2.597em"><mjx-mtd id="mjx-eqn-10.16"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c28"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c36"></mjx-c><mjx-c class="mjx-c29"></mjx-c></mjx-mtext><mjx-tstrut style="height: 2.597em; vertical-align: -0.949em"></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-labels>
</mjx-mtable>
</mjx-math>
<mjx-assistive-mml display="block" role="presentation" unselectable="on"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mtable displaystyle="true"><mlabeledtr><mtd><mtext>(10.16)</mtext></mtd><mtd><mfrac><msub><mi>i</mi><mn>1</mn></msub><msub><mi>i</mi><mn>2</mn></msub></mfrac><mo>=</mo><msup>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><mfrac><msub><mi>d</mi><mn>2</mn></msub><msub><mi>d</mi><mn>1</mn></msub></mfrac><mo data-mjx-texclass="CLOSE">)</mo></mrow>
<mn>2</mn></msup><mo>,</mo></mtd></mlabeledtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<p class="NoIndent">
where <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></mjx-assistive-mml>
</mjx-container> is the radiant flux (the radiant power per unit area) and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></mjx-assistive-mml>
</mjx-container> is the distance. To
understand the squaring in real-world attenuation, consider the sphere formed by all the photons
emitted from a point light at the same instant.  As these photons move outward, a larger and
larger sphere is formed by the same number of photons.  The density of this photon flow per unit
area (the radiant flux) is inversely proportional to the surface area of the sphere, which is
proportional to the square of the radius (see <a href="geomprims.html#spheres_and_circles">Section&#160;9.3</a>).
</p>
<p>Let's pause here to discuss a finer point: the perceived brightness of an object (or light
source) <i>does not</i> decrease with increased distance from the viewer, ignoring atmospheric
effects. As a light or object recedes from the viewer, the irradiance on our eye decreases for
the reasons just described. However, perceived brightness is related to <i>radiance</i>, not
irradiance. Remember that radiance measures power per unit projected area <i>per unit solid
angle</i>, and as the object recedes from view, the decrease in irradiance is compensated for by the
decrease in solid angle subtended by the object.  It's particularly educational to understand how
the rendering equation naturally accounts for light attenuation.   Inside the integral, for each
direction on the hemisphere surrounding the shading point <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>, we measure the incident
radiance from an emissive surface in that direction. We've just said that this radiance does not
attenuate with distance. However, as the light source moves away from <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>, it occupies a
smaller solid angle on this hemisphere.  Thus, attenuation happens automatically in the rendering
equation if our light sources have finite area. However, for abstract light sources emanating
from a single point (Dirac delta), attenuation must be manually factored in. Because this is a bit confusing, let's
summarize the general rule for real-time rendering.  Emissive surfaces, which are rendered and
have finite area, typically are <i>not</i> attenuated due to distance&#8212;but they might be
affected by atmospheric effects such as fog.  For purposes of calculating the effective light
color when shading a particular spot, the standard abstract light types <i>are</i> attenuated.
</p>
<p>
In practice, <a href="#light_attenuation_inverse_squared">Equation&#160;(10.16)</a> can be unwieldy for two reasons.
First, the light intensity theoretically increases to infinity at <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c30"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mo>=</mo><mn>0</mn></math></mjx-assistive-mml>
</mjx-container>.  (This is a result of
the light being a Dirac delta, as mentioned previously.)  Barzel <a class="RefCite" href="#reference_3">[3]</a>
describes a simple adjustment to smoothly transition from the inverse square curve near the light
origin, to limit the maximum intensity near the center. Second, the light intensity never falls
off completely to zero.
</p>
<p>Instead of the real-world model, a simpler model based on <i>falloff distance</i> is often used.
<a href="#light_sources">Section&#160;10.7</a> mentioned that the falloff distance controls the distance beyond which
the light has no effect. It's common to use a simple linear interpolation formula such that the
light gradually fades with the distance <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></mjx-assistive-mml>
</mjx-container>:
</p>
<span class="InMarginAnchor"><span class="InMargin"><span class="EqMarginCaption">Typical linear attenuation model</span></span></span><div class="DisplayMath">
<mjx-container class="MathJax" display="true" jax="CHTML" role="presentation" style="font-size: 100%; min-width: 100%; position: relative" width="full">
<mjx-math aria-hidden="true" class="MJX-TEX" display="true" width="full"><mjx-mtable side="right" style="min-width: 100%; display: flex; justify-content: space-between; flex-flow: row nowrap">
<mjx-labels-partner style="flex: 1 0 0; max-width: 3.856em"></mjx-labels-partner><mjx-table style="flex: 0 0 18.096em"><mjx-itable width="full"><mjx-mlabeledtr><mjx-mtd><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mrow space="4"><mjx-mo class="mjx-n"><mjx-stretchy-v class="mjx-c7B" style="height: 4.614em; vertical-align: -2.057em"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-mid><mjx-c></mjx-c></mjx-mid><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style="min-width: 14.231em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: left; padding-right: 0.5em; padding-bottom: 0.1em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0.5em; padding-bottom: 0.1em"><mjx-mstyle><mjx-mtext class="mjx-n"><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c66"></mjx-c><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext></mjx-mstyle><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: left; padding-right: 0.5em; padding-top: 0.1em; padding-bottom: 0.1em"><mjx-texatom texclass="ORD"><mjx-mstyle><mjx-mfrac><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-msub><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mrow><mjx-msub><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle></mjx-texatom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0.5em; padding-top: 0.1em; padding-bottom: 0.1em"><mjx-mstyle><mjx-mtext class="mjx-n"><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c66"></mjx-c><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext></mjx-mstyle><mjx-msub><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3C"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: left; padding-right: 0.5em; padding-top: 0.1em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0.5em; padding-top: 0.1em"><mjx-mstyle><mjx-mtext class="mjx-n"><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c66"></mjx-c><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext></mjx-mstyle><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2265"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noic="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-n"></mjx-mo></mjx-mrow><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mlabeledtr></mjx-itable></mjx-table>
<mjx-labels style="flex: 0 0 3.856em"><mjx-itable align="right" style=""><mjx-mtr style="height: 4.614em"><mjx-mtd id="mjx-eqn-10.17"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c28"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c29"></mjx-c></mjx-mtext><mjx-tstrut style="height: 4.614em; vertical-align: -2.057em"></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-labels>
</mjx-mtable>
</mjx-math>
<mjx-assistive-mml display="block" role="presentation" unselectable="on"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mtable displaystyle="true"><mlabeledtr><mtd><mtext>(10.17)</mtext></mtd><mtd><mi>i</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">)</mo><mo>=</mo>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">{</mo><mtable columnalign="left left" columnspacing="1em" rowspacing=".2em"><mtr><mtd><mn>1</mn></mtd><mtd><mstyle displaystyle="false" scriptlevel="0"><mtext>if&#160;</mtext></mstyle><mi>d</mi><mo>&#8804;</mo><msub><mi>d</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</mrow></msub><mo>,</mo></mtd></mtr><mtr><mtd>
<mrow><mstyle displaystyle="true" scriptlevel="0"><mfrac>
<mrow><msub><mi>d</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
</mrow></msub><mo>&#8722;</mo><mi>d</mi></mrow>
<mrow><msub><mi>d</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
</mrow></msub><mo>&#8722;</mo><msub><mi>d</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</mrow></msub></mrow>
</mfrac></mstyle></mrow>
</mtd><mtd><mstyle displaystyle="false" scriptlevel="0"><mtext>if&#160;</mtext></mstyle><msub><mi>d</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</mrow></msub><mo>&lt;</mo><mi>d</mi><mo>&lt;</mo><msub><mi>d</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
</mrow></msub><mo>,</mo></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mstyle displaystyle="false" scriptlevel="0"><mtext>if&#160;</mtext></mstyle><mi>d</mi><mo>&#8805;</mo><msub><mi>d</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
</mrow></msub><mo>.</mo></mtd></mtr></mtable><mo data-mjx-texclass="CLOSE" fence="true" stretchy="true" symmetric="true"></mo></mrow>
</mtd></mlabeledtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<p>
As <a href="#linear_light_attenuation">Equation&#160;(10.17)</a> shows, there are actually two distances used to control
the attenuation. Within <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>d</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container>, the light is at full intensity (100%). As the
distance goes from <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>d</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container> to <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>d</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container>, the intensity varies linearly from
100%down to 0%. At <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>d</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container> and beyond, the light intensity is 0%. So basically,
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>d</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container> controls the distance at which the light begins to fall off; it is frequently
zero, which means that the light begins falling off immediately. The quantity <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c78"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>d</mi>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow>
</mrow></msub></math></mjx-assistive-mml>
</mjx-container>
is the actual falloff distance&#8212;the distance where the light has fallen off completely and no
longer has any effect. <a href="#light_attenuation_curves">Figure&#160;10.32</a> compares real-world light attenuation
to the simple linear attenuation model.
</p>
<div id="light_attenuation_curves" class="Display Figure Wide">
<div class="Body">
	<img src="figs/graphics/light_attenuation_curves.png" loading="lazy" width="510" height="510">
</div><span class="Caption">
<span class="Label">Figure&#160;10.32</span><span class="CaptionText">Real-world light attenuation vs.&#160;simple linear attenuation</span>
</span>
</div><p>
Distance attenuation can be applied to point and spot lights; directional lights are usually not
attenuated.  An additional attenuation factor is used for spot lights.
    <i>Hotspot falloff</i> attenuates light as we move closer to the edge of the cone.
</p>
<h2 id="volumetric_lights"><span class="SectionNumber">10.7.3</span><span class="SectionTitle"><i>Doom</i>-style Volumetric Lights</span></h2>
<p class="NoIndent">In the theoretical framework of the rendering equation as well as HLSL shaders doing lighting
equations using the standard Blinn-Phong model, all that is required of a light source for it to
be used in shading calculations at a particular point <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> is a light color (intensity)
and direction of incidence.  This section discusses a type of volumetric light, popularized by
the
    <i>Doom 3</i> engine (also known as <i>id Tech 4</i>) around 2003, which specifies these values
in a novel way. Not only are these types of lights interesting to understand from a practical
standpoint (they are still useful today), they are interesting from a theoretical perspective
because they illustrate an elegant, fast approximation.  Such approximations are the essence of
the art of real-time rendering.
</p>
<p>
The most creative aspect of <i>Doom</i>-style volumetric lights is how they determine the
intensity at a given point.  It is controlled through two texture maps.  One map is essentially a
    gobo, which can be projected by either orthographic or perspective projection, similar to a spot
or directional light.  The other map is a <i>one-dimensional</i> map, known as the
    <i>falloff map</i>, which controls the falloff.  The procedure for determining the light
intensity at point <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> is as follows: <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> is multiplied by a <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c34"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c34"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>4</mn><mo>&#215;</mo><mn>4</mn></math></mjx-assistive-mml>
</mjx-container>
matrix, and the resulting coordinates are used to index into the two maps.  The 2D gobo is
indexed using <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi>
<mrow><mo>/</mo></mrow>
<mi>w</mi><mo>,</mo><mi>y</mi>
<mrow><mo>/</mo></mrow>
<mi>w</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container>, and the 1D falloff map is indexed with <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container>. The product of these two
texels defines the light intensity at <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">x</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>.
</p>
<div id="doom_lights_example" class="Display Figure Wide">
<div class="Body">
<span class="minipage">
    <table>
<tr>
<td></td>
<td class="AlignCenter"><b>Omni</b></td>
<td class="AlignCenter"><b>Spot</b></td>
<td class="AlignCenter"><b>Fake spot</b></td>
</tr>
<tr>
<td></td>
<td class="AlignCenter"><img src="figs/graphics/doom_light_omni_room.png" loading="lazy" width="255" height="260">
</td>
<td class="AlignCenter"><img src="figs/graphics/doom_light_spot_room.png" loading="lazy" width="255" height="260">
</td>
<td class="AlignCenter"><img src="figs/graphics/doom_light_fake_spot_room.png" loading="lazy" width="255" height="260">
</td>
</tr>
<tr>
<td><span class="FontScriptSize box">Example</span></td>
</tr>
<tr>
<td>[-12pt]</td>
<td class="AlignCenter"><img src="figs/graphics/doom_light_omni_gobo.png" loading="lazy" width="255" height="255">
</td>
<td class="AlignCenter"><img src="figs/graphics/doom_light_spot_gobo.png" loading="lazy" width="255" height="255">
</td>
<td class="AlignCenter"><img src="figs/graphics/doom_light_fake_spot_gobo.png" loading="lazy" width="255" height="255">
</td>
</tr>
<tr>
<td><span class="FontScriptSize box">Gobo</span></td>
</tr>
<tr>
<td>
[-12pt]
         <span class="FontScriptSize">Falloff</span>
</td>
<td class="AlignCenter"><img src="figs/graphics/doom_light_omni_falloff.png" loading="lazy" width="255" height="16">
</td>
<td class="AlignCenter"><img src="figs/graphics/doom_light_spot_falloff.png" loading="lazy" width="255" height="16">
</td>
<td class="AlignCenter"><img src="figs/graphics/doom_light_fake_spot_falloff.png" loading="lazy" width="255" height="16">
</td>
</tr>
<tr>
<td><span class="FontScriptSize">Projection</span></td>
<td class="AlignCenter">Orthographic</td>
<td class="AlignCenter">Perspective</td>
<td class="AlignCenter">Orthographic</td>
</tr>
<tr>
<td></td>
<td class="AlignCenter"><img src="figs/graphics/doom_light_omni_box.png" loading="lazy" width="255" height="260">
</td>
<td class="AlignCenter"><img src="figs/graphics/doom_light_spot_box.png" loading="lazy" width="255" height="260">
</td>
<td class="AlignCenter"><img src="figs/graphics/doom_light_fake_spot_box.png" loading="lazy" width="255" height="260">
</td>
</tr>
<tr>
<td><span class="FontScriptSize box">Bounding box</span></td>
</tr>
<tr>
<td>[-12pt]</td>
</tr>
</table>
</span>
</div><span class="Caption">
<span class="Label">Figure&#160;10.33</span><span class="CaptionText">Examples of <i>Doom</i>-style volumetric lights</span>
</span>
</div><p>
The examples in <a href="#doom_lights_example">Figure&#160;10.33</a>  will make this clear. Let's look at each of the
examples in  more detail. The omni light projects the circular gobo orthographically across the box,
and places the &#8220;position&#8221; of the light (which is used to compute the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D425 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">l</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> vector) in the
center of the box.  The <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c34"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c34"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>4</mn><mo>&#215;</mo><mn>4</mn></math></mjx-assistive-mml>
</mjx-container> matrix used to generate the texture coordinates in this case is
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mrow><mjx-mo class="mjx-n"><mjx-stretchy-v style="height: 5.245em; vertical-align: -2.372em" class="mjx-c5B"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style="min-width: 9.915em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-n"><mjx-stretchy-v style="height: 5.245em; vertical-align: -2.372em" class="mjx-c5D"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mtable columnspacing="1em" rowspacing="4pt"><mtr><mtd><mn>1</mn>
<mrow><mo>/</mo></mrow>
<msub><mi>s</mi><mi>x</mi></msub></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mo>&#8722;</mo><mn>1</mn>
<mrow><mo>/</mo></mrow>
<msub><mi>s</mi><mi>y</mi></msub></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn>
<mrow><mo>/</mo></mrow>
<msub><mi>s</mi><mi>z</mi></msub></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>1</mn>
<mrow><mo>/</mo></mrow>
<mn>2</mn></mtd><mtd><mn>1</mn>
<mrow><mo>/</mo></mrow>
<mn>2</mn></mtd><mtd><mn>1</mn>
<mrow><mo>/</mo></mrow>
<mn>2</mn></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">]</mo></mrow>
<mo>,</mo></math></mjx-assistive-mml>
</mjx-container>
</div><span class="InMarginAnchor">
<span class="InMargin"><span class="EqMarginCaption">Texture coordinate generation matrix for a <i>Doom</i>-style omni light</span>
</span>
</span>
<p class="NoIndent">
where <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mi>x</mi></msub></math></mjx-assistive-mml>
</mjx-container>, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mi>y</mi></msub></math></mjx-assistive-mml>
</mjx-container>, and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mi>z</mi></msub></math></mjx-assistive-mml>
</mjx-container> are the dimensions of the box on each axis.  This matrix operates
on points in the object space of the light, where the position of the light is in the center of
the box, so for the matrix that operates on world-space coordinates, we would need to multiply
this matrix by a <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c34"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c34"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>4</mn><mo>&#215;</mo><mn>4</mn></math></mjx-assistive-mml>
</mjx-container> world-to-object matrix on the left.  Note the right-most column is
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo><mjx-script style="vertical-align: 0.363em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c54"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><msup><mo stretchy="false">]</mo>
<mrow><mi mathvariant="normal">T</mi></mrow>
</msup></math></mjx-assistive-mml>
</mjx-container>, since we use an orthographic projection onto the gobo.  The translation of 1/2 is
to adjust the coordinates from the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>&#8722;</mo><mn>1</mn>
<mrow><mo>/</mo></mrow>
<mn>2</mn><mo>,</mo><mo>+</mo><mn>1</mn>
<mrow><mo>/</mo></mrow>
<mn>2</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container> range into the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container> range of the texture.
Also, note the flipping of the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></mjx-assistive-mml>
</mjx-container>-axis, since <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>+</mo><mi>y</mi></math></mjx-assistive-mml>
</mjx-container> points up in our 3D conventions, but <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>+</mo><mi>v</mi></math></mjx-assistive-mml>
</mjx-container>
points down in the texture.
</p>
<p>
Next, let's look at the spot light.  It uses a perspective projection, where the center of
projection is at one end of the box.  The position of the light used for calculating the
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D425 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">l</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> vector is at this same location, but that isn't always the case!  Note that the same
circular gobo is used as for the omni, but due to the perspective projection, it forms a cone
shape. The falloff map is brightest at the end of the box nearest the center of projection and
falls off linearly along the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>+</mo><mi>z</mi></math></mjx-assistive-mml>
</mjx-container> axis, which is the direction of projection of the gobo in all
cases. Notice that the very first pixel of the spot light falloff map is black, to prevent
objects &#8220;behind&#8221; the light from getting lit; in fact, all of the gobos and falloff maps have
black pixels at their edges, since these pixels will be used for any geometry outside the box.
    (The addressing mode must be set to clamp to avoid the gobo and falloff map tiling across 3D
space.) The texture generation matrix for perspective spots is
</p>
<span class="InMarginAnchor">
<span class="InMargin"><span class="EqMarginCaption">Texture coordinate generation matrix for a <i>Doom</i>-style spot light</span>
</span>
</span><div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mrow><mjx-mo class="mjx-n"><mjx-stretchy-v style="height: 5.245em; vertical-align: -2.372em" class="mjx-c5B"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style="min-width: 10.61em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-bottom: 0.2em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.2em 0.5em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-right: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-n"><mjx-stretchy-v style="height: 5.245em; vertical-align: -2.372em" class="mjx-c5D"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mtable columnspacing="1em" rowspacing="4pt"><mtr><mtd><msub><mi>s</mi><mi>z</mi></msub>
<mrow><mo>/</mo></mrow>
<msub><mi>s</mi><mi>x</mi></msub></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mo>&#8722;</mo><msub><mi>s</mi><mi>z</mi></msub>
<mrow><mo>/</mo></mrow>
<msub><mi>s</mi><mi>y</mi></msub></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>1</mn>
<mrow><mo>/</mo></mrow>
<mn>2</mn></mtd><mtd><mn>1</mn>
<mrow><mo>/</mo></mrow>
<mn>2</mn></mtd><mtd><mn>1</mn>
<mrow><mo>/</mo></mrow>
<msub><mi>s</mi><mi>z</mi></msub></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">]</mo></mrow>
<mo>.</mo></math></mjx-assistive-mml>
</mjx-container>
</div>
<p>The &#8220;fake spot&#8221; on the right is perhaps the most interesting. Here, projection is orthographic,
and it is <i>sideways</i>. The conical nature of the light as well as its falloff (what we
ordinarily think of as the falloff, that is) are both encoded in the gobo. The falloff map used
for this light is the same as for the omni light: it is brightest in the center of the box, and
causes the light to fade out as we approach the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>&#8722;</mo><mi>z</mi></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>+</mo><mi>z</mi></math></mjx-assistive-mml>
</mjx-container> faces of the box.  The texture
coordinate matrix in this case is actually the same as that for the omni.  The entire change
comes from using a different gobo, and orienting the light properly!
</p>
<p>
You should study these examples until you are sure you know how they work.
</p>
<p>
<i>Doom</i>-style volumetric lights can be attractive for real-time graphics for several reasons:
</p>
<ul>
    <li>
They are simple and efficient, requiring only the basic functionality
        of texture coordinate generation, and two texture lookups.  These are
        flexible operations that are easily hardwired into
            fixed-function hardware such as the Nintendo Wii.
</li>
<li>
Many different light types and effects can be represented in the
        same framework.  This can be helpful to limit the number of different
        shaders that are needed.  Lighting models, light types, material properties,
        and lighting passes can all be dimensions in the matrix of shaders, and the size
        of this matrix can grow quite quickly.  It can also be useful to reduce the
        amount of switching of render states.
</li>
<li>
Arbitrary falloff curves can be encoded in the gobo and falloff maps. We are not
        restricted to linear or real-world inverse squared attenuation.
</li>
<li>
Due to the ability to control the falloff, the bounding box that contains the
        lighting volume can usually be relatively tight compared to traditional spot
        and omni lights.  In other words, a large percentage of the volume within
        the box is receiving significant lighting, and the light falls off more
        rapidly than for traditional models, so the volume is as small and as tight
        as possible.  Looking at the bottom row of <a href="#doom_lights_example">Figure&#160;10.33</a>,
        compare the size of the box needed to contain the true spot light, versus the
        fake spot light.
<br>
        This is perhaps the most important feature behind the introduction of these
        sorts of lights in <i>Doom 3</i>, which used an accumulated rendering technique
        with no lightmaps or precomputed lighting; every object was fully lit in real time.
        Each light was <i>added</i> into the scene by rerendering the geometry within the
        volume of the light and adding the light's contribution into the frame buffer. Limiting
        the amount of geometry that had to be redrawn (as well as the geometry that had
        to be processed for purposes of the stencil shadows that were used) was a huge
        performance win.
</li>
</ul>
<h2 id="precomputed_light"><span class="SectionNumber">10.7.4</span><span class="SectionTitle">Precalculated Lighting</span></h2>
<p class="NoIndent">
One of the greatest sources of error in the images produced in real time (those positive thinkers
among you might say the greatest opportunity for improvement) is indirect lighting: light that
has &#8220;bounced&#8221; at least one time before illuminating the pixel being rendered.  This is an
extremely difficult problem. A first important step to making it tractable is to break up the
surfaces in the scene into discrete patches or sample points. But even with a relatively modest
number of patches, we still have to determine which patches can &#8220;see&#8221; each other and have a
conduit of radiance, and which cannot see each other and do not exchange radiance.  Then we must
solve for the balance of light in the rendering equation. Furthermore, when any object moves, it
can potentially alter which patches can see which.  In other words, practically <i>any</i> change
will alter the distribution of light in the <i>entire scene</i>.
</p>
<p>
However, it is usually the case that certain lights and geometry in the scene are <i>not</i>
moving. In this case, we can perform more detailed lighting calculations (solve the rendering
equation more fully), and then use those results, ignoring any error that results due to the
difference in the current lighting configuration and the one that was used during the offline
calculations. Let's consider several examples of this basic principle.
</p>
<p>One technique is <i>lightmapping</i>.  In this case, an extra UV channel is used to arrange the
polygons of the scene into a special texture map that contains precalculated lighting
information.  This process of finding a good way to arrange the polygons within the texture map
is often called
    <i>atlasing</i>. In this case, the discrete &#8220;patches&#8221; that we mentioned earlier
are the lightmap texels. Lightmapping works well on large flat surfaces, such as floors and
ceilings, which are relatively easy to arrange within the lightmap effectively. But more dense
meshes, such as staircases, statues, machinery, and trees, which have much more complicated
topology, are not so easily atlased. Luckily, we can just as easily store precomputed lighting
values in the vertices, which often works better for relatively dense meshes.
</p>
<p>
What exactly is the precomputed information that is stored in lightmaps (or vertices)?
Essentially, we store incident illumination, but there are many options.  One option is the
number of samples per patch.  If we have only a single lightmap or vertex color, then we cannot
account for the directional distribution of this incident illumination and must simply use the
sum over the entire hemisphere.  (As we have shown in <a href="#color_and_radiometry">Section&#160;10.1.3</a>, this
&#8220;directionless&#8221; quantity, the incident radiant power per unit area, is properly known as
<i>radiosity</i>, and for historical reasons algorithms for calculating lightmaps are sometimes
confusingly known as
    radiosity techniques, even if the lightmaps include a directional component.) If we can afford
more than one lightmap or vertex color, then we can more accurately capture the distribution.
This directional information is then projected onto a particular basis. We might have each basis
correspond to a single direction.  A technique known as
    <i>spherical harmonics</i> <a class="RefCite" href="#reference_24">[24]</a><a class="RefCite" href="#reference_15">[15]</a>
uses sinusoidal basis functions similar to 2D Fourier techniques. The point in any case is that
the directional distribution of incident light does matter, but when saving precomputed incident
light information, we are usually forced to discard or compress this information.
</p>
<p>Another option is whether the precalculated illumination includes direct lighting, indirect
light, or both.  This decision can often be made on a per-light basis.  The earliest examples of
lightmapping simply calculated the direct light from each light in the scene for each patch. The
primary advantage of this was that it allowed for shadows, which at the time were prohibitively
expensive to produce in real time.  (The same basic idea is still useful today, only now the goal
is usually to reduce the total number of real-time shadows that must be generated.)  Then the
view could be moved around in real time, but obviously, any lights that were burned into the
lightmaps could not move, and if any geometry moved, the shadows would be &#8220;stuck&#8221; to them and
the illusion would break down.  An identical runtime system can be used to render lightmaps that
also include indirect lighting, although the offline calculations require much more finesse. It
is possible for certain lights to have both their direct and indirect lighting baked into the
lightmaps, while other lights have just the indirect portion included in the precalculated
lighting and direct lighting done at runtime.  This might offer advantages, such as shadows with
higher precision than the lightmap texel density, improved specular highlights due to the correct
modeling of the direction of incidence (which is lost when the light is burned into the
lightmaps), or some limited ability to dynamically adjust the intensity of the light or turn it
off or change its position.  Of course, the presence of precalculated lighting for some lights
doesn't preclude the use of completely dynamic techniques for other lights.
</p>
<p>
The lightmapping techniques just discussed work fine for static geometry, but what about dynamic
objects such as characters, vehicles, platforms, and items?  These must be lit dynamically, which
makes the inclusion of indirect lighting challenging.  One technique, popularized by Valve's
<i>Half Life&#160;2</i> <a class="RefCite" href="#reference_10">[10]</a><a class="RefCite" href="#reference_16">[16]</a>, is to strategically place
    <i>light probes</i> at various locations in the scene.  At each probe, we render a cubic
environment map offline.  When rendering a dynamic object, we locate the closest nearby probe and
use this probe to get localized indirect lighting.  There are many variations on this
technique&#8212;for example, we might use one environment map for diffuse reflection of indirect
light, where each sample is prefiltered to contain the entire cosine-weighted hemisphere
surrounding this direction, and a different cubic map for specular reflection of indirect light,
which does not have this filtering.
</p>

<h1 id="skeletal_animation"><span class="SectionNumber">10.8</span><span class="SectionTitle">Skeletal Animation</span></h1>
<p class="NoIndent">The animation of human creatures is certainly of great importance in video games and in computer
graphics in general.  One of the most important techniques for animating characters is
<i>skeletal animation</i>, although it is certainly not limited to this purpose. The easiest way
to appreciate skeletal animation is to compare it to other alternatives, so let's review those
first.
</p>
<p>
Let's say we have created a model of a humanoid creature such as a robot.  How do we animate it?
Certainly, we could treat it like a chess piece and move it around just like a box of
    microwavable herring sandwiches or any other solid object&#8212;this is obviously not very
convincing. Creatures are <i>articulated</i>, meaning they are composed of connected, movable
parts.  The simplest method of animating an articulated creature is to break the model up into a
hierarchy of connected parts&#8212;left forearm, left upper arm, left thigh, left shin, left foot,
torso, head, and so on&#8212;and animate this hierarchy.  An early example of this was
    Dire Straits' <i>Money for Nothing</i> music video.  Newer examples include practically every
    PlayStation 2 game, such as the first <i>Tomb Raider</i>.  The common feature here is that each
part is still rigid; it does not bend or flex.  Hence, no matter how skillfully the character is
animated, it still looks like a robot.
</p>
<p>
The idea behind skeletal animation is to replace the hierarchy of parts with an imaginary
hierarchy of <i>bones</i>.  Then each vertex of the model is associated with one or more bones,
each of which exert influence over the vertex but do not totally determine its position.  If a
vertex is associated with a single bone, then it will maintain a fixed offset relative to this
bone. Such a vertex is known as a <i>rigid</i> vertex, and that vertex behaves exactly like any
vertex from the first
    Laura Croft model. However, more generally, a vertex will receive influence from more than one
bone.  An artist needs to specify which bones influence which vertices.  This process is known as
    <i>skinning</i>,<a href="#footnote_18" class="FootnoteRef">18</a>
and a model thus annotated is known as a <i>skinned</i> model. When more than one bone influences
    a vertex, the animator can distribute, per vertex, differing amounts of influence to each bone.
As you can imagine, this can be very labor intensive. Automated tools exist that can provide a
quick first pass at the skin weights, but a well-skinned character requires expertise and time.
</p>
<div class="KeyIdea">
    To determine the animated position of a vertex, we iterate over all the bones that exert
    some influence over the vertex, and compute the position that the vertex would have if it were
    rigid relative to that bone.  The final vertex position is then taken as the
    weighted average of those positions.
</div><p>
Let's look at an example.  <a href="#skinned_robot_bend_elbow">Figure&#160;10.34</a> shows two example skinned
vertices near the elbow of a robot.  The blue and green dots show what a vertex would look like
if it were rigid to the corresponding bone, and the cyan dot is the skinned vertex; notice that
it stays attached to the surface of the mesh.
</p>
<div id="skinned_robot_bend_elbow" class="Display Figure Wide">
<div class="Body">
<span class="minipage">
<img src="figs/graphics/skinned_robot_bend_elbow.png" loading="lazy" width="900" height="450">
</span>
</div><span class="Caption"><span class="Label">Figure&#160;10.34</span><span class="CaptionText">Two skinned vertices</span>
</span>
</div><p>
The vertex on the right, closer to the shoulder, is influenced approximately 60%by the upper
arm bone and 40%by the forearm bone.  You can see that as the arm bends, this vertex stays
closer to the blue rigid vertex.  In contrast, the vertex closer to the hand appears to be
influenced approximately 80%by the forearm bone and only 20%by the upper arm bone, and thus
it stays closer to its green rigid vertex.
</p>
<p>
So a simple strategy for implementing skeletal animation might be as follows.  For each vertex,
we keep a list of bones that influence the vertex.  Typically we set a limit on the number of
bones that may influence any one vertex (four is a common number).  For each bone, we know the
position of the vertex relative to the bone's local axes, and we have a weight for that bone.  To
compute the skinned vertex positions for a model in an arbitrary pose, we need a transform matrix
for each bone that tells how to convert from bone coordinate space into modeling coordinate
space.  Varying these transform matrices over time is what makes the character appear to animate.
</p>
<p>
<a href="#skeletal_modeling_naive">Listing&#160;10.7</a> illustrates this basic technique.  Note that we are also
planning ahead by including vertex normals.  These are handled in the same way as vertex
positions, only we discard the translation portion of the matrix.  In theory, the same matrix
    should not be used to transform positions and normals.  Remember that if nonuniform scale or skew
is included in the matrix, we really should use the inverse transpose matrix, as was discussed in
<a href="#surface_normals">Section&#160;10.4.2</a>.  In practice, however, computing and sending two sets of matrices
to the GPU is too expensive, so for the sake of efficiency this error is ignored, or nonuniform
scale is simply avoided.  (Uniform scale is typically OK because the normals have to be
renormalized anyway.)  Basis vectors for bump mapping are also commonly part of the process, but
they are handled in a manner very similar to normals, so we will leave those out for now.
</p>
<p>
<div class="Wide Display Listing">
<pre>
// Set a limit on the max number of bones that can influence one vertex
const int kMaxBonesPerVertex = 4;

// Describes a vertex in a skeletal model
struct SkinnedVertex {

    // Number of bones that influence this vertex
    int boneCount;

    // Which bones influence the vertex?  These are indices
    // into a list of bones.
    int boneIndex[kMaxBonesPerVertex];

    // Bone weights.  These must sum to 1
    float boneWeight[kMaxBonesPerVertex];

    // Vertex position and normal, in bone space
    Vector3 posInBoneSpace[kMaxBonesPerVertex];
    Vector3 normalInBoneSpace[kMaxBonesPerVertex];
};

// Describes a vertex as we will use it for rendering
struct Vertex {
    Vector3 pos;
    Vector3 normal;
};

// Compute skinned vertex positions and normals.
void computeSkinnedVertices(
    int vertexCount,                     // number of verts to skin
    const SkinnedVertex *inSkinVertList, // input vert list
    const Matrix4x3 *boneToModelList,    // Pos/orient of each bone
    Vertex *outVertList                  // output goes here
) {

    // Iterate over all the vertices
    for (int i = 0 ; i &lt; vertexCount ; ++i) {
        const SkinnedVertex &amp;s = inSkinVertList[i];
        Vertex &amp;d = outVertList[i];

        // Loop over all bones that influence this vertex, and
        // compute weighted average
        d.pos.zero();
        d.normal.zero();
        for (int j = 0 ; j &lt; s.boneCount ; ++j) {

            // Locate the transform matrix
            const Matrix4x3 &amp;boneToModel
                = boneToModelList[s.boneIndex[j]];

            // Transform from bone to model space (using
            // overloaded vector * matrix operator which does
            // matrix multiplication), and sum in this bone's
            // contribution
            d.pos += s.posInBoneSpace[j] * boneToModel
                * s.boneWeight[j];

            // *Rotate* the vertex into body space, ignoring the
            // translation portion of the affine transform.  The
            // normal is a "vector" and not a "point", so it is not
            // translated.
            d.normal += boneToModel.rotate(s.normalInBoneSpace[j])
                * s.boneWeight[j];
        }

        // Make sure the normal is normalized
        d.normal.normalize();
    }
}
</pre>
</div>
</p>
<p>
Like all of the code snippets in this book, the purpose of this code is to explain principles,
not to show how things are optimized in practice.  In reality, the skinning computations shown
here are usually done in hardware in a vertex shader; we'll show how this is done in
<a href="#hlsl_skinned mesh">Section&#160;10.11.5</a>. But there's plenty more theory to talk about, so let's stay at a
high level.  As it turns out, the technique just presented is easy to understand, but there's an
important high-level optimization. In practice, a slightly different technique is used.
</p>
<p>
We'll get to the optimization in just a moment, but for now, let's back up and ask ourselves
where the bone space coordinates (the member variables named <span class="inlinecode">posInBoneSpace</span> and
<span class="inlinecode">normalInBoneSpace</span> in <a href="#skeletal_modeling_naive">Listing&#160;10.7</a>) came from in the first
place.
    &#8220;That's easy,&#8221; you might say, &#8220;we just export them directly from Maya!&#8221;  But how did Maya
determine them?  The answer is they come from the
    <i>binding pose</i>.  The binding pose (sometimes called the <i>home pose</i>) describes an
orientation of the bones in some default position. When an artist creates a character mesh, he
starts by building a mesh without any bones or skinning data, just like any other model.  During
this process, he builds the character posed in the binding pose.
<a href="#robot_model_binding_pose">Figure&#160;10.35</a> shows our skinned model in her binding pose, along with the
skeleton that is used to animate her.  Remember that bones are really just coordinate spaces and
don't have any actual geometry. The geometry you see exists only as an aid to visualization
</p>
<div id="robot_model_binding_pose" class="Display Figure Wide">
<div class="Body">
<span class="minipage">
        <img src="figs/graphics/robot_binding_pose_model.png" loading="lazy" width="374" height="299">
        <img src="figs/graphics/robot_binding_pose_together.png" loading="lazy" width="374" height="299">
</span>
</div><span class="Caption">
<span class="Label">Figure&#160;10.35</span><span class="CaptionText">The robot model in the binding pose (left), and the bones used to animate the model (right)</span>
</span>
</div><p>
When the mesh is done,<a href="#footnote_19" class="FootnoteRef">19</a> it is
    <i>rigged</i>, which means a hierarchy of bones (a skeleton) is created and the skinning data is
edited to associate vertices with the appropriate bones. During this process, the rigger will
bend bones to various extreme angles to preview how well the model reacts to these contortions.
Is the weighting done properly so that joints don't collapse? This is where the skill and
experience of both the character modeler and the rigger come into play. The point for us is that
although Maya is constantly calculating new vertex positions in response to the manipulation of
the bones, it has saved the original modeling space coordinates of each vertex at the location it
had in the binding pose, before it got attached to a skeleton. Everything starts with that
original vertex position.
</p>
<p>So, to compute the bone-space coordinates of a vertex, we start with the modeling-space
coordinates of that vertex in the binding pose.  We also know the position and orientation of
each bone in the binding pose.  We simply transform the vertex positions from modeling space into
bone space based on those positions and orientations.
</p>
<p>
That's the big picture of mesh skinning, in principle.  Now let's get to the optimization.  The
basic idea is to store the position of each vertex only in the binding pose, rather than storing
it relative to each bone that exerts influence.  Then, when rendering a mesh, rather than having
a bone-to-model transform for each bone, we have a matrix that transforms coordinates from the
original binding space to modeling space in the current pose.  In other words, this matrix
describes the difference between the bone's orientation in the binding pose and the bone's
current orientation in the current pose.  This is shown in
<a href="#skeletal_modeling_optimized">Listing&#160;10.8</a>.
</p>
<p>
<div class="Wide Display Listing">
<pre>
// Set a limit on the max number of bones that can influence one vertex
const int kMaxBonesPerVertex = 4;

// Describes a vertex in a skeletal model
struct SkinnedVertex {

    // Number of bones that influence this vertex
    int boneCount;

    // Which bones influence the vertex?  These are indices
    // into a list of bones.
    int boneIndex[kMaxBonesPerVertex];
    // Bone weights.  These must sun to 1
    float boneWeight[kMaxBonesPerVertex];

    // Vertex position and normal in the binding pose,
    // in model space
    Vector3 pos;
    Vector3 normal;
};

// Describes a vertex as we will use it for rendering
struct Vertex {
    Vector3 pos;
    Vector3 normal;
};

// Compute skinned vertex positions and normals.
void computeSkinnedVertices(
    int vertexCount,                     // number of verts to skin
    const SkinnedVertex *inSkinVertList, // input vert list
    const Matrix4x3 *boneTransformList,  // From binding to current pose
    Vertex *outVertList                  // output goes here
) {

    // Iterate over all the vertices
    for (int i = 0 ; i &lt; vertexCount ; ++i) {
        const SkinnedVertex &amp;s = inSkinVertList[i];
        Vertex &amp;d = outVertList[i];

        // Loop over all bones that influence this vertex, and compute
        // a blended *matrix* for this vertex
        Matrix4x3 blendedMat;
        blendedMat.zero();
        for (int j = 0 ; j &lt; s.boneCount ; ++j) {
            blendedMat += boneTransformList[s.boneIndex[j]]
                * s.boneWeight[j];
        }

        // Transform position and normal using blended matrix
        d.pos = s.pos * blendedMat;
        d.normal = blendedMat.rotate(s.normal);
        // Make sure the normal is normalized
        d.normal.normalize();
    }
}
</pre>
</div>
</p>
<p>This produces a significant reduction in bandwidth to the GPU (due to the decrease in
<span class="inlinecode">sizeof(SkinnedVertex)</span>), as well as a reduction in per-vertex computation, especially
when basis vectors are present.  It just requires a bit more manipulation of the matrices before
handing them to the GPU.
</p>
<p>
We have presented the basic idea behind simple skinning.  Certainly, in situations where
computing resources (and human resources!) are available and worth expending to produce the
highest fidelity characters possible, such as in fighting games or sports games, more advanced
techniques can be employed. For example, we might want to make the bicep bulge as the arm bends
up, or squish out the flesh of a dinosaur foot as weight is transferred and the foot is pressed
harder into the ground.
</p>

<h1 id="bump_mapping"><span class="SectionNumber">10.9</span><span class="SectionTitle">Bump Mapping</span></h1>
<p class="NoIndent">The first use of texture mapping in computer graphics was to define the <i>color</i> of an
object. But texture mapping can be used when we want to specify <i>any</i> surface property with
more granularity than at the vertex level.  The particular surface property that perhaps is
closest to controlling its &#8220;texture,&#8221; in the sense most laypersons would understand it, is
actually the surface normal.
</p>
<p>
<i>Bump mapping</i> is a general term that can refer to at least two different methods of
controlling the surface normal per texel.  A
    <i>height map</i> is a grayscale map, in which the intensity indicates the local &#8220;elevation&#8221; of
the surface.  Lighter colors indicate portions of the surface that are &#8220;bumped out,&#8221; and darker
colors are areas where the surface is &#8220;bumped in.&#8221; Height maps are attractive because they are
very easy to author, but they are not ideal for real-time purposes because the normal is not
directly available; instead, it must be calculated from the intensity gradient. We focus here on
the technique of
    <i>normal mapping</i>, which is very common nowadays and what most people usually mean when they
say &#8220;bump map.&#8221;
</p>
<p>
In a normal map, the coordinates of the surface normal are directly encoded in the map.  The most
basic way is to encode <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml>
</mjx-container>, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></mjx-assistive-mml>
</mjx-container>, and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container> in the red, green, and blue channels, respectively,
although certain hardware supports more optimized formats. The values are usually scaled, biased,
and quantized such that a coordinate value of <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>&#8722;</mo><mn>1</mn></math></mjx-assistive-mml>
</mjx-container> is encoded as a 0, and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>+</mo><mn>1</mn></math></mjx-assistive-mml>
</mjx-container> is encoded using
the maximum color value (usually 255). Now, in principle, using a normal map is simple.  In our
lighting calculation, rather than using the result of interpolating the vertex normals, we fetch
a normal out of the normal map and use it instead.  Voila!  Ah, if only it were that easy&#8230;
</p>
<p>
Complications arise for two primary reasons.  First, normal maps are not intuitive to edit. While
a height map (or true displacement map) can be easily painted in
    <i>Photoshop</i>, normal maps are not so easily visualized and edited.  Cut-and-paste operations
on normal maps are usually safe, but for the normal map to be valid, each pixel should encode a
vector that is normalized. The usual technique for making a normal map is for an artist to
actually model a low- and high-res version of the mesh. The low-res mesh is the one actually used
at runtime, and the high-res mesh is solely to create the bump map,<a href="#footnote_20" class="FootnoteRef">20</a> using an automated tool that raytraces against the
higher resolution mesh to determine the surface normal for every texel in the normal map.
</p>
<p>
The trickier issue is that texture memory is a precious resource.<a href="#footnote_21" class="FootnoteRef">21</a> In some simple cases, every texel in the normal map is
used at most once on the surface of the mesh.  In this case, we could simply encode the normal in
object space, and our earlier description would work just fine. But real-world objects exhibit a
great deal of symmetry and self-similarity, and patterns are often repeated.  For example, a box
often has similar bumps and notches on more than one side.  Because of this, it is currently a
more efficient use of the same amount of memory (and artist time) to increase the resolution of
the map and reuse the same normal map (or perhaps just portions of it) on multiple models (or
perhaps just on multiple places in the same model). Of course, the same principle applies to any
sort of texture map, not just normal maps. But normal maps are different in that they cannot be
arbitrarily rotated or mirrored because they encode a vector. Imagine using the same normal map
on all six sides of a cube. While shading a point on the surface of the cube, we will fetch a
texel from the map and decode it into a 3D vector.  A particular normal map texel on the top will
produce a surface normal that points in the same direction as that same texel on the bottom of
the cube, when they should be opposites! We need some other kind of information to tell us how to
interpret the normal we get from the texture, and this extra bit of information is stored in the
<i>basis vectors</i>.
</p>
<h2 id="tangent_space"><span class="SectionNumber">10.9.1</span><span class="SectionTitle">Tangent Space</span></h2>
<p class="NoIndent">The most common technique these days is for the normal encoded in the map to use coordinates in
<i>tangent space</i>.  In tangent space, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>+</mo><mi>z</mi></math></mjx-assistive-mml>
</mjx-container> points out from the surface; the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>+</mo><mi>z</mi></math></mjx-assistive-mml>
</mjx-container> basis vector
is actually just the surface normal <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math></mjx-assistive-mml>
</mjx-container>.  The <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml>
</mjx-container> basis vector is known as the
    <i>tangent</i> vector, which we'll denote <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42E TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">u</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math></mjx-assistive-mml>
</mjx-container>, and it points in the direction of
increasing <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></mjx-assistive-mml>
</mjx-container> in texture space. In other words, when we move in the direction of the tangent
vector in 3D, this corresponds to moving to the right in 2D in the normal map. (Often, the bump
map shares the same UV coordinates as other maps, but if they differ, it's the coordinates used
for bump mapping that count.) Similarly, the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></mjx-assistive-mml>
</mjx-container> basis vector, known as the
    <i>binormal</i><a href="#footnote_22" class="FootnoteRef">22</a> and denoted here as <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.053em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math></mjx-assistive-mml>
</mjx-container>, corresponds to the direction of increasing <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></mjx-assistive-mml>
</mjx-container>,
although whether this motion is &#8220;up&#8221; or &#8220;down&#8221; in the texture space depends on the
conventions for the origin in <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container> space, which can differ, as we discussed earlier. Of
course, the coordinates for the tangent and binormal are given in model space, just like the
surface normal. As implied by the hats over the variables, basis vectors are usually stored as
unit vectors.
</p>
<p>
For example, assume that a certain texel in a normal map has the RGB triple <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c33"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c38"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c38"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>37</mn><mo>,</mo><mn>128</mn><mo>,</mo><mn>218</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container>, which
is decoded to the unit vector <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>&#8722;</mo><mn>0.707</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0.707</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container>.  We interpret this to mean that the local
surface normal is pointing at about a <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c34"></mjx-c><mjx-c class="mjx-c35"></mjx-c></mjx-mn><mjx-TeXAtom texclass="ORD"><mjx-msup><mjx-mi class="mjx-n"></mjx-mi><mjx-script style="vertical-align: 0.363em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msup></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>45</mn>
<mrow><msup><mi></mi>
<mrow><mi mathvariant="normal">o</mi></mrow>
</msup></mrow>
</math></mjx-assistive-mml>
</mjx-container> angle from a &#8220;flat&#8221; surface normal defined
by the interpolated vertex normal.  It points &#8220;to the left,&#8221; where &#8220;left&#8221; is meaningful in
the image space of the normal map and really means &#8220;in the direction of decreasing <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></mjx-assistive-mml>
</mjx-container>.&#8221;
</p>
<p>
In summary, the tangent, binormal, and normal are the axes of a coordinate space known as tangent
space, and the coordinates of the per-texel normal are interpreted by using this coordinate
space. To obtain the model-space normal from a tangent-space normal, we first decode the normal
from the map and then transform it into model space just like any other vector.  Let
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: 0.363em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-msubsup><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.29em"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.29em"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.29em"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow><mi>t</mi></msup><mo>=</mo><mo stretchy="false">[</mo><msubsup><mi>s</mi><mi>x</mi><mi>t</mi></msubsup><mo>,</mo><msubsup><mi>s</mi><mi>y</mi><mi>t</mi></msubsup><mo>,</mo><msubsup><mi>s</mi><mi>z</mi><mi>t</mi></msubsup><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container> denote the tangent-space surface normal and
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: 0.363em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-msubsup><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.29em"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.29em"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.29em"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow><mi>m</mi></msup><mo>=</mo><mo stretchy="false">[</mo><msubsup><mi>s</mi><mi>x</mi><mi>m</mi></msubsup><mo>,</mo><msubsup><mi>s</mi><mi>y</mi><mi>m</mi></msubsup><mo>,</mo><msubsup><mi>s</mi><mi>z</mi><mi>m</mi></msubsup><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container> denote the model-space surface normal.  We can determine
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: 0.363em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow><mi>m</mi></msup></math></mjx-assistive-mml>
</mjx-container> simply by taking the linear combination of the basis vectors
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: 0.413em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msubsup space="4"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.34em"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42E TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msubsup space="3"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.34em"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.053em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msubsup space="3"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.34em"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow><mi>m</mi></msup><mo>=</mo><msubsup><mi>s</mi><mi>x</mi><mi>t</mi></msubsup>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">u</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo>+</mo><msubsup><mi>s</mi><mi>y</mi><mi>t</mi></msubsup>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo>+</mo><msubsup><mi>s</mi><mi>z</mi><mi>t</mi></msubsup>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo>.</mo></math></mjx-assistive-mml>
</mjx-container>
</div><p>
By now, we know that this is the same thing as multiplying <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msup><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: 0.363em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow><mi>t</mi></msup></math></mjx-assistive-mml>
</mjx-container> by a matrix whose rows
are the basis vectors:
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" display="true" jax="CHTML" role="presentation" style="font-size: 100%; min-width: 100%; position: relative" width="full">
<mjx-math aria-hidden="true" class="MJX-TEX" display="true" width="full"><mjx-mtable side="right" style="min-width: 100%; display: flex; justify-content: space-between; flex-flow: row nowrap">
<mjx-labels-partner style="flex: 1 0 0; max-width: 3.856em"></mjx-labels-partner><mjx-table style="flex: 0 0 7.025em"><mjx-itable width="full"><mjx-mlabeledtr><mjx-mtd style="text-align: right"><mjx-msup><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: 0.413em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msup space="4"><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42C TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom><mjx-script style="vertical-align: 0.413em"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mrow><mjx-mo class="mjx-n"><mjx-stretchy-v class="mjx-c5B" style="height: 3.863em; vertical-align: -1.681em"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable justify="right" style="min-width: 2.195em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-bottom: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-texatom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42E TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-base></mjx-mover></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-top: 0.2em; padding-bottom: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-texatom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.053em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-base></mjx-mover></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-top: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-texatom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-texatom texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-base></mjx-mover></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-n"><mjx-stretchy-v class="mjx-c5D" style="height: 3.863em; vertical-align: -1.681em"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mlabeledtr></mjx-itable></mjx-table>
<mjx-labels style="flex: 0 0 3.856em"><mjx-itable align="right" style=""><mjx-mtr style="height: 3.863em"><mjx-mtd id="mjx-eqn-10.18"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c28"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c38"></mjx-c><mjx-c class="mjx-c29"></mjx-c></mjx-mtext><mjx-tstrut style="height: 3.863em; vertical-align: -1.681em"></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-labels>
</mjx-mtable>
</mjx-math>
<mjx-assistive-mml display="block" role="presentation" unselectable="on"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mlabeledtr><mtd><mtext>(10.18)</mtext></mtd><mtd><msup>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow><mi>m</mi></msup><mo>=</mo><msup>
<mrow>
<mrow><mi mathvariant="bold">s</mi></mrow>
</mrow><mi>t</mi></msup>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mtable columnalign="center" columnspacing="1em" rowspacing="4pt"><mtr><mtd><mo>&#8722;</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">u</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo>&#8722;</mo></mtd></mtr><mtr><mtd><mo>&#8722;</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo>&#8722;</mo></mtd></mtr><mtr><mtd><mo>&#8722;</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo>&#8722;</mo></mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">]</mo></mrow>
<mo>.</mo></mtd></mlabeledtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<p>
Remember that the polygon mesh is just an approximation for a potentially curved surface, so the
surface normal we use for lighting varies continuously over each face in order to approximate the
true surface normal.  In the same way, the tangent and binormal basis vectors also vary
continuously over the mesh, since they should be perpendicular to the surface normal and tangent
to the surface being approximated.  But even on a flat surface, the basis vectors can change over
the surface if a texture is squeezed, squashed, or twisted. Two instructive examples can be found
in <a href="#texture_map_examples_not_quad">Figure&#160;10.19</a>.  The left side shows an example of
&#8220;squishing.&#8221;  In this case, the tangent vector <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42E TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">u</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math></mjx-assistive-mml>
</mjx-container> would be pointing to the right,
parallel to the horizontal polygon edges, while the binormal <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.053em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math></mjx-assistive-mml>
</mjx-container> would be locally
parallel to the vertical (curving) polygon edges at each vertex. To determine the basis vectors
at any given point in the interior of the face, we interpolate the basis vectors from the
vertices, just like we do with the surface normal.  Compare this with the texture mapping on the
right side, where the texture mapping is planar.  In this example, the binormal at every vertex
(and every interior point) points directly down.
</p>
<p>
Notice that in the texture mapping used in the left side of the figure, the tangent and binormal
vectors are not perpendicular. Despite this possibility, it's common to assume the basis vectors
form an orthonormal basis (or to adjust them so that they do), even if the texture is being
manhandled. We make this assumption in order to facilitate two optimizations.  The first
optimization is that we can perform our lighting calculations in tangent space rather than in
model space.  If we do the lighting in model space, we must interpolate the three basis vectors
across the face, and then in the pixel shader we must transform our tangent-space normal into
model space.  When we do the lighting in tangent space, however, we can instead transform the
vectors needed for lighting (<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D425 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">l</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D421 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">h</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>) into tangent space once in the vertex
shader, and then during rasterization the interpolation is done in tangent space. In many
circumstances, this is faster. If we have an orthonormal basis, then the inverse of the transform
matrix is simply its transpose, and we can transform from model space to tangent space just by
using the dot product. (If this isn't making sense, see
<a href="multiplespaces.html#basis_vectors">Section&#160;3.3.3</a> and <a href="matrixmore.html#orthogonal_matrices">Section&#160;6.3</a>.)
Of course, we are free to rotate vectors into tangent space by using the dot product even if our
basis isn't orthonormal; in fact, after interpolating basis vectors and renormalizing them, it's
likely that it will be slightly out of orthogonality.  In this case, our transform is not
completely correct, but usually this doesn't cause any problems.  It's important to remember that
the whole idea of interpolating surface normals and basis vectors is an approximation to begin
with.
</p>
<p>
The second optimization we can make by assuming perpendicular basis vectors is to completely
avoid storing one of the two basis vectors (usually we drop the binormal) and compute it on the
fly.  This can be faster when the performance bottleneck is the shuffling around of memory rather
than per-vertex calculations.  There's just one complication: mirrored bump maps. It is very
common on symmetrical objects for texture maps, including the bump map, to be used twice; on one
side the &#8220;regular&#8221; way, and mirrored on the other side.  Essentially, we need to know whether
the texture is applied in its regular orientation or mirrored.  This is done by storing a flag
that indicates whether the texture is mirrored.  A value of <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>+</mo><mn>1</mn></math></mjx-assistive-mml>
</mjx-container> indicates the usual orientation,
and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>&#8722;</mo><mn>1</mn></math></mjx-assistive-mml>
</mjx-container> indicates the mirrored state.  It's common to conveniently tuck away this flag in the
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></mjx-assistive-mml>
</mjx-container> component of the one basis vector we are keeping.  Now when we need to compute the dropped
basis vector, we take the appropriate cross product (for example <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.053em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-TeXAtom space="4" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42E TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo>=</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo>&#215;</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">u</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math></mjx-assistive-mml>
</mjx-container>), and then multiply by our flag to flip the basis vector if necessary.  This
flag is calculated by the triple product <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42E TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.053em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">n</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo>&#215;</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">u</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
<mo>&#8901;</mo>
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math></mjx-assistive-mml>
</mjx-container>,
which is the same thing as the determinant of the transform matrix in
<a href="#tangent_space_transform_matrix">Equation&#160;(10.18)</a>.
</p>
<h2 id="computing_basis_vectors"><span class="SectionNumber">10.9.2</span><span class="SectionTitle">Calculating Tangent Space Basis Vectors</span></h2>
<p class="NoIndent">Finally, let's talk about how to compute basis vectors. Our development follows Lengyel <a class="RefCite" href="#reference_14">[14]</a>.  We are given a triangle with vertex
positions <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>0</mn></msub><mo>=</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>,</mo><msub><mi>y</mi><mn>0</mn></msub><mo>,</mo><msub><mi>z</mi><mn>0</mn></msub><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container>, <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>1</mn></msub><mo>=</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><msub><mi>z</mi><mn>1</mn></msub><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container>, and
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>2</mn></msub><mo>=</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub><mo>,</mo><msub><mi>z</mi><mn>2</mn></msub><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container>, and at those vertices we have the UV coordinates <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>u</mi><mn>0</mn></msub><mo>,</mo><msub><mi>v</mi><mn>0</mn></msub><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container>,
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>u</mi><mn>1</mn></msub><mo>,</mo><msub><mi>v</mi><mn>1</mn></msub><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container>, and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>u</mi><mn>2</mn></msub><mo>,</mo><msub><mi>v</mi><mn>2</mn></msub><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container>.  Under these circumstances, it is always possible to find a
    planar mapping, meaning the mapping gradient is constant over the entire triangle.
</p>
<p>
Looking ahead, the math will be simplified if we shift the origin to <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>0</mn></msub></math></mjx-assistive-mml>
</mjx-container> by
introducing
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mtable style="min-width: 20.963em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-bottom: 0.15em"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-right: 1em; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding-left: 1em; padding-right: 0; padding-bottom: 0.15em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-right: 1em; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding-left: 1em; padding-right: 0; padding-bottom: 0.15em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-right: 1em; padding-top: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D429 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding-left: 1em; padding-right: 0; padding-top: 0.15em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-right: 1em; padding-top: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding-left: 1em; padding-right: 0; padding-top: 0.15em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" rowspacing="3pt"><mtr><mtd><msub>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mn>1</mn></msub></mtd><mtd><mi></mi><mo>=</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>1</mn></msub><mo>&#8722;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>0</mn></msub><mo>,</mo></mtd><mtd><msub><mi>s</mi><mn>1</mn></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>u</mi><mn>1</mn></msub><mo>&#8722;</mo><msub><mi>u</mi><mn>0</mn></msub><mo>,</mo></mtd><mtd><msub><mi>t</mi><mn>1</mn></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>v</mi><mn>1</mn></msub><mo>&#8722;</mo><msub><mi>v</mi><mn>0</mn></msub><mo>,</mo></mtd></mtr><mtr><mtd><msub>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mn>2</mn></msub></mtd><mtd><mi></mi><mo>=</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>2</mn></msub><mo>&#8722;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">p</mi></mrow>
</mrow><mn>0</mn></msub><mo>,</mo></mtd><mtd><msub><mi>s</mi><mn>2</mn></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>u</mi><mn>2</mn></msub><mo>&#8722;</mo><msub><mi>u</mi><mn>0</mn></msub><mo>,</mo></mtd><mtd><msub><mi>t</mi><mn>2</mn></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>v</mi><mn>2</mn></msub><mo>&#8722;</mo><msub><mi>v</mi><mn>0</mn></msub><mo>.</mo></mtd></mtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div><p>
We seek basis vectors that lie in the plane of the triangle, and thus we can express the triangle
edge vectors <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mn>1</mn></msub></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mn>2</mn></msub></math></mjx-assistive-mml>
</mjx-container> as a linear combination of the basis vectors,
where the known <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></mjx-assistive-mml>
</mjx-container> displacements on those edges are the coordinates:
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mtable style="min-width: 6.728em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-bottom: 0.15em"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42E TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42E TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-TeXAtom space="3" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" rowspacing="3pt"><mtr><mtd>
<mrow>
<mrow><mi mathvariant="bold">u</mi></mrow>
</mrow><msub><mi>s</mi><mn>1</mn></msub><mo>+</mo>
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow><msub><mi>t</mi><mn>1</mn></msub></mtd><mtd><mi></mi><mo>=</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mn>1</mn></msub></mtd></mtr><mtr><mtd>
<mrow>
<mrow><mi mathvariant="bold">u</mi></mrow>
</mrow><msub><mi>s</mi><mn>2</mn></msub><mo>+</mo>
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow><msub><mi>t</mi><mn>2</mn></msub></mtd><mtd><mi></mi><mo>=</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mn>2</mn></msub><mo>.</mo></mtd></mtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div><p>
Normalizing <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42E TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">u</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> produces the unit vectors we seek. We can write these
equations more compactly in matrix notation as
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mrow><mjx-mo class="mjx-s3"><mjx-c class="mjx-c5B TEX-S3"></mjx-c></mjx-mo><mjx-mtable style="min-width: 2.637em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-bottom: 0.2em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-bottom: 0.2em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-s3"><mjx-c class="mjx-c5D TEX-S3"></mjx-c></mjx-mo></mjx-mrow><mjx-mrow><mjx-mo class="mjx-s3"><mjx-c class="mjx-c5B TEX-S3"></mjx-c></mjx-mo><mjx-mtable style="min-width: 2.195em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-bottom: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42E TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-top: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-s3"><mjx-c class="mjx-c5D TEX-S3"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mrow space="4"><mjx-mo class="mjx-s3"><mjx-c class="mjx-c5B TEX-S3"></mjx-c></mjx-mo><mjx-mtable style="min-width: 2.567em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-bottom: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-top: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-s3"><mjx-c class="mjx-c5D TEX-S3"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mtable columnspacing="1em" rowspacing="4pt"><mtr><mtd><msub><mi>s</mi><mn>1</mn></msub></mtd><mtd><msub><mi>t</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>s</mi><mn>2</mn></msub></mtd><mtd><msub><mi>t</mi><mn>2</mn></msub></mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">]</mo></mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mtable columnspacing="1em" rowspacing="4pt"><mtr><mtd><mo>&#8722;</mo>
<mrow>
<mrow><mi mathvariant="bold">u</mi></mrow>
</mrow><mo>&#8722;</mo></mtd></mtr><mtr><mtd><mo>&#8722;</mo>
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow><mo>&#8722;</mo></mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">]</mo></mrow>
<mo>=</mo>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mtable columnspacing="1em" rowspacing="4pt"><mtr><mtd><mo>&#8722;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mn>1</mn></msub><mo>&#8722;</mo></mtd></mtr><mtr><mtd><mo>&#8722;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mn>2</mn></msub><mo>&#8722;</mo></mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">]</mo></mrow>
<mo>,</mo></math></mjx-assistive-mml>
</mjx-container>
</div>
<p class="NoIndent">
whence an elegant solution presents itself.  By multiplying both sides by the inverse of the
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo>,</mo><mi>t</mi></math></mjx-assistive-mml>
</mjx-container> matrix on the left, we have
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mtable style="min-width: 18.671em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-bottom: 0.15em"><mjx-mrow><mjx-mo class="mjx-s3"><mjx-c class="mjx-c5B TEX-S3"></mjx-c></mjx-mo><mjx-mtable style="min-width: 2.195em" justify="right"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-bottom: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42E TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-top: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-s3"><mjx-c class="mjx-c5D TEX-S3"></mjx-c></mjx-mo></mjx-mrow><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msup space="4"><mjx-mrow><mjx-mo class="mjx-s3"><mjx-c class="mjx-c5B TEX-S3"></mjx-c></mjx-mo><mjx-mtable style="min-width: 2.637em" justify="left"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-bottom: 0.2em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-bottom: 0.2em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-s3"><mjx-c class="mjx-c5D TEX-S3"></mjx-c></mjx-mo></mjx-mrow><mjx-script style="vertical-align: 1.177em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-script></mjx-msup><mjx-mrow><mjx-mo class="mjx-s3"><mjx-c class="mjx-c5B TEX-S3"></mjx-c></mjx-mo><mjx-mtable style="min-width: 2.567em" justify="left"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-bottom: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-top: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-s3"><mjx-c class="mjx-c5D TEX-S3"></mjx-c></mjx-mo></mjx-mrow><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-TeXAtom space="4" texclass="ORD"><mjx-mstyle><mjx-mfrac><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mrow><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle></mjx-TeXAtom><mjx-mrow><mjx-mo class="mjx-s3"><mjx-c class="mjx-c5B TEX-S3"></mjx-c></mjx-mo><mjx-mtable style="min-width: 4.193em" justify="left"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-bottom: 0.2em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-bottom: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-right: 0.5em; padding-top: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0.5em; padding-top: 0.2em"><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-s3"><mjx-c class="mjx-c5D TEX-S3"></mjx-c></mjx-mo></mjx-mrow><mjx-mrow><mjx-mo class="mjx-s3"><mjx-c class="mjx-c5B TEX-S3"></mjx-c></mjx-mo><mjx-mtable style="min-width: 2.567em" justify="left"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="padding-bottom: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="padding-top: 0.2em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-s3"><mjx-c class="mjx-c5D TEX-S3"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" rowspacing="3pt"><mtr><mtd>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mtable columnalign="center" columnspacing="1em" rowspacing="4pt"><mtr><mtd><mo>&#8722;</mo>
<mrow>
<mrow><mi mathvariant="bold">u</mi></mrow>
</mrow><mo>&#8722;</mo></mtd></mtr><mtr><mtd><mo>&#8722;</mo>
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow><mo>&#8722;</mo></mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">]</mo></mrow>
</mtd><mtd><mi></mi><mo>=</mo><msup>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mtable columnalign="center" columnspacing="1em" rowspacing="4pt"><mtr><mtd><msub><mi>s</mi><mn>1</mn></msub></mtd><mtd><msub><mi>t</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>s</mi><mn>2</mn></msub></mtd><mtd><msub><mi>t</mi><mn>2</mn></msub></mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">]</mo></mrow>
<mrow><mo>&#8722;</mo><mn>1</mn></mrow>
</msup>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mtable columnalign="center" columnspacing="1em" rowspacing="4pt"><mtr><mtd><mo>&#8722;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mn>1</mn></msub><mo>&#8722;</mo></mtd></mtr><mtr><mtd><mo>&#8722;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mn>2</mn></msub><mo>&#8722;</mo></mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">]</mo></mrow>
</mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo>
<mrow><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>1</mn>
<mrow><msub><mi>s</mi><mn>1</mn></msub><msub><mi>t</mi><mn>2</mn></msub><mo>&#8722;</mo><msub><mi>s</mi><mn>2</mn></msub><msub><mi>t</mi><mn>1</mn></msub></mrow>
</mfrac></mstyle></mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mtable columnalign="center" columnspacing="1em" rowspacing="4pt"><mtr><mtd><msub><mi>t</mi><mn>2</mn></msub></mtd><mtd><mo>&#8722;</mo><msub><mi>t</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><mo>&#8722;</mo><msub><mi>s</mi><mn>2</mn></msub></mtd><mtd><msub><mi>s</mi><mn>1</mn></msub></mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">]</mo></mrow>
<mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mtable columnalign="center" columnspacing="1em" rowspacing="4pt"><mtr><mtd><mo>&#8722;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mn>1</mn></msub><mo>&#8722;</mo></mtd></mtr><mtr><mtd><mo>&#8722;</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mn>2</mn></msub><mo>&#8722;</mo></mtd></mtr></mtable><mo data-mjx-texclass="CLOSE">]</mo></mrow>
<mo>.</mo></mtd></mtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<p>
Since we are planning on normalizing our basis vectors, we can drop the leading constant
fraction, and we are left with
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mtable style="min-width: 8.017em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-bottom: 0.15em"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42E TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-bottom: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i" noIC="true"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42A TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.229em"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" rowspacing="3pt"><mtr><mtd>
<mrow>
<mrow><mi mathvariant="bold">u</mi></mrow>
</mrow></mtd><mtd><mi></mi><mo>=</mo><msub><mi>t</mi><mn>2</mn></msub><msub>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mn>1</mn></msub><mo>&#8722;</mo><msub><mi>t</mi><mn>1</mn></msub><msub>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mn>2</mn></msub><mo>,</mo></mtd></mtr><mtr><mtd>
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow></mtd><mtd><mi></mi><mo>=</mo><mo>&#8722;</mo><msub><mi>s</mi><mn>2</mn></msub><msub>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mn>1</mn></msub><mo>+</mo><msub><mi>s</mi><mn>1</mn></msub><msub>
<mrow>
<mrow><mi mathvariant="bold">q</mi></mrow>
</mrow><mn>2</mn></msub><mo>.</mo></mtd></mtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div><p>
This gives us basis vectors for each triangle.  They are not guaranteed to be perpendicular, but
they are usable for our main purpose: determining basis vectors at the vertex level.  These can
be calculated by using a trick similar to computing vertex normals: for each vertex we take the
average of the basis vectors of the adjacent triangles.  We also usually enforce an orthonormal
basis. This is done most simply via Gram-Schmidt orthogonalization (<a href="matrixmore.html#orthonogal_matrices_orthogonalizing">Section&#160;6.3.3</a>).
Also, if we are dropping one of the basis vectors, then this is where we need to save the
determinant of the basis. <a href="#calculating_basis_vectors">Listing&#160;10.9</a> shows how we might compute
vertex basis vectors.
</p>
<p>
<div class="Wide Display Listing">
<pre>
struct Vertex {
    Vector3 pos;
    float   u,v;
    Vector3 normal;
    Vector3 tangent;
    float   det;     // determinant of tangent transform.  (-1 if mirrored)
};
struct Triangle {
    int vertexIndex[3];
};
struct TriangleMesh {
    int      vertexCount;
    Vertex   *vertexList;
    int      triangleCount;
    Triangle *triangleList;

    void computeBasisVectors() {

        // Note: we assume vertex normals are valid
        Vector3 *tempTangent = new Vector3[vertexCount];
        Vector3 *tempBinormal = new Vector3[vertexCount];

        // First clear out the accumulators
        for (int i = 0 ; i &lt; vertexCount ; ++i) {
            tempTangent[i].zero();
            tempBinormal[i].zero();
        }

        // Average in the basis vectors for each face
        // into its neighboring vertices
        for (int i = 0 ; i &lt; triangleCount ; ++i) {

            // Get shortcuts
            const Triangle &amp;tri = triangleList[i];
            const Vertex &amp;v0 = vertexList[tri.vertexIndex[0]];
            const Vertex &amp;v1 = vertexList[tri.vertexIndex[1]];
            const Vertex &amp;v2 = vertexList[tri.vertexIndex[2]];

            // Compute intermediate values
            Vector3 q1 = v1.pos - v0.pos;
            Vector3 q2 = v2.pos - v0.pos;
            float s1 = v1.u - v0.u;
            float s2 = v2.u - v0.u;
            float t1 = v1.v - v0.v;
            float t2 = v2.v - v0.v;

            // Compute basis vectors for this triangle
            Vector3 tangent = t2*q1 - t1*q2; tangent.normalize();
            Vector3 binormal = -s2*q1 + s1*q2; binormal.normalize();

            // Add them into the running totals for neighboring verts
            for (int j = 0 ; j &lt; 3 ; ++j) {
                tempTangent[tri.vertexIndex[j]] += tangent;
                tempBinormal[tri.vertexIndex[j]] += binormal;
            }
        }

        // Now fill in the values into the vertices
        for (int i = 0 ; i &lt; vertexCount ; ++i) {
            Vertex &amp;v = vertexList[i];
            Vector3 t = tempTangent[i];

            // Ensure tangent is perpendicular to the normal.
            // (Gram-Schmit), then keep normalized version
            t -= v.normal * dot(t, v.normal);
            t.normalize();
            v.tangent = t;

            // Figure out if we're mirrored
            if (dot(cross(v.normal, t), tempBinormal[i]) &lt; 0.0f) {
                v.det = -1.0f; // we're mirrored
            } else {
                v.det = +1.0f; // not mirrored
            }
        }

        // Clean up
        delete[] tempTangent;
        delete[] tempBinormal;
    }
};
</pre>
</div>
</p>
<p>One irritating complication that <a href="#calculating_basis_vectors">Listing&#160;10.9</a> doesn't address is that
there may be a discontinuity in the mapping, where the basis vectors <i>should not</i> be
averaged together, and the basis vectors must be different across a shared edge.  Most of the
time, the faces will have already be detached from each other (the vertices will be duplicated)
along such an edge, since the UV coordinates or normals will not match.  Unfortunately, there is
one particularly common case where this is not true: mirrored textures on symmetric objects. For
example, it is common for character models and other symmetric meshes to have a line down their
center, across which the texture has been mirrored. The vertices along this seam very often
require identical UVs but an opposite <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.07em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42E TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">u</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math></mjx-assistive-mml>
</mjx-container> or <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.06em; padding-left: 0.053em; margin-bottom: -0.531em"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-base></mjx-mover></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow><mover>
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow><mo stretchy="false">^</mo></mover></mrow>
</math></mjx-assistive-mml>
</mjx-container>. These vertices must be
detached in order to avoid producing invalid basis vectors along this seam.
</p>
<p>
<a href="#hlsl_bump_mapping">Section&#160;10.11.4</a> shows some sample shader code that actually uses the basis vectors
to perform bump mapping.  The runtime code is surprisingly simple, once all the data has been
munged into the right format.  This illustrates a common theme of contemporary real-time
graphics: at least 75%of the code is in the <i>tools</i> that manipulate the data&#8212;optimizing,
packing, and otherwise manipulating it into just the right format&#8212;so that the runtime code (the
other 25%) can run as fast as possible.
</p>

<h1 id="realtime_graphics_pipeline"><span class="SectionNumber">10.10</span><span class="SectionTitle">The Real-Time Graphics Pipeline</span></h1>
<p class="NoIndent">The rendering equation is the correct way to produce images, assuming you have an infinite amount
of computing power.  But if you want to produce images in the real world on a real computer, you
need to understand the contemporary trade-offs that are being made. The remainder of this chapter
is more focused on those techniques, by attempting to describe a typical simple real-time
graphics pipeline, circa 2010. After giving an overview of the graphics pipeline, we then descend
that pipeline and discuss each section in more detail, stopping along the way to focus on some
key mathematical ideas.  The reader of this section should be aware of several serious flaws in
this discussion:
</p>
<ul>
    <li>
There is no such thing as the &#8220;typical&#8221; modern graphics
        pipeline. The number of different rendering strategies is equal to
        the number of graphics programmers.  Everyone has his or her own
        preferences, tricks, and optimizations.  Graphics hardware
        continues to evolve <i>rapidly</i>.  As evidence, the use of shader
        programs is now in widespread use in consumer hardware such as gaming
        consoles, and this technology was in its infancy at the
        time of the writing of the first edition of this book.  Still,
        although there is great variance in graphics systems and
        graphics programmers, most systems do have a great deal in
        common.<a href="#footnote_23" class="FootnoteRef">23</a>  We'd like to reiterate that
        our goal in this chapter (indeed, this entire book!) is to give
        you a solid overview, especially where the mathematics is involved,
        from which you can expand your knowledge.  This is not a survey of
        the latest cutting-edge techniques.
        (<i>Real-Time Rendering</i> <a class="RefCite" href="#reference_1">[1]</a> is the best such
        survey at the time of this writing.)
</li>
<li>
We attempt to describe the basic procedure for generating a
        single rendered image with very basic lighting.  We do not consider
        animation, and we only briefly mention techniques for global
        illumination in passing.
</li>
<li>
Our description is of the <i>conceptual</i> flow of data through the graphics
        pipeline.  In practice, tasks are often performed in parallel or out of sequence for
        performance reasons.
</li>
<li>
We are interested in real-time rendering systems which, at the time of this
        writing, are primarily geared for rendering triangle meshes. Other means of producing
        an image, such as raytracing, have a very different high-level structure than that
        discussed here. A reader is warned that in the future, techniques for real-time and
        offline rendering could converge if parallel raytracing becomes a more economical
        way to keep up with the march of Moore's law.
</li>
</ul>
<p>
With the above simplifications in mind, the following is a rough
outline of the flow of data through the graphics pipeline.
</p>
<ul>
    <li>
<span class="ListItemTitle">Setting up the scene.</span>  Before we can begin rendering, we must set several
        options that apply to the entire scene.  For example, we need to set up the camera,
        or more specifically, pick a point of view in the scene from which to render it,
        and choose where on the screen to render it. We discussed the math involved in this
        process in <a href="#viewing_in_3d">Section&#160;10.2</a>.  We also need to select lighting and fog
        options, and prepare the depth buffer.
</li>
<li>
<span class="ListItemTitle">Visibility determination.</span>  Once we have a camera in place, we must
        then decide which objects in the scene are visible.  This is extremely
        important for real-time rendering, since we don't want to waste time
        rendering anything that isn't actually visible.  This high-level culling
        is very important for real games, but is usually ignored for simple applications
        when you're getting started, and is not covered here.
</li>
<li>
<span class="ListItemTitle">Setting object-level rendering states.</span>  Once we know that an object is
        potentially visible, it's time to actually draw the object.  Each object may have its
        own rendering options.  We must install these options into the rendering context
        before rendering any primitives associated with the object.  Perhaps the most basic
        property associated with an object is a
            <i>material</i> that describes the surface
        properties of the object. One of the most common material properties is the
            diffuse color of the object, which is usually controlled by using a <i>texture map</i>, as we
        discussed in <a href="#texture_mapping">Section&#160;10.5</a>.
</li>
<li>
<span class="ListItemTitle">Geometry generation/delivery.</span>  Next, the geometry is actually
        submitted to the rendering API.  Typically, the data is delivered in
        the form of triangles; either as individual triangles, or an indexed
        triangle mesh, triangle strip, or some other form.  At this
        stage, we may also perform
            level of detail (LOD) selection or generate geometry procedurally.  We discuss a
        number of issues related to delivering geometry to the rendering API in
        <a href="#geometry_delivery">Section&#160;10.10.2</a>.
</li>
<li>
<span class="ListItemTitle">Vertex-level operations.</span>  Once the rendering API has the geometry in some
        triangulated format, a number of various operations are performed at the vertex
        level.  Perhaps the most important such operation is the transformation of vertex
        positions from modeling space into camera space.  Other vertex level operations might
        include skinning for animation of skeletal models, vertex lighting, and texture
        coordinate generation.  In consumer graphics systems at the time of this writing,
        these operations are performed by a user-supplied microprogram called a
            <i>vertex shader</i>.  We give several examples of vertex and pixel shaders at the
        end of this chapter, in <a href="#hlsl_examples">Section&#160;10.11</a>.
</li>
<li>
<span class="ListItemTitle">Culling, clipping, and projection.</span>  Next, we must perform three operations
        to get triangles in 3D onto the screen in 2D.  The exact order in which these steps are
        taken can vary.  First, any portion of a triangle outside the view frustum is
        removed, by a process known as
            <i>clipping</i>, which is discussed in <a href="#clipping">Section&#160;10.10.4</a>.  Once we have a clipped
        polygon in
            3D clip space, we then project the vertices of that polygon, mapping them to
        the
            2D screen-space coordinates of the output window, as was explained in
        <a href="#screen_space">Section&#160;10.3.5</a>.
            Finally, individual triangles that face away from the camera
        are removed (&#8220;culled&#8221;), based on the clockwise or counterclockwise ordering of their
        vertices, as we discuss in <a href="#backface_culling">Section&#160;10.10.5</a>.
</li>
<li>
<span class="ListItemTitle">Rasterization.</span>  Once we have a clipped polygon in screen space, it is
        rasterized.  Rasterization refers to the process of selecting which pixels on the
        screen should be drawn for a particular triangle; interpolating texture coordinates,
        colors, and lighting values that were computed at the vertex level across the face
        for each pixel; and passing these down to the next stage for pixel shading. Since
        this operation is usually performed at the hardware level, we will only briefly
        mention rasterization in <a href="#rasterization_shading_and_output">Section&#160;10.10.6</a>.
</li>
<li>
<span class="ListItemTitle">Pixel shading.</span>  Next we compute a
        color for the pixel, a process known as <i>shading</i>.  Of course, the innocuous
        phrase &#8220;compute a color&#8221; is the heart of computer graphics! Once we have picked a
        color, we then write that color to the frame buffer, possibly subject to alpha blending and
        <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container>-buffering.  We discuss this process in
        <a href="#rasterization_shading_and_output">Section&#160;10.10.6</a>. In today's consumer hardware, pixel
        shading is done by a
            <i>pixel shader</i>, which is a small piece of code you can
        write that takes the values from the vertex shader (which are interpolated across the
        face and supplied per-pixel), and then outputs the  color value to the final step: blending.
</li>
<li>
<span class="ListItemTitle">Blending and output.</span>  Finally, at the very bottom of the render pipeline,
        we have produced a color, opacity, and depth value.
            The depth value is tested
        against the depth buffer for per-pixel visibility determination to ensure that an
        object farther away from the camera doesn't obscure one closer to the camera.  Pixels
        with an opacity that is too low are rejected, and the output color is then combined
        with the previous color in the frame buffer in a process known as <i>alpha
        blending</i>.
</li>
</ul>
<p>
The pseudocode in <a href="#pipeline_pseudocode">Listing&#160;10.10</a> summarizes the simplified rendering pipeline
outlined above.
</p>
<p>
<div class="Wide Display Listing">
<pre>
// First, figure how to view the scene
setupTheCamera();

// Clear the zbuffer
clearZBuffer();

// Setup environmental lighting and fog
setGlobalLightingAndFog();

// get a list of objects that are potentially visible
potentiallyVisibleObjectList = highLevelVisibilityDetermination(scene);

// Render everything we found to be potentially visible
for (all objects in potentiallyVisibleObjectList) {

    // Perform lower-level VSD using bounding volume test
    if (!object.isBoundingVolumeVisible()) continue;

    // Fetch or procedurally generate the geometry
    triMesh = object.getGeometry()

    // Clip and render the faces
    for (each triangle in the geometry) {

        // Transform the vertices to clip space, and perform
        // vertex-level calculations (run the vertex shader)
        clipSpaceTriangle = transformAndLighting(triangle);

        // Clip the triangle to the view volume
        clippedTriangle = clipToViewVolume(clipSpaceTriangle);
        if (clippedTriangle.isEmpty()) continue;

        // Project the triangle onto screen space
        screenSpaceTriangle = clippedTriangle.projectToScreenSpace();

        // Is the triangle backfacing?
        if (screenSpaceTriangle.isBackFacing()) continue;

        // Rasterize the triangle
        for (each pixel in the triangle) {

            // Scissor the pixel here (if triangle was
            // not completely clipped to the frustum)
            if (pixel is off-screen) continue;

            // Interpolate color, zbuffer value,
            // and texture mapping coords

            // The pixel shader takes interpolated values
            // and computes a color and alpha value
            color = shadePixel();

            // Perform zbuffering
            if (!zbufferTest()) continue;

            // Alpha test to ignore pixels that are "too
            // transparent"
            if (!alphaTest()) continue;

            // Write to the frame buffer and zbuffer
            writePixel(color, interpolatedZ);

            // Move on to the next pixel in this triangle
        }

        // Move on to the next triangle in this object
    }

    // Move on to the next potentially visible object
}
</pre>
</div>
</p>
<p>
It wasn't too long ago that a graphics programmer would be responsible for writing code to do all
of the steps shown <a href="#pipeline_pseudocode">Listing&#160;10.10</a> in software.  Nowadays, we delegate many
tasks to a graphics API such as DirectX or OpenGL. The API may perform some of these tasks in
software on the main CPU, and other tasks (ideally, as many as possible) are dispatched to
specialized graphics hardware.  Modern graphics hardware allows the graphics programmer (that's
us) very low level control through
    <i>vertex shaders</i> and <i>pixel shaders</i>, which are basically microprograms we write that
are executed on the hardware for each vertex and pixel that is processed.  While performance
concerns in the old single processor software rendering days were addressed with hand-tuned
assembly, nowadays the concerns are more about using the GPU as efficiently as possible, and
ensuring that it is never idle, waiting on the CPU to do anything. Of course, both now and then
the simplest way to speed up rendering something is to simply avoid rendering it at all (if it
isn't visible) or to render a cheaper approximation of it (if it's not large on the screen).
</p>
<p>
In summary, a modern graphics pipeline involves close cooperation of our code and the rendering
API. When we say &#8220;rendering API,&#8221; we mean the API software <i>and</i> the graphics hardware. On
PC platforms the API software layer is necessarily very &#8220;thick,&#8221; due to the wide variety of
underlying hardware that must be supported.  On console platforms where the hardware is
standardized, the layer can be significantly leaner.  A notable example of this was the
    PlayStation 2, which allowed programmers direct access to hardware registers and very low level
control over direct memory access (DMA).  <a href="#graphics_pipeline_division_of_labor">Figure&#160;10.36</a>
illustrates the division of labor involved in this cooperation.
</p>
<div id="graphics_pipeline_division_of_labor" class="Display Figure Wide">
<div class="Body">
		<img class="WithFrame" src="figs/graphics/graphics_pipeline_division_of_labor.png" loading="lazy" width="450" height="650">
</div><span class="Caption">
<span class="Label">Figure&#160;10.36</span><span class="CaptionText">
Division of labor
between our code and the graphics API
</span>
</span>
</div><p>
A slightly different summary of the real-time graphics pipeline is illustrated in
<a href="#graphics_pipeline_data_flow">Figure&#160;10.37</a>, this time focusing more on the lower end of the pipeline
and the conceptual flow of data.  The blue boxes represent data that we provide, and blue ovals
are our shaders that we write.  The yellow ovals are operations that are performed by the API.
</p>
<div id="graphics_pipeline_data_flow" class="Display Figure Wide">
<div class="Body">
<span class="minipage">
<img src="figs/graphics/graphics_pipeline_data_flow.png" loading="lazy" width="673" height="727">
</span>
</div><span class="Caption"><span class="Label">Figure&#160;10.37</span><span class="CaptionText">Data flow through the graphics pipeline.</span>
</span>
</div><p>
The remainder of this chapter discusses a number of various topics in computer graphics. We
proceed roughly in the order that these topics are encountered in the graphics pipeline.
</p>
<h2 id="buffers"><span class="SectionNumber">10.10.1</span><span class="SectionTitle">Buffers</span></h2>
<p class="NoIndent">Rendering involves many buffers.  In this context, a buffer is simply a rectangular region of
memory that stores some sort of data per pixel.  The most important buffers are the <i>frame
buffer</i> and the <i>depth buffer</i>.
</p>
<p>The frame buffer stores one color per pixel&#8212;it holds the rendered image. The color for a single
pixel may be stored in a variety of formats; the variations are not significant for the current
discussion.  If we're rendering a single image, the frame buffer may be in regular RAM, to be
saved to disk.
</p>
<p>
A more interesting situation arises in real-time animation.  In this case, the frame buffer is
normally located in video RAM. The video card is constantly reading this area of video RAM,
converting the binary data into the appropriate signal to be sent to the display device.  But how
can the monitor read this memory while we're trying to render to it?  A technique known as
    <i>double buffering</i> is used to prevent an image from being displayed before it is completely
rendered. Under double buffering, there are actually two frame buffers. One frame buffer, the
    <i>front buffer</i>, holds the image currently displayed on the monitor. The
    <i>back buffer</i> is the off-screen buffer, which holds the image currently being rendered.
</p>
<p>When we have finished rendering an image and are ready for it to be displayed, we &#8220;flip&#8221; the
buffers.  We can do this in one of two ways.  If we use page flipping, then we instruct the video
hardware to begin reading from the buffer that was the off-screen buffer.  We then swap the roles
of the two buffers; the buffer that was being displayed now becomes the off-screen buffer. Or we
may blit (copy) the off-screen buffer over the display buffer.  Double buffering is shown in
<a href="#double_buffering">Figure&#160;10.38</a>.
</p>
<div id="double_buffering" class="Display Figure Narrow">
<div class="Body">
		<img class="WithFrame" src="figs/graphics/double_buffering.png" loading="lazy" width="467" height="292">
</div><span class="Caption"><span class="Label">Figure&#160;10.38</span><span class="CaptionText">Double buffering</span>
</span>
</div><p>The more modern terminology for making visible the image that was rendered into the back buffer
is <i>presenting</i> the image.
</p>
<p>The second important buffer used for rendering is the <i>depth buffer</i>, also known as the
<i><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container>-buffer</i>.  Rather than storing a color at each pixel, the depth buffer stores a depth
value per pixel. There are many variations in the specifics of exactly what value goes into the
depth buffer, but the basic idea is that it is related to the distance from the camera.  Often
the clip-space <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container>-coordinate is used as a depth value, which is why the depth buffer is also
known as the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container>-buffer.
</p>
<p>
The depth buffer is used to determine which objects occlude which objects, as follows.  As we are
rasterizing a triangle, we compute an interpolated depth value per pixel.  Before rendering a
pixel, we compare this depth value with the value already in the depth buffer for this pixel.  If
the new depth is farther from the camera than the value currently in the depth buffer, then the
pixel is discarded.  Otherwise, the pixel color is written to the frame buffer, and the depth
buffer is updated with the new, closer depth value.
</p>
<p>
Before we can begin rendering an image, we must clear the depth buffer to a value that means
&#8220;very far from the camera.&#8221;  (In clip space, this value is 1.0).  Then, the first pixels to be
rendered are guaranteed to pass the depth buffer test. There's normally no need to double buffer the
depth buffer like we do the frame buffer.
</p>
<h2 id="geometry_delivery"><span class="SectionNumber">10.10.2</span><span class="SectionTitle">Delivering the Geometry</span></h2>
<p class="NoIndent">
After deciding which objects to render, we need to actually render them.  This is actually a
two-step process.  First, we must set up the
    <i>render context</i>.  This involves telling the renderer what vertex and pixel shaders to use,
what textures to use, and setting any other constants needed by the shaders, such as the
transform matrices, lighting positions, colors, fog settings, and so forth. The details of this
process depend greatly on your high-level rendering strategy and target platform, so there isn't
much more specific we can say here, although we give several examples in
<a href="#hlsl_examples">Section&#160;10.11</a>.  Instead, we would like to focus on the second step, which is
essentially the top box in <a href="#graphics_pipeline_data_flow">Figure&#160;10.37</a>, where vertex data is
delivered to the API for rendering.  Nowadays a programmer has quite a bit of flexibility in what
data to send, how to pack and format each data element, and how to arrange the bits in memory for
maximum efficiency.
</p>
<p>
What values might we need to supply per vertex?  Basically, the answer is, &#8220;whatever properties
you want to use to render the triangles.&#8221; Ultimately, there are only two required outputs of the
vertex and pixel shader. First, the vertex shader must output a position for each vertex so that
the hardware can perform rasterization. This position is typically specified in clip space, which
means the hardware will do the perspective divide and conversion to screen space coordinates (see
<a href="#screen_space">Section&#160;10.3.5</a>) for you.  The pixel shader really has only one required output: a
color value (which typically includes an alpha channel). Those two outputs are the only things
that are <i>required</i>.  Of course, to properly determine the proper clip-space coordinates, we
probably need the matrix that transforms from model space to clip space. We can pass parameters
like this that apply to all the vertices or pixels in a given batch of triangles by setting
    <i>shader constants</i>.  This is conceptually just a large table of vector values that is part
of the render context and for us to use as needed. (Actually, there is usually one set of
registers assigned for use in the vertex shader and a different set of registers that can be
accessed in the pixel shader.)
</p>
<p>Some typical pieces of information that are stored at the vertex level include
</p>
<ul>
    <li>
<span class="ListItemTitle">Position.</span>  This describes the location of the vertex.  This can be a 3D
        vector or a 2D screen-space position, or it could be a position already transformed
        into clip space that is simply passed directly through the vertex shader. If a
        3D vector is used, the position must be transformed into clip space by the
        current model, view, and projection transforms.  If 2D window coordinates (ranging according to
        the resolution of the screen, not normalized) are used, then they must be converted back
        into clip space in the vertex shader.  (Some hardware allows your shader to output
        coordinates that are already projected to screen space.)
<br>
If the model is a skinned model (see <a href="#skeletal_animation">Section&#160;10.8</a>), then the
        positional data must also include the indices and weights of the bones that influence
        the vertex.  The animated matrices can be delivered in a variety of ways.  A standard
        technique is to pass them as vertex shader constants.  A newer technique that works
        on some hardware is to deliver them in a separate vertex stream, which must be
        accessed through special instructions since the access pattern is random rather than
        streaming.
</li>
<li>
<span class="ListItemTitle">Texture-mapping coordinates.</span>  If we are using texture-mapped triangles,
        then each vertex must be assigned a set of mapping coordinates.  In this simplest
        case, this is a 2D location into the texture map.  We usually denote the coordinates
        <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml>
</mjx-container>.  If we are using multitexturing, then we might need one set of mapping
        coordinates per texture map.  Optionally, we can generate one or more sets of
        texture-mapping coordinates procedurally (for example, if we are projecting a gobo onto a
        surface).
</li>
<li>
<span class="ListItemTitle">Surface normal.</span>  Most lighting calculations need the surface normal. Even
        though these lighting equations are often done per-pixel, with the surface normal
        being determined from a normal map, we still often store a normal at the vertex
        level, in order to establish the basis for tangent space.
</li>
<li>
<span class="ListItemTitle">Color.</span>  Sometimes it's useful to assign a color input to each vertex.  For
        example, if we are rendering particles, the color of the particle may change over
        time. Or we may use one channel (such as alpha) to control the blending between two
        texture layers.  An artist can edit the vertex alpha to control this blending.  We
        might also have per-vertex lighting calculations that were done offline.
</li>
<li>
<span class="ListItemTitle">Basis vectors.</span>  As discussed in <a href="#bump_mapping">Section&#160;10.9</a>, for tangent-space
        normal maps (and a few other similar techniques) we need basis vectors in order to
        define the local tangent space.  The basis vectors and surface normal establish
        this coordinate space at each vertex.  These vectors are then interpolated across
        the triangle during rasterization, to provide an approximate tangent space per pixel.
</li>
</ul>
<p>
With all that in mind, let's give a few examples of C <span class="inlinecode">struct</span>s that could be used to
deliver vertex data in some situations that might arise in practice.
</p>
<p>One of the most basic vertex formats contains a 3D position, surface normal, and mapping
coordinates.  A basic triangle mesh with a simple diffuse map is stored using this vertex type.
We can't use tangent space normal maps with this vertex format, since there are no basis vectors:
</p>
<p>
<div class="Wide Display Listing">
<pre>
// Untransformed, unlit vertex
struct RenderVertex {
    Vector3 p;   // position
    float   u,v; // texture mapping coordinates
    Vector3 n;   // normal
};
</pre>
</div>
</p>
<p>If we want to use a tangent-space normal map, we'll need to include basis vectors:
</p>
<p>
<div class="Wide Display Listing">
<pre>
// Untransformed, unlit vertex with basis vectors
struct RenderVertexBasis {
    Vector3 p;        // position
    Vector3 n;        // normal
    Vector3 tangent;  // 1st basis vector
    float   det;      // Determinant of tangent space
                      // transform (mirror flag)
    float   u,v;      // texture mapping coordinates
};
</pre>
</div>
</p>
<p>Another common format, used for heads-up displays, text rendering, and other 2D items, is a
vertex with screen space coordinates and pre-lit vertices  (no normal needs to be supplied since
no lighting calculations will take place):
</p>
<p>
<div class="Wide Display Listing">
<pre>
// 2D screen-space pre-lit.
struct RenderVertex2D {
    float    x,y;  // 2D screen-space position
    unsigned argb; // prelit color (0xAARRGGBB)
    float    u,v;  // texture mapping coordinates
};
</pre>
</div>
</p>
<p>The following vertex is expressed in 3D, but does not need to be lit by the graphics API's
lighting engine.  This format is often useful for particle effects, such as explosions, flames,
and self-illuminated objects, and for rendering debugging objects such as bounding boxes,
waypoints, markers, and the like:
</p>
<p>
<div class="Wide Display Listing">
<pre>
// Untransformed, lit vertex
struct RenderVertexL {
    Vector3  p;    // 3D position
    unsigned argb; // prelit color (0xAARRGGBB)
    float    u,v;  // texture mapping coordinates
};
</pre>
</div>
</p>
<p>The next example is a vertex used for lightmapped, bump-mapped geometry.  It has basis vectors
for lightmapping, and two sets of UVs, one for the regular diffuse texture, and another for the
lightmap, which stores baked-in lighting that was calculated offline:
</p>
<p>
<div class="Wide Display Listing">
<pre>
// Lightmapped, bump mapped vertex
struct RenderVertexLtMapBump {
    Vector3 p;         // position
    Vector3 n;         // normal
    Vector3 tangent;   // 1st basis vector
    float   det;       // Determinant of tangent space
                       // transform (mirror flag)
    float   u,v;       // regular coordinates for diffuse and bump map
    float   lmu,lmv;   // texture coords into lightmap
};
</pre>
</div>
</p>
<p>Finally, here's a vertex that might be used for skeletal rendering.  The indices are stored in four
8-bit values, and the weights are stored as four floats:
</p>
<p>
<div class="Wide Display Listing">
<pre>
// Lightmapped, bump mapped vertex
struct RenderVertexSkinned {
    Vector3 p;            // position
    Vector3 n;            // normal
    Vector3 tangent;      // 1st basis vector
    float   det;          // Determinant of tangent space
                          // transform (mirror flag)
    float   u,v;          // regular coordinates for diffuse and bump map
    unsigned boneIndices; // bone indices for up to 4 bones
                          // (8-bit values)
    Vector4  boneWeights; // weights for up to 4 bones
};
</pre>
</div>
</p>
<p>The preceding examples were all declared as <span class="inlinecode">struct</span>s.  As you can see, the
combinations can grow quite quickly.  Dealing with this simply but efficiently is a challenge.
One idea is to allocate the fields as a structure of arrays (SOA) rather than array of structures
(AOS):
<div class="Wide Display Listing">
<pre>
struct VertexListSOA {
    Vector3  *p;           // positions
    Vector3  *n;           // normals
    Vector4  *tangentDet;  // xyz tangent + det in w
    Vector2  *uv0;         // first channel mapping coords
    Vector2  *uv1;         // second channel mapping
    Vector2  *ltMap;       // lightmap coords
    unsigned *boneIndices; // bone indices for up to 4 bones
                           // (8-bit values)
    Vector4  *boneWeights; // weights for up to 4 bones
    unsigned *argb;        // vertex color
};
</pre>
</div>
</p>
<p>
In this case, if a value was not present, the array pointer would simply be <span class="inlinecode">NULL</span>.
</p>
<p>
Another idea is to use a raw block of memory, but declare a vertex format class with accessor
functions that do the address arithmetic to locate a vertex by index, based on the variable
stride, and access a member based on its variable offset within the structure.
</p>
<h2 id="vertex_operations"><span class="SectionNumber">10.10.3</span><span class="SectionTitle">Vertex-Level Operations</span></h2>
<p class="NoIndent">After mesh data has been submitted to the API, a wide range of vertex-level computations are
performed.  In a shader-based renderer (as opposed to a fixed-function pipeline), this happens in
our vertex shader.  The input to a vertex shader is essentially one of the <span class="inlinecode">struct</span>s
that we described in the previous section.  As discussed earlier, a vertex shader can produce
many different types of output, but there are two basic responsibilities it <i>must</i> fulfill.
The first is that it must output, at the very minimum, a clip-space (or in some circumstances
screen-space) position.  The second responsibility is to provide to the pixel shader any inputs
that are needed for the pixel shader to perform the shading calculations. In many cases, we can
simply pass through vertex values received from the input streams, but other times, we must
perform calculations, such as transforming raw vertex values from modeling space to some other
coordinate space in which we are performing lighting or generating texture coordinates.
</p>
<p>
Some of the most common operations that are done in a vertex shader are
</p>
<ul>
    <li>
Transforming model-space vertex positions into clip space.
</li>
<li>
Performing skinning for skeletal models.
</li>
<li>
Transforming normals and basis vectors into the appropriate space
        for lighting.
</li>
<li>
Calculating vectors needed for lighting (<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D425 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">l</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container> and
        <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b"><mjx-c class="mjx-c1D421 TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<mrow><mi mathvariant="bold">h</mi></mrow>
</mrow></math></mjx-assistive-mml>
</mjx-container>) and transforming them into the appropriate coordinate space.
</li>
<li>
Computing fog density values from the vertex position.
</li>
<li>
Generating texture mapping coordinates procedurally.  Examples
        include projected spot lights, <i>Doom</i>-style volumetric light,
        reflecting a view vector about the normal for environment mapping,
        various fake reflection techniques, scrolling or otherwise animated textures,
        and so on.
</li>
<li>
Passing through raw vertex inputs without modification, if they
        are already in the correct format and coordinate space.
</li>
</ul>
<p>If we are using Gouraud shading, we might actually perform the lighting calculations here, and
interpolate the lighting results.  We'll show some examples of this later in the chapter.
</p>
<p>The transformation from modeling to clip space is the most common operation, so let's review the
process. We do it with matrix multiplication.  Conceptually, the vertices undergo a sequence of
transformations as follows:
</p>
<ul>
    <li>
The model transform transforms from modeling space to world space.
</li>
<li>
The view transform transforms from world space to camera space.
</li>
<li>
The clip matrix is used to transform from camera space to clip space.
</li>
</ul>
<p>
Conceptually, the matrix math is
</p>
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D42F TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D40C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2192"></mjx-c></mjx-mo><mjx-mi class="mjx-n"><mjx-c class="mjx-c77"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D40C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c77"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2192"></mjx-c></mjx-mo><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-b" noIC="true"><mjx-c class="mjx-c1D40C TEX-B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom><mjx-script style="vertical-align: -0.15em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-TeXAtom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c65"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c72"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c61"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2192"></mjx-c></mjx-mo><mjx-mi class="mjx-n"><mjx-c class="mjx-c63"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c69"></mjx-c></mjx-mi><mjx-mi class="mjx-n"><mjx-c class="mjx-c70"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub>
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">p</mi></mrow>
</mrow></msub><mo>=</mo><mo stretchy="false">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">v</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi></mrow>
</mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">M</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi><mo stretchy="false">&#8594;</mo><mi mathvariant="normal">w</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">d</mi></mrow>
</mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">M</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">d</mi><mo stretchy="false">&#8594;</mo><mi mathvariant="normal">c</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi></mrow>
</mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub>
<mrow>
<mrow><mi mathvariant="bold">M</mi></mrow>
</mrow>
<mrow>
<mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mo stretchy="false">&#8594;</mo><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">p</mi></mrow>
</mrow></msub><mo stretchy="false">)</mo><mo>.</mo></math></mjx-assistive-mml>
</mjx-container>
</div><p>
In practice, we don't actually perform three separate matrix multiplications.  We have one
matrix that transforms from object space to clip space, and inside the vertex shader we perform
one matrix multiplication using this matrix.
</p>
<h2 id="clipping"><span class="SectionNumber">10.10.4</span><span class="SectionTitle">Clipping</span></h2>
<p class="NoIndent">After vertices have been transformed into clip space, two important tests are performed on the
triangle: clipping and culling. Both operations are usually performed by the rendering API, so
although you won't usually have to perform these operations yourself, it's important to know how
they work.  The order in which we discuss these tests is not necessarily the order in which they
will occur on a particular piece of hardware.  Most hardware culls in screen space, whereas older
software renderers did it earlier, in 3D, in order to reduce the number of triangles that had to
be clipped.
</p>
<p>
Before we can project the vertices onto screen space, we must ensure that they are completely
inside the view frustum.  This process is known as <i>clipping</i>. Since clipping is normally
performed by the hardware, we will describe the process with only cursory detail.
</p>
<p>The standard algorithm for clipping polygons is the <i>Sutherland-Hodgman</i> algorithm.  This
algorithm tackles the difficult problem of polygon clipping by breaking it down into a sequence
of easy problems.  The input polygon is clipped against one plane at a time.
</p>
<p>
To clip a polygon against one plane, we iterate around the polygon, clipping each edge against
the plane in sequence.  Each of the two vertices of the edge may be inside or outside the plane;
thus, there are four cases.  Each case may generate zero, one, or two output vertices, as shown
in <a href="#clip_rules">Figure&#160;10.39</a>.
</p>
<div id="clip_rules" class="Display Figure Narrow">
<div class="Body">
		<img class="WithFrame" src="figs/graphics/clip_rules.png" loading="lazy" width="338" height="388">
</div><span class="Caption"><span class="Label">Figure&#160;10.39</span><span class="CaptionText">Clipping a single edge&#8212;the four cases</span>
</span>
</div><p>
<a href="#clip_example">Figure&#160;10.40</a> shows an example of how we can apply these rules to clip a polygon
against the right clip plane. Remember that the clipper outputs vertices, not edges.  In
<a href="#clip_example">Figure&#160;10.40</a>, the edges are drawn only for illustration. In particular, the final
clip step appears to output two edges when actually only one vertex was output&#8212;the last edge is
implicit to complete the polygon.
</p>
<div id="clip_example" class="Display Figure Narrow">
<div class="Body">
		<img class="WithFrame" src="figs/graphics/clip_example.png" loading="lazy" width="375" height="388">
</div><span class="Caption">
<span class="Label">Figure&#160;10.40</span><span class="CaptionText">
Clipping a polygon against the right
clip plane
</span>
</span>
</div><p>
At the end of each stage, if there are fewer than three vertices
remaining, then the polygon is rejected as being invisible.  (Notice
that it is impossible to output only one or two vertices.  The
number of vertices output by any one pass will either be zero, or at
least three.)
</p>
<p>Some graphics hardware does not clip polygons to all six planes in 3D (or 4D).  Instead, only the
near clip is performed, and then <i>scissoring</i> is done in 2D to clip to the window. This can
be a performance win because clipping is slow on certain hardware.  A variation on this technique
is to employ a <i>guard band</i>.  Polygons completely outside the screen are rejected, polygons
completely inside the guard band are scissored rather than clipped in 3D, and polygons that are
partially on screen but outside of the guard band are clipped in 3D.
</p>
<h2 id="backface_culling"><span class="SectionNumber">10.10.5</span><span class="SectionTitle">Backface Culling</span></h2>
<p class="NoIndent">The second test used to reject hidden surfaces is known as <i>backface culling</i>, and the
purpose of this test is to reject triangles that don't face the camera.  In standard closed
meshes, we should never see the back side of a triangle unless we are allowed to go inside the
mesh.  Removal of the backfacing triangles is not strictly necessary in an opaque mesh&#8212;we could
draw them and still generate a correct image, since they will be covered up by a closer,
front-facing triangle.  However, we don't want to waste time drawing anything that isn't visible,
so we usually want to cull backfaces.  In theory, about half of the triangles will be backfacing.
In practice, less than half of the triangles can be culled, especially in static scenery, which
in many cases is created without backfaces in the first place.  One obvious example is a terrain
system.  Certainly we may be able to eliminate some backfacing triangles, for example, on the
backside of a hill, but in general most triangles will be frontfacing because we are usually
above the ground.  However, for dynamic objects that move around in the world freely, roughly
half of the faces will be backfacing.
</p>
<p>
Backfacing triangles can be detected in 3D (before projection) or 2D (after projection).  On
modern graphics hardware, backface culling is performed in 2D based on clockwise or
counterclockwise enumeration of vertices in screen space.  In a left-handed coordinate system
like we use in this book, the convention is to order the vertices in a clockwise fashion around
the triangle when viewed from the front side. Thus, as shown in <a href="#backface_culling_vertex_order">Figure&#160;10.41</a>, we will normally remove any triangle whose
vertices are ordered in a counterclockwise fashion on the screen.  (Right-handers usually employ
the opposite conventions.)
</p>
<div id="backface_culling_vertex_order" class="Display Figure Narrow">
<div class="Body">
		<img class="WithFrame" src="figs/graphics/backface_culling_vertex_order.png" loading="lazy" width="450" height="233">
</div><span class="Caption">
<span class="Label">Figure&#160;10.41</span><span class="CaptionText">
Backface culling of triangles with vertices
enumerated counterclockwise in screen space
</span>
</span>
</div><div id="backface_culling" class="Display Figure Narrow">
<div class="Body">
		<img class="WithFrame" src="figs/graphics/backface_culling.png" loading="lazy" width="350" height="417">
</div><span class="Caption"><span class="Label">Figure&#160;10.42</span><span class="CaptionText">Backface culling in 3D</span>
</span>
</div>
<p class="NoIndent">
The API will let you control backface culling.  You may want to turn backface culling off while
rendering certain geometry.  Or, if geometry has been reflected, you may need to invert the
culling, since reflection flips the vertex order around the faces.  Rendering using stencil
shadows requires rendering the frontfaces in one pass and the backfaces in another pass.
</p>
<p>The bottlenecks are different in software rendering compared to hardware rendering (notably, the
bandwidth required for raw delivery of data to the hardware), and in software, backface culling
is usually done in 3D. The basic idea with the 3D backfacing test is to determine whether the
camera position is on the front side of the triangle's plane.  To make this determination
quickly, we store a precomputed triangle normal.  This is shown in <a href="#backface_culling">Figure&#160;10.42</a>,
in which the backfacing triangles that could be culled are drawn in gray. Notice that backface
culling doesn't depend on whether a triangle is inside or outside the view frustum.  In fact, it
doesn't depend on the orientation of the camera at all&#8212;only the position of the camera relative
to the triangle is relevant.
</p>
<p>
To detect backfacing triangles in 3D, we need the normal of the plane containing the triangle,
and a vector from the eye to the triangle (any point on the triangle will do&#8212;usually we just
pick one vertex arbitrarily).  If these two vectors point in basically the same direction (their
dot product is greater than zero), then the triangle is backfacing.  A variation on this theme is
to also precompute and store the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></mjx-assistive-mml>
</mjx-container> value of the
    plane equation (see <a href="geomprims.html#plane_equation">Section&#160;9.5.1</a>).  Then the backfacing check can be
done with one dot product and scalar comparison.  One quick note about a tempting optimization
trick that doesn't work: you might try to only use the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container>-component of the normal of the
triangle in camera (or clip) space.  Although it might seem like if the <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml>
</mjx-container> value is positive,
then the triangle faces away from the camera and could be culled, an example where this isn't
true is circled in <a href="#backface_culling">Figure&#160;10.42</a>.
</p>
<h2 id="rasterization_shading_and_output"><span class="SectionNumber">10.10.6</span><span class="SectionTitle">Rasterization, Shading, and Output</span></h2>
<p class="NoIndent">After clipping, the vertices are projected and mapped into the screen coordinates of the output
window, according to
Equations&#160;<a href="#clip_space_to_screen_space_first">(10.8)</a>&#8211;<a href="#clip_space_to_screen_space_last">(10.9)</a>.
Of course, these coordinates are floating-point coordinates, which are &#8220;continuous&#8221; (see
<a href="cartesianspace.html#1d">Section&#160;1.1</a>). But we typically render pixels, which are discrete. So how do
we know which pixels actually get drawn?  Devising an algorithm to answer this question is
surprisingly complicated.  If we answer wrong, then gaps can appear between triangles. Rendering
a pixel more than once can be bad, too, if we are using alpha blending. In other words, we must
make sure that when we render a surface represented as triangles, every pixel is rendered
<i>exactly once</i>. Luckily, the graphics hardware takes care of this for us and we don't have
to sweat the details.
</p>
<p>During rasterization, the rendering system may perform <i>scissoring</i>, which rejects pixels
that are outside of the rendering window.  This is impossible if the polygon is clipped to the
edge of the screen, but it might be advantageous for performance reasons to skip that step.  The
guard band is a technique that can be used to tune performance trade-offs between clipping and
scissoring (see <a href="#clipping">Section&#160;10.10.4</a>).
</p>
<p>
Even though we don't necessarily have to understand exactly how the graphics hardware decides
which pixels to render for a given triangle, we do need to understand how it determines what to
do with a single pixel.  Conceptually, five basic steps are performed:
</p>
<ol>
    <li>
<span class="ListItemTitle">Interpolate.</span>  Any quantities computed at the vertex level, such as texture
        coordinates, colors, and normals, are interpolated across the face.  The interpolated
        values for each quantity must be computed for the pixel before it can be shaded.
</li>
<li>
<span class="ListItemTitle">Depth test.</span>  We reject pixels by using the depth buffer
        (see <a href="#buffers">Section&#160;10.10.1</a>) if the pixel we are about to shade would be obscured
        by a closer pixel.  Note that, in some circumstances, the pixel shader is allowed to
        modify the depth value, in which case this test must be deferred until after shading.
</li>
<li>
<span class="ListItemTitle">Shade.</span>  <i>Pixel shading</i> refers to the process of computing a color
        for a pixel.  On shader-based hardware, this is where your pixel shader is executed.
        In a basic forward renderer pass, where we are actually rendering objects into the
            frame buffer (as opposed to writing into a shadow map, or doing some other lighting
        pass), the pixel is typically first lit and then fogged if fogging is being used.
        The output of a pixel shader consists of not only an RGB color, but also an alpha value,
        which is usually interpreted as the
            &#8220;opacity&#8221; of the pixel, used for blending.  The next section shows several examples
        of pixel shaders.
</li>
<li>
<span class="ListItemTitle">Alpha test.</span>  This rejects pixels based on the alpha value of the pixel.
        All sorts of different alpha tests can be used, but the most common one is to reject
        pixels that are &#8220;too transparent.&#8221;  Although such invisible pixels may not cause
        any change the frame buffer were we to write them, we do need to reject them so that
        they do not cause us to write into the depth buffer.
</li>
<li>
<span class="ListItemTitle">Write.</span>  If the pixel passes the depth and alpha tests, then the frame
        buffer and depth buffers are updated.
<ul>
            <li>
The depth buffer is updated simply by replacing the old depth value
                with the new one.
</li>
<li>
The frame buffer update is more complicated.  If blending is not used,
                then the new pixel color replaces the old one.  Otherwise, the new pixel
                color is blended with the old one, with the relative contributions of the
                old and new colors controlled by the alpha value.  Other mathematical
                operations, such as addition, subtraction, and multiplication, are also
                often available, depending on the graphics hardware.
</li>
</ul>
</li>
</ol>

<h1 id="hlsl_examples"><span class="SectionNumber">10.11</span><span class="SectionTitle">Some HLSL Examples</span></h1>
<p class="NoIndent">In this section we will present some examples of HLSL vertex and pixel shaders that demonstrate
many of the techniques discussed in previous sections.  These code snippets are well commented,
as we intend for this code to be <i>read</i>.  We are giving examples in HLSL for the same reason
that we show code snippets in C: we expect that it will be applicable to a large number of our
readers, and although we know not every reader will be using this specific language, we think the
language is sufficiently high level that many of the basic principles can be conveyed and
appreciated by almost everyone.
</p>
<div class="WarningNote">
    HLSL is essentially the same language as the shader language developed by NVIDIA
    known as &#8220;Cg.&#8221;  HLSL is also very similar, although not identical, to GLSL, the
    shading language used in OpenGL.
</div><p>
One aspect of HLSL that we realize introduces an unwanted impediment to those not interested in
real-time rendering is the division of labor between vertex and pixel shaders.<a href="#footnote_24" class="FootnoteRef">24</a> Unfortunately, this is where some
of the messy guts cannot be fully hidden.  This book is <i>not</i> a book on HLSL, so we don't
fully explain these details, and some exposure to HLSL is helpful. However, since the language
uses the C syntax, it is relatively approachable, and our examples should be readable. For those
who are unfamiliar with HLSL, the comments in the examples introduce the HLSL specifics as they
come up.
</p>
<p>
Because these examples are all very basic, they were written targeting shader model 2.0.
</p>
<h2 id="hlsl_decal"><span class="SectionNumber">10.11.1</span><span class="SectionTitle">Decal Shading and HLSL Basics</span></h2>
<p class="NoIndent">
We'll start with a very simple example to get warmed up and demonstrate the basic mechanisms of
HLSL for declaring constants and passing interpolated arguments.  Perhaps the simplest type of
shading is to just output the color from a texture map directly, without any lighting at all.
This is sometimes called
    <i>decal</i> shading.  The vertex shader in <a href="#decal_v">Listing&#160;10.11</a> illustrates several of the basic
mechanisms of HLSL, as explained by the source comments.
</p>
<p>
<div id="decal_v" class="Wide Display Listing">
<pre>
// This struct declares the inputs we receive from the mesh.
// Note that the order here is not important.  Inputs are identified
// by their "semantic", which is the thing on the right after the
// colon.  When sending the vertex list to the renderer, we must
// specify the "semantic" of each vertex element.
struct Input {
  float4 pos : POSITION;  // position in modeling space
  float2 uv  : TEXCOORD0; // texture coordinates
};

// This is the data we will output from our vertex shader.  These
// are matched up with the pixel shader inputs based on the semantic
struct Output {
  float4 pos : POSITION;  // position in CLIP space
  float2 uv  : TEXCOORD0; // texture coordinate
};

// Here we declare a global variable, which is a shader constant
// that holds the model-&gt;clip transform matrix.
uniform float4x4 modelToClip;

// The body of our vertex shader
Output main(Input input) {
  Output output;

  // Transform vertex position to clip space.  The mul() intrinsic
  // function performs matrix multiplication.  Note that mul()
  // treats any vector passed as the first operand as a row vector.
  output.pos = mul(input.pos, modelToClip);

  // Pass through the supplied UV coordinates without modification
  output.uv = input.uv;

  return output;
}
</pre>
<span class="Caption"><span class="Label">Listing&#160;10.11</span><span class="CaptionText">Vertex shader for decal rendering</span>
</span>
</div>
</p>
<p>
A vertex shader like this could be be used with the pixel shader of <a href="#decal_p">Listing&#160;10.12</a>, which
actually does the decal shading.  However, to make things interesting and demonstrate that pixel
shader constants work the same as vertex shader constants, we've added a global
    constant color, which we consider to be part of the global render context.  We have found it very
useful to have a constant such as this, which modulates the color and
    opacity of every rendered primitive.
</p>
<p>
<div id="decal_p" class="Wide Display Listing">
<pre>
// This struct declares the interpolated inputs we receive from the
// rasterizer.  They will usually match the vertex outputs exactly,
// except that we often leave off the clip-space position.
struct Input {
  float2 uv : TEXCOORD0; // texture coordinates
};

// Here, just to show how a pixel shader constant works, we declare
// a global constant color.  The output of our shader is multiplied
// by this RGBA value.  One of the most common reasons to have such a
// constant is to add an opacity setting into the render context,
// but it's very handy to have a full RGBA constant color.
uniform float4 constantColor;

// We are going to do a texture lookup.  Here we declare a "variable"
// to refer to this texture, and annotate it with sufficient information
// so that our rendering code can select the appropriate texture into
// the rendering context before drawing primitives.
sampler2D diffuseMap;

// The body of our pixel shader.  It only has one output, which falls
// under the semantic "COLOR"
float4 main(Input input): COLOR {

  // Fetch the texel
  float4 texel = tex2D(diffuseMap, input.uv);

  // Modulate it by the constant color and output. Note that
  // operator* performs component-wise multiplication.
  return texel*constantColor;
}
</pre>
<span class="Caption"><span class="Label">Listing&#160;10.12</span><span class="CaptionText">Pixel shader for decal rendering</span>
</span>
</div>
</p>
<p>Clearly, the higher-level code must supply the shader constants and the primitive data properly.
The simplest way to match up a shader constant with the higher-level code is to specifically
assign a register number to a constant by using special HLSL variable declaration syntax, but
there are subtler techniques, such as locating constants by name. These practical details are
certainly important, but they are don't belong in this book.
</p>
<h2 id="hlsl_basic_per_pixel_lighting"><span class="SectionNumber">10.11.2</span><span class="SectionTitle">Basic Per-Pixel Blinn-Phong Lighting</span></h2>
<p class="NoIndent">
Now let's look at a simple example that actually does some lighting calculations. We start with
basic per-pixel lighting, although we don't use a bump map just yet.  This example simply
illustrates the  Phong shading technique of interpolating the normal across the face and
evaluating the full lighting equation per-pixel.  We compare Phong shading with Gouraud shading
in <a href="#hlsl_gouraud_lighting">Section&#160;10.11.3</a>, and we show an example of normal mapping in
<a href="#hlsl_bump_mapping">Section&#160;10.11.4</a>.
</p>
<p>
All of our lighting examples use the standard Blinn-Phong lighting equation.  In this example and
most of the examples to follow, the lighting environment consists of a single linearly-attenuated
omni light plus a constant ambient.
</p>
<p>
For the first example (Listings&#160;<a href="#omni_per_pixel_1_v">10.13</a> and
<a href="#omni_per_pixel_1_p">10.14</a>), we do all of the work in the pixel shader.  In this case,
the vertex shader is fairly trivial; it just needs to pass through the inputs to the pixel
shader.
</p>
<p>
<div id="omni_per_pixel_1_v" class="Wide Display Listing">
<pre>
// Mesh inputs.
struct Input {
  float4 pos    : POSITION;  // position in model space
  float3 normal : NORMAL;    // vertex normal in model space
  float2 uv     : TEXCOORD0; // texture coords for diffuse, spec maps
};

// Vertex shader output.  Note that with the exception of the output
// position, which is output under the POSITION sematic, all others go
// under the TEXCOORDx semantic.  Despite its name, this semantic is
// actually used for pretty much ANY interpolated vector value up to 4D
// that we want to pass to the pixel shader, not just texture coords.
struct Output {
  float4 clipPos  : POSITION;  // clip-space position
  float2 uv       : TEXCOORD0; // texture coords for diffuse, spec maps
  float3 normal   : TEXCOORD1; // vertex normal in model space
  float3 modelPos : TEXCOORD2; // position in model space
};

// Model-&gt;clip transform matrix.
uniform float4x4 modelToClip;

// The body of our vertex shader
Output main(Input input) {
  Output output;

  // Transform vertex position to clip space.
  output.clipPos = mul(input.pos, modelToClip);

  // Pass through vertex inputs without modification
  output.normal = input.normal;
  output.uv = input.uv;
  output.modelPos = input.pos;

  return output;
}
</pre>
<span class="Caption">
<span class="Label">Listing&#160;10.13</span><span class="CaptionText">Vertex shader for per-pixel lighting of a single omni plus ambient</span>
</span>
</div>
</p>
<p><a href="#omni_per_pixel_1_p">Listing&#160;10.14</a> is the corresponding pixel shader, where all the action happens.
Notice that we are using two different texture maps, one for the diffuse color and another for
the specular color. We assume that the two maps use the same texture-mapping coordinates.
</p>
<p><div id="omni_per_pixel_1_p" class="Wide Display Listing">
<pre>
// Interpolated inputs from the vertex shader.
struct Input {
  float2 uv       : TEXCOORD0; // texture coords for diffuse, spec maps
  float3 normal   : TEXCOORD1; // vertex normal in model space
  float3 modelPos : TEXCOORD2; // model space position (for lighting)
};

// A global constant RGB and opacity
uniform float4 constantColor;

// Omni light position, in MODEL space,
uniform float3 omniPos;

// Reciprocal of omni light radius.  (The light will falloff
// linearly to zero at this radius).  Note that it's common to tuck
// this into the w component of the position, to reduce the number of
// constants, since each  constant usually takes a full 4D vector slot.
uniform float invOmniRad;

// Unattenuated omni light color
uniform float3 omniColor;

// View position, in MODEL space
uniform float3 viewPos;

// Constant ambient light color
uniform float3 ambientLightColor;

// Material glossiness (phong exponent)
uniform float specExponent;

// Diffuse and specular map samplers.  Note we assume that diffuse
// and spec maps use the same UV coords
sampler2D diffuseMap;
sampler2D specularMap;

// Pixel shader body
float4 main(Input input): COLOR {

  // Fetch the texels to get the material colors
  float4 matDiff = tex2D(diffuseMap, input.uv);
  float4 matSpec = tex2D(specularMap, input.uv);

  // Normalize interpolated vertex normal
  float3 N = normalize(input.normal);

  // Compute vector to light
  float3 L = omniPos - input.modelPos;

  // Normalize it, and save off distance to use later
  // for attenuation
  float dist = length(L);
  L /= dist;

  // Compute view vector and halfway vector
  float3 V = normalize(viewPos - input.modelPos);
  float3 H = normalize(V + L);

  // Compute attenuated light color.
  float3 lightColor = omniColor * max(1 - dist*invOmniRad,0);

  // Compute diffuse and specular factors
  float diffFactor = max(dot(N, L),0);
  float specFactor = pow(max(dot(N,H),0), specExponent);

  // Compute effective light colors
  float3 diffColor = lightColor*diffFactor + ambientLightColor;
  float3 specColor = lightColor*specFactor;

  // Sum up colors.  Note that HLSL has a very flexible swizzling system
  // which allows us to access a portion of a vector as if were a
  // "member" of the vector
  float4 result = matDiff; // RGB and opacity from diffuse map
  result.rgb *= diffColor; // modulate by diffuse+ambient lighting
  result.rgb += matSpec.rgb*specColor; // add spec, ignoring map alpha

  // Modulate it by the constant and output
  return result*constantColor;
}
</pre>
<span class="Caption">
<span class="Label">Listing&#160;10.14</span><span class="CaptionText">Pixel shader for per-pixel lighting of a single omni plus ambient</span>
</span>
</div>
</p>
<p>Of course, several of the values needed in this calculation could be computed in the vertex
shader, and we could use the interpolated results in the pixel shader.  This is <i>usually</i> a
performance win because we assume that most of our triangles fill more than a pixel or two, so
that number of pixels to fill is significantly more than the number of vertices to shade.
However, a precise analysis can be complicated because the number of vertices and pixels is not
the only factor; the number of execution units available for vertex and pixel shading is also
important.  Furthermore, on some hardware, a pool of generic execution units are shared between
vertex and pixel shading. There can also be performance implications for increasing the number of
interpolated values. Still, dividing up the labor to do more calculations per vertex is a speedup
on most platforms and in most situations.  Listings&#160;<a href="#omni_per_pixel_2_v">10.15</a> and
<a href="#omni_per_pixel_2_p">10.16</a> show one way we could shift work up to the vertex shader.
</p>
<p>
<div id="omni_per_pixel_2_v" class="Wide Display Listing">
<pre>
// Mesh inputs.
struct Input {
  float4 pos    : POSITION;  // position in model space
  float3 normal : NORMAL;    // vertex normal in model space
  float2 uv     : TEXCOORD0; // texture coords for diffuse, spec maps
};

// Vertex shader output
struct Output {
  float4 clipPos    : POSITION;  // clip-space position
  float2 uv         : TEXCOORD0; // texture coords for diffuse, spec maps
  float3 normal     : TEXCOORD1; // vertex normal in model space
  float3 L          : TEXCOORD2; // vector to light
  float3 H          : TEXCOORD3; // halfway vector
  float3 lightColor : TEXCOORD4; // light color + attenuation factor
};

// Model-&gt;clip transform matrix.
uniform float4x4 modelToClip;

// Omni light position, in MODEL space,
uniform float3 omniPos;

// Reciprocal of omni light radius.  (The light will falloff
// linearly to zero at this radius).  Note that it's common to tuck
// this into the w component of the position, to reduce the number of
// constants, since each  constant usually takes a full 4D vector slot.
uniform float invOmniRad;

// Unattenuated omni light color
uniform float3 omniColor;

// View position, in MODEL space
uniform float3 viewPos;

// The body of our vertex shader
Output main(Input input) {
  Output output;

  // Transform vertex position to clip space.
  output.clipPos = mul(input.pos, modelToClip);

  // Compute vector to light
  float3 L = omniPos - input.pos;

  // Normalize it, and save off distance to use later
  // for attenuation
  float dist = length(L);
  output.L = L / dist;

  // Compute view and halfway vector.
  float3 V = normalize(viewPos - input.pos);
  output.H = normalize(V + output.L);

  // Compute attenuation factor.  Note that we do NOT clamp
  // to zero here, we will do that in the pixel shader.  This
  // is important in case the falloff reaches zero in the middle
  // of a large polygon.
  float attenFactor = 1 - dist*invOmniRad;
  output.lightColor = omniColor * attenFactor;

  // Pass through other vertex inputs without modification
  output.normal = input.normal;
  output.uv = input.uv;

  return output;
}
</pre>
<span class="Caption">
<span class="Label">Listing&#160;10.15</span><span class="CaptionText">Alternate vertex shader for per-pixel lighting of a single omni plus ambient</span>
</span>
</div>
</p>
<p>
Now the pixel shader has less work to do.  According to the DirectX 10 FXC compiler, the pixel
shader in <a href="#omni_per_pixel_2_p">Listing&#160;10.16</a> compiles to approximately 25 instruction slots,
compared to 33 instruction slots for <a href="#omni_per_pixel_1_p">Listing&#160;10.14</a>.
</p>
<p>
<div id="omni_per_pixel_2_p" class="Wide Display Listing">
<pre>
// Interpolated inputs from the vertex shader.
struct Input {
  float2 uv         : TEXCOORD0; // texture coords for diffuse, spec maps
  float3 normal     : TEXCOORD1; // vertex normal in model space
  float3 L          : TEXCOORD2; // vector to light
  float3 H          : TEXCOORD3; // halfway vector
  float3 lightColor : TEXCOORD4; // light color + attenuation factor
};

// A global constant RGB and opacity
uniform float4 constantColor;

// Constant ambient light color
uniform float3 ambientLightColor;

// Material glossiness (phong exponent)
uniform float specExponent;

// Diffuse and specular map samplers.  Note we assume that diffuse
// and spec maps use the same UV coords
sampler2D diffuseMap;
sampler2D specularMap;

// Pixel shader body
float4 main(Input input): COLOR {

  // Fetch the texels to get the material colors
  float4 matDiff = tex2D(diffuseMap, input.uv);
  float4 matSpec = tex2D(specularMap, input.uv);

  // Normalize interpolated vectors
  float3 N = normalize(input.normal);
  float3 L = normalize(input.L);
  float3 H = normalize(input.H);

  // Compute diffuse and specular factors
  float diffFactor = max(dot(N, L),0);
  float specFactor = pow(max(dot(N,H),0), specExponent);

  // Clamp the light color,  (Note that this max is applied
  // component-wize)
  float3 lightColor = max(input.lightColor,0);

  // Compute effective light colors
  float3 diffColor = lightColor*diffFactor + ambientLightColor;
  float3 specColor = lightColor*specFactor;

  // Sum up colors.  Note that HLSL has a very flexible swizzling system
  // which allows us to access a portion of a vector as if were a
  // "member" of the vector
  float4 result = matDiff; // RGB and opacity from diffuse map
  result.rgb *= diffColor; // modulate by diffuse+ambient lighting
  result.rgb += matSpec.rgb*specColor; // add spec, ignoring map alpha

  // Modulate it by the constant and output
  return result*constantColor;
}
</pre>
<span class="Caption">
<span class="Label">Listing&#160;10.16</span><span class="CaptionText">Alternate pixel shader for per-pixel lighting of a single omni plus ambient</span>
</span>
</div>
</p>
<p>
Finally, we present one last variation on this example.  Notice that in the previous pixel
shader, <a href="#omni_per_pixel_2_p">Listing&#160;10.16</a>, the code does not assume that the lighting is taking
place in any particular coordinate space.  We have been performing the lighting calculations in
model space, but it is also common to do it in camera space.  The advantage is that we do not
need to resend shader constants for lighting data for each object that is rendered, as we do when
those values are specified in modeling space (which will vary for each object).
<a href="#omni_per_pixel_3_v">Listing&#160;10.17</a> is a vertex shader that illustrates this technique.
</p>
<p>
<div id="omni_per_pixel_3_v" class="Wide Display Listing">
<pre>
// Mesh inputs.
struct Input {
  float4 pos    : POSITION;  // position in model space
  float3 normal : NORMAL;    // vertex normal in model space
  float2 uv     : TEXCOORD0; // texture coords for diffuse, spec maps
};

// Vertex shader output
struct Output {
  float4 clipPos    : POSITION;  // clip-space position
  float2 uv         : TEXCOORD0; // texture coords for diffuse, spec maps
  float3 normal     : TEXCOORD1; // vertex normal in camera space
  float3 L          : TEXCOORD2; // vector to light in camera space
  float3 H          : TEXCOORD3; // halfway vector in camera space
  float3 lightColor : TEXCOORD4; // light color + attenuation factor
};

// Model-&gt;view transform matrix.  (The "modelview" matrix)
uniform float4x4 modelToView;

// Clip matrix.  (The "projection" matrix).
uniform float4x4 viewToClip;

// Omni light position, in VIEW space, and reciprocal of
// falloff in the w component
uniform float4 omniPosAndInvRad;

// Unattenuated omni light color
uniform float3 omniColor;

// The body of our vertex shader
Output main(Input input) {
  Output output;

  // Transform vertex position to view space.
  float4 vPos = mul(input.pos, modelToView);

  // And into clip space.  Note that the clip matrix
  // often has a simple structure which can be exploited
  // and the number of vector operations can be reduced.
  output.clipPos = mul(vPos, viewToClip);

  // Transform normal to camera space.  We "promote" the normal
  // to float4 by setting w to 0, so it will receive any translation
  output.normal = mul(float4(input.normal,0), modelToView);

  // Compute vector to light
  float3 L = omniPosAndInvRad.xyz - vPos;

  // Normalize it, and save off distance to use later
  // for attenuation
  float dist = length(L);
  output.L = L / dist;

  // Compute view and halfway vector.
  // Note that the view position is the origin,
  // in view space, by definition
  float3 V = normalize(-vPos);
  output.H = normalize(V + output.L);

  // Compute attenuation factor.  Note that we do NOT clamp
  // to zero here, we will do that in the pixel shader.  This
  // is important in case the falloff reaches zero in the middle
  // of a large polygon.
  float attenFactor = 1 - dist*omniPosAndInvRad.w;
  output.lightColor = omniColor * attenFactor;

  // Pass through UV's without modification
  output.uv = input.uv;

  return output;
}
</pre>
<span class="Caption">
<span class="Label">Listing&#160;10.17</span><span class="CaptionText">
Vertex shader for per-pixel lighting of a single omni plus ambient,
calculated in camera space
</span>
</span>
</div>
</p>
<p>
World space (&#8220;upright space&#8221;) is an attractive option for lighting calculations in many
circumstances because shadow cube maps or lighting probes are usually rendered in this
orientation; it also has the advantage that we do not need to resend lighting-related shader
constants due to change of the model reference frame for each object.
</p>
<h2 id="hlsl_gouraud_lighting"><span class="SectionNumber">10.11.3</span><span class="SectionTitle">Gouraud Shading</span></h2>
<p class="NoIndent">Even modest modern hardware has plenty of beef for Phong shading; indeed, the previous examples
are relatively cheap shaders.  However, it's very instructive to consider how to implement
Gouraud shading.  Even though the results are inferior to Phong shading, and Gouraud shading
precludes bump mapping, Gouraud shading can still be useful on the PC to emulate the results of
other hardware.
</p>
<p>
<a href="#omni_gouraud_v">Listing&#160;10.18</a> is a vertex shader that performs the same lighting calculations as
just demonstrated in <a href="#hlsl_basic_per_pixel_lighting">Section&#160;10.11.2</a>, only they are done at the vertex
level. Compare this shader code to <a href="#standard_lighting_model_gouraud_suitable">Equation&#160;(10.15)</a>.
</p>
<p>
<div id="omni_gouraud_v" class="Wide Display Listing">
<pre>
// Mesh inputs.
struct Input {
  float4 pos    : POSITION;  // position in model space
  float3 normal : NORMAL;    // vertex normal in model space
  float2 uv     : TEXCOORD0; // texture coords for diffuse, spec maps
};

// Vertex shader output
struct Output {
  float4 clipPos   : POSITION;  // clip-space position
  float2 uv        : TEXCOORD0; // texture coords for diffuse, spec maps
  float3 diffColor : TEXCOORD1; // diffuse lighting RGB
  float3 specColor : TEXCOORD2; // specular lighting RGB
};

// Model-&gt;clip transform matrix.
uniform float4x4 modelToClip;

// Omni light position, in MODEL space, and reciprocal of
// falloff in the w component
uniform float4 omniPosAndInvRad;

// Unattenuated omni light color
uniform float3 omniColor;

// Constant ambient light color
uniform float3 ambientLightColor;

// View position, in MODEL space
uniform float3 viewPos;

// Material glossiness (phong exponent)
uniform float specExponent;

// The body of our vertex shader
Output main(Input input) {
  Output output;

  // Transform vertex position to clip space.
  output.clipPos = mul(input.pos, modelToClip);

  // Compute vector to light
  float L = omniPosAndInvRad.xyz - input.pos;

  // Normalize it, and save off distance to use later
  // for attenuation
  float dist = length(L);
  L /= dist;

  // Compute view and halfway vector
  float3 V = normalize(viewPos - input.pos);
  float3 H = normalize(V + L);

  // Compute attenuated light color.
  float3 lightColor = omniColor * max(1 - dist*omniPosAndInvRad.w,0);

  // Compute diffuse and specular factors
  float diffFactor = max(dot(input.normal, L),0);
  float specFactor = pow(max(dot(input.normal,H),0), specExponent);

  // Compute effective light colors
  output.diffColor = lightColor*diffFactor + ambientLightColor;
  output.specColor = lightColor*specFactor;

  // Pass through the supplied UV coordinates without modification
  output.uv = input.uv;

  return output;
}
</pre>
<span class="Caption">
<span class="Label">Listing&#160;10.18</span><span class="CaptionText">Vertex shader for Gouraud shading of a single omni plus ambient</span>
</span>
</div>
</p>
<p>
Now the pixel shader (<a href="#gouraud_p">Listing&#160;10.19</a>) simply takes the lighting results and modulates by
the material diffuse and specular colors, from the texture maps.
</p>
<p>
<div id="gouraud_p" class="Wide Display Listing">
<pre>
// Interpolated inputs from the vertex shader.
struct Input {
  float2 uv        : TEXCOORD0; // texture coords for diffuse, spec maps
  float3 diffColor : TEXCOORD1; // diffuse lighting RGB
  float3 specColor : TEXCOORD2; // specular lighting RGB
};

// A global constant RGB and opacity
uniform float4 constantColor;

// Diffuse and specular map samplers.  Note that we assume that diffuse
// and spec maps are mapped the same, and so they use the same UV coords
sampler2D diffuseMap;
sampler2D specularMap;

// Pixel shader body
float4 main(Input input): COLOR {

  // Fetch the texels to get the material colors
  float4 materialDiff = tex2D(diffuseMap, input.uv);
  float4 materialSpec = tex2D(specularMap, input.uv);

  // Sum up colors.  Note that HLSL has a very flexible swizzling system
  // which allows us to access a portion of a vector as if were a
  // "member" of the vector
  float4 result = materialDiff; // RGB *and* opacity from diffuse map
  result.rgb *= input.diffColor; // modulate by diffuse+ambient lighting
  result.rgb +=
    materialSpec.rgb*input.specColor; // add spec, ignore map alpha

  // Modulate it by the constant and output
  return result*constantColor;
}
</pre>
<span class="Caption">
<span class="Label">Listing&#160;10.19</span><span class="CaptionText">Pixel shader for Gouraud shading for any lighting environment</span>
</span>
</div>
</p>
<p>
As the caption for <a href="#gouraud_p">Listing&#160;10.19</a> indicates, this pixel shader does not depend on the
number of lights, or even the lighting model, since all lighting calculations are done in the
vertex shader.  <a href="#three_directional_lights_gouraud_v">Listing&#160;10.20</a> shows a vertex shader that could
be used with this same pixel shader, but it implements a different lighting environment: ambient
plus three directional lights.  This is a very useful lighting environment in editors and tools,
since it's easy to create one lighting rig that works decently well for practically any object
(although we would usually use it with per-pixel shading).
</p>
<p>
<div id="three_directional_lights_gouraud_v" class="Wide Display Listing">
<pre>
// Mesh inputs.
struct Input {
  float4 pos    : POSITION;  // position in model space
  float3 normal : NORMAL;    // vertex normal in model space
  float2 uv     : TEXCOORD0; // texture coords for diffuse, spec maps
};

// Vertex shader output
struct Output {
  float4 clipPos   : POSITION;  // clip-space position
  float2 uv        : TEXCOORD0; // texture coords for diffuse, spec maps
  float3 diffColor : TEXCOORD1; // diffuse lighting RGB
  float3 specColor : TEXCOORD2; // specular lighting RGB
};

// Model-&gt;clip transform matrix.
uniform float4x4 modelToClip;

// Three light directions (in MODEL space).  These point
// in the opposite direction that the light is shining.
uniform float3 lightDir[3];

// Three light RGB colors
uniform float3 lightColor[3];

// Constant ambient light color
uniform float3 ambientLightColor;

// View position, in MODEL space
uniform float3 viewPos;

// Material glossiness (phong exponent)
uniform float specExponent;

// The body of our vertex shader
Output main(Input input) {
  Output output;

  // Transform vertex position to clip space.
  output.clipPos = mul(input.pos, modelToClip);

  // Compute the V vector
  float3 V = normalize(viewPos - input.pos);

  // Clear accumulators.
  output.diffColor = ambientLightColor;
  output.specColor = 0;

  // Sum up lights.  Note that the compiler is *usually* pretty
  // good at unrolling small loops like this, but to ensure
  // the fastest code, it's best not to depend on the compiler,
  // and unroll the loop yourself
  for (int i = 0 ; i &lt; 3 ; ++i) {

    // Compute lambert term and sum diffuse contrib
    float nDotL = dot(input.normal, lightDir[i]);
    output.diffColor += max(nDotL,0) * lightColor[i];

    // Compute halfway vector
    float3 H = normalize(V + lightDir[i]);

    // Sum  specular contrib
    float nDotH = dot(input.normal,H);
    float s = pow(max(nDotH,0), specExponent);
    output.specColor += s*lightColor[i];
  }

  // Pass through the supplied UV coordinates without modification
  output.uv = input.uv;

  return output;
}
</pre>
<span class="Caption">
<span class="Label">Listing&#160;10.20</span><span class="CaptionText">Vertex shader for Gouraud shading, using constant ambient plus three directional lights</span>
</span>
</div>
</p>
<h2 id="hlsl_bump_mapping"><span class="SectionNumber">10.11.4</span><span class="SectionTitle">Bump Mapping</span></h2>
<p class="NoIndent">
Next, let's look at an example of normal mapping.  We will be performing the lighting in tangent
space, and we'll stick with the lighting environment of a single omni light plus constant ambient
to make the examples easier to compare. In the vertex shader (<a href="#omni_bump_mapped_1_v">Listing&#160;10.21</a>),
we synthesize the binormal from the normal and tangent. Then, we use the three basis vectors
to rotate <span class="inlinecode">L</span> and <span class="inlinecode">H</span> into tangent space, after first computing them as
usual in model space.  Notice the use of the three dot products, which is equivalent to
multiplication by the transpose of the matrix. We also perform the attenuation calculations in
the vertex shader, passing the unclamped attenuated light color, as we have done in previous
examples.
</p>
<p>
<div id="omni_bump_mapped_1_v" class="Wide Display Listing">
<pre>
// Mesh inputs.
struct Input {
  float4 pos        : POSITION;  // position in model space
  float3 normal     : NORMAL;    // vertex normal in model space
  float4 tangentDet : TANGENT;   // tangent in model space, det in w
  float2 uv         : TEXCOORD0; // texture coords for diffuse, spec maps
};

// Vertex shader output
struct Output {
  float4 clipPos    : POSITION;  // clip-space position
  float2 uv         : TEXCOORD0; // texture coords for all maps
  float3 L          : TEXCOORD1; // vector to light, in TANGENT space
  float3 H          : TEXCOORD2; // halfway vector, in TANGENT space
  float3 lightColor : TEXCOORD3; // light color &amp; attenuation factor
};

// Model-&gt;clip transform matrix.
uniform float4x4 modelToClip;

// Omni light position, in MODEL space, and reciprocal of
// falloff in the w component
uniform float4 omniPosAndInvRad;

// Unattenuated omni light color
uniform float3 omniColor;

// View position, in MODEL space
uniform float3 viewPos;

// The body of our vertex shader
Output main(Input input) {
  Output output;

  // Transform vertex position to clip space.
  output.clipPos = mul(input.pos, modelToClip);

  // Compute vector to light (in model space)
  float3 L_model = omniPosAndInvRad.xyz - input.pos.xyz;

  // Normalize it, and save off distance to use later
  // for attenuation
  float dist = length(L_model);
  float3 L_model_norm = L_model / dist;

  // Compute view and halfway vector
  float3 V_model = normalize(viewPos - input.pos);
  float3 H_model = normalize(V_model + L_model_norm);

  // Reconstruct the third basis vector
  float3 binormal =
    cross(input.normal, input.tangentDet.xyz) * input.tangentDet.w;

  // Rotate lighting-related vectors into tangent space
  output.L.x = dot(L_model, input.tangentDet.xyz);
  output.L.y = dot(L_model, binormal);
  output.L.z = dot(L_model, input.normal);

  output.H.x = dot(H_model, input.tangentDet.xyz);
  output.H.y = dot(H_model, binormal);
  output.H.z = dot(H_model, input.normal);

  // Compute UNCLAMPED color + attenuation factor.
  float attenFactor = 1 - dist*omniPosAndInvRad.w;
  output.lightColor = omniColor * attenFactor;

  // Pass through mapping coords without modification
  output.uv = input.uv;

  return output;
}
</pre>
<span class="Caption">
<span class="Label">Listing&#160;10.21</span><span class="CaptionText">Vertex shader for omni lighting of normal mapped object, with lighting done in tangent space</span>
</span>
</div>
</p>
<p>
The pixel shader (<a href="#omni_bump_mapped_1_p">Listing&#160;10.22</a>) is quite compact, since most of the prep
work has been done in the vertex shader. We unpack the normal and normalize the interpolated
<span class="inlinecode">L</span> and <span class="inlinecode">H</span> vectors. Then we perform the Blinn-Phong lighting equation,
just as in the other examples.
</p>
<p>
<div id="omni_bump_mapped_1_p" class="Wide Display Listing">
<pre>
// Interpolated inputs from the vertex shader.
struct Input {
  float2 uv         : TEXCOORD0; // texture coords for all maps
  float3 L          : TEXCOORD1; // vector to light, in TANGENT space
  float3 H          : TEXCOORD2; // halfway vector, in TANGENT space
  float3 lightColor : TEXCOORD3; // light color + and attenuation factor
};

// A global constant RGB and opacity
uniform float4 constantColor;

// Constant ambient light color
uniform float3 ambientLightColor;

// Material glossiness (phong exponent)
uniform float specExponent;

// Diffuse, spec, and normal map samplers
sampler2D diffuseMap;
sampler2D specularMap;
sampler2D normalMap;

// Pixel shader body
float4 main(Input input): COLOR {

  // Fetch the texels to get the material colors
  float4 matDiff = tex2D(diffuseMap, input.uv);
  float4 matSpec = tex2D(specularMap, input.uv);

  // Decode the tangent-space normal
  float3 N = tex2D(normalMap, input.uv).rgb * 2 - 1;

  // Normalize interpolated lighting vectors
  float3 L = normalize(input.L);
  float3 H = normalize(input.H);
  // Compute diffuse and specular factors
  float diffFactor = max(dot(N, L),0);
  float specFactor = pow(max(dot(N,H),0), specExponent);

  // Clamp the light color and attenuation
  float3 lightColor = max(input.lightColor,0);

  // Compute effective light colors
  float3 diffColor = lightColor*diffFactor + ambientLightColor;
  float3 specColor = lightColor*specFactor;

  // Sum up colors.
  float4 result = matDiff; // RGB &amp; opacity from the diffuse map
  result.rgb *= diffColor; // modulate by diffuse+ambient lighting
  result.rgb += matSpec.rgb*specColor; // add spec, ignore map alpha

  // Modulate it by the constant and output
  return result*constantColor;
}
</pre>
<span class="Caption">
<span class="Label">Listing&#160;10.22</span><span class="CaptionText">Pixel shader for omni lighting of normal mapped object, with lighting done in tangent space</span>
</span>
</div>
</p>
<h2 id="hlsl_skinned mesh"><span class="SectionNumber">10.11.5</span><span class="SectionTitle">Skinned Mesh</span></h2>
<p class="NoIndent">Now for some examples of skeletal rendering.  All of the skinning happens in the vertex shaders,
and so we will not need to show any pixel shaders here; the vertex shaders here can be used with
the pixel shaders given previously.  This is not unusual: skinned and unskinned geometry can
usually share the same pixel shader. We give two examples.  The first example
(<a href="#omni_per_pixel_skinned_v">Listing&#160;10.23</a>) illustrates per-pixel lighting of our omni + ambient
lighting rig.  We will do all the lighting in the pixel shader (<a href="#omni_per_pixel_1_p">Listing&#160;10.14</a>),
so that we can focus on the skinning, which is what is new.
</p>
<p>
<div id="omni_per_pixel_skinned_v" class="Wide Display Listing">
<pre>
// Mesh inputs.
struct Input {
  float4 pos     : POSITION;     // model space position (binding pose)
  float3 normal  : NORMAL;       // model space vertex normal (ditto)
  byte4  bones   : BLENDINDICES; // Bone indices.  Unused entries are 0
  float4 weight  : BLENDWEIGHT;  // Blend weights.  Unused entries are 0
  float2 uv      : TEXCOORD0;    // texture coords for diffuse, spec maps
};

// Vertex shader output.
struct Output {
  float4 clipPos  : POSITION;  // clip-space position (for rasterization)
  float2 uv       : TEXCOORD0; // texture coords for diffuse, spec maps
  float3 normal   : TEXCOORD1; // vertex normal in model space
  float3 modelPos : TEXCOORD2; // position in model space (for lighting)
};

// Model-&gt;clip transform matrix.
uniform float4x4 modelToClip;

// Declare an arbitrary max number of bones.
#define MAX_BONES 40

// Array of ``binding pose -&gt; current'' pose matrices for each bone.
// These are 4x3 matrices, which we iterpret as 4x4 matrices with the
// rightmost column assumed to be [0,0,0,1].  Note we are assuming
// that column_major is the default storage --- meaning each column
// is stored in a 4D register.  Thus each matrix takes 3 registers.
uniform float4x3 boneMatrix[MAX_BONES];

// The body of our vertex shader
Output main(Input input) {
  Output output;

  // Generate a blended matrix.  Notice that we always blend 4 bones,
  // even though most vertices will use fewer bones.  Whether its
  // faster to use conditional logic to try to bypass this extra logic,
  // or if it's better to just to all of calculations (which can be
  // easily scheduled by the assembler to hide any instruction
  // latency) will depend on the hardware.
  float4x3 blendedMat =
  boneMatrix[input.bones.x]*input.weight.x
    + boneMatrix[input.bones.y]*input.weight.y
    + boneMatrix[input.bones.z]*input.weight.z
    + boneMatrix[input.bones.w]*input.weight.w;

  // Perform skinning to transform position and normal
  // from their binding pose position into the position
  // for the current pose.  Note the matrix  multiplication
  // [1x3] = [1x4] x [4x3]
  output.modelPos = mul(input.pos, blendedMat);
  output.normal = mul(float4(input.normal,0), blendedMat);
  output.normal = normalize(output.normal);

  // Transform vertex position to clip space.
  output.clipPos = mul(float4(output.modelPos,1), modelToClip);

  // Pass through UVs
  output.uv = input.uv;

  return output;
}
</pre>
<span class="Caption"><span class="Label">Listing&#160;10.23</span><span class="CaptionText">Vertex shader for skinned geometry</span>
</span>
</div>
</p>
<p>
We have declared the vertices as an array of vertex shader constants, and sending all these
matrices to the hardware can be a significant performance bottleneck.  On certain platforms there
are more efficient ways of doing this, such as indexing into an auxiliary &#8220;vertex&#8221; stream.
</p>
<p>
Next, let's show how to use normal mapping on a skinned mesh.  The vertex shader in
<a href="#omni_bump_mapped_skinned_v">Listing&#160;10.24</a> could be used with the pixel shader in
<a href="#omni_bump_mapped_1_p">Listing&#160;10.22</a>.
</p>
<p>
<div id="omni_bump_mapped_skinned_v" class="Wide Display Listing">
<pre>
// Mesh inputs.
struct Input {
  float4 pos        : POSITION;     // model space posn (binding pose)
  float3 normal     : NORMAL;       // vertex normal in model space
  float4 tangentDet : TANGENT;      // model space tangent, det in w
  byte4  bones      : BLENDINDICES; // Bone indices.  Unused entries 0
  float4 weight     : BLENDWEIGHT;  // Blend weights.  Unused entries 0
  float2 uv         : TEXCOORD0;    // texture coords for diff, spec maps
};

// Vertex shader output
struct Output {
  float4 pos        : POSITION;  // clip-space position
  float2 uv         : TEXCOORD0; // texture coords for all maps
  float3 L          : TEXCOORD1; // vector to light, in TANGENT space
  float3 H          : TEXCOORD2; // halfway vector, in TANGENT space
  float3 lightColor : TEXCOORD3; // light color + and attenuation factor
};

// Model-&gt;clip transform matrix.
uniform float4x4 modelToClip;

// Array of ``binding pose -&gt; current'' pose matrices for each bone.
#define MAX_BONES 40
uniform float4x3 boneMatrix[MAX_BONES];

// Omni light position, in MODEL space, and reciprocal of
// falloff in the w component
uniform float4 omniPosAndInvRad;

// Unattenuated omni light color
uniform float3 omniColor;

// View position, in MODEL space
uniform float3 viewPos;

// The body of our vertex shader
Output main(Input input) {
  Output output;

  // Generate a blended matrix.
  float4x3 blendedMat =
    boneMatrix[input.bones.x]*input.weight.x
    + boneMatrix[input.bones.y]*input.weight.y
    + boneMatrix[input.bones.z]*input.weight.z
    + boneMatrix[input.bones.w]*input.weight.w;

  // Perform skinning to get values in model space,
  // in the current pose
  float3 pos = mul(input.pos, blendedMat);
  float3 normal = normalize(mul(float4(input.normal,0), blendedMat));
  float3 tangent =
    normalize(mul(float4(input.tangentDet.xyz,0), blendedMat));

  // Transform vertex position to clip space.
  output.pos = mul(float4(pos,1), modelToClip);

  // Compute vector to light (in model space)
  float3 L_model = omniPosAndInvRad.xyz - pos;

  // Normalize it, and save off distance to use later
  // for attenuation
  float dist = length(L_model);
  float3 L_model_norm = L_model / dist;

  // Compute view and halfway vector
  float3 V_model = normalize(viewPos - pos);
  float3 H_model = normalize(V_model + L_model_norm);

  // Reconstruct the third basis vector
  float3 binormal = cross(normal, tangent) * input.tangentDet.w;

  // Rotate lighting-related vectors into tangent space
  output.L.x = dot(L_model, tangent);
  output.L.y = dot(L_model, binormal);
  output.L.z = dot(L_model, normal);

  output.H.x = dot(H_model, tangent);
  output.H.y = dot(H_model, binormal);
  output.H.z = dot(H_model, normal);

  // Compute UNCLAMPED color + attenuation factor.
  float attenFactor = 1 - dist*omniPosAndInvRad.w;
  output.lightColor = omniColor * attenFactor;

  // Pass through mapping coords without modification
  output.uv = input.uv;

  return output;
}
</pre>
<span class="Caption">
<span class="Label">Listing&#160;10.24</span><span class="CaptionText">Vertex shader for skinned, normal-mapped geometry</span>
</span>
</div>
</p>

<h1 id="further_reading"><span class="SectionNumber">10.12</span><span class="SectionTitle">Further Reading</span></h1>
<p class="NoIndent">
A student seeking a good background in graphics is encouraged to divide his or her reading across
the spectrum, from &#8220;ivory tower&#8221; theoretical principles at one end, to &#8220;here is some source
code that runs on a particular platform and probably will be obsolete in 5 years&#8221; on the other.
We have made an attempt here to select, from the large body of graphics literature, just a few
sources that are especially recommended.
</p>
<p>
<i>Fundamentals of Computer Graphics</i> <a class="RefCite" href="#reference_23">[23]</a> by
Shirley provides a solid introductory survey of the fundamentals.  Written by one of the field's
founding fathers, it is used as the first-year textbook for graphics courses at many
universities, and is our recommendation for those near the beginning of their graphics education.
</p>
<p>
Glassner's magnum opus <i>Principles of Digital Image Synthesis</i> <a class="RefCite" href="#reference_8">[8]</a> has
stood out among the theoretical works for its comprehensive scope and continued relevance since
it was first published in 1995. For a reader wishing to learn &#8220;how graphics really works,&#8221; as
we described at the start of this chapter, this masterwork is required reading, even though it is
inexplicably underappreciated in the video game industry.  Best of all, both volumes have
recently been made available in electronic form for free (legitimately). You can find them on
<a href="https://books.google.com">books.google.com</a>.  A consolidated, corrected PDF should be available soon.
</p>
<p>
Phar and Humphreys' <i>Physically Based Rendering</i> <a class="RefCite" href="#reference_20">[20]</a> is an
excellent way to learn the proper theoretical framework of graphics.  Shorter and more recent
than Glassner's, this text nonetheless provides a broad theoretical foundation of rendering
principles. Although this is an excellent book for theoretical purposes, a unique feature of the
book is the source code for a working raytracer that is woven throughout, illustrating how the
ideas can be implemented.
</p>
<p><i>Real-Time Rendering</i> <a class="RefCite" href="#reference_1">[1]</a>, by Akenine-M&#246;ller et al., gives a very broad
survey of issues specific to real-time rendering, such as rendering hardware, shader programs,
and performance.  This classic, in its third edition at the time of this writing, is essential
reading for any intermediate or advanced student interested in real-time graphics.
</p>
<p>The OpenGL <a class="RefCite" href="#reference_18">[18]</a> and DirectX <a class="RefCite" href="#reference_5">[5]</a> API
documentations are certainly important sources.  Not only is such reference material necessary
from a practical standpoint, but a surprising amount of knowledge can be gained just by browsing.
Nearly a generation of OpenGL users have grown up on the &#8220;red book&#8221; <a class="RefCite" href="#reference_19">[19]</a>.
</p>
<p>
The subtleties related to radiometry and color spaces that we glossed over are explained in more
detail by Glassner <a class="RefCite" href="#reference_8">[8]</a> and also by Phar andHumphreys
<a class="RefCite" href="#reference_20">[20]</a>. Ashdown <a class="RefCite" href="#reference_2">[2]</a> and Poynton
<a class="RefCite" href="#reference_22">[22]</a> have written papers that are approachable and freely available.
</p>

<h1 id="exercises">Exercises</h1>
<div class="ExercisesSection">
<ol class="ExercisesList">
    <li>
On the Nintendo Wii, a common frame buffer resolution is <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c36"></mjx-c><mjx-c class="mjx-c34"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c34"></mjx-c><mjx-c class="mjx-c38"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>640</mn><mo>&#215;</mo><mn>480</mn></math></mjx-assistive-mml>
</mjx-container>.  This same
        frame buffer resolution is used for 4:3 and 16:9 televisions.
<ol>
            <li class="HasCustomMarker"><span class="ItemMarker">(a)</span>What is the pixel aspect on a 4:3 television?</li>
<li class="HasCustomMarker"><span class="ItemMarker">(b)</span>What is the pixel aspect on a 16:9 television?</li>
</ol>
</li>
<li id="split_screen_aspect">
Continuing the previous exercise, assume we are making a split-screen cooperative game,
        and we assign one player the left <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c33"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c34"></mjx-c><mjx-c class="mjx-c38"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>320</mn><mo>&#215;</mo><mn>480</mn></math></mjx-assistive-mml>
</mjx-container>, and the other player the right
        <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c33"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c34"></mjx-c><mjx-c class="mjx-c38"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>320</mn><mo>&#215;</mo><mn>480</mn></math></mjx-assistive-mml>
</mjx-container>.  We always want the horizontal field of view to be <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c36"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-TeXAtom texclass="ORD"><mjx-msup><mjx-mi class="mjx-n"></mjx-mi><mjx-script style="vertical-align: 0.363em"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6F"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msup></mjx-TeXAtom>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>60</mn>
<mrow><msup><mi></mi>
<mrow><mi mathvariant="normal">o</mi></mrow>
</msup></mrow>
</math></mjx-assistive-mml>
</mjx-container>.  Assume
        the system settings tell us that the console is connected to a 4:3 television.
<ol>
            <li class="HasCustomMarker"><span class="ItemMarker">(a)</span>What is the window aspect?</li>
<li class="HasCustomMarker"><span class="ItemMarker">(b)</span>What should the horizontal zoom value be?</li>
<li class="HasCustomMarker"><span class="ItemMarker">(c)</span>What should the vertical zoom value be?</li>
<li class="HasCustomMarker"><span class="ItemMarker">(d)</span>What is the resulting vertical field of view, in degrees?</li>
<li class="HasCustomMarker">
<span class="ItemMarker">(e)</span>Assume the near and far clip planes are 1.0 and 256.0.  What is the
                clip matrix, assuming all OpenGL conventions?
</li>
<li class="HasCustomMarker">
<span class="ItemMarker">(f)</span>What about the DirectX conventions?
</li>
</ol>
</li>
<li>
Repeat parts (a)&#8211;(d) from <a href="#split_screen_aspect">Exercise&#160;2</a>, but assume a 16:9 television.
</li>
<li id="texture_map_quad_match">
For each set of UV coordinates (a)&#8211;(f), match it with the corresponding texture-mapped
        quad in <a href="#exercise_texture_mapping_match">Figure&#160;10.43</a>. The upper-left vertex is numbered
        0, and the vertices are enumerated clockwise around the quad.
<div class="DisplayMath">
<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" display="true" role="presentation">
<mjx-math display="true" style="margin-left: 0; margin-right: 0" class=" MJX-TEX" aria-hidden="true"><mjx-mtable style="min-width: 36.895em"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-bottom: 0.15em"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c28"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c29"></mjx-c></mjx-mtext><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-right: 1em; padding-bottom: 0.15em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding-left: 1em; padding-right: 0; padding-bottom: 0.15em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-right: 1em; padding-bottom: 0.15em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3A"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c33"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding-left: 1em; padding-right: 0; padding-bottom: 0.15em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-right: 1em; padding-bottom: 0.15em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3A"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c33"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c33"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding-left: 1em; padding-right: 0; padding-bottom: 0.15em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-right: 1em; padding-bottom: 0.15em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3A"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c33"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding-left: 1em; padding-right: 0; padding-bottom: 0.15em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-bottom: 0.15em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3A"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c28"></mjx-c><mjx-c class="mjx-c62"></mjx-c><mjx-c class="mjx-c29"></mjx-c></mjx-mtext><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 1em 0.15em 0"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0 0.15em 1em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 1em 0.15em 0"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3A"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0 0.15em 1em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 1em 0.15em 0"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3A"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c36"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0 0.15em 1em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 1em 0.15em 0"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3A"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c36"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0 0.15em 1em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3A"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c28"></mjx-c><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c29"></mjx-c></mjx-mtext><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 1em 0.15em 0"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0 0.15em 1em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 1em 0.15em 0"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3A"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0 0.15em 1em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 1em 0.15em 0"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3A"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0 0.15em 1em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 1em 0.15em 0"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3A"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0 0.15em 1em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3A"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c34"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c28"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-c29"></mjx-c></mjx-mtext><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 1em 0.15em 0"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0 0.15em 1em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 1em 0.15em 0"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3A"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0 0.15em 1em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 1em 0.15em 0"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3A"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0 0.15em 1em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 1em 0.15em 0"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3A"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0 0.15em 1em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3A"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c28"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c29"></mjx-c></mjx-mtext><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 1em 0.15em 0"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0 0.15em 1em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 1em 0.15em 0"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3A"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0 0.15em 1em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 1em 0.15em 0"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3A"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0 0.15em 1em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 1em 0.15em 0"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3A"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c39"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0 0.15em 1em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em; padding-bottom: 0.15em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3A"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c39"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0; padding-top: 0.15em"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c28"></mjx-c><mjx-c class="mjx-c66"></mjx-c><mjx-c class="mjx-c29"></mjx-c></mjx-mtext><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-right: 1em; padding-top: 0.15em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding-left: 1em; padding-right: 0; padding-top: 0.15em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-right: 1em; padding-top: 0.15em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3A"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding-left: 1em; padding-right: 0; padding-top: 0.15em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-right: 1em; padding-top: 0.15em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3A"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c33"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c33"></mjx-c><mjx-c class="mjx-c35"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c36"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding-left: 1em; padding-right: 0; padding-top: 0.15em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-right: 1em; padding-top: 0.15em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3A"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding-left: 1em; padding-right: 0; padding-top: 0.15em"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0; padding-top: 0.15em"><mjx-mn class="mjx-n"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3A"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c33"></mjx-c><mjx-c class="mjx-c36"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c39"></mjx-c><mjx-c class="mjx-c34"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" rowspacing="3pt"><mtr><mtd><mtext>(a)</mtext></mtd><mtd></mtd><mtd></mtd><mtd><mn>0</mn><mo>:</mo><mo stretchy="false">(</mo><mn>0.20</mn><mo>,</mo><mo>&#8722;</mo><mn>0.30</mn><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mn>1</mn><mo>:</mo><mo stretchy="false">(</mo><mn>1.30</mn><mo>,</mo><mo>&#8722;</mo><mn>0.30</mn><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mn>2</mn><mo>:</mo><mo stretchy="false">(</mo><mn>1.30</mn><mo>,</mo><mn>1.20</mn><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mn>3</mn><mo>:</mo><mo stretchy="false">(</mo><mn>0.20</mn><mo>,</mo><mn>1.20</mn><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mtext>(b)</mtext></mtd><mtd></mtd><mtd></mtd><mtd><mn>0</mn><mo>:</mo><mo stretchy="false">(</mo><mn>5.00</mn><mo>,</mo><mo>&#8722;</mo><mn>1.00</mn><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mn>1</mn><mo>:</mo><mo stretchy="false">(</mo><mn>6.00</mn><mo>,</mo><mo>&#8722;</mo><mn>1.00</mn><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mn>2</mn><mo>:</mo><mo stretchy="false">(</mo><mn>6.00</mn><mo>,</mo><mn>0.00</mn><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mn>3</mn><mo>:</mo><mo stretchy="false">(</mo><mn>5.00</mn><mo>,</mo><mn>0.00</mn><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mtext>(c)</mtext></mtd><mtd></mtd><mtd></mtd><mtd><mn>0</mn><mo>:</mo><mo stretchy="false">(</mo><mn>1.00</mn><mo>,</mo><mn>0.00</mn><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mn>1</mn><mo>:</mo><mo stretchy="false">(</mo><mo>&#8722;</mo><mn>0.23</mn><mo>,</mo><mo>&#8722;</mo><mn>0.77</mn><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mn>2</mn><mo>:</mo><mo stretchy="false">(</mo><mn>0.00</mn><mo>,</mo><mn>1.00</mn><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mn>3</mn><mo>:</mo><mo stretchy="false">(</mo><mn>1.24</mn><mo>,</mo><mn>1.77</mn><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mtext>(d)</mtext></mtd><mtd></mtd><mtd></mtd><mtd><mn>0</mn><mo>:</mo><mo stretchy="false">(</mo><mn>2.00</mn><mo>,</mo><mn>0.00</mn><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mn>1</mn><mo>:</mo><mo stretchy="false">(</mo><mn>1.00</mn><mo>,</mo><mn>1.00</mn><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mn>2</mn><mo>:</mo><mo stretchy="false">(</mo><mn>0.00</mn><mo>,</mo><mn>1.00</mn><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mn>3</mn><mo>:</mo><mo stretchy="false">(</mo><mn>1.00</mn><mo>,</mo><mn>0.00</mn><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mtext>(e)</mtext></mtd><mtd></mtd><mtd></mtd><mtd><mn>0</mn><mo>:</mo><mo stretchy="false">(</mo><mo>&#8722;</mo><mn>0.10</mn><mo>,</mo><mn>1.10</mn><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mn>1</mn><mo>:</mo><mo stretchy="false">(</mo><mo>&#8722;</mo><mn>0.10</mn><mo>,</mo><mn>0.10</mn><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mn>2</mn><mo>:</mo><mo stretchy="false">(</mo><mn>0.90</mn><mo>,</mo><mn>0.10</mn><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mn>3</mn><mo>:</mo><mo stretchy="false">(</mo><mn>0.90</mn><mo>,</mo><mn>1.10</mn><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mtext>(f)</mtext></mtd><mtd></mtd><mtd></mtd><mtd><mn>0</mn><mo>:</mo><mo stretchy="false">(</mo><mn>0.00</mn><mo>,</mo><mo>&#8722;</mo><mn>1.00</mn><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mn>1</mn><mo>:</mo><mo stretchy="false">(</mo><mn>3.35</mn><mo>,</mo><mn>0.06</mn><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mn>2</mn><mo>:</mo><mo stretchy="false">(</mo><mn>1.00</mn><mo>,</mo><mn>2.00</mn><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd><mn>3</mn><mo>:</mo><mo stretchy="false">(</mo><mo>&#8722;</mo><mn>2.36</mn><mo>,</mo><mn>0.94</mn><mo stretchy="false">)</mo></mtd></mtr></mtable></math></mjx-assistive-mml>
</mjx-container>
</div>
<div id="exercise_texture_mapping_match" class="Display Figure Wide">
<div class="Body">
<span class="CenterContainer">
<span></span><span class="CenterBody">
        <img src="figs/graphics/exercise_texture_mapping_match.png" loading="lazy" width="771" height="429">
</span><span></span>
</span>
</div><span class="Caption">
<span class="Label">Figure&#160;10.43</span><span class="CaptionText">Texture mapped quads for <a href="#texture_map_quad_match">Exercise&#160;4</a>
</span>
</span>
</div>
</li>
<li id="lighting_diffuse_spec_match">
For each entry (a)&#8211;(j) in the table below,
		match the Blinn-Phong material diffuse color, specular color, and specular exponent with
		the corresponding creepy floating head in <a href="#exercise_lighting_diffuse_spec_match">Figure&#160;10.44</a>.
		There is a single white omni light in the scene. Diffuse and specular colors are given as
		(red, green, blue) triples.
<br>
<br>
        <table>
<tr>
<td class="AlignRight"></td>
<td class="FontSmall"><b>Diffuse</b></td>
<td class="FontSmall"><b>Specular</b></td>
<td class="FontSmall"><b>Specular</b></td>
</tr>
<tr>
<td class="AlignRight">[-6pt]</td>
<td class="FontSmall"><b>Color</b></td>
<td class="FontSmall"><b>Color</b></td>
<td class="FontSmall"><b>Exponent</b></td>
</tr>
<tr class="HLineAbove">
<td class="AlignRight">(a)</td>
<td>(210,40,50)</td>
<td>(0,0,0)</td>
<td>1</td>
</tr>
<tr>
<td class="AlignRight">(b)</td>
<td>(65,55,200)</td>
<td>(150,0,0)</td>
<td>16</td>
</tr>
<tr>
<td class="AlignRight">(c)</td>
<td>(65,55,200)</td>
<td>(230,230,230)</td>
<td>2</td>
</tr>
<tr>
<td class="AlignRight">(d)</td>
<td>(50,50,100)</td>
<td>(210,40,50)</td>
<td>4</td>
</tr>
<tr>
<td class="AlignRight">(e)</td>
<td>(65,55,200)</td>
<td>(210,40,50)</td>
<td>2</td>
</tr>
<tr>
<td class="AlignRight">(f)</td>
<td>(65,55,200)</td>
<td>(0,0,0)</td>
<td>64</td>
</tr>
<tr>
<td class="AlignRight">(g)</td>
<td>(0,0,0)</td>
<td>(210,40,50)</td>
<td>1</td>
</tr>
<tr>
<td class="AlignRight">(h)</td>
<td>(210,40,50)</td>
<td>(100,100,100)</td>
<td>64</td>
</tr>
<tr>
<td class="AlignRight">(i)</td>
<td>(210,40,50)</td>
<td>(230,230,230)</td>
<td>2</td>
</tr>
<tr>
<td class="AlignRight">(j)</td>
<td>(210,40,50)</td>
<td>(65,55,200)</td>
<td>2</td>
</tr>
</table>
<br>
<div id="exercise_lighting_diffuse_spec_match" class="Display Figure Wide">
<div class="Body">
<span class="CenterContainer">
<span></span><span class="CenterBody">
        <img src="figs/graphics/exercise_lighting_diffuse_spec_match.png" loading="lazy" width="750" height="450">
</span><span></span>
</span>
</div><span class="Caption">
<span class="Label">Figure&#160;10.44</span><span class="CaptionText">
Creepy
			floating heads for <a href="#lighting_diffuse_spec_match">Exercise&#160;5</a>
</span>
</span>
</div>
</li>
<li>
How would the following normals be encoded in a 24-bit normal map with the usual
        conventions?
<br>
<table>
<tr>
<td class="AlignRight">(a)</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>&#8722;</mo><mn>1.00</mn><mo>,</mo><mn>0.00</mn><mo>,</mo><mn>0.00</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td class="AlignRight">(b)</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c36"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c33"></mjx-c><mjx-c class="mjx-c35"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c38"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c35"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0.267</mn><mo>,</mo><mo>&#8722;</mo><mn>0.535</mn><mo>,</mo><mn>0.805</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
<tr>
<td class="AlignRight">(c)</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0.00</mn><mo>,</mo><mn>0.00</mn><mo>,</mo><mn>1.00</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td class="AlignRight">(d)</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c38"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c34"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0.00</mn><mo>,</mo><mn>0.857</mn><mo>,</mo><mn>0.514</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
</tr>
</table>
</li>
<li>
For each row (a)&#8211;(d) in the table below, decode the texel from the normal map to obtain
        the tangent-space surface normal.  Determine the binormal from the vertex
        normal, tangent, and determinant.  Then calculate the model-space coordinates of
        the per-texel surface normal.
<br>
<table>
<tr>
<td class="AlignRight"></td>
<td class="FontSmall"><b>Normal map</b></td>
<td class="FontSmall"><b>Vertex</b></td>
<td class="FontSmall"><b>Vertex</b></td>
<td class="AlignCenter FontSmall"><b>Determinant</b></td>
</tr>
<tr>
<td class="AlignRight">[-6pt]</td>
<td class="FontSmall"><b>texel RGB</b></td>
<td class="FontSmall"><b>normal</b></td>
<td class="FontSmall"><b>tangent</b></td>
<td class="AlignCenter FontSmall"><b>(Mirror flag)</b></td>
</tr>
<tr class="HLineAbove">
<td class="AlignRight">(a)</td>
<td>(128,255,128)</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c34"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c38"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c34"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c38"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c38"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c36"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0.408</mn><mo>,</mo><mo>&#8722;</mo><mn>0.408</mn><mo>,</mo><mo>&#8722;</mo><mn>0.816</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td>[0.707,0.707,0.000]</td>
<td class="AlignCenter">1</td>
</tr>
<tr>
<td class="AlignRight">(b)</td>
<td>(106,155,250)</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0.000</mn><mo>,</mo><mn>1.000</mn><mo>,</mo><mn>0.000</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td>[1.000,0.000,0.000]</td>
<td class="AlignCenter">-1</td>
</tr>
<tr>
<td class="AlignRight">(c)</td>
<td>(128,218,218)</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>1.000</mn><mo>,</mo><mn>0.000</mn><mo>,</mo><mn>0.000</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td>[0.000,0.447,-0.894]</td>
<td class="AlignCenter">1</td>
</tr>
<tr>
<td class="AlignRight">(d)</td>
<td>(233,58,145)</td>
<td><mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c34"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c36"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c37"></mjx-c><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0.154</mn><mo>,</mo><mo>&#8722;</mo><mn>0.617</mn><mo>,</mo><mn>0.772</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml>
</mjx-container></td>
<td>[0.986,0.046,-0.161]</td>
<td class="AlignCenter">-1</td>
</tr>
</table>
</li>
</ol>
</div><div class="ChapterEndQuotes">
<div class="WittyQuotation">
        There are too many special effects in all these movies today.
<div class="QuotationSource">&#8212;&#160;Steven Spielberg (1946&#8211;)</div>
</div>
</div><p>
<div class="References">
<div class="RefSectionTitle">References</div>
<div id="reference_1" class="RefEntry">
<span class="RefNum">[1]</span><span class="RefBody">
Tomas Akenine-M&#246;ller, Eric Haines, and Natty Hoffman.
 &#160; <i>Real-Time Rendering</i>, Third edition.
 &#160; Natick, MA: A K Peters, Ltd., 2008.
 &#160; <a href="http://www.realtimerendering.com/">http://www.realtimerendering.com/</a>.
</span>
</div>
<div id="reference_2" class="RefEntry">
<span class="RefNum">[2]</span><span class="RefBody">
Ian Ashdown.
 &#160; &#8220;Photometry and Radiometry: A Tour Guide for Computer
  Graphics Enthusiasts.&#8221;
 &#160; Adapted from <i>Radiosity: A Programmer's Perspective</i>, Ian
  Ashdown, Wiley, 1994.
 &#160; <a href="http://www.helios32.com/">http://www.helios32.com/</a>.
</span>
</div>
<div id="reference_3" class="RefEntry">
<span class="RefNum">[3]</span><span class="RefBody">
Ronen Barzel.
 &#160; &#8220;Lighting Controls for Computer Cinematography.&#8221;
 &#160; <i>J. Graph. Tools</i> 2 (1997), 1&#8211;20.
</span>
</div>
<div id="reference_4" class="RefEntry">
<span class="RefNum">[4]</span><span class="RefBody">
James&#160;F. Blinn.
 &#160; &#8220;Models of Light Reflection for Computer Synthesized
  Pictures.&#8221;
 &#160; <i>SIGGRAPH Comput. Graph.</i> 11:2 (1977), 192&#8211;198.
</span>
</div>
<div id="reference_5" class="RefEntry">
<span class="RefNum">[5]</span><span class="RefBody">
&#8220;DirectX Developer Center.&#8221;
 &#160; <a href="http://msdn.microsoft.com/en-us/directx/default.aspx">http://msdn.microsoft.com/en-us/directx/default.aspx</a>.
</span>
</div>
<div id="reference_6" class="RefEntry">
<span class="RefNum">[6]</span><span class="RefBody">
Frederick Fisher and Andrew Woo.
 &#160; &#8220;<mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D445 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D438 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi><mo>&#8901;</mo><mi>E</mi></math></mjx-assistive-mml>
</mjx-container> versus <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D43B TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi><mo>&#8901;</mo><mi>H</mi></math></mjx-assistive-mml>
</mjx-container> Specular Highlights.&#8221;
 &#160; In <i>Graphics Gems IV</i>, edited by Paul&#160;S. Heckbert. San Diego:
  Academic Press Professional, 1994.
</span>
</div>
<div id="reference_7" class="RefEntry">
<span class="RefNum">[7]</span><span class="RefBody">
Andrew&#160;S. Glassner.
 &#160; &#8220;Maintaining Winged-Edge Models.&#8221;
 &#160; In <i>Graphics Gems II</i>, edited by James Arvo. San Diego: Academic
  Press Professional, 1991.
</span>
</div>
<div id="reference_8" class="RefEntry">
<span class="RefNum">[8]</span><span class="RefBody">
Andrew&#160;S Glassner.
 &#160; <i>Principles of Digital Image Synthesis</i>.
 &#160; San Francisco: Morgan Kaufmann Publishers, 1995.
 &#160; <a href="http://glassner.com/andrew/writing/books/podis.htm">http://glassner.com/andrew/writing/books/podis.htm</a>.
</span>
</div>
<div id="reference_9" class="RefEntry">
<span class="RefNum">[9]</span><span class="RefBody">
H.&#160;Gouraud.
 &#160; &#8220;Continuous Shading of Curved Surfaces.&#8221;
 &#160; <i>IEEE Transactions on Computers</i> 20 (1971), 623&#8211;629.
</span>
</div>
<div id="reference_10" class="RefEntry">
<span class="RefNum">[10]</span><span class="RefBody">
Ned Greene.
 &#160; &#8220;Environment Mapping and Other Applications of World
  Projections.&#8221;
 &#160; <i>IEEE Comput. Graph. Appl.</i> 6 (1986), 21&#8211;29.
</span>
</div>
<div id="reference_11" class="RefEntry">
<span class="RefNum">[11]</span><span class="RefBody">
Roy Hall.
 &#160; <i>Illumination and Color in Computer Generated Imagery</i>.
 &#160; New York: Springer-Verlag New York, 1989.
</span>
</div>
<div id="reference_12" class="RefEntry">
<span class="RefNum">[12]</span><span class="RefBody">
Paul&#160;S. Heckbert.
 &#160; &#8220;What Are the Coordinates of a Pixel?&#8221;
 &#160; In <i>Graphics Gems</i>, edited by Andrew&#160;S. Glassner, pp.&#160;246&#8211;248.
  San Diego: Academic Press Professional, 1990.
 &#160; <a href="http://www.graphicsgems.org/">http://www.graphicsgems.org/</a>.
</span>
</div>
<div id="reference_13" class="RefEntry">
<span class="RefNum">[13]</span><span class="RefBody">
James&#160;T. Kajiya.
 &#160; &#8220;The Rendering Equation.&#8221;
 &#160; In <i>SIGGRAPH '86: Proceedings of the 13th Annual Conference on
  Computer Graphics and Interactive Techniques</i>, pp.&#160;143&#8211;150. New York: ACM,
  1986.
</span>
</div>
<div id="reference_14" class="RefEntry">
<span class="RefNum">[14]</span><span class="RefBody">
Eric Lengyel.
 &#160; <i>Mathematics for 3D Game Programming and Computer Graphics</i>,
  Second edition.
 &#160; Boston: Charles River Media, 2004.
 &#160; <a href="http://www.terathon.com/books/mathgames2.html">http://www.terathon.com/books/mathgames2.html</a>.
</span>
</div>
<div id="reference_15" class="RefEntry">
<span class="RefNum">[15]</span><span class="RefBody">
T.&#160;M. MacRobert.
 &#160; <i>Spherical Harmonics</i>, Second edition.
 &#160; New York: Dover Publications, 1948.
</span>
</div>
<div id="reference_16" class="RefEntry">
<span class="RefNum">[16]</span><span class="RefBody">
Jason Mitchell, Gary McTaggart, and Chris Green.
 &#160; &#8220;Shading in Valve's Source Engine.&#8221;
 &#160; In <i>ACM SIGGRAPH 2006 Courses</i>, <i>SIGGRAPH '06</i>,
  pp.&#160;129&#8211;142. New York: ACM, 2006.
 &#160; <a href="http://www.valvesoftware.com/publications.html">http://www.valvesoftware.com/publications.html</a>.
</span>
</div>
<div id="reference_17" class="RefEntry">
<span class="RefNum">[17]</span><span class="RefBody">
Addy Ngan, Fr&#233;do Durand, and Wojciech Matusik.
 &#160; &#8220;Experimental Validation of Analytical BRDF Models.&#8221;
 &#160; In <i>ACM SIGGRAPH 2004 Sketches</i>, <i>SIGGRAPH '04</i>, pp.&#160;90&#8211;.
  New York: ACM, 2004.
</span>
</div>
<div id="reference_18" class="RefEntry">
<span class="RefNum">[18]</span><span class="RefBody">
&#8220;OpenGL Software Development Kit.&#8221;
 &#160; <a href="http://www.opengl.org/sdk/docs/man/">http://www.opengl.org/sdk/docs/man/</a>.
</span>
</div>
<div id="reference_19" class="RefEntry">
<span class="RefNum">[19]</span><span class="RefBody">
OpenGL Architecture Review Board, Shreiner, Dave, Woo, Mason, Neider,
  Jackie, and Davis, Tom.
 &#160; <i>OpenGL(R) Programming Guide: The Official Guide to Learning
  OpenGL(R), Version 2.1</i>.
 &#160; Reading, MA: Addison-Wesley Professional, 2007.
 &#160; <a href="http://www.opengl.org/documentation/red_book/">http://www.opengl.org/documentation/red_book/</a>.
</span>
</div>
<div id="reference_20" class="RefEntry">
<span class="RefNum">[20]</span><span class="RefBody">
Matt Pharr and Greg Humphreys.
 &#160; <i>Physically Based Rendering: From Theory to Implementation</i>.
 &#160; San Francisco: Morgan Kaufmann Publishers, 2004.
 &#160; <a href="http://www.pbrt.org/">http://www.pbrt.org/</a>.
</span>
</div>
<div id="reference_21" class="RefEntry">
<span class="RefNum">[21]</span><span class="RefBody">
Bui&#160;Tuong Phong.
 &#160; &#8220;Illumination for Computer Generated Pictures.&#8221;
 &#160; <i>Commun. ACM</i> 18:6 (1975), 311&#8211;317.
</span>
</div>
<div id="reference_22" class="RefEntry">
<span class="RefNum">[22]</span><span class="RefBody">
Charles Poynton.
 &#160; &#8220;Frequently Asked Questions about Color.&#8221;
 &#160; <a href="http://www.poynton.com/ColorFAQ.html">http://www.poynton.com/ColorFAQ.html</a>.
</span>
</div>
<div id="reference_23" class="RefEntry">
<span class="RefNum">[23]</span><span class="RefBody">
Peter Shirley.
 &#160; <i>Fundamentals of Computer Graphics</i>.
 &#160; Natick, MA: A K Peters, Ltd., 2002.
 &#160; <a href="http://www.cs.utah.edu/&nbsp;shirley/books/">http://www.cs.utah.edu/&#160;shirley/books/</a>.
</span>
</div>
<div id="reference_24" class="RefEntry">
<span class="RefNum">[24]</span><span class="RefBody">
Peter-Pike Sloan.
 &#160; &#8220;Stupid Spherical Harmonics (SH) Tricks.&#8221;
 &#160; Technical report, Microsoft Cooporation, 2008.
 &#160; <a href="http://www.ppsloan.org/publications">http://www.ppsloan.org/publications</a>.
</span>
</div>
<div id="reference_25" class="RefEntry">
<span class="RefNum">[25]</span><span class="RefBody">
Alvy&#160;Ray Smith.
 &#160; &#8220;A Pixel Is Not a Little Square, a Pixel Is Not a Little
  Square, a Pixel Is Not a Little Square! (And a Voxel is Not a Little Cube.&#8221;
 &#160; Technical report, Technical Memo 6, Microsoft Research, 1995.
 &#160; <a href="http://alvyray.com/memos/6_pixel.pdf">http://alvyray.com/memos/6_pixel.pdf</a>.
</span>
</div>
<div id="reference_26" class="RefEntry">
<span class="RefNum">[26]</span><span class="RefBody">
Paul&#160;S. Strauss.
 &#160; &#8220;A Realistic Lighting Model for Computer Animators.&#8221;
 &#160; <i>IEEE Comput. Graph. Appl.</i> 10:6 (1990), 56&#8211;64.
</span>
</div>
<div id="reference_27" class="RefEntry">
<span class="RefNum">[27]</span><span class="RefBody">
David&#160;R. Warn.
 &#160; &#8220;Lighting Controls for Synthetic Images.&#8221;
 &#160; In <i>Proceedings of the 10th Annual Conference on Computer
  Graphics and Interactive Techniques</i>, <i>SIGGRAPH '83</i>, pp.&#160;13&#8211;21. New
  York: ACM, 1983.
</span>
</div>
</div>
</p>
<ol class="Footnotes">
<li id="footnote_0">
Actually, almost everybody approximates the true physics of light by
using simpler
    <i>geometric optics</i>.
</li>
<li id="footnote_1">
Speaking of equipment, there are
also many phenomena that occur in a camera but not the eye, or as a result of the storage of an
image on film. These effects, too, are often simulated to make it look as if the animation was
filmed.
</li>
<li id="footnote_2">
Actually, it's probably not a good idea to think of pixels as having a &#8220;center,&#8221; as they are
not really rectangular blobs of color, but rather are best interpreted as infinitely small point
samples in a continuous signal. The question of which mental model is best is incredibly
important \cite_need_fixup{smith:pixel-not-a-square, heckbert:coordinates-of-pixel}, and is intimately
related to the process by which the pixels are combined to reconstruct an image.
    On CRTs, pixels were definitely not little rectangles, but on modern display devices such as
    LCD monitors, &#8220;rectangular blob of color&#8221; is not too bad of a description of the reconstruction
process. Nonetheless, whether pixels are rectangles or point samples, we still might not send a
single ray through the center of each pixel, but rather we might send several rays (&#8220;samples&#8221;)
in a smart pattern, and average them together them in a smart way.
</li>
<li id="footnote_3">
Further relevant questions that should influence what color we write into
the frame buffer could be asked concerning the general viewing conditions, but these issues have
no bearing on the light coming into our eye; rather, they affect our perception of that light.
</li>
<li id="footnote_4">
Remember that <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D714 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>&#969;</mi></math></mjx-assistive-mml>
</mjx-container> and <mjx-container class="MathJax" jax="CHTML" style="font-size: 100%; position: relative" role="presentation">
<mjx-math class=" MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D706 TEX-I"></mjx-c></mjx-mi>
</mjx-math>
<mjx-assistive-mml role="presentation" unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>&#955;</mi></math></mjx-assistive-mml>
</mjx-container> are
the lowercase Greek letters omega and lambda, respectively.
</li>
<li id="footnote_5">
Here and
elsewhere, we use the word &#8220;color&#8221; in a way that's technically a bit dodgy, but is OK under the
assumptions about light and color made in most graphics systems.
</li>
<li id="footnote_6">
Monitor manufacturers must have been overjoyed to find that people perceived a
premium quality to these
    &#8220;widescreen&#8221; monitors. Monitor sizes are typically measured by the
diagonal, but costs are more directly tied to number of pixels, which is proportional to area,
not diagonal length. Thus, a 16:9 monitor with the same number of pixels as a 4:3 will have a
longer diagonal measurement, which is perceived as a &#8220;bigger&#8221; monitor. We're not sure if the
proliferation of monitors with even wider aspect ratios is fueled more by market forces or
    market<i>ing</i> forces.
</li>
<li id="footnote_7">
While it causes videophiles extreme stress to see an image manhandled this way,
apparently some TV owners prefer a stretched image to the black bars, which give them the feeling
that they are not getting all their money's worth out of their expensive new&#160;TV.
</li>
<li id="footnote_8">
The
&#8220;film&#8221; is in front of the focal point rather than behind the focal point like in a real camera,
but that fact is not significant to this discussion.
</li>
<li id="footnote_9">
This is not
strictly necessary in some cases, but in practice we almost always use unit vectors.
</li>
<li id="footnote_10">
This technique of interpolating the vertex normals
is also sometimes confusingly known as <i>Phong</i> shading, not to be confused with the Phong
model for specular reflection.
</li>
<li id="footnote_11">Pronounced &#8220;guh-ROH.&#8221;</li>
<li id="footnote_12">
This is a very important lesson. Realistic graphics might be important to
hardcore gamers, but for a more general audience they are not nearly as important as we once
believed. The recent surge in popularity of facebook games further underscores this point.
</li>
<li id="footnote_13">
Unfortunately, some
people refer to this map as the <i>gloss map</i>, creating confusion as to exactly which material
property is being specified on a per-texel basis.
</li>
<li id="footnote_14">
The proper radiometric term is <i>irradiance</i>, which measures the radiant
power arriving per unit area.
</li>
<li id="footnote_15">Pronounced &#8220;fre-NELL.&#8221;</li>
<li id="footnote_16">
&#8220;Gobo&#8221; is short for &#8220;go between,&#8221; and &#8220;cookie&#8221; is short for
    &#8220;cucoloris.&#8221; The subtle technical difference between these terms from the world of theater is
not relevant for computer-generated imagery.
</li>
<li id="footnote_17">
You might also hear the term
    <i>rigging</i>, but this term can imply a wider range of tasks.  For example, often a rigger
creates an extra apparatus that assists with animation but is not used directly for rendering.
</li>
<li id="footnote_18">
Well, this is the ideal process.  In reality, changes to the mesh
are often necessary after the mesh is rigged.  The mesh might require adjustments in order to
make it bend better, although an experienced character modeler can anticipate the needs of
rigging. Of course, changes are often needed for aesthetic purposes having nothing to do with
rigging&#8212;especially if executives or focus groups are involved.
</li>
<li id="footnote_19">
And for high-res
renders for the box art. Some people also use high-res models to make disingenuous screen shots
of &#8220;in-game&#8221; footage, sort of like how the hamburger you get at a fast-food restaurant doesn't
look like the one in the picture on the menu.
</li>
<li id="footnote_20">
We don't all have
    <i>id Tech 5</i>'s MegaTexturing yet.
</li>
<li id="footnote_21">
The term &#8220;bitangent&#8221; is probably more correct; but it's less commonly
used.
</li>
<li id="footnote_22">
And most programmers have a lot in common, too,
        even though we might hate to admit it.
</li>
<li id="footnote_23">
For
example, the
    <i>RenderMan</i> shading language does not have this property.</li>
</ol>
<footer class="NavBar">
<div class="NavPrevChapter"><a class="NavChapterNum" href="geomprims.html">&lt;&lt; Geometric Primitives</a>
</div><div class="NavContents"><a onclick="window.scrollTo(0,0);" style="cursor:pointer;">Back To Top</a>
</div><div class="NavNextChapter"><a class="NavChapterNum" href="kinematics_calculus.html">Mechanics 1: Linear Kinematics and Calculus &gt;&gt;
</a></div>
</footer></div>
<div id="RightColumn"></div>
</div></body></html>